[0m12:34:27.468874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097506d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109750b50>]}


============================== 12:34:27.473072 | 909fd906-26cb-4cb5-ba6d-84a2736afee9 ==============================
[0m12:34:27.473072 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:34:27.473615 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt debug --target prod', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m12:34:27.485081 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m12:34:27.485606 [info ] [MainThread]: python version: 3.10.0
[0m12:34:27.485907 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:34:27.486190 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:34:27.490396 [info ] [MainThread]: Using profiles dir at /Users/preben/Documents/dbt-workshop
[0m12:34:27.490714 [info ] [MainThread]: Using profiles.yml file at /Users/preben/Documents/dbt-workshop/profiles.yml
[0m12:34:27.491097 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:34:27.606310 [info ] [MainThread]: Configuration:
[0m12:34:27.606742 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:34:27.607039 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:34:27.607316 [info ] [MainThread]: Required dependencies:
[0m12:34:27.607654 [debug] [MainThread]: Executing "git --help"
[0m12:34:27.621092 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:34:27.621884 [debug] [MainThread]: STDERR: "b''"
[0m12:34:27.622218 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:34:27.622538 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:34:27.622840 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:34:27.623115 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m12:34:27.924392 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.52839553, "process_in_blocks": "0", "process_kernel_time": 0.184818, "process_mem_max_rss": "109428736", "process_out_blocks": "0", "process_user_time": 1.417024}
[0m12:34:27.925826 [debug] [MainThread]: Command `dbt debug` failed at 12:34:27.925629 after 0.53 seconds
[0m12:34:27.926736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108268a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109825f90>]}
[0m12:34:27.927570 [debug] [MainThread]: Flushing usage events
[0m12:34:28.460961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:30.073688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b4d90>]}


============================== 12:34:30.077105 | 2b3bf297-289e-4306-985a-b10071a387b1 ==============================
[0m12:34:30.077105 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:34:30.077653 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --target prod', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m12:34:30.080675 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:34:30.082740 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07458783, "process_in_blocks": "0", "process_kernel_time": 0.112308, "process_mem_max_rss": "106119168", "process_out_blocks": "0", "process_user_time": 1.236159}
[0m12:34:30.083159 [debug] [MainThread]: Command `dbt build` failed at 12:34:30.083073 after 0.08 seconds
[0m12:34:30.083498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b6c20>]}
[0m12:34:30.084017 [debug] [MainThread]: Flushing usage events
[0m12:34:30.553164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:28.886361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a00730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a00bb0>]}


============================== 12:37:28.890395 | 2f4b3169-56e4-41c6-b106-fe07a8100820 ==============================
[0m12:37:28.890395 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:37:28.890948 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'invocation_command': 'dbt debug --target prod', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False'}
[0m12:37:28.902986 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m12:37:28.903365 [info ] [MainThread]: python version: 3.10.0
[0m12:37:28.903657 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:37:28.903933 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:37:28.908321 [info ] [MainThread]: Using profiles dir at /Users/preben/Documents/dbt-workshop
[0m12:37:28.908677 [info ] [MainThread]: Using profiles.yml file at /Users/preben/Documents/dbt-workshop/profiles.yml
[0m12:37:28.908957 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:37:29.023504 [info ] [MainThread]: Configuration:
[0m12:37:29.023951 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:37:29.024253 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:37:29.024534 [info ] [MainThread]: Required dependencies:
[0m12:37:29.024894 [debug] [MainThread]: Executing "git --help"
[0m12:37:29.035841 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:37:29.036592 [debug] [MainThread]: STDERR: "b''"
[0m12:37:29.036923 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:37:29.037239 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:37:29.037529 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:37:29.037799 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m12:37:29.040927 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22939354, "process_in_blocks": "0", "process_kernel_time": 0.154574, "process_mem_max_rss": "109740032", "process_out_blocks": "0", "process_user_time": 1.365646}
[0m12:37:29.041403 [debug] [MainThread]: Command `dbt debug` failed at 12:37:29.041304 after 0.23 seconds
[0m12:37:29.041827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03c70>]}
[0m12:37:29.042225 [debug] [MainThread]: Flushing usage events
[0m12:37:29.617344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:31.233213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc9a0>]}


============================== 12:37:31.237070 | 3bc4e05b-aa58-443d-89a1-1448f405fa20 ==============================
[0m12:37:31.237070 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:37:31.237614 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt build --target prod', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m12:37:31.240657 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:37:31.242816 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07452554, "process_in_blocks": "0", "process_kernel_time": 0.113117, "process_mem_max_rss": "106086400", "process_out_blocks": "0", "process_user_time": 1.237027}
[0m12:37:31.243310 [debug] [MainThread]: Command `dbt build` failed at 12:37:31.243216 after 0.08 seconds
[0m12:37:31.243660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcff370>]}
[0m12:37:31.244010 [debug] [MainThread]: Flushing usage events
[0m12:37:31.781946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:44.593413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c198280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d8be0>]}


============================== 12:42:44.597288 | dcc0268c-4043-41e8-a101-1901e08bf8cd ==============================
[0m12:42:44.597288 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:42:44.597825 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'empty': 'None', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m12:42:44.600863 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:42:44.603698 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.08370979, "process_in_blocks": "0", "process_kernel_time": 0.162065, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.24134}
[0m12:42:44.604179 [debug] [MainThread]: Command `dbt seed` failed at 12:42:44.604088 after 0.08 seconds
[0m12:42:44.604532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c198280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6db6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6dada0>]}
[0m12:42:44.604890 [debug] [MainThread]: Flushing usage events
[0m12:42:45.223927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:47.972054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71cbe0>]}


============================== 12:43:47.976120 | 431dbbce-aedd-4933-84e9-3bc836ab81ba ==============================
[0m12:43:47.976120 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:43:47.976657 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt seed', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m12:43:47.978256 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /Users/preben/Documents/dbt-workshop/profiles.yml
  
[0m12:43:47.980959 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.077663705, "process_in_blocks": "0", "process_kernel_time": 0.16098, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.247626}
[0m12:43:47.981385 [debug] [MainThread]: Command `dbt seed` failed at 12:43:47.981299 after 0.08 seconds
[0m12:43:47.981734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71f6a0>]}
[0m12:43:47.982059 [debug] [MainThread]: Flushing usage events
[0m12:43:48.487790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:59.108589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50be0>]}


============================== 12:44:59.112671 | cb756505-14b1-47d8-9ec7-942dfc1e0ae2 ==============================
[0m12:44:59.112671 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:44:59.113243 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'introspect': 'True'}
[0m12:44:59.117994 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m12:44:59.118682 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "workshop_duckdb", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m12:44:59.121056 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.082555875, "process_in_blocks": "0", "process_kernel_time": 0.161813, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.24929}
[0m12:44:59.121505 [debug] [MainThread]: Command `dbt seed` failed at 12:44:59.121418 after 0.08 seconds
[0m12:44:59.121828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb532b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50d90>]}
[0m12:44:59.122176 [debug] [MainThread]: Flushing usage events
[0m12:44:59.709894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:53.719238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935b010>]}


============================== 12:46:53.724124 | d3348f53-45c2-430a-8a2f-f6288ba90a79 ==============================
[0m12:46:53.724124 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:46:53.724657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:53.852210 [error] [MainThread]: Encountered an error:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:46:53.855077 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.19681813, "process_in_blocks": "0", "process_kernel_time": 0.149653, "process_mem_max_rss": "105857024", "process_out_blocks": "0", "process_user_time": 1.241223}
[0m12:46:53.855535 [debug] [MainThread]: Command `dbt seed` failed at 12:46:53.855446 after 0.20 seconds
[0m12:46:53.855874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b9150>]}
[0m12:46:53.856214 [debug] [MainThread]: Flushing usage events
[0m12:47:33.987512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11eec0>]}


============================== 12:47:33.992211 | b040c08e-9b40-4670-b6e5-643259214ee1 ==============================
[0m12:47:33.992211 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:47:33.992767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir . --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:34.002725 [info ] [MainThread]: dbt version: 1.8.9
[0m12:47:34.003131 [info ] [MainThread]: python version: 3.10.0
[0m12:47:34.003494 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:47:34.004035 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:47:34.125072 [info ] [MainThread]: Using profiles dir at .
[0m12:47:34.125514 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m12:47:34.125814 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:47:34.130035 [info ] [MainThread]: adapter type: duckdb
[0m12:47:34.130381 [info ] [MainThread]: adapter version: 1.8.4
[0m12:47:34.141379 [info ] [MainThread]: Configuration:
[0m12:47:34.141746 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:47:34.142075 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m12:47:34.142357 [info ] [MainThread]: Required dependencies:
[0m12:47:34.142682 [debug] [MainThread]: Executing "git --help"
[0m12:47:34.161237 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:47:34.162116 [debug] [MainThread]: STDERR: "b''"
[0m12:47:34.162473 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:47:34.162807 [info ] [MainThread]: Connection:
[0m12:47:34.163176 [info ] [MainThread]:   database: dev
[0m12:47:34.163534 [info ] [MainThread]:   schema: analytics_dev
[0m12:47:34.163878 [info ] [MainThread]:   path: ./warehouse/dev.duckdb
[0m12:47:34.164216 [info ] [MainThread]:   config_options: None
[0m12:47:34.164487 [info ] [MainThread]:   extensions: ['httpfs']
[0m12:47:34.164801 [info ] [MainThread]:   settings: {}
[0m12:47:34.165073 [info ] [MainThread]:   external_root: ./external
[0m12:47:34.165323 [info ] [MainThread]:   use_credential_provider: None
[0m12:47:34.165642 [info ] [MainThread]:   attach: None
[0m12:47:34.165915 [info ] [MainThread]:   filesystems: None
[0m12:47:34.166264 [info ] [MainThread]:   remote: None
[0m12:47:34.166606 [info ] [MainThread]:   plugins: None
[0m12:47:34.167021 [info ] [MainThread]:   disable_transactions: False
[0m12:47:34.167890 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:47:34.270978 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:47:34.323513 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:47:34.323867 [debug] [MainThread]: On debug: select 1 as id
[0m12:47:34.324154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:34.756081 [debug] [MainThread]: SQL status: OK in 0.432 seconds
[0m12:47:34.757257 [debug] [MainThread]: On debug: Close
[0m12:47:34.758926 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:47:34.759284 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:47:34.759562 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml


[0m12:47:34.762613 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.8347332, "process_in_blocks": "0", "process_kernel_time": 0.30395, "process_mem_max_rss": "130203648", "process_out_blocks": "0", "process_user_time": 1.515268}
[0m12:47:34.763061 [debug] [MainThread]: Command `dbt debug` failed at 12:47:34.762961 after 0.84 seconds
[0m12:47:34.763399 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:47:34.763744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e25f0>]}
[0m12:47:34.764143 [debug] [MainThread]: Flushing usage events
[0m12:47:36.795738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a985c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9851e0>]}


============================== 12:47:36.800754 | d08d042a-cc69-431f-9fc7-6b73967facf7 ==============================
[0m12:47:36.800754 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:47:36.801312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir . --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:47:36.905181 [error] [MainThread]: Encountered an error:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:47:36.907619 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.17241058, "process_in_blocks": "0", "process_kernel_time": 0.110477, "process_mem_max_rss": "105791488", "process_out_blocks": "0", "process_user_time": 1.2275}
[0m12:47:36.908123 [debug] [MainThread]: Command `dbt seed` failed at 12:47:36.908032 after 0.17 seconds
[0m12:47:36.908520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa8dc0>]}
[0m12:47:36.908895 [debug] [MainThread]: Flushing usage events
[0m12:48:35.611606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc458d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d2f80>]}


============================== 12:48:35.616472 | 300329d7-7dd1-435d-b744-c4e0cd09caa8 ==============================
[0m12:48:35.616472 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:35.617029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir . --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:35.628179 [info ] [MainThread]: dbt version: 1.8.9
[0m12:48:35.628581 [info ] [MainThread]: python version: 3.10.0
[0m12:48:35.628895 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:48:35.629187 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:48:35.748074 [info ] [MainThread]: Using profiles dir at .
[0m12:48:35.748494 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m12:48:35.748790 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:48:35.752519 [info ] [MainThread]: adapter type: duckdb
[0m12:48:35.752859 [info ] [MainThread]: adapter version: 1.8.4
[0m12:48:35.848188 [info ] [MainThread]: Configuration:
[0m12:48:35.848600 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:35.848894 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:35.849170 [info ] [MainThread]: Required dependencies:
[0m12:48:35.849503 [debug] [MainThread]: Executing "git --help"
[0m12:48:35.866563 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:35.867427 [debug] [MainThread]: STDERR: "b''"
[0m12:48:35.867751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:35.868061 [info ] [MainThread]: Connection:
[0m12:48:35.868392 [info ] [MainThread]:   database: dev
[0m12:48:35.868657 [info ] [MainThread]:   schema: analytics_dev
[0m12:48:35.868909 [info ] [MainThread]:   path: ./warehouse/dev.duckdb
[0m12:48:35.869162 [info ] [MainThread]:   config_options: None
[0m12:48:35.869690 [info ] [MainThread]:   extensions: ['httpfs']
[0m12:48:35.870033 [info ] [MainThread]:   settings: {}
[0m12:48:35.870318 [info ] [MainThread]:   external_root: ./external
[0m12:48:35.870585 [info ] [MainThread]:   use_credential_provider: None
[0m12:48:35.870845 [info ] [MainThread]:   attach: None
[0m12:48:35.871097 [info ] [MainThread]:   filesystems: None
[0m12:48:35.871351 [info ] [MainThread]:   remote: None
[0m12:48:35.871607 [info ] [MainThread]:   plugins: None
[0m12:48:35.871858 [info ] [MainThread]:   disable_transactions: False
[0m12:48:35.872499 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:48:35.962705 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:48:36.003557 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:48:36.003918 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:36.004202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:36.147371 [debug] [MainThread]: SQL status: OK in 0.143 seconds
[0m12:48:36.148300 [debug] [MainThread]: On debug: Close
[0m12:48:36.149683 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:36.150060 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:36.152822 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.60297644, "process_in_blocks": "0", "process_kernel_time": 0.29976, "process_mem_max_rss": "134529024", "process_out_blocks": "0", "process_user_time": 1.598457}
[0m12:48:36.153229 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:36.153142 after 0.60 seconds
[0m12:48:36.153528 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:36.153845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc458d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fa0b0>]}
[0m12:48:36.154219 [debug] [MainThread]: Flushing usage events
[0m12:48:38.271593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7f010>]}


============================== 12:48:38.275871 | 2cf08aa5-0020-47db-9c1a-b8cba7294b42 ==============================
[0m12:48:38.275871 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:38.276398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir . --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:38.508023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cf08aa5-0020-47db-9c1a-b8cba7294b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9cfa0>]}
[0m12:48:38.560816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cf08aa5-0020-47db-9c1a-b8cba7294b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107697be0>]}
[0m12:48:38.564794 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:48:38.690011 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 4 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:48:38.692391 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.47765446, "process_in_blocks": "0", "process_kernel_time": 0.13669, "process_mem_max_rss": "110215168", "process_out_blocks": "0", "process_user_time": 1.42462}
[0m12:48:38.692813 [debug] [MainThread]: Command `dbt seed` failed at 12:48:38.692728 after 0.48 seconds
[0m12:48:38.693194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917e320>]}
[0m12:48:38.693553 [debug] [MainThread]: Flushing usage events
[0m12:48:45.058153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2ec0>]}


============================== 12:48:45.062913 | 92f3ec45-bf4c-4c9b-b265-794a5009bd3b ==============================
[0m12:48:45.062913 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:45.063452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:48:45.179970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3940>]}
[0m12:48:45.193866 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-_ee8jy6j'
[0m12:48:45.194366 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:48:45.300365 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:48:45.300979 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:48:45.347137 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:48:45.354459 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m12:48:45.404493 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m12:48:45.408205 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:48:45.454263 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:48:45.455182 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m12:48:45.455558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efd90>]}
[0m12:48:45.458649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:48:45.503895 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:48:45.509705 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:48:45.644405 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:48:45.670058 [info ] [MainThread]: Updating lock file in file path: /Users/preben/Documents/dbt-workshop/package-lock.yml
[0m12:48:45.673442 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-uhq_1o3c'
[0m12:48:45.687147 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:48:46.017289 [info ] [MainThread]: Installed from version 1.1.1
[0m12:48:46.017704 [info ] [MainThread]: Updated version available: 1.3.1
[0m12:48:46.018060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080063b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef5e0>]}
[0m12:48:46.018411 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m12:48:46.496555 [info ] [MainThread]: Installed from version 0.11.0
[0m12:48:46.496997 [info ] [MainThread]: Updated version available: 1.0.2
[0m12:48:46.497427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080063b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef2e0>]}
[0m12:48:46.497803 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:48:47.159539 [info ] [MainThread]: Installed from version 0.10.3
[0m12:48:47.160745 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:48:47.161143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ec220>]}
[0m12:48:47.161513 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:48:47.409557 [info ] [MainThread]: Installed from version 0.12.1
[0m12:48:47.410025 [info ] [MainThread]: Updated version available: 0.13.1
[0m12:48:47.410409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ed900>]}
[0m12:48:47.410770 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:48:47.733698 [info ] [MainThread]: Installed from version 0.10.1
[0m12:48:47.734116 [info ] [MainThread]: Up to date!
[0m12:48:47.734465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef5b0>]}
[0m12:48:47.734811 [info ] [MainThread]: 
[0m12:48:47.735121 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m12:48:47.738566 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7394335, "process_in_blocks": "0", "process_kernel_time": 0.281932, "process_mem_max_rss": "105693184", "process_out_blocks": "0", "process_user_time": 1.478357}
[0m12:48:47.739029 [debug] [MainThread]: Command `dbt deps` succeeded at 12:48:47.738924 after 2.74 seconds
[0m12:48:47.739424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109527fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ed900>]}
[0m12:48:47.740017 [debug] [MainThread]: Flushing usage events
[0m12:50:09.172486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31d8a0>]}


============================== 12:50:09.177396 | 9cd4ef3f-a762-4616-9094-5029107bf9bf ==============================
[0m12:50:09.177396 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:50:09.177929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:09.435875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f12da0>]}
[0m12:50:09.486419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b38e0>]}
[0m12:50:09.492999 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:50:09.619475 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:50:09.620367 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:50:09.620746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b427ee0>]}
[0m12:50:12.010129 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:50:12.010646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb12ef0>]}
[0m12:50:12.380042 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:50:12.380502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:50:12.380821 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:50:12.381116 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:50:12.381399 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:50:12.381680 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:50:12.381961 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:50:12.382239 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:50:12.382514 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:50:12.382789 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:50:12.383060 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:50:12.383333 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:50:12.383619 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:50:12.383894 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:50:12.384167 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:50:12.384439 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:50:12.384712 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:50:12.384984 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:50:12.385256 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:50:12.385529 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:50:12.385803 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:50:12.386077 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:50:12.386349 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:50:12.386624 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:50:12.386898 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:50:12.387169 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:50:12.387440 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:50:12.387711 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:50:12.551748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ada80>]}
[0m12:50:12.705921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b882b30>]}
[0m12:50:12.706427 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:50:12.706766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31630>]}
[0m12:50:12.708935 [info ] [MainThread]: 
[0m12:50:12.709407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:50:12.714798 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:50:12.767198 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:50:12.767587 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m12:50:12.767877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:12.934735 [debug] [ThreadPool]: SQL status: OK in 0.167 seconds
[0m12:50:12.936673 [debug] [ThreadPool]: On list_dev: Close
[0m12:50:12.938425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_analytics_dev)
[0m12:50:12.939049 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "analytics_dev"
"
[0m12:50:12.946001 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.946334 [debug] [ThreadPool]: On create_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics_dev"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:50:12.946613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:12.987363 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m12:50:12.988943 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.989244 [debug] [ThreadPool]: On create_dev_analytics_dev: BEGIN
[0m12:50:12.989690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:12.990073 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.990339 [debug] [ThreadPool]: On create_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics_dev"} */

    
    
        create schema if not exists dev.analytics_dev
    
[0m12:50:12.991598 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:12.992338 [debug] [ThreadPool]: On create_dev_analytics_dev: COMMIT
[0m12:50:12.992632 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.992897 [debug] [ThreadPool]: On create_dev_analytics_dev: COMMIT
[0m12:50:12.993693 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:12.993969 [debug] [ThreadPool]: On create_dev_analytics_dev: Close
[0m12:50:12.997177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_analytics_dev, now list_dev_analytics)
[0m12:50:13.002888 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:50:13.003313 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:50:13.003589 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:50:13.006812 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:50:13.007107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:13.007387 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:50:13.007717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:13.046046 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:13.046380 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:50:13.046664 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:13.046955 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m12:50:13.047247 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:50:13.047637 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m12:50:13.061914 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:50:13.062249 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:50:13.063335 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m12:50:13.064334 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m12:50:13.065123 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m12:50:13.065478 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m12:50:13.065751 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:50:13.066029 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m12:50:13.067315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108155a20>]}
[0m12:50:13.067724 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.067989 [debug] [MainThread]: On master: BEGIN
[0m12:50:13.068240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:13.110773 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m12:50:13.111121 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.111403 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.111668 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.112025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:13.112314 [debug] [MainThread]: On master: Close
[0m12:50:13.113268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:13.113579 [info ] [MainThread]: 
[0m12:50:13.115696 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:50:13.116069 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:50:13.116675 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_dev.raw_customers ............................. [RUN]
[0m12:50:13.117083 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:50:13.117474 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:50:13.117873 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_dev.raw_order_items ........................... [RUN]
[0m12:50:13.118363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m12:50:13.118874 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_dev.raw_orders ................................ [RUN]
[0m12:50:13.119757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m12:50:13.119444 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_dev.raw_products .............................. [RUN]
[0m12:50:13.120178 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:50:13.120591 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:50:13.120964 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:50:13.121377 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:50:13.121718 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:50:13.122038 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:50:13.122573 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:50:13.123223 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:50:13.137216 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:50:13.144168 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:50:13.166325 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.168336 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.170341 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.173761 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:50:13.174110 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:50:13.174481 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:50:13.177660 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.178002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:13.178320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:13.178736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:13.179073 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:50:13.179530 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:13.218220 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m12:50:13.218592 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.218933 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:50:13.219269 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:50:13.219569 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m12:50:13.219884 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table dev.analytics_dev.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:50:13.220217 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.220531 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.220847 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.221300 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */

    create table dev.analytics_dev.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:50:13.221671 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table dev.analytics_dev.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:50:13.222027 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table dev.analytics_dev.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:50:13.222950 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.223272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.223572 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:50:13.223857 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.234630 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.235586 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.236494 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.237369 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.237708 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238036 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238357 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238671 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.254405 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m12:50:13.254855 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.255210 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.255536 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.260756 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:50:13.261343 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:50:13.261839 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:50:13.262390 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:50:13.282823 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:13.284682 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:13.285884 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:13.286229 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.287346 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:13.287712 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.288226 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.288615 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:13.288966 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.289287 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:13.289600 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:13.290012 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:13.291228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.291588 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.293350 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:50:13.293678 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:50:13.293981 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:50:13.294590 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:50:13.295890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b8370>]}
[0m12:50:13.296502 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:50:13.297101 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:50:13.297551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba1c310>]}
[0m12:50:13.298028 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_dev.raw_customers ......................... [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.298487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba1e830>]}
[0m12:50:13.299480 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:50:13.299007 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_dev.raw_orders ............................ [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.300032 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_dev.raw_products .......................... [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.300664 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:50:13.301122 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:50:13.308239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba102e0>]}
[0m12:50:13.308717 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_dev.raw_order_items ....................... [[32mINSERT 14[0m in 0.19s]
[0m12:50:13.309218 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:50:13.310150 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.310530 [debug] [MainThread]: On master: BEGIN
[0m12:50:13.310810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:13.360351 [debug] [MainThread]: SQL status: OK in 0.049 seconds
[0m12:50:13.360762 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.361066 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.361342 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.361712 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:13.361988 [debug] [MainThread]: On master: Close
[0m12:50:13.363116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:13.363402 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:50:13.363648 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:50:13.363893 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:50:13.364130 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:50:13.364452 [info ] [MainThread]: 
[0m12:50:13.364759 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:50:13.365799 [debug] [MainThread]: Command end result
[0m12:50:13.479131 [info ] [MainThread]: 
[0m12:50:13.479605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:13.479914 [info ] [MainThread]: 
[0m12:50:13.480224 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:50:13.483189 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.370567, "process_in_blocks": "0", "process_kernel_time": 0.436314, "process_mem_max_rss": "168230912", "process_out_blocks": "0", "process_user_time": 5.908098}
[0m12:50:13.483570 [debug] [MainThread]: Command `dbt seed` succeeded at 12:50:13.483494 after 4.37 seconds
[0m12:50:13.483896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b675a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b677400>]}
[0m12:50:13.484221 [debug] [MainThread]: Flushing usage events
[0m12:50:34.178921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb56c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb570a0>]}


============================== 12:50:34.184032 | bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e ==============================
[0m12:50:34.184032 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:50:34.184562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed --target prod', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:34.419079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b797070>]}
[0m12:50:34.468658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2735b0>]}
[0m12:50:34.472923 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:50:34.597937 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:50:34.722380 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:50:34.722811 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m12:50:34.723100 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:50:34.723415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3fd60>]}
[0m12:50:37.038332 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:50:37.038837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e3880>]}
[0m12:50:37.462316 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:50:37.462816 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:50:37.463151 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:50:37.463459 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:50:37.463752 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:50:37.464039 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:50:37.464324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:50:37.464607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:50:37.464883 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:50:37.465156 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:50:37.465424 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:50:37.465693 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:50:37.465966 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:50:37.466245 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:50:37.466517 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:50:37.466793 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:50:37.467071 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:50:37.467344 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:50:37.467614 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:50:37.467885 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:50:37.468163 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:50:37.468439 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:50:37.468717 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:50:37.468993 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:50:37.469267 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:50:37.469538 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:50:37.469807 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:50:37.470076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:50:37.578328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533520>]}
[0m12:50:37.727327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19a350>]}
[0m12:50:37.727849 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:50:37.728188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ca980>]}
[0m12:50:37.730351 [info ] [MainThread]: 
[0m12:50:37.730830 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:50:37.736147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:50:37.781247 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:50:37.781619 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:50:37.781909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:37.929322 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m12:50:37.931423 [debug] [ThreadPool]: On list_prod: Close
[0m12:50:37.933450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now create_prod_analytics)
[0m12:50:37.933938 [debug] [ThreadPool]: Creating schema "database: "prod"
schema: "analytics"
"
[0m12:50:37.940989 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.941319 [debug] [ThreadPool]: On create_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_analytics"} */

    
        select type from duckdb_databases()
        where database_name='prod'
        and type='sqlite'
    
  
[0m12:50:37.941601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:37.980201 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:37.981786 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.982108 [debug] [ThreadPool]: On create_prod_analytics: BEGIN
[0m12:50:37.982483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:37.982751 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.983016 [debug] [ThreadPool]: On create_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_analytics"} */

    
    
        create schema if not exists prod.analytics
    
[0m12:50:37.984300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:37.985073 [debug] [ThreadPool]: On create_prod_analytics: COMMIT
[0m12:50:37.985372 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.985638 [debug] [ThreadPool]: On create_prod_analytics: COMMIT
[0m12:50:37.986459 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:37.986732 [debug] [ThreadPool]: On create_prod_analytics: Close
[0m12:50:37.990402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_prod_analytics, now list_prod_analytics)
[0m12:50:37.997331 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:50:37.997673 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:50:37.997949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:38.037136 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:38.037511 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:50:38.037805 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:50:38.048313 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:50:38.049376 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:50:38.050130 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:50:38.050403 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:50:38.051545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bb6a0>]}
[0m12:50:38.052000 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.052294 [debug] [MainThread]: On master: BEGIN
[0m12:50:38.052560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:38.091287 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m12:50:38.091622 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.091902 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.092165 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.092539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:38.092890 [debug] [MainThread]: On master: Close
[0m12:50:38.093855 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:50:38.094183 [info ] [MainThread]: 
[0m12:50:38.096318 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:50:38.096696 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:50:38.097162 [info ] [Thread-1 (]: 1 of 4 START seed file analytics.raw_customers ................................. [RUN]
[0m12:50:38.097560 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:50:38.097968 [info ] [Thread-2 (]: 2 of 4 START seed file analytics.raw_order_items ............................... [RUN]
[0m12:50:38.098375 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:50:38.099008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now seed.ci_cd_project.raw_customers)
[0m12:50:38.099455 [info ] [Thread-3 (]: 3 of 4 START seed file analytics.raw_orders .................................... [RUN]
[0m12:50:38.100012 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_order_items'
[0m12:50:38.100842 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:50:38.100422 [info ] [Thread-4 (]: 4 of 4 START seed file analytics.raw_products .................................. [RUN]
[0m12:50:38.101364 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:50:38.101675 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:50:38.102000 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:50:38.102392 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:50:38.102696 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:50:38.103069 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:50:38.115654 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:50:38.120672 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:50:38.130760 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:50:38.139534 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.140737 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.148133 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:50:38.148554 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:50:38.150527 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.153825 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.154148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:38.154474 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:50:38.154823 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:50:38.155132 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:50:38.155592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:38.155956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:38.194987 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:50:38.195374 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:50:38.195717 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.196023 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:50:38.196317 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:50:38.196642 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.196970 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table prod.analytics.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:50:38.197290 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.197594 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.197916 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table prod.analytics.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:50:38.198389 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */

    create table prod.analytics.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:50:38.198772 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table prod.analytics.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:50:38.199739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.205872 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:50:38.206234 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:50:38.211301 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.211660 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.212605 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.213509 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.213847 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY prod.analytics.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.214716 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.215050 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY prod.analytics.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.215375 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY prod.analytics.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.215879 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY prod.analytics.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.228869 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229243 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229576 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229887 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m12:50:38.234907 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:50:38.235421 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:50:38.235926 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:50:38.236403 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:50:38.257562 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:38.259241 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:38.262720 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:38.263099 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.263465 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.264622 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:38.264947 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.265271 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:38.265584 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:38.265907 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.266214 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:38.266698 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:38.267229 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.267568 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.269274 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:50:38.269589 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:50:38.269882 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:50:38.270481 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:50:38.271734 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:50:38.272494 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:50:38.273026 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ac610>]}
[0m12:50:38.273452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5aeaa0>]}
[0m12:50:38.273881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d187be0>]}
[0m12:50:38.274402 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics.raw_orders ................................ [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.274799 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics.raw_products .............................. [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.275837 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:50:38.275296 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics.raw_customers ............................. [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.276390 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:50:38.276956 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:50:38.282816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d187df0>]}
[0m12:50:38.283313 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics.raw_order_items ........................... [[32mINSERT 14[0m in 0.18s]
[0m12:50:38.283874 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:50:38.284988 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.285454 [debug] [MainThread]: On master: BEGIN
[0m12:50:38.286009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:38.332350 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m12:50:38.332740 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.333028 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.333298 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.333635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:38.333907 [debug] [MainThread]: On master: Close
[0m12:50:38.334904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:38.335222 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:50:38.335485 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:50:38.335733 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:50:38.335977 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:50:38.336286 [info ] [MainThread]: 
[0m12:50:38.336588 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:50:38.337541 [debug] [MainThread]: Command end result
[0m12:50:38.445225 [info ] [MainThread]: 
[0m12:50:38.445693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:38.445999 [info ] [MainThread]: 
[0m12:50:38.446306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:50:38.449341 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.328413, "process_in_blocks": "0", "process_kernel_time": 0.392192, "process_mem_max_rss": "167362560", "process_out_blocks": "0", "process_user_time": 5.89138}
[0m12:50:38.449758 [debug] [MainThread]: Command `dbt seed` succeeded at 12:50:38.449675 after 4.33 seconds
[0m12:50:38.450101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3584c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e8430>]}
[0m12:50:38.450444 [debug] [MainThread]: Flushing usage events
[0m12:52:10.118753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093feb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fefe0>]}


============================== 12:52:10.123471 | ebd1395c-8329-4d75-bac8-e763623e1bc1 ==============================
[0m12:52:10.123471 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:52:10.123991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --target test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:10.382152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108018430>]}
[0m12:52:10.432880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eb040>]}
[0m12:52:10.436963 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:52:10.561302 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:52:10.685779 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:52:10.686200 [debug] [MainThread]: previous checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m12:52:10.686486 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:52:10.686805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b2c20>]}
[0m12:52:13.007689 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:52:13.008194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109970e80>]}
[0m12:52:13.394479 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:52:13.394940 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:52:13.395260 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:52:13.395554 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:52:13.395836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:52:13.396117 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:52:13.396393 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:52:13.396669 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:52:13.396942 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:52:13.397211 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:52:13.397480 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:52:13.397744 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:52:13.398014 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:52:13.398283 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:52:13.398552 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:52:13.398817 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:52:13.399084 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:52:13.399353 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:52:13.399616 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:52:13.399881 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:52:13.400147 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:52:13.400413 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:52:13.400683 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:52:13.400949 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:52:13.401215 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:52:13.401478 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:52:13.401746 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:52:13.402011 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:52:13.532182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e854b0>]}
[0m12:52:13.681604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfda50>]}
[0m12:52:13.682095 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:52:13.682437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfd450>]}
[0m12:52:13.684608 [info ] [MainThread]: 
[0m12:52:13.685074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:13.690057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:52:13.740407 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:52:13.740790 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:52:13.741083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:13.878345 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:52:13.878757 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:52:13.879462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:13.879786 [debug] [MainThread]: Connection 'list_test' was properly closed.
[0m12:52:13.880083 [info ] [MainThread]: 
[0m12:52:13.880395 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m12:52:13.880822 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "./warehouse/prod.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:52:13.883578 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.8271637, "process_in_blocks": "0", "process_kernel_time": 0.367492, "process_mem_max_rss": "152666112", "process_out_blocks": "0", "process_user_time": 4.713808}
[0m12:52:13.883972 [debug] [MainThread]: Command `dbt seed` failed at 12:52:13.883890 after 3.83 seconds
[0m12:52:13.884301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd2bc0>]}
[0m12:52:13.884636 [debug] [MainThread]: Flushing usage events
[0m12:53:25.219049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a15900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ab070>]}


============================== 12:53:25.223873 | c637d95c-b330-4217-a0e2-4aa001b74539 ==============================
[0m12:53:25.223873 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:25.224393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --target test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:25.478566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109566ef0>]}
[0m12:53:25.528489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5a170>]}
[0m12:53:25.532552 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:25.657776 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:25.875029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:25.875443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:25.929076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d442b0>]}
[0m12:53:26.109111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7b520>]}
[0m12:53:26.109611 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:26.109949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d243d0>]}
[0m12:53:26.112104 [info ] [MainThread]: 
[0m12:53:26.112573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:26.117754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:26.170609 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:26.170985 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:26.171293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:26.318895 [debug] [ThreadPool]: SQL status: OK in 0.148 seconds
[0m12:53:26.320824 [debug] [ThreadPool]: On list_test: Close
[0m12:53:26.322578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now create_test_analytics_test)
[0m12:53:26.323031 [debug] [ThreadPool]: Creating schema "database: "test"
schema: "analytics_test"
"
[0m12:53:26.329931 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.330259 [debug] [ThreadPool]: On create_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics_test"} */

    
        select type from duckdb_databases()
        where database_name='test'
        and type='sqlite'
    
  
[0m12:53:26.330621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:26.364998 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:53:26.366404 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.366717 [debug] [ThreadPool]: On create_test_analytics_test: BEGIN
[0m12:53:26.367063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:26.367324 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.367586 [debug] [ThreadPool]: On create_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics_test"} */

    
    
        create schema if not exists test.analytics_test
    
[0m12:53:26.368579 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:26.369350 [debug] [ThreadPool]: On create_test_analytics_test: COMMIT
[0m12:53:26.369646 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.369911 [debug] [ThreadPool]: On create_test_analytics_test: COMMIT
[0m12:53:26.370652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:26.370920 [debug] [ThreadPool]: On create_test_analytics_test: Close
[0m12:53:26.373711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_analytics_test, now list_test_analytics_test)
[0m12:53:26.379990 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:26.380414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics'
[0m12:53:26.380681 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:26.383130 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:26.383420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:26.383702 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:26.384033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:26.419977 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m12:53:26.420312 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:26.420589 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m12:53:26.420870 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:26.421160 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:26.421536 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:26.434207 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:53:26.434634 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:53:26.435681 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:26.436774 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:26.437620 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:26.438004 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:26.438305 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:26.438626 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:26.440063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d243d0>]}
[0m12:53:26.440498 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.440774 [debug] [MainThread]: On master: BEGIN
[0m12:53:26.441029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:26.480904 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:53:26.481234 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.481518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.481778 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.482132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:26.482444 [debug] [MainThread]: On master: Close
[0m12:53:26.483411 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:26.483732 [info ] [MainThread]: 
[0m12:53:26.485522 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:53:26.486039 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:53:26.486510 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_test.raw_customers ............................ [RUN]
[0m12:53:26.486922 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:53:26.487325 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_test.raw_order_items .......................... [RUN]
[0m12:53:26.487701 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:53:26.488060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now seed.ci_cd_project.raw_customers)
[0m12:53:26.488492 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_test.raw_orders ............................... [RUN]
[0m12:53:26.488939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics, now seed.ci_cd_project.raw_order_items)
[0m12:53:26.489440 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_test.raw_products ............................. [RUN]
[0m12:53:26.489830 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:53:26.490260 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:53:26.490605 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:53:26.491022 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:53:26.491384 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:53:26.491724 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:53:26.492036 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:53:26.492334 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:53:26.507027 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:53:26.516296 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:53:26.529111 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.531724 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.533732 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.536946 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:53:26.540132 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.540549 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:53:26.540881 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:53:26.541193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:26.541501 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:53:26.541796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:26.542084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:26.542463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:26.578193 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:53:26.578586 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:53:26.578895 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.579187 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m12:53:26.579473 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:53:26.579787 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.580113 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table test.analytics_test.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:53:26.580440 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.580740 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.581054 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_products"} */

    create table test.analytics_test.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:53:26.581501 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table test.analytics_test.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:53:26.581863 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table test.analytics_test.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:53:26.582274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.582768 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.589425 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:53:26.594017 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.594349 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m12:53:26.595271 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.596180 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.596515 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY test.analytics_test.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.597388 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.597721 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY test.analytics_test.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.598045 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY test.analytics_test.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.598445 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY test.analytics_test.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.612045 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.612453 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.612799 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.613133 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.618257 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:53:26.618789 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:53:26.619280 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:53:26.619748 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:53:26.641941 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:53:26.642364 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.644210 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:53:26.646089 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:53:26.650882 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:53:26.651241 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:53:26.651622 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.651977 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.652316 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.652734 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:53:26.653072 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:53:26.653418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.653808 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:53:26.656014 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:53:26.656399 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.656762 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.657508 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:53:26.658846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6cfd0>]}
[0m12:53:26.659221 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.659856 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:53:26.660280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094633a0>]}
[0m12:53:26.660742 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_test.raw_customers ........................ [[32mINSERT 10[0m in 0.17s]
[0m12:53:26.661448 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:53:26.661901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a69270>]}
[0m12:53:26.662335 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_test.raw_orders ........................... [[32mINSERT 10[0m in 0.17s]
[0m12:53:26.662857 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:53:26.663315 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_test.raw_order_items ...................... [[32mINSERT 14[0m in 0.17s]
[0m12:53:26.663810 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:53:26.664373 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:53:26.672637 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21bc70>]}
[0m12:53:26.673149 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_test.raw_products ......................... [[32mINSERT 10[0m in 0.18s]
[0m12:53:26.673681 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:53:26.674728 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.675033 [debug] [MainThread]: On master: BEGIN
[0m12:53:26.675296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:26.715236 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:53:26.715597 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.715890 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.716156 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.716509 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:26.716788 [debug] [MainThread]: On master: Close
[0m12:53:26.717772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:26.718084 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:53:26.718345 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:53:26.718588 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:53:26.718825 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:53:26.719134 [info ] [MainThread]: 
[0m12:53:26.719444 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:53:26.720381 [debug] [MainThread]: Command end result
[0m12:53:26.792061 [info ] [MainThread]: 
[0m12:53:26.792511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:26.792810 [info ] [MainThread]: 
[0m12:53:26.793116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:53:26.795746 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.6374655, "process_in_blocks": "0", "process_kernel_time": 0.425814, "process_mem_max_rss": "161349632", "process_out_blocks": "0", "process_user_time": 3.237472}
[0m12:53:26.796115 [debug] [MainThread]: Command `dbt seed` succeeded at 12:53:26.796039 after 1.64 seconds
[0m12:53:26.796437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a15900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108888850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a260a60>]}
[0m12:53:26.796758 [debug] [MainThread]: Flushing usage events
[0m12:53:44.872209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091598d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abeebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abef040>]}


============================== 12:53:44.878123 | 27e2ac68-77c4-4630-8573-59bf46225dd3 ==============================
[0m12:53:44.878123 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:44.878688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target test', 'send_anonymous_usage_stats': 'True'}
[0m12:53:45.114221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abddae0>]}
[0m12:53:45.164506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2a080>]}
[0m12:53:45.168998 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:45.291935 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:45.500860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:45.501260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:45.554697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b488280>]}
[0m12:53:45.731335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1af220>]}
[0m12:53:45.731843 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:45.732179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ad450>]}
[0m12:53:45.734365 [info ] [MainThread]: 
[0m12:53:45.734861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:45.740209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:45.792656 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:45.793051 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:45.793352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:45.947050 [debug] [ThreadPool]: SQL status: OK in 0.154 seconds
[0m12:53:45.948566 [debug] [ThreadPool]: On list_test: Close
[0m12:53:45.950557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now create_test_analytics)
[0m12:53:45.951158 [debug] [ThreadPool]: Creating schema "database: "test"
schema: "analytics"
"
[0m12:53:45.958045 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.958386 [debug] [ThreadPool]: On create_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics"} */

    
        select type from duckdb_databases()
        where database_name='test'
        and type='sqlite'
    
  
[0m12:53:45.958746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:45.996424 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m12:53:45.997893 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.998224 [debug] [ThreadPool]: On create_test_analytics: BEGIN
[0m12:53:45.998595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:45.998869 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.999134 [debug] [ThreadPool]: On create_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics"} */

    
    
        create schema if not exists test.analytics
    
[0m12:53:46.000056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:46.000834 [debug] [ThreadPool]: On create_test_analytics: COMMIT
[0m12:53:46.001134 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:46.001406 [debug] [ThreadPool]: On create_test_analytics: COMMIT
[0m12:53:46.002204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:46.002481 [debug] [ThreadPool]: On create_test_analytics: Close
[0m12:53:46.008520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_analytics, now list_test_analytics)
[0m12:53:46.014833 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:46.015272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics_test'
[0m12:53:46.015546 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:46.018060 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:46.018363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:46.018651 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:46.018987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:46.054519 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:46.054810 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:46.055077 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:46.055345 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:46.055623 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:46.056019 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:46.068417 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:53:46.068744 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:53:46.069779 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:46.070813 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:46.071591 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:46.071950 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:46.072216 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:46.072495 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:46.074327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b436cb0>]}
[0m12:53:46.074751 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.075026 [debug] [MainThread]: On master: BEGIN
[0m12:53:46.075280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:46.112036 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:53:46.112435 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.112735 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.113009 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.113400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:46.113731 [debug] [MainThread]: On master: Close
[0m12:53:46.114768 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:46.115149 [info ] [MainThread]: 
[0m12:53:46.117128 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:53:46.117526 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:53:46.118004 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:53:46.118412 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:53:46.118834 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:53:46.119263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics, now model.ci_cd_project.stg_customers)
[0m12:53:46.119630 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:53:46.120042 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:53:46.120525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now model.ci_cd_project.stg_order_items)
[0m12:53:46.120953 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:53:46.121413 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:53:46.121970 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:53:46.122343 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:53:46.131768 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:53:46.132241 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:53:46.132595 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:53:46.137125 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:53:46.137633 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:53:46.141575 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:53:46.145308 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:53:46.146218 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:53:46.146614 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:53:46.146973 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:53:46.166238 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:53:46.195692 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:53:46.197113 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:53:46.198961 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:53:46.202428 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:53:46.203551 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.203978 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.204359 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.204703 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.205010 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:53:46.205336 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:53:46.205644 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:53:46.205947 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:53:46.206253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:46.206575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:46.206928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:46.207240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:46.244421 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.244766 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.245092 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.245460 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:53:46.245787 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view test.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:46.246118 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:53:46.246421 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.246724 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.247191 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.247590 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view test.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:53:46.247927 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.248272 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view test.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:46.248635 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view test.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:53:46.255684 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.256196 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:53:46.256577 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view test.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:53:46.256955 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.257309 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.260571 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.263897 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.264258 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:46.267454 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.267809 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view test.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:53:46.268145 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view test.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:53:46.281058 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view test.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:53:46.282529 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:46.283119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.283455 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.283748 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.284074 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.285107 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:46.285449 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:46.286438 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:46.287423 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:46.287760 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.288141 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.288525 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.288843 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:46.289167 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:46.289490 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:46.289772 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.295138 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.295500 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.295816 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:53:46.296126 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists test.analytics.stg_orders__dbt_backup cascade
[0m12:53:46.296432 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m12:53:46.299156 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.301847 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.305193 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.305576 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists test.analytics.stg_customers__dbt_backup cascade
[0m12:53:46.305922 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:53:46.306234 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists test.analytics.stg_products__dbt_backup cascade
[0m12:53:46.306570 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists test.analytics.stg_order_items__dbt_backup cascade
[0m12:53:46.308874 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:53:46.309285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.309676 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.310614 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.311663 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:53:46.312410 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b798fd0>]}
[0m12:53:46.313487 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:53:46.314504 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:53:46.315459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb6020>]}
[0m12:53:46.315081 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.19s]
[0m12:53:46.316007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b798a90>]}
[0m12:53:46.316592 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.20s]
[0m12:53:46.317096 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:53:46.317620 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.18s]
[0m12:53:46.318260 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:53:46.318966 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:53:46.319359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a5480>]}
[0m12:53:46.320124 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.20s]
[0m12:53:46.320793 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:53:46.321161 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m12:53:46.321764 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:53:46.322192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now model.ci_cd_project.dim_customers)
[0m12:53:46.322548 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_products
[0m12:53:46.322883 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m12:53:46.323193 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:53:46.323646 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:53:46.324088 [info ] [Thread-2 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:53:46.328470 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:53:46.328888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.dim_products)
[0m12:53:46.329254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.fct_orders)
[0m12:53:46.329695 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:53:46.330082 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:53:46.333700 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:53:46.337719 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:53:46.338238 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:53:46.350740 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_products
[0m12:53:46.363271 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:53:46.368088 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:53:46.368420 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:53:46.371958 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:53:46.372725 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.373082 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:53:46.373460 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.373834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:46.374185 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:53:46.374557 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.374941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:46.375268 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:53:46.375624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:46.412096 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.412460 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.412786 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:53:46.413101 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.413461 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      test.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from test.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from test.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:53:46.413835 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.414146 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.414672 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      test.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from test.analytics.stg_orders
),

order_items as (
    select * from test.analytics.stg_order_items
),

products as (
    select * from test.analytics.stg_products
),

customers as (
    select * from test.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:53:46.415119 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      test.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from test.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from test.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:53:46.422818 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:53:46.423234 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m12:53:46.426854 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.427206 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m12:53:46.464631 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.465019 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table test.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:53:46.468291 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.468659 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table test.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:53:46.469126 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table test.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:53:46.469512 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.473924 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:46.474285 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.474620 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.474944 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.475244 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:46.476462 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:46.477546 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:46.477964 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.478333 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.478659 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.478964 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:46.479272 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:46.481989 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.482447 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists test.analytics.dim_products__dbt_backup cascade
[0m12:53:46.482871 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.483229 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.485946 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.486264 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:53:46.489629 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.489972 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists test.analytics.dim_customers__dbt_backup cascade
[0m12:53:46.491102 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: Close
[0m12:53:46.491444 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists test.analytics.fct_orders__dbt_backup cascade
[0m12:53:46.492003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb51c00>]}
[0m12:53:46.492361 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.493961 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m12:53:46.494285 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.492966 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.16s]
[0m12:53:46.494773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb51e70>]}
[0m12:53:46.495849 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m12:53:46.496333 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_products
[0m12:53:46.496840 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.17s]
[0m12:53:46.497476 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:53:46.509841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a8610>]}
[0m12:53:46.510430 [info ] [Thread-2 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.18s]
[0m12:53:46.510944 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:53:46.511886 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.512200 [debug] [MainThread]: On master: BEGIN
[0m12:53:46.512467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:46.555613 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m12:53:46.556000 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.556293 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.556561 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.556951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:46.557299 [debug] [MainThread]: On master: Close
[0m12:53:46.558350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:46.558660 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:53:46.558920 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:53:46.559165 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:53:46.559403 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:53:46.559769 [info ] [MainThread]: 
[0m12:53:46.560077 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m12:53:46.561314 [debug] [MainThread]: Command end result
[0m12:53:46.633171 [info ] [MainThread]: 
[0m12:53:46.633607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:46.633920 [info ] [MainThread]: 
[0m12:53:46.634233 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:46.636911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8228965, "process_in_blocks": "0", "process_kernel_time": 0.436627, "process_mem_max_rss": "170131456", "process_out_blocks": "0", "process_user_time": 3.60153}
[0m12:53:46.637287 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:46.637214 after 1.82 seconds
[0m12:53:46.637615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091598d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95e70>]}
[0m12:53:46.637938 [debug] [MainThread]: Flushing usage events
[0m12:53:56.297424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae198d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d9870>]}


============================== 12:53:56.302191 | a8d95aaf-2dd5-423d-82ea-4a256d7d951e ==============================
[0m12:53:56.302191 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:56.302715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target test', 'send_anonymous_usage_stats': 'True'}
[0m12:53:56.511162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c899ae0>]}
[0m12:53:56.562250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ea080>]}
[0m12:53:56.568439 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:56.691187 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:56.893771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:56.894161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:56.947598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d148280>]}
[0m12:53:57.126588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce83220>]}
[0m12:53:57.127085 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:57.127415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce81450>]}
[0m12:53:57.129556 [info ] [MainThread]: 
[0m12:53:57.130030 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:57.135389 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:57.181295 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:57.181678 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:57.181993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.232202 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m12:53:57.233387 [debug] [ThreadPool]: On list_test: Close
[0m12:53:57.235706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now list_test_analytics_test)
[0m12:53:57.241649 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:57.242080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics'
[0m12:53:57.242447 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:57.245300 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:57.245594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:57.245928 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:57.246264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.281852 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:57.282172 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:57.282462 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:57.282776 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:57.283082 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:57.283466 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:57.292443 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:53:57.292807 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:53:57.293961 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:57.295048 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:57.298303 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:57.298630 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:57.298951 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:57.299372 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:57.302316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f6cb0>]}
[0m12:53:57.302798 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.303099 [debug] [MainThread]: On master: BEGIN
[0m12:53:57.303367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:57.340233 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:53:57.340537 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.340812 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.341069 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.341404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:57.341669 [debug] [MainThread]: On master: Close
[0m12:53:57.342648 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:57.343001 [info ] [MainThread]: 
[0m12:53:57.344737 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:53:57.345254 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:53:57.345704 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:53:57.346158 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:53:57.346543 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:53:57.346900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now model.ci_cd_project.stg_customers)
[0m12:53:57.347250 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:53:57.347598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics, now model.ci_cd_project.stg_order_items)
[0m12:53:57.348030 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:53:57.348423 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:53:57.348875 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:53:57.349259 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:53:57.349676 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:53:57.358803 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:53:57.359265 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:53:57.362941 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:53:57.363314 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:53:57.363735 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:53:57.367988 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:53:57.371338 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:53:57.371711 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:53:57.372026 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:53:57.384301 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:53:57.411855 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:53:57.412153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:53:57.413315 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:53:57.413890 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:53:57.417560 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:53:57.418114 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.418506 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.418871 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:53:57.419235 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.419594 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.419910 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:53:57.420230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:57.420557 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:53:57.420868 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:53:57.421170 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:57.421543 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:57.421856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:57.460073 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.460431 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.460756 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:53:57.461122 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.461454 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view test.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:53:57.461805 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.462102 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.462407 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.462753 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.463193 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view test.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:57.463614 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view test.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:57.463984 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.464317 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view test.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:53:57.470910 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.471390 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:53:57.471719 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "test"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m12:53:57.472044 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:53:57.475931 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.476245 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:53:57.479587 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.479947 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "test"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m12:53:57.480277 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.483567 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.483920 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view "test"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m12:53:57.487192 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.487544 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "test"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m12:53:57.487847 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.488203 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view test.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:53:57.488678 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.492359 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.492685 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.495945 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.496292 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view test.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:53:57.496592 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.499679 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.500015 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view test.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:53:57.506713 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:53:57.515714 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:57.516065 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view test.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:53:57.517272 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:57.517630 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.517957 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.518319 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.518651 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:57.518939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.520000 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:57.520314 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:57.521412 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:57.521744 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.522102 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.522433 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.522741 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.523033 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:57.528789 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.529124 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:57.531977 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.532446 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists test.analytics.stg_order_items__dbt_backup cascade
[0m12:53:57.532888 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.533382 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists test.analytics.stg_orders__dbt_backup cascade
[0m12:53:57.533807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:57.537050 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.537382 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.540260 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.540624 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists test.analytics.stg_products__dbt_backup cascade
[0m12:53:57.540950 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.543168 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:53:57.543530 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists test.analytics.stg_customers__dbt_backup cascade
[0m12:53:57.544678 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:53:57.545644 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.546467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d149f60>]}
[0m12:53:57.546830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.547232 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3dba30>]}
[0m12:53:57.548287 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:53:57.549861 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:53:57.548850 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.20s]
[0m12:53:57.550446 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.20s]
[0m12:53:57.550915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6808e0>]}
[0m12:53:57.551431 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:53:57.551882 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:53:57.552370 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.19s]
[0m12:53:57.553063 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:53:57.553549 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_products
[0m12:53:57.554001 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:53:57.554525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.dim_products)
[0m12:53:57.554856 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:53:57.559468 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:53:57.560060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49d630>]}
[0m12:53:57.560667 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.21s]
[0m12:53:57.561321 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:53:57.561765 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.dim_products
[0m12:53:57.580962 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_customers
[0m12:53:57.583300 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:53:57.583671 [debug] [Thread-3 (]: Began running node model.ci_cd_project.fct_orders
[0m12:53:57.584090 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:53:57.584677 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:53:57.585130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.dim_customers)
[0m12:53:57.585509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now model.ci_cd_project.fct_orders)
[0m12:53:57.585859 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:53:57.586201 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:53:57.589819 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:53:57.594169 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:53:57.594562 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.595054 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:53:57.595434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:57.595891 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:53:57.596264 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:53:57.663623 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:53:57.667458 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:53:57.668101 [debug] [Thread-2 (]: SQL status: OK in 0.073 seconds
[0m12:53:57.668474 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.668868 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      test.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from test.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from test.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:53:57.669604 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.670011 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.670361 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:53:57.670726 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:53:57.671085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:57.671428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:57.671988 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.672314 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.672679 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      test.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from test.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from test.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:53:57.673044 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.673344 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.676795 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.677173 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.677510 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.677841 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table "test"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m12:53:57.678248 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      test.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from test.analytics.stg_orders
),

order_items as (
    select * from test.analytics.stg_order_items
),

products as (
    select * from test.analytics.stg_products
),

customers as (
    select * from test.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:53:57.681500 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.682096 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "test"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m12:53:57.682480 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.686454 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.686825 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table test.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:53:57.687160 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:53:57.690508 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.690876 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table test.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:53:57.691203 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m12:53:57.691528 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.694719 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.698992 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:57.699347 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m12:53:57.699663 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "test"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m12:53:57.699992 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.701138 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:57.701543 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:57.701875 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.702174 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.702546 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:57.705746 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.706071 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.706442 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table test.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:53:57.706766 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:53:57.710386 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.713210 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.713556 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists test.analytics.dim_products__dbt_backup cascade
[0m12:53:57.713863 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.714193 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists test.analytics.dim_customers__dbt_backup cascade
[0m12:53:57.715398 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:57.715816 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.716127 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:57.716428 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.716741 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.717835 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: Close
[0m12:53:57.718149 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.719183 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: Close
[0m12:53:57.719630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a96f0>]}
[0m12:53:57.722430 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.722850 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d777f40>]}
[0m12:53:57.723679 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists test.analytics.fct_orders__dbt_backup cascade
[0m12:53:57.723391 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.17s]
[0m12:53:57.724279 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.14s]
[0m12:53:57.724849 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_products
[0m12:53:57.725302 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:53:57.725618 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.726820 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: Close
[0m12:53:57.739321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d777ac0>]}
[0m12:53:57.739971 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.15s]
[0m12:53:57.740591 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:53:57.741802 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.742103 [debug] [MainThread]: On master: BEGIN
[0m12:53:57.742379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:57.783855 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m12:53:57.784222 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.784519 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.784789 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.785129 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:57.785398 [debug] [MainThread]: On master: Close
[0m12:53:57.786403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:57.786665 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:53:57.786902 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:53:57.787133 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:53:57.787361 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:53:57.787715 [info ] [MainThread]: 
[0m12:53:57.788016 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:53:57.789237 [debug] [MainThread]: Command end result
[0m12:53:57.861512 [info ] [MainThread]: 
[0m12:53:57.861938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:57.862237 [info ] [MainThread]: 
[0m12:53:57.862539 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:57.865171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6282461, "process_in_blocks": "0", "process_kernel_time": 0.289514, "process_mem_max_rss": "168837120", "process_out_blocks": "0", "process_user_time": 3.408644}
[0m12:53:57.865578 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:57.865496 after 1.63 seconds
[0m12:53:57.865907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae198d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ea1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5cd60>]}
[0m12:53:57.866237 [debug] [MainThread]: Flushing usage events
[0m12:54:04.537472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae798d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c939cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c939870>]}


============================== 12:54:04.542279 | 7625b782-269d-426c-bf2c-96b6199ac7f5 ==============================
[0m12:54:04.542279 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:54:04.542801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target prod', 'send_anonymous_usage_stats': 'True'}
[0m12:54:04.749150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3bbbb0>]}
[0m12:54:04.798819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b024040>]}
[0m12:54:04.803436 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:54:04.923185 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:54:05.045754 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:54:05.046198 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e
[0m12:54:05.046497 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:54:05.046820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcef190>]}
[0m12:54:07.373762 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:54:07.374271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cda7df0>]}
[0m12:54:07.762179 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:54:07.762656 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:54:07.762977 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:54:07.763274 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:54:07.763557 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:54:07.763834 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:54:07.764109 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:54:07.764381 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:54:07.764649 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:54:07.764920 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:54:07.765186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:54:07.765456 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:54:07.765723 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:54:07.765993 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:54:07.766258 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:54:07.766528 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:54:07.766796 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:54:07.767062 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:54:07.767328 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:54:07.767594 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:54:07.767865 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:54:07.768131 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:54:07.768399 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:54:07.768668 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:54:07.768934 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:54:07.769199 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:54:07.769469 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:54:07.769738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:54:07.878073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3683a0>]}
[0m12:54:08.023008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0af160>]}
[0m12:54:08.023502 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:54:08.023835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0adae0>]}
[0m12:54:08.026025 [info ] [MainThread]: 
[0m12:54:08.026491 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:08.031793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:54:08.076361 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:54:08.076741 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:54:08.077038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:08.129062 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m12:54:08.130220 [debug] [ThreadPool]: On list_prod: Close
[0m12:54:08.132465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now list_prod_analytics)
[0m12:54:08.138231 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:54:08.138563 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:54:08.138836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:08.174075 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m12:54:08.174426 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:54:08.174735 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:54:08.182241 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:54:08.183400 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:54:08.184708 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:54:08.185008 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:54:08.186672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4d960>]}
[0m12:54:08.187080 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.187353 [debug] [MainThread]: On master: BEGIN
[0m12:54:08.187610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:08.221729 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m12:54:08.222075 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.222363 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.222627 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.222964 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:08.223231 [debug] [MainThread]: On master: Close
[0m12:54:08.224176 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:54:08.224500 [info ] [MainThread]: 
[0m12:54:08.226562 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:54:08.226963 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:54:08.228016 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:54:08.228753 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:54:08.228468 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:54:08.229260 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:54:08.229730 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:54:08.230197 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:54:08.230639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now model.ci_cd_project.stg_customers)
[0m12:54:08.231065 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_order_items'
[0m12:54:08.231467 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:54:08.231856 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:54:08.232179 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:54:08.232485 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:54:08.232782 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:54:08.233077 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:54:08.242056 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:54:08.245706 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:54:08.249041 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:54:08.253408 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:54:08.254166 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:54:08.254510 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:54:08.261138 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:54:08.267814 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:54:08.295607 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:54:08.296154 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:54:08.299888 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:54:08.335235 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:54:08.336184 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.336621 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.336993 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.337333 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.337640 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:54:08.337957 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:54:08.338266 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:54:08.338570 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:54:08.338867 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:08.339161 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:08.339450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:08.339741 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:08.377528 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.377894 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.378235 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.378549 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.378874 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.379168 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.379502 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:54:08.379830 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.380129 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.380454 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:54:08.380939 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:54:08.381316 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:54:08.381655 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.388276 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.388649 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.388997 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:54:08.389341 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.389668 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:54:08.392870 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.396775 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.399976 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.400294 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.400629 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:54:08.400962 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:54:08.401286 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:54:08.414984 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:54:08.415387 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.415884 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.416192 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.417251 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:54:08.417567 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.417883 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:54:08.418880 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:54:08.419221 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.420200 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:54:08.420618 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.420957 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:54:08.421308 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.421647 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.421952 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:54:08.422327 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:54:08.427448 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.427830 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.428273 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m12:54:08.431060 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.431378 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.431709 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.432097 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m12:54:08.435469 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.435811 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.438477 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.438888 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m12:54:08.441112 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:54:08.441435 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.441772 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m12:54:08.443549 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:54:08.444288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c6a0>]}
[0m12:54:08.444624 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.445177 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29fdf0>]}
[0m12:54:08.445695 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.21s]
[0m12:54:08.446899 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:54:08.447418 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.21s]
[0m12:54:08.447771 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.448255 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:54:08.448688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c490>]}
[0m12:54:08.449153 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:54:08.450215 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:54:08.450840 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.22s]
[0m12:54:08.451528 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:54:08.451998 [debug] [Thread-6 (]: Began running node model.ci_cd_project.dim_customers
[0m12:54:08.452479 [info ] [Thread-6 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:54:08.452990 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_customers'
[0m12:54:08.453316 [debug] [Thread-6 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:54:08.457344 [debug] [Thread-6 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:54:08.457879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c7f0>]}
[0m12:54:08.458448 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.23s]
[0m12:54:08.458972 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:54:08.459489 [debug] [Thread-8 (]: Began running node model.ci_cd_project.dim_products
[0m12:54:08.459818 [debug] [Thread-6 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:54:08.460171 [debug] [Thread-5 (]: Began running node model.ci_cd_project.fct_orders
[0m12:54:08.460579 [info ] [Thread-8 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:54:08.472577 [info ] [Thread-5 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:54:08.480762 [debug] [Thread-6 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:54:08.481208 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_products'
[0m12:54:08.481623 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.ci_cd_project.fct_orders'
[0m12:54:08.482051 [debug] [Thread-8 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:54:08.482404 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:54:08.487086 [debug] [Thread-8 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:54:08.487537 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.491529 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:54:08.491988 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:54:08.492539 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:54:08.492881 [debug] [Thread-8 (]: Began executing node model.ci_cd_project.dim_products
[0m12:54:08.496637 [debug] [Thread-8 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:54:08.496997 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:54:08.500699 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:54:08.532764 [debug] [Thread-6 (]: SQL status: OK in 0.040 seconds
[0m12:54:08.533122 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.533501 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.533925 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:54:08.534295 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:54:08.534661 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.535151 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:54:08.535455 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:54:08.535850 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:54:08.536269 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.536576 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.536948 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:54:08.537332 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.537875 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.538286 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:54:08.538658 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.543390 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.543792 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:54:08.544155 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.544486 [debug] [Thread-5 (]: SQL status: OK in 0.005 seconds
[0m12:54:08.547754 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.550901 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.551216 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.551541 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:54:08.551862 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:54:08.556054 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:54:08.556581 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.556914 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:54:08.557287 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.558422 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:54:08.558764 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.559095 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.559389 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.560468 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:54:08.560788 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:54:08.563509 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.563835 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.564215 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m12:54:08.564550 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m12:54:08.564834 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:54:08.568305 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.568690 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.568997 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m12:54:08.569314 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.570377 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: Close
[0m12:54:08.573106 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.573568 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3565c0>]}
[0m12:54:08.573921 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.574238 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m12:54:08.575760 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: Close
[0m12:54:08.574788 [info ] [Thread-6 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.12s]
[0m12:54:08.576335 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d927e20>]}
[0m12:54:08.576826 [debug] [Thread-6 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:54:08.577145 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.577620 [info ] [Thread-8 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.10s]
[0m12:54:08.578813 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: Close
[0m12:54:08.579270 [debug] [Thread-8 (]: Finished running node model.ci_cd_project.dim_products
[0m12:54:08.590119 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d927b50>]}
[0m12:54:08.590724 [info ] [Thread-5 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.11s]
[0m12:54:08.591363 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:54:08.592404 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.592720 [debug] [MainThread]: On master: BEGIN
[0m12:54:08.592991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:08.630694 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m12:54:08.631027 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.631307 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.631575 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.631906 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:08.632172 [debug] [MainThread]: On master: Close
[0m12:54:08.633147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:08.633453 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:54:08.633715 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_order_items' was properly closed.
[0m12:54:08.633953 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m12:54:08.634186 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_products' was properly closed.
[0m12:54:08.634419 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:54:08.634654 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:54:08.634880 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:54:08.635241 [info ] [MainThread]: 
[0m12:54:08.635548 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:54:08.636753 [debug] [MainThread]: Command end result
[0m12:54:08.708757 [info ] [MainThread]: 
[0m12:54:08.709179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:08.709488 [info ] [MainThread]: 
[0m12:54:08.709791 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:54:08.712729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.231933, "process_in_blocks": "0", "process_kernel_time": 0.299059, "process_mem_max_rss": "177061888", "process_out_blocks": "0", "process_user_time": 6.014648}
[0m12:54:08.713134 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:08.713054 after 4.23 seconds
[0m12:54:08.713469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae798d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d581960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96a200>]}
[0m12:54:08.713801 [debug] [MainThread]: Flushing usage events
[0m12:56:47.839798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108881cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108881840>]}


============================== 12:56:47.844651 | 89aa3906-18fa-4494-88a8-b31c049acaff ==============================
[0m12:56:47.844651 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:47.845201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --target prod', 'send_anonymous_usage_stats': 'True'}
[0m12:56:48.101310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106300f70>]}
[0m12:56:48.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c26560>]}
[0m12:56:48.155434 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:56:48.278512 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:56:48.489741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:48.490151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:48.543503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ec130>]}
[0m12:56:48.730261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3b4f0>]}
[0m12:56:48.730763 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:56:48.731096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a23ac0>]}
[0m12:56:48.734395 [info ] [MainThread]: 
[0m12:56:48.734880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:56:48.740517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m12:56:48.792396 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:56:48.792762 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:56:48.793045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:48.849400 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:56:48.849773 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:56:48.850444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:48.850740 [debug] [MainThread]: Connection 'list_prod_analytics' was properly closed.
[0m12:56:48.851022 [info ] [MainThread]: 
[0m12:56:48.851328 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m12:56:48.851766 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/preben/Documents/dbt-workshop/./warehouse/prod.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:56:48.854488 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0757446, "process_in_blocks": "0", "process_kernel_time": 0.266153, "process_mem_max_rss": "130449408", "process_out_blocks": "0", "process_user_time": 1.887856}
[0m12:56:48.854885 [debug] [MainThread]: Command `dbt test` failed at 12:56:48.854804 after 1.08 seconds
[0m12:56:48.855208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911ded0>]}
[0m12:56:48.855539 [debug] [MainThread]: Flushing usage events
[0m12:56:58.656492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091818d0>]}


============================== 12:56:58.661235 | ae489945-7d81-468c-8c94-21ff79457b3d ==============================
[0m12:56:58.661235 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:58.661762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:58.866673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d76ce0>]}
[0m12:56:58.916361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092178b0>]}
[0m12:56:58.920659 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:56:59.041605 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:56:59.163917 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:56:59.164343 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m12:56:59.164628 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:56:59.164948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536c20>]}
[0m12:57:01.467220 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:57:01.467708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109797f10>]}
[0m12:57:01.848641 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:57:01.849114 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:57:01.849437 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:57:01.849740 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:57:01.850024 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:57:01.850303 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:57:01.850578 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:57:01.850854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:57:01.851123 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:57:01.851390 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:57:01.851659 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:57:01.851922 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:57:01.852189 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:57:01.852455 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:57:01.852728 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:57:01.852992 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:57:01.853261 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:57:01.853524 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:57:01.853791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:57:01.854058 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:57:01.854323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:57:01.854594 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:57:01.854859 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:57:01.855128 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:57:01.855392 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:57:01.855655 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:57:01.855923 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:57:01.856184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:57:01.963253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0de10>]}
[0m12:57:02.117249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109525480>]}
[0m12:57:02.117761 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:02.118093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b340>]}
[0m12:57:02.121411 [info ] [MainThread]: 
[0m12:57:02.121893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:02.127609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:57:02.137967 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m12:57:02.172859 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:02.173237 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:02.173545 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:57:02.173839 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:57:02.174121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:02.174394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:02.180480 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:57:02.180843 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:57:02.183480 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:57:02.183805 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:57:02.184337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:02.184609 [debug] [MainThread]: Connection 'list_dev_analytics_dev' was properly closed.
[0m12:57:02.184854 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m12:57:02.185116 [info ] [MainThread]: 
[0m12:57:02.185410 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:57:02.185823 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/preben/Documents/dbt-workshop/./warehouse/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:57:02.188516 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.5890808, "process_in_blocks": "0", "process_kernel_time": 0.19364, "process_mem_max_rss": "140443648", "process_out_blocks": "0", "process_user_time": 4.514934}
[0m12:57:02.188890 [debug] [MainThread]: Command `dbt test` failed at 12:57:02.188814 after 3.59 seconds
[0m12:57:02.189213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099296c0>]}
[0m12:57:02.189552 [debug] [MainThread]: Flushing usage events
[0m12:57:31.080619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e89900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a949cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a949840>]}


============================== 12:57:31.085359 | d683f181-7e49-4d6d-9b6b-0ca68b0154c0 ==============================
[0m12:57:31.085359 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:57:31.085878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:57:31.315914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953ca90>]}
[0m12:57:31.365820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d35300>]}
[0m12:57:31.370092 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:57:31.492874 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:57:31.706170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:31.706574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:31.760186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b4130>]}
[0m12:57:31.946015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af034f0>]}
[0m12:57:31.946520 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:31.946853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf8e20>]}
[0m12:57:31.950172 [info ] [MainThread]: 
[0m12:57:31.950661 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:31.956496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:57:31.959669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m12:57:32.014932 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:32.015319 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:32.015632 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:57:32.015937 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:57:32.016224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:32.016502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:32.172465 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m12:57:32.172885 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m12:57:32.173205 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:32.173518 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:32.173847 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m12:57:32.174179 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m12:57:32.195915 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:57:32.196618 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:57:32.197727 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m12:57:32.198803 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m12:57:32.199574 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m12:57:32.199928 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m12:57:32.200203 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:57:32.200480 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m12:57:32.203333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad25ab0>]}
[0m12:57:32.203764 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:32.204046 [debug] [MainThread]: On master: BEGIN
[0m12:57:32.204305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:32.239316 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m12:57:32.239684 [debug] [MainThread]: On master: COMMIT
[0m12:57:32.239985 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:32.240263 [debug] [MainThread]: On master: COMMIT
[0m12:57:32.240609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:32.240887 [debug] [MainThread]: On master: Close
[0m12:57:32.241924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:32.242234 [info ] [MainThread]: 
[0m12:57:32.244773 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.245187 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.245852 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.246190 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.245571 [info ] [Thread-1 (]: 1 of 41 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m12:57:32.246616 [info ] [Thread-2 (]: 2 of 41 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m12:57:32.247032 [info ] [Thread-3 (]: 3 of 41 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:57:32.247496 [info ] [Thread-4 (]: 4 of 41 START test not_null_dim_customers_customer_tier ........................ [RUN]
[0m12:57:32.247907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m12:57:32.248270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m12:57:32.248686 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:57:32.249080 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:57:32.249413 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.249741 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.250052 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.250352 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.274401 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.277565 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.285692 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.289754 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.290727 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.291115 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.304112 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.304475 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.316299 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.321981 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.324789 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.328096 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.328966 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.329323 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:57:32.329706 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.330062 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:32.330493 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m12:57:32.330905 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.331275 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.331692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.332040 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m12:57:32.332362 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m12:57:32.332713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.333027 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:32.367518 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:32.367871 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.368190 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.368505 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.368846 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.369196 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.369559 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.369916 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.370235 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.370581 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.371079 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.371463 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.384704 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.385188 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.385596 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.386012 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.386346 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.386690 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387051 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387391 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387813 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m12:57:32.388212 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:57:32.388594 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m12:57:32.388981 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m12:57:32.396056 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:57:32.396440 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m12:57:32.397147 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:57:32.397871 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m12:57:32.398779 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:57:32.399112 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:57:32.399489 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m12:57:32.399847 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m12:57:32.400612 [debug] [Thread-4 (]: Runtime Error in test not_null_dim_customers_customer_tier (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.401557 [error] [Thread-4 (]: 4 of 41 ERROR not_null_dim_customers_customer_tier ............................. [[31mERROR[0m in 0.15s]
[0m12:57:32.402272 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.402698 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.403065 [info ] [Thread-4 (]: 5 of 41 START test not_null_dim_customers_total_orders ......................... [RUN]
[0m12:57:32.404458 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.404840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m12:57:32.405598 [debug] [Thread-1 (]: Runtime Error in test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 20:     from dev.analytics.dim_customers
                    ^
[0m12:57:32.406010 [error] [Thread-3 (]: 3 of 41 ERROR not_null_dim_customers_customer_id ............................... [[31mERROR[0m in 0.16s]
[0m12:57:32.406408 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.407167 [debug] [Thread-2 (]: Runtime Error in test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 20:     from dev.analytics.dim_products
                    ^
[0m12:57:32.407575 [error] [Thread-1 (]: 1 of 41 ERROR accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[31mERROR[0m in 0.16s]
[0m12:57:32.408213 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.413045 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.413528 [error] [Thread-2 (]: 2 of 41 ERROR accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[31mERROR[0m in 0.17s]
[0m12:57:32.414244 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.414634 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.415257 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.415650 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.416100 [info ] [Thread-3 (]: 6 of 41 START test not_null_dim_customers_total_spent .......................... [RUN]
[0m12:57:32.416544 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.416858 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.417238 [info ] [Thread-1 (]: 7 of 41 START test not_null_dim_products_performance_category .................. [RUN]
[0m12:57:32.417658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m12:57:32.418039 [info ] [Thread-2 (]: 8 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m12:57:32.421055 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.421462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m12:57:32.421823 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.422221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m12:57:32.422656 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.426955 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.427311 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.427696 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.432715 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.436862 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.437276 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m12:57:32.437696 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.438077 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.440951 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.441401 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.441763 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.444924 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.448342 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.448822 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.481394 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m12:57:32.481805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.482298 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.482658 [debug] [Thread-4 (]: SQL status: OK in 0.045 seconds
[0m12:57:32.483114 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.483448 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m12:57:32.483787 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.484104 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.484424 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:57:32.484741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.485072 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.485411 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.485741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.486128 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.486465 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.487052 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.487387 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.487731 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.488075 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.488489 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.493927 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.494315 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.494740 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495177 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495587 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495998 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:57:32.496330 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.496649 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.496967 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.497437 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m12:57:32.497943 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m12:57:32.498373 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m12:57:32.499399 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:57:32.499859 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:57:32.501014 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:57:32.501361 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m12:57:32.502051 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:57:32.502609 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m12:57:32.503566 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:57:32.503894 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m12:57:32.504566 [debug] [Thread-2 (]: Runtime Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.505842 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_customers_total_spent (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.505112 [error] [Thread-2 (]: 8 of 41 ERROR not_null_dim_products_product_id ................................. [[31mERROR[0m in 0.08s]
[0m12:57:32.506380 [error] [Thread-3 (]: 6 of 41 ERROR not_null_dim_customers_total_spent ............................... [[31mERROR[0m in 0.09s]
[0m12:57:32.507122 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.507898 [debug] [Thread-4 (]: Runtime Error in test not_null_dim_customers_total_orders (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.508392 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.508810 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.509239 [error] [Thread-4 (]: 5 of 41 ERROR not_null_dim_customers_total_orders .............................. [[31mERROR[0m in 0.10s]
[0m12:57:32.509783 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.510496 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_products_performance_category (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.510839 [info ] [Thread-2 (]: 9 of 41 START test not_null_dim_products_profit_margin ......................... [RUN]
[0m12:57:32.511407 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.511754 [info ] [Thread-3 (]: 10 of 41 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:57:32.512225 [error] [Thread-1 (]: 7 of 41 ERROR not_null_dim_products_performance_category ....................... [[31mERROR[0m in 0.09s]
[0m12:57:32.512713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m12:57:32.513099 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.513506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:57:32.513993 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.514309 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.514639 [info ] [Thread-4 (]: 11 of 41 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:57:32.515045 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.515445 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.519970 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.520390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:57:32.524586 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.524990 [info ] [Thread-1 (]: 12 of 41 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:57:32.525444 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.525897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m12:57:32.530198 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.530637 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.531007 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.531303 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.536408 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.539265 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.541995 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.542592 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.545488 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.546025 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.546387 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:57:32.546711 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.547065 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.547386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.547764 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.585217 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.585587 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m12:57:32.586041 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:57:32.586510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.586866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.587489 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.587827 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:57:32.588135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.623508 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m12:57:32.623865 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.624181 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.624483 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.624764 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.625074 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.625402 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.625705 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.626004 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.626390 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.626860 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.627208 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.634159 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.634657 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635086 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635489 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635808 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636120 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636423 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636720 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.637105 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:57:32.637484 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m12:57:32.637849 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:57:32.638207 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:57:32.639604 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m12:57:32.639975 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m12:57:32.640811 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m12:57:32.641353 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:57:32.642039 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m12:57:32.642839 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m12:57:32.643155 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:57:32.643649 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:57:32.644740 [debug] [Thread-2 (]: Runtime Error in test not_null_dim_products_profit_margin (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.645430 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_products_total_revenue (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.646021 [error] [Thread-2 (]: 9 of 41 ERROR not_null_dim_products_profit_margin .............................. [[31mERROR[0m in 0.13s]
[0m12:57:32.646498 [error] [Thread-3 (]: 10 of 41 ERROR not_null_dim_products_total_revenue ............................. [[31mERROR[0m in 0.13s]
[0m12:57:32.647032 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.647524 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.647961 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.648494 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.649198 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_orders_customer_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.649902 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_orders_order_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.650242 [info ] [Thread-2 (]: 13 of 41 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m12:57:32.650600 [info ] [Thread-3 (]: 14 of 41 START test not_null_fct_orders_product_id ............................. [RUN]
[0m12:57:32.651056 [error] [Thread-4 (]: 11 of 41 ERROR not_null_fct_orders_customer_id ................................. [[31mERROR[0m in 0.13s]
[0m12:57:32.651503 [error] [Thread-1 (]: 12 of 41 ERROR not_null_fct_orders_order_id .................................... [[31mERROR[0m in 0.13s]
[0m12:57:32.651903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m12:57:32.652263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m12:57:32.652869 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.653336 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.653657 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.653963 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.654322 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.654728 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.659174 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.663464 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.663864 [info ] [Thread-4 (]: 15 of 41 START test not_null_fct_orders_quantity ............................... [RUN]
[0m12:57:32.664282 [info ] [Thread-1 (]: 16 of 41 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m12:57:32.664843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m12:57:32.665293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m12:57:32.665661 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.665973 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.666261 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.666565 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.670685 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.674573 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.677334 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.681504 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.682409 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.682809 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.683136 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m12:57:32.683504 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.683821 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m12:57:32.684145 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.684464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.687313 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.687652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.691134 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.691837 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.692203 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m12:57:32.692521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.692931 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.693271 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m12:57:32.693843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.728889 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m12:57:32.729274 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:57:32.729606 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.729920 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.730208 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.730521 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.730855 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.731182 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.731485 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.731805 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.732263 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.732646 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.739860 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.740247 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.740675 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741113 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741514 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741923 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m12:57:32.742249 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.742562 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.742869 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.743350 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m12:57:32.743846 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m12:57:32.744282 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m12:57:32.745403 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m12:57:32.745887 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m12:57:32.746618 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m12:57:32.747113 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m12:57:32.748054 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m12:57:32.748718 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m12:57:32.749078 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m12:57:32.749438 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m12:57:32.750161 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_orders_product_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.750916 [error] [Thread-3 (]: 14 of 41 ERROR not_null_fct_orders_product_id .................................. [[31mERROR[0m in 0.10s]
[0m12:57:32.751485 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.752135 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.752538 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.753170 [error] [Thread-2 (]: 13 of 41 ERROR not_null_fct_orders_order_item_id ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.753703 [info ] [Thread-3 (]: 17 of 41 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m12:57:32.754467 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_orders_quantity (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.754945 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.755563 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_orders_unit_price (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.755932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m12:57:32.756332 [error] [Thread-4 (]: 15 of 41 ERROR not_null_fct_orders_quantity .................................... [[31mERROR[0m in 0.09s]
[0m12:57:32.756753 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.757146 [error] [Thread-1 (]: 16 of 41 ERROR not_null_fct_orders_unit_price .................................. [[31mERROR[0m in 0.09s]
[0m12:57:32.757509 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.758210 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.758565 [info ] [Thread-2 (]: 18 of 41 START test not_null_stg_customers_email ............................... [RUN]
[0m12:57:32.759049 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.763581 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.764016 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.764443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m12:57:32.764828 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.765617 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.765315 [info ] [Thread-4 (]: 19 of 41 START test not_null_stg_customers_first_name .......................... [RUN]
[0m12:57:32.766050 [info ] [Thread-1 (]: 20 of 41 START test not_null_stg_customers_last_name ........................... [RUN]
[0m12:57:32.770233 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.770660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_quantity.f754434156, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m12:57:32.771049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m12:57:32.771389 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.771777 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.772100 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.774954 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.780419 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.780771 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.784865 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.787862 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.788420 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.791248 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.791682 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.792106 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.795730 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.796109 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m12:57:32.796506 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.796878 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.797275 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.797622 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m12:57:32.797958 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m12:57:32.798318 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.798715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.799037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.799360 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m12:57:32.799724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.833728 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.834132 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.834473 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.834783 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.835073 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.835384 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.835718 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.836023 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.836325 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.836702 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.837159 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.837511 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.844766 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.845245 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.845656 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.846048 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.846362 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.846677 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.846984 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.847283 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.847673 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m12:57:32.848052 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m12:57:32.848425 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m12:57:32.848794 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m12:57:32.850289 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m12:57:32.851060 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m12:57:32.851405 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m12:57:32.852055 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m12:57:32.852710 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m12:57:32.853013 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m12:57:32.853535 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m12:57:32.853873 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m12:57:32.855138 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_customers_first_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.856404 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_last_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.855706 [error] [Thread-4 (]: 19 of 41 ERROR not_null_stg_customers_first_name ............................... [[31mERROR[0m in 0.09s]
[0m12:57:32.856934 [error] [Thread-1 (]: 20 of 41 ERROR not_null_stg_customers_last_name ................................ [[31mERROR[0m in 0.09s]
[0m12:57:32.857692 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.858281 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.858937 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.859396 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.859779 [error] [Thread-3 (]: 17 of 41 ERROR not_null_stg_customers_customer_id .............................. [[31mERROR[0m in 0.10s]
[0m12:57:32.860179 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.860637 [error] [Thread-2 (]: 18 of 41 ERROR not_null_stg_customers_email .................................... [[31mERROR[0m in 0.10s]
[0m12:57:32.861089 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.861620 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.861963 [info ] [Thread-4 (]: 21 of 41 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m12:57:32.862580 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.862934 [info ] [Thread-1 (]: 22 of 41 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m12:57:32.863341 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.863718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m12:57:32.864095 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.864497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m12:57:32.864836 [info ] [Thread-3 (]: 23 of 41 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m12:57:32.865180 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.865504 [info ] [Thread-2 (]: 24 of 41 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m12:57:32.865834 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.866168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m12:57:32.870704 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.871118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m12:57:32.875271 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.875653 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.876085 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.880422 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.885615 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.886145 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.888960 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.889429 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.889813 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.892553 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.892898 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.895661 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.896148 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.899372 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.899836 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m12:57:32.900248 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.900618 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.900963 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.901290 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m12:57:32.901690 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m12:57:32.902048 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.902383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.902696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.903026 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m12:57:32.903412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.937541 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m12:57:32.937912 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.938243 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.938550 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.938836 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.939143 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.939470 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.939800 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.940099 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.940419 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.940861 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.941252 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.948556 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.948963 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.949397 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.949809 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.950200 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.950599 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m12:57:32.950930 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951238 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951541 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951985 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m12:57:32.952481 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m12:57:32.952928 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m12:57:32.954066 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m12:57:32.954420 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m12:57:32.955529 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m12:57:32.956280 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m12:57:32.956926 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m12:57:32.957247 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m12:57:32.957976 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_order_items_product_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.958292 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m12:57:32.958595 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m12:57:32.959026 [error] [Thread-3 (]: 23 of 41 ERROR not_null_stg_order_items_product_id ............................. [[31mERROR[0m in 0.09s]
[0m12:57:32.960132 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.960580 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.960949 [info ] [Thread-3 (]: 25 of 41 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m12:57:32.961409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m12:57:32.962087 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_order_items_order_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.962683 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.963141 [error] [Thread-4 (]: 21 of 41 ERROR not_null_stg_order_items_order_id ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.967946 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.968638 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.969252 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.969921 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_order_items_quantity (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.970444 [error] [Thread-1 (]: 22 of 41 ERROR not_null_stg_order_items_order_item_id .......................... [[31mERROR[0m in 0.11s]
[0m12:57:32.970915 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.971379 [error] [Thread-2 (]: 24 of 41 ERROR not_null_stg_order_items_quantity ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.971886 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.972252 [info ] [Thread-4 (]: 26 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m12:57:32.972774 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.973149 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.973515 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.973877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:57:32.974259 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:32.974638 [info ] [Thread-1 (]: 27 of 41 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m12:57:32.977580 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.978080 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.978437 [info ] [Thread-2 (]: 28 of 41 START test not_null_stg_products_cost ................................. [RUN]
[0m12:57:32.978867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m12:57:32.983192 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:32.983606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m12:57:32.983982 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.984388 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:32.989385 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:32.993483 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:32.993964 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.994513 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.994944 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:57:32.997803 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:32.998228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.998545 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.998919 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:33.001820 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.005311 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.005850 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:33.006223 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:57:33.036543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.037142 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.037513 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:33.037876 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.038267 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.038620 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.039017 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.039333 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:33.039665 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m12:57:33.040097 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m12:57:33.040444 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.040790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.041105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.041696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.042010 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.042325 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.042657 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.043031 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.043482 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.046859 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.047261 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.047686 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048093 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048487 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048886 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:57:33.049211 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.049581 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.049919 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.050445 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:57:33.050887 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m12:57:33.051313 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m12:57:33.052210 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m12:57:33.052795 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:57:33.053903 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m12:57:33.054218 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m12:57:33.054915 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m12:57:33.055435 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:57:33.056206 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m12:57:33.056534 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m12:57:33.057473 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.058067 [error] [Thread-4 (]: 26 of 41 ERROR not_null_stg_orders_order_id .................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.058714 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:33.059376 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_products_cost (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.059810 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.060399 [error] [Thread-2 (]: 28 of 41 ERROR not_null_stg_products_cost ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.061156 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_orders_customer_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.061508 [info ] [Thread-4 (]: 29 of 41 START test not_null_stg_products_price ................................ [RUN]
[0m12:57:33.062021 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:33.062648 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_orders_total_amount (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.063044 [error] [Thread-3 (]: 25 of 41 ERROR not_null_stg_orders_customer_id ................................. [[31mERROR[0m in 0.10s]
[0m12:57:33.063545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m12:57:33.063923 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.064518 [error] [Thread-1 (]: 27 of 41 ERROR not_null_stg_orders_total_amount ................................ [[31mERROR[0m in 0.09s]
[0m12:57:33.065103 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:33.065427 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.065763 [info ] [Thread-2 (]: 30 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m12:57:33.066248 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:33.066610 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.071137 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.071559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m12:57:33.071968 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.072382 [info ] [Thread-3 (]: 31 of 41 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m12:57:33.072827 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.073183 [info ] [Thread-1 (]: 32 of 41 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m12:57:33.073569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m12:57:33.077875 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.078323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m12:57:33.078667 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.078993 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.079408 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.082342 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.097614 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.098026 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.098483 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.101479 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.102016 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.102424 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.102745 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m12:57:33.105568 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.105947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.106314 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.106758 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.110490 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.110848 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:57:33.111227 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.111608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.111936 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m12:57:33.112343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.112736 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.113081 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m12:57:33.113380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.145515 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:57:33.145866 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m12:57:33.146176 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.146485 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m12:57:33.146818 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.147114 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m12:57:33.147441 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.147774 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.148099 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.148431 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.148879 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.149399 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.156603 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.157005 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.157473 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.157919 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.158346 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.158761 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m12:57:33.159089 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.159399 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.159706 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.160194 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m12:57:33.160689 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:57:33.161125 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m12:57:33.162242 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m12:57:33.162607 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m12:57:33.163735 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m12:57:33.164410 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m12:57:33.164751 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:57:33.165162 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m12:57:33.165812 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m12:57:33.166775 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_products_price (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.167251 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m12:57:33.168018 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.168451 [error] [Thread-4 (]: 29 of 41 ERROR not_null_stg_products_price ..................................... [[31mERROR[0m in 0.10s]
[0m12:57:33.169050 [error] [Thread-2 (]: 30 of 41 ERROR not_null_stg_products_product_id ................................ [[31mERROR[0m in 0.10s]
[0m12:57:33.169778 [debug] [Thread-3 (]: Runtime Error in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.170275 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.170898 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.171304 [error] [Thread-3 (]: 31 of 41 ERROR relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[31mERROR[0m in 0.10s]
[0m12:57:33.171743 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.172570 [debug] [Thread-1 (]: Runtime Error in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.172927 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.173437 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.173781 [info ] [Thread-4 (]: 33 of 41 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m12:57:33.174216 [error] [Thread-1 (]: 32 of 41 ERROR relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[31mERROR[0m in 0.10s]
[0m12:57:33.174588 [info ] [Thread-2 (]: 34 of 41 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:57:33.174997 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.175408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:57:33.176070 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.176520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:57:33.176875 [info ] [Thread-3 (]: 35 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m12:57:33.177218 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.177569 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.177930 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.178305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m12:57:33.184118 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.184523 [info ] [Thread-1 (]: 36 of 41 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m12:57:33.190933 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.191332 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.191779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m12:57:33.196055 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.196474 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.196925 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.201945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.202293 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.245081 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.248114 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.248513 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.251522 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.251901 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.252415 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.255159 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.255510 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.255862 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m12:57:33.256271 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.256600 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:57:33.256959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.257307 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:57:33.257653 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.257962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.258344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.258666 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m12:57:33.259040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.296707 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.297098 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.297435 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:57:33.297750 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.298089 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.298413 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.298726 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.299025 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.299371 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.299824 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.300194 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.300540 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.306863 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.307271 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.307721 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.308155 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.308578 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.308992 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:57:33.309317 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.309629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.309976 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.310439 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:57:33.310924 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m12:57:33.311377 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m12:57:33.312397 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m12:57:33.312820 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:57:33.313894 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m12:57:33.314308 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m12:57:33.315211 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m12:57:33.315874 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m12:57:33.316194 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:57:33.316603 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m12:57:33.317243 [debug] [Thread-2 (]: Runtime Error in test unique_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.dim_customers
                ^
[0m12:57:33.318005 [error] [Thread-2 (]: 34 of 41 ERROR unique_dim_customers_customer_id ................................ [[31mERROR[0m in 0.14s]
[0m12:57:33.318629 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.319029 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.319385 [info ] [Thread-2 (]: 37 of 41 START test unique_stg_customers_customer_id ........................... [RUN]
[0m12:57:33.320133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m12:57:33.320810 [debug] [Thread-3 (]: Runtime Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.dim_products
                ^
[0m12:57:33.321159 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.321808 [debug] [Thread-4 (]: Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 16:     from dev.analytics.stg_orders
                    ^
[0m12:57:33.322227 [error] [Thread-3 (]: 35 of 41 ERROR unique_dim_products_product_id .................................. [[31mERROR[0m in 0.14s]
[0m12:57:33.327867 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.328352 [error] [Thread-4 (]: 33 of 41 ERROR relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[31mERROR[0m in 0.15s]
[0m12:57:33.328863 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.329636 [debug] [Thread-1 (]: Runtime Error in test unique_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.fct_orders
                ^
[0m12:57:33.330180 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.330570 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.330993 [error] [Thread-1 (]: 36 of 41 ERROR unique_fct_orders_order_item_id ................................. [[31mERROR[0m in 0.14s]
[0m12:57:33.331409 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.331814 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.332134 [info ] [Thread-3 (]: 38 of 41 START test unique_stg_customers_email ................................. [RUN]
[0m12:57:33.332603 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.332923 [info ] [Thread-4 (]: 39 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m12:57:33.335871 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.336278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m12:57:33.336692 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.337110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m12:57:33.337535 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.337875 [info ] [Thread-1 (]: 40 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:57:33.338234 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.342289 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.342702 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.343046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:57:33.347314 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.347764 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m12:57:33.348096 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.348511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.348841 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.353821 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.356715 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.357067 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.359937 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.360543 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.361151 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.361491 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m12:57:33.364318 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.364682 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.396143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.396582 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m12:57:33.396919 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m12:57:33.397397 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.397735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.398030 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:57:33.398386 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.398766 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.399163 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.399479 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:57:33.399912 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:57:33.400249 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.400580 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.400876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.401316 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.401817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.402129 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.402458 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.406398 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.406888 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.407323 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.407732 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.408056 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.408393 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.408736 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.409054 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.409449 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m12:57:33.409836 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m12:57:33.410205 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:57:33.410574 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m12:57:33.412036 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m12:57:33.412707 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m12:57:33.413430 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m12:57:33.413802 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m12:57:33.414467 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m12:57:33.414760 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:57:33.415060 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m12:57:33.415428 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m12:57:33.416966 [debug] [Thread-3 (]: Runtime Error in test unique_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.417436 [error] [Thread-3 (]: 38 of 41 ERROR unique_stg_customers_email ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.417972 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.418639 [debug] [Thread-1 (]: Runtime Error in test unique_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.stg_orders
                ^
[0m12:57:33.419161 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.419754 [error] [Thread-1 (]: 40 of 41 ERROR unique_stg_orders_order_id ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.420455 [debug] [Thread-2 (]: Runtime Error in test unique_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.420867 [info ] [Thread-3 (]: 41 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m12:57:33.421388 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.421848 [error] [Thread-2 (]: 37 of 41 ERROR unique_stg_customers_customer_id ................................ [[31mERROR[0m in 0.10s]
[0m12:57:33.422536 [debug] [Thread-4 (]: Runtime Error in test unique_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 18: from dev.analytics.stg_order_items
                ^
[0m12:57:33.422912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m12:57:33.423672 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.424076 [error] [Thread-4 (]: 39 of 41 ERROR unique_stg_order_items_order_item_id ............................ [[31mERROR[0m in 0.09s]
[0m12:57:33.424438 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.425009 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.430483 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.431238 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.434042 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.434629 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.434946 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:57:33.435237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.472660 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:33.473034 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.473370 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.479347 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.479739 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.480144 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:57:33.481003 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m12:57:33.481320 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m12:57:33.482947 [debug] [Thread-3 (]: Runtime Error in test unique_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.stg_products
                ^
[0m12:57:33.483406 [error] [Thread-3 (]: 41 of 41 ERROR unique_stg_products_product_id .................................. [[31mERROR[0m in 0.06s]
[0m12:57:33.483919 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.484895 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:33.485201 [debug] [MainThread]: On master: BEGIN
[0m12:57:33.485458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:33.523235 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m12:57:33.523592 [debug] [MainThread]: On master: COMMIT
[0m12:57:33.523926 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:33.524242 [debug] [MainThread]: On master: COMMIT
[0m12:57:33.524609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:33.524887 [debug] [MainThread]: On master: Close
[0m12:57:33.525821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:33.526082 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:57:33.526326 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m12:57:33.526640 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:57:33.526907 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108' was properly closed.
[0m12:57:33.527250 [info ] [MainThread]: 
[0m12:57:33.527557 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m12:57:33.532611 [debug] [MainThread]: Command end result
[0m12:57:33.606484 [info ] [MainThread]: 
[0m12:57:33.606927 [info ] [MainThread]: [31mCompleted with 41 errors and 0 warnings:[0m
[0m12:57:33.607212 [info ] [MainThread]: 
[0m12:57:33.607564 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_customer_tier (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.607847 [info ] [MainThread]: 
[0m12:57:33.608173 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.608439 [info ] [MainThread]: 
[0m12:57:33.608764 [error] [MainThread]:   Runtime Error in test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 20:     from dev.analytics.dim_customers
                    ^
[0m12:57:33.609028 [info ] [MainThread]: 
[0m12:57:33.609399 [error] [MainThread]:   Runtime Error in test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 20:     from dev.analytics.dim_products
                    ^
[0m12:57:33.609720 [info ] [MainThread]: 
[0m12:57:33.610054 [error] [MainThread]:   Runtime Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.610321 [info ] [MainThread]: 
[0m12:57:33.610638 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_total_spent (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.610898 [info ] [MainThread]: 
[0m12:57:33.611211 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_total_orders (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.611468 [info ] [MainThread]: 
[0m12:57:33.611832 [error] [MainThread]:   Runtime Error in test not_null_dim_products_performance_category (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.612210 [info ] [MainThread]: 
[0m12:57:33.612568 [error] [MainThread]:   Runtime Error in test not_null_dim_products_profit_margin (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.612841 [info ] [MainThread]: 
[0m12:57:33.613170 [error] [MainThread]:   Runtime Error in test not_null_dim_products_total_revenue (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.613676 [info ] [MainThread]: 
[0m12:57:33.614053 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_customer_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.614322 [info ] [MainThread]: 
[0m12:57:33.614638 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_order_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.614896 [info ] [MainThread]: 
[0m12:57:33.615205 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_product_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.615461 [info ] [MainThread]: 
[0m12:57:33.615770 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.616022 [info ] [MainThread]: 
[0m12:57:33.616325 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_quantity (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.616578 [info ] [MainThread]: 
[0m12:57:33.616910 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_unit_price (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.617188 [info ] [MainThread]: 
[0m12:57:33.617503 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_first_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.617764 [info ] [MainThread]: 
[0m12:57:33.618073 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_last_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.618325 [info ] [MainThread]: 
[0m12:57:33.618631 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.618887 [info ] [MainThread]: 
[0m12:57:33.619193 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.619450 [info ] [MainThread]: 
[0m12:57:33.619760 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_product_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.620024 [info ] [MainThread]: 
[0m12:57:33.620340 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_order_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.620596 [info ] [MainThread]: 
[0m12:57:33.620901 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.621155 [info ] [MainThread]: 
[0m12:57:33.621460 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_quantity (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.621715 [info ] [MainThread]: 
[0m12:57:33.622078 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.622366 [info ] [MainThread]: 
[0m12:57:33.622706 [error] [MainThread]:   Runtime Error in test not_null_stg_products_cost (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.622984 [info ] [MainThread]: 
[0m12:57:33.623315 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_customer_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.623584 [info ] [MainThread]: 
[0m12:57:33.623899 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_total_amount (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.624156 [info ] [MainThread]: 
[0m12:57:33.624464 [error] [MainThread]:   Runtime Error in test not_null_stg_products_price (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.624721 [info ] [MainThread]: 
[0m12:57:33.625030 [error] [MainThread]:   Runtime Error in test not_null_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.625287 [info ] [MainThread]: 
[0m12:57:33.625606 [error] [MainThread]:   Runtime Error in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.625869 [info ] [MainThread]: 
[0m12:57:33.626184 [error] [MainThread]:   Runtime Error in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.626516 [info ] [MainThread]: 
[0m12:57:33.627022 [error] [MainThread]:   Runtime Error in test unique_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.dim_customers
                ^
[0m12:57:33.627315 [info ] [MainThread]: 
[0m12:57:33.627670 [error] [MainThread]:   Runtime Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.dim_products
                ^
[0m12:57:33.627934 [info ] [MainThread]: 
[0m12:57:33.628260 [error] [MainThread]:   Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 16:     from dev.analytics.stg_orders
                    ^
[0m12:57:33.628520 [info ] [MainThread]: 
[0m12:57:33.628827 [error] [MainThread]:   Runtime Error in test unique_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.fct_orders
                ^
[0m12:57:33.629078 [info ] [MainThread]: 
[0m12:57:33.629383 [error] [MainThread]:   Runtime Error in test unique_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.629632 [info ] [MainThread]: 
[0m12:57:33.629935 [error] [MainThread]:   Runtime Error in test unique_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.stg_orders
                ^
[0m12:57:33.630187 [info ] [MainThread]: 
[0m12:57:33.630494 [error] [MainThread]:   Runtime Error in test unique_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.630746 [info ] [MainThread]: 
[0m12:57:33.631056 [error] [MainThread]:   Runtime Error in test unique_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 18: from dev.analytics.stg_order_items
                ^
[0m12:57:33.631310 [info ] [MainThread]: 
[0m12:57:33.631616 [error] [MainThread]:   Runtime Error in test unique_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.stg_products
                ^
[0m12:57:33.631920 [info ] [MainThread]: 
[0m12:57:33.632257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=41 SKIP=0 TOTAL=41
[0m12:57:33.634877 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.6135461, "process_in_blocks": "0", "process_kernel_time": 0.549885, "process_mem_max_rss": "156319744", "process_out_blocks": "0", "process_user_time": 5.569214}
[0m12:57:33.635252 [debug] [MainThread]: Command `dbt test` failed at 12:57:33.635177 after 2.61 seconds
[0m12:57:33.635587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e89900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfcf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce9db0>]}
[0m12:57:33.635916 [debug] [MainThread]: Flushing usage events
[0m12:57:55.720221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c618d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871d870>]}


============================== 12:57:55.725077 | fc8306d4-ce4e-461f-ac1c-05b04e8ccd77 ==============================
[0m12:57:55.725077 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:57:55.725631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target prod', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:55.950620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d3bb0>]}
[0m12:57:56.000362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e08040>]}
[0m12:57:56.004577 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:57:56.127298 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:57:56.250101 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:57:56.250522 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m12:57:56.250811 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:56.251133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad3190>]}
[0m12:57:58.569887 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:57:58.570392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8bdf0>]}
[0m12:57:58.954588 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:57:58.955076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:57:58.955403 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:57:58.955704 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:57:58.955992 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:57:58.956276 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:57:58.956557 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:57:58.956838 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:57:58.957109 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:57:58.957382 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:57:58.957656 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:57:58.957925 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:57:58.958200 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:57:58.958473 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:57:58.958742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:57:58.959012 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:57:58.959283 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:57:58.959550 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:57:58.959816 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:57:58.960082 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:57:58.960356 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:57:58.960630 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:57:58.960905 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:57:58.961180 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:57:58.961450 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:57:58.961720 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:57:58.961988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:57:58.962255 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:57:59.070219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0b8b0>]}
[0m12:57:59.215867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66320>]}
[0m12:57:59.216353 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:59.216684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f30760>]}
[0m12:57:59.218835 [info ] [MainThread]: 
[0m12:57:59.219306 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:59.224634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:57:59.268719 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:57:59.269078 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:57:59.269367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:59.420677 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m12:57:59.422249 [debug] [ThreadPool]: On list_prod: Close
[0m12:57:59.425559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now list_prod_analytics)
[0m12:57:59.431470 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:57:59.431789 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:57:59.432056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:59.467501 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m12:57:59.467833 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:57:59.468130 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:57:59.479448 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:57:59.480697 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:57:59.481438 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:57:59.481713 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:57:59.484284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a31960>]}
[0m12:57:59.484755 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.485051 [debug] [MainThread]: On master: BEGIN
[0m12:57:59.485320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:59.519898 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m12:57:59.520224 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.520505 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.520767 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.521099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:59.521365 [debug] [MainThread]: On master: Close
[0m12:57:59.522328 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:57:59.522651 [info ] [MainThread]: 
[0m12:57:59.525308 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:57:59.525702 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:57:59.526162 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:57:59.526541 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:57:59.526886 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:57:59.527294 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:57:59.527746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now model.ci_cd_project.stg_customers)
[0m12:57:59.528259 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:57:59.528752 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:57:59.529212 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_order_items'
[0m12:57:59.529550 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:57:59.529969 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:57:59.530392 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:57:59.530728 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:57:59.539715 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:57:59.540065 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:57:59.540396 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:57:59.543735 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:57:59.547303 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:57:59.551678 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:57:59.552145 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:57:59.565198 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:57:59.584412 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:57:59.587068 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:57:59.587638 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:57:59.591241 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:57:59.591706 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:57:59.625721 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.628877 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:57:59.629289 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:57:59.629697 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.630121 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.630488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:59.630825 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:57:59.631171 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:57:59.631533 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.631920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:59.632245 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:59.632560 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:57:59.632930 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:59.667747 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.668118 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.668461 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:57:59.668824 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:57:59.669157 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.669447 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.669762 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.670437 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.670763 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.671093 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:57:59.671405 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.671737 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:57:59.672090 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:57:59.678898 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.679300 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.679878 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "prod"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m12:57:59.683299 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.683635 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.683970 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.684616 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view "prod"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m12:57:59.684980 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.688272 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.692218 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.695570 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.695935 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "prod"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m12:57:59.696245 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.696566 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "prod"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m12:57:59.696887 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:57:59.700162 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.700558 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.700911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.701261 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:57:59.704425 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.704766 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.708446 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.708877 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:57:59.715182 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:57:59.721831 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:57:59.724902 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:57:59.726121 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:57:59.726496 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.726900 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.727224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.727539 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.728603 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:57:59.728928 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:57:59.729957 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:57:59.730283 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:57:59.730602 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.730996 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.731420 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:57:59.731812 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:57:59.732221 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.732567 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.737746 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.738128 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.740898 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.741235 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:57:59.741551 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m12:57:59.744821 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.745188 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m12:57:59.747899 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.748311 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m12:57:59.748733 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m12:57:59.749066 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.749505 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.751664 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:57:59.752016 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.752325 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.753363 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:57:59.755034 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:57:59.755793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082e90>]}
[0m12:57:59.756821 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:57:59.757255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d236d0>]}
[0m12:57:59.757647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109059d20>]}
[0m12:57:59.758188 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.22s]
[0m12:57:59.758794 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.23s]
[0m12:57:59.759340 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.23s]
[0m12:57:59.759863 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:57:59.760331 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:57:59.760782 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:57:59.761395 [debug] [Thread-6 (]: Began running node model.ci_cd_project.dim_customers
[0m12:57:59.761826 [info ] [Thread-6 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:57:59.762277 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_customers'
[0m12:57:59.762596 [debug] [Thread-6 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:57:59.766569 [debug] [Thread-6 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:57:59.767019 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082fe0>]}
[0m12:57:59.767725 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.24s]
[0m12:57:59.768311 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:57:59.768723 [debug] [Thread-6 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:57:59.788246 [debug] [Thread-8 (]: Began running node model.ci_cd_project.dim_products
[0m12:57:59.788801 [debug] [Thread-6 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:57:59.789162 [debug] [Thread-5 (]: Began running node model.ci_cd_project.fct_orders
[0m12:57:59.789589 [info ] [Thread-8 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:57:59.790142 [info ] [Thread-5 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:57:59.790661 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_products'
[0m12:57:59.791081 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.ci_cd_project.fct_orders'
[0m12:57:59.791409 [debug] [Thread-8 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:57:59.791747 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.792054 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:57:59.796741 [debug] [Thread-8 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:57:59.797129 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:57:59.801108 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:57:59.801566 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:57:59.802053 [debug] [Thread-8 (]: Began executing node model.ci_cd_project.dim_products
[0m12:57:59.805759 [debug] [Thread-8 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:57:59.806169 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:57:59.809788 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:57:59.840316 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.840725 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:57:59.841108 [debug] [Thread-6 (]: SQL status: OK in 0.040 seconds
[0m12:57:59.841440 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:57:59.841818 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.842243 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.842629 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:57:59.842995 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m12:57:59.843314 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:57:59.843795 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.844110 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:57:59.844503 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:57:59.845114 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.845444 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.845813 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:57:59.853515 [debug] [Thread-8 (]: SQL status: OK in 0.009 seconds
[0m12:57:59.853902 [debug] [Thread-6 (]: SQL status: OK in 0.010 seconds
[0m12:57:59.858312 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.858676 [debug] [Thread-5 (]: SQL status: OK in 0.012 seconds
[0m12:57:59.861898 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.862261 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table "prod"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m12:57:59.865387 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.865736 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "prod"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m12:57:59.866165 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "prod"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m12:57:59.866567 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.866933 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.870070 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.873898 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.874209 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.874531 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:57:59.874854 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:57:59.877974 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.878496 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:57:59.878837 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.879185 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.883585 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:57:59.884775 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:57:59.885099 [debug] [Thread-5 (]: SQL status: OK in 0.006 seconds
[0m12:57:59.885424 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.885735 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.886821 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:57:59.887146 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:57:59.887449 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:57:59.887755 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.888221 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:57:59.888803 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.891677 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.892002 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.892311 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m12:57:59.892606 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.895394 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.899178 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.899575 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m12:57:59.899956 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.900315 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m12:57:59.901591 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: Close
[0m12:57:59.902149 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109829120>]}
[0m12:57:59.902515 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:57:59.904071 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: Close
[0m12:57:59.903075 [info ] [Thread-8 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.11s]
[0m12:57:59.904488 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.904918 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1d80>]}
[0m12:57:59.905383 [debug] [Thread-8 (]: Finished running node model.ci_cd_project.dim_products
[0m12:57:59.906443 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: Close
[0m12:57:59.906959 [info ] [Thread-6 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.14s]
[0m12:57:59.907588 [debug] [Thread-6 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:57:59.919531 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f64220>]}
[0m12:57:59.920114 [info ] [Thread-5 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.13s]
[0m12:57:59.920641 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:57:59.921687 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.922002 [debug] [MainThread]: On master: BEGIN
[0m12:57:59.922272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:59.962753 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:57:59.963096 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.963383 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.963648 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.964015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:59.964327 [debug] [MainThread]: On master: Close
[0m12:57:59.965333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:59.965642 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:57:59.965897 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_order_items' was properly closed.
[0m12:57:59.966140 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m12:57:59.966376 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_products' was properly closed.
[0m12:57:59.966611 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:57:59.966844 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:57:59.967076 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:57:59.967431 [info ] [MainThread]: 
[0m12:57:59.967735 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:57:59.968952 [debug] [MainThread]: Command end result
[0m12:58:00.040306 [info ] [MainThread]: 
[0m12:58:00.040753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:00.041060 [info ] [MainThread]: 
[0m12:58:00.041361 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:58:00.044079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.38141, "process_in_blocks": "0", "process_kernel_time": 0.381365, "process_mem_max_rss": "182894592", "process_out_blocks": "0", "process_user_time": 6.027266}
[0m12:58:00.044485 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:00.044403 after 4.38 seconds
[0m12:58:00.044825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c618d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e08040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9d000>]}
[0m12:58:00.045157 [debug] [MainThread]: Flushing usage events
[0m12:58:07.291183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093958a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae55d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae558a0>]}


============================== 12:58:07.295871 | aa14daee-4fce-4c31-9c4f-5f9629d0831e ==============================
[0m12:58:07.295871 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:07.296390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --target prod', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:07.500955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d5c60>]}
[0m12:58:07.551016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeeb8e0>]}
[0m12:58:07.555137 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:58:07.676456 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:58:07.879666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:07.880073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:07.933919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c0130>]}
[0m12:58:08.117880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40ffd0>]}
[0m12:58:08.118376 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:58:08.118709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae0ee0>]}
[0m12:58:08.122006 [info ] [MainThread]: 
[0m12:58:08.122492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:58:08.128350 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m12:58:08.171642 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:58:08.171995 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:58:08.172274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:08.221656 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:58:08.222008 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:58:08.222304 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:58:08.230180 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:58:08.231546 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:58:08.232528 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:58:08.232841 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:58:08.235341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9da20>]}
[0m12:58:08.235810 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:08.236099 [debug] [MainThread]: On master: BEGIN
[0m12:58:08.236360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:08.273883 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:58:08.274194 [debug] [MainThread]: On master: COMMIT
[0m12:58:08.274466 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:08.274726 [debug] [MainThread]: On master: COMMIT
[0m12:58:08.275092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:08.275433 [debug] [MainThread]: On master: Close
[0m12:58:08.276446 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:58:08.276766 [info ] [MainThread]: 
[0m12:58:08.279480 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.279918 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.280604 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.280315 [info ] [Thread-1 (]: 1 of 41 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m12:58:08.281049 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.281666 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.281401 [info ] [Thread-2 (]: 2 of 41 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m12:58:08.282162 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.282481 [info ] [Thread-3 (]: 3 of 41 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:58:08.282880 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.283273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m12:58:08.283638 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.283965 [info ] [Thread-4 (]: 4 of 41 START test not_null_dim_customers_customer_tier ........................ [RUN]
[0m12:58:08.284333 [info ] [Thread-5 (]: 5 of 41 START test not_null_dim_customers_total_orders ......................... [RUN]
[0m12:58:08.284808 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:58:08.285149 [info ] [Thread-6 (]: 6 of 41 START test not_null_dim_customers_total_spent .......................... [RUN]
[0m12:58:08.285579 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:58:08.285912 [info ] [Thread-7 (]: 7 of 41 START test not_null_dim_products_performance_category .................. [RUN]
[0m12:58:08.286258 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.286585 [info ] [Thread-8 (]: 8 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m12:58:08.287004 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:58:08.287397 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:58:08.287735 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.288159 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:58:08.288525 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.288989 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:58:08.301974 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:58:08.307869 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.308264 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.308595 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.315486 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.315829 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.323905 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.324260 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.324593 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.328684 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.332753 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.333224 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.338070 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.342262 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.342665 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.346631 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.347046 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.365005 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.365443 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.365755 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.368575 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.369032 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.371870 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.372293 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.375112 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.375441 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.378679 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.379179 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.381929 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.382425 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.385146 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.387927 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.388271 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.388690 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m12:58:08.389070 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.389479 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m12:58:08.389945 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.390363 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.390703 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:58:08.391062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.391412 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m12:58:08.391751 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.392103 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.392441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:58:08.392754 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m12:58:08.393061 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m12:58:08.393359 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:58:08.393754 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:58:08.394069 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m12:58:08.394376 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:58:08.394714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:58:08.395020 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:58:08.395378 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:58:08.395682 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:58:08.433562 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.434042 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.434397 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.434756 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.435220 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from prod.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:58:08.435666 [debug] [Thread-5 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.436074 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.436487 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.436850 [debug] [Thread-8 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.437147 [debug] [Thread-6 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.437446 [debug] [Thread-7 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.437757 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.438229 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.438590 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.438955 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.439376 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.439934 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.440309 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.440616 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.441013 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from prod.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:58:08.441430 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from prod.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.441794 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from prod.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442252 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442615 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from prod.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442947 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.443324 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from prod.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.447346 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m12:58:08.448322 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.449519 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:58:08.449851 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.450176 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.450517 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.450845 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.451304 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m12:58:08.452439 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m12:58:08.452806 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.453151 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:58:08.454236 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:58:08.455335 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m12:58:08.456408 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m12:58:08.457469 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m12:58:08.457797 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m12:58:08.458181 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:58:08.458543 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:58:08.459648 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m12:58:08.460045 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:58:08.460427 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:58:08.460790 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:58:08.461137 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:58:08.461483 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m12:58:08.461984 [info ] [Thread-1 (]: 1 of 41 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.18s]
[0m12:58:08.462562 [info ] [Thread-3 (]: 3 of 41 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m12:58:08.462963 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:58:08.463277 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:58:08.463594 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m12:58:08.463900 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m12:58:08.464199 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m12:58:08.464701 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.465139 [info ] [Thread-4 (]: 4 of 41 PASS not_null_dim_customers_customer_tier .............................. [[32mPASS[0m in 0.18s]
[0m12:58:08.465619 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.465932 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m12:58:08.466427 [info ] [Thread-8 (]: 8 of 41 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.16s]
[0m12:58:08.466888 [info ] [Thread-2 (]: 2 of 41 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.18s]
[0m12:58:08.467415 [info ] [Thread-6 (]: 6 of 41 PASS not_null_dim_customers_total_spent ................................ [[32mPASS[0m in 0.18s]
[0m12:58:08.467955 [info ] [Thread-5 (]: 5 of 41 PASS not_null_dim_customers_total_orders ............................... [[32mPASS[0m in 0.18s]
[0m12:58:08.468391 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.468913 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.469281 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.469832 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.470302 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.470799 [info ] [Thread-7 (]: 7 of 41 PASS not_null_dim_products_performance_category ........................ [[32mPASS[0m in 0.18s]
[0m12:58:08.471284 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.471737 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.472081 [info ] [Thread-1 (]: 9 of 41 START test not_null_dim_products_profit_margin ......................... [RUN]
[0m12:58:08.472477 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.473170 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.472852 [info ] [Thread-3 (]: 10 of 41 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:58:08.473649 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.474122 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.474533 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.474930 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.475668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m12:58:08.476098 [info ] [Thread-4 (]: 11 of 41 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:58:08.476966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:58:08.476491 [info ] [Thread-8 (]: 12 of 41 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:58:08.477818 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.477381 [info ] [Thread-2 (]: 13 of 41 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m12:58:08.478315 [info ] [Thread-6 (]: 14 of 41 START test not_null_fct_orders_product_id ............................. [RUN]
[0m12:58:08.478713 [info ] [Thread-5 (]: 15 of 41 START test not_null_fct_orders_quantity ............................... [RUN]
[0m12:58:08.479090 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.479454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:58:08.479787 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.480125 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m12:58:08.480465 [info ] [Thread-7 (]: 16 of 41 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m12:58:08.480845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m12:58:08.481209 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m12:58:08.481598 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m12:58:08.487398 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.487784 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.491859 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.492227 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.492600 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m12:58:08.492941 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.493257 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.493597 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.497884 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.502002 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.502382 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.502713 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.507583 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.511758 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.512137 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.516061 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.520196 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.555958 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.559163 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.559551 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.559890 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.560339 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.560680 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.561293 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.561688 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.564495 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.564926 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.567624 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.570900 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.571288 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.574021 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.576699 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.579375 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.579785 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m12:58:08.580311 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.580647 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:58:08.581127 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.581493 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.581933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.582273 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.582636 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:58:08.582996 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.583325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.583663 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.583961 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:58:08.584276 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m12:58:08.584658 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m12:58:08.585034 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.585356 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m12:58:08.585692 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m12:58:08.585990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.586293 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.586588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.586915 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.587208 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.621586 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.621946 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:58:08.622348 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.622707 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.623080 [debug] [Thread-6 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.623369 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.623729 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.624044 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.624349 [debug] [Thread-7 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.624693 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from prod.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.625008 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.625313 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.625618 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.625918 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.626221 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.626551 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from prod.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.626882 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.627299 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.627666 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.627988 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.628320 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.628664 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629008 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629448 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from prod.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629810 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.630116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.631460 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:58:08.631889 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.632269 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.632711 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.633144 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.633492 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.633841 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.634970 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m12:58:08.635346 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m12:58:08.636525 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:58:08.637584 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m12:58:08.638668 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:58:08.639780 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m12:58:08.640862 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m12:58:08.641296 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m12:58:08.642347 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m12:58:08.642656 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:58:08.643027 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m12:58:08.643387 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m12:58:08.643764 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m12:58:08.644123 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m12:58:08.644471 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m12:58:08.644780 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m12:58:08.645126 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m12:58:08.645463 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:58:08.645931 [info ] [Thread-3 (]: 10 of 41 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.17s]
[0m12:58:08.646291 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m12:58:08.646596 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:58:08.646893 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m12:58:08.647186 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m12:58:08.647515 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m12:58:08.647952 [info ] [Thread-1 (]: 9 of 41 PASS not_null_dim_products_profit_margin ............................... [[32mPASS[0m in 0.17s]
[0m12:58:08.648456 [info ] [Thread-4 (]: 11 of 41 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.17s]
[0m12:58:08.648951 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.649402 [info ] [Thread-6 (]: 14 of 41 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.649893 [info ] [Thread-8 (]: 12 of 41 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.650397 [info ] [Thread-7 (]: 16 of 41 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.16s]
[0m12:58:08.650912 [info ] [Thread-2 (]: 13 of 41 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.17s]
[0m12:58:08.651472 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.651918 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.652300 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.652757 [info ] [Thread-5 (]: 15 of 41 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.653313 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.653756 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.654292 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.654758 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.655130 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.655557 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.655966 [info ] [Thread-3 (]: 17 of 41 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m12:58:08.656444 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.656794 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.657185 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.657607 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.657987 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.658338 [info ] [Thread-1 (]: 18 of 41 START test not_null_stg_customers_email ............................... [RUN]
[0m12:58:08.658706 [info ] [Thread-4 (]: 19 of 41 START test not_null_stg_customers_first_name .......................... [RUN]
[0m12:58:08.659106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m12:58:08.659507 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.659873 [info ] [Thread-6 (]: 20 of 41 START test not_null_stg_customers_last_name ........................... [RUN]
[0m12:58:08.660276 [info ] [Thread-8 (]: 21 of 41 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m12:58:08.660698 [info ] [Thread-7 (]: 22 of 41 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m12:58:08.661098 [info ] [Thread-2 (]: 23 of 41 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m12:58:08.661548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m12:58:08.661969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m12:58:08.662304 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.662641 [info ] [Thread-5 (]: 24 of 41 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m12:58:08.663047 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m12:58:08.663421 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m12:58:08.663773 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m12:58:08.664116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m12:58:08.664466 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.664778 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.670281 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.670689 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_quantity.f754434156, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m12:58:08.671033 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.671349 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.671657 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.671958 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.675930 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.680022 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.680461 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.684540 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.689545 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.689911 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.693919 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.697949 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.702062 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.702706 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.703018 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.706827 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.707241 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.707623 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.710518 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.710942 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.713625 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.713974 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.714331 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.717113 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.720364 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.720862 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.723545 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.724036 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.726735 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.729493 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.729873 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.730346 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m12:58:08.730751 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.731130 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m12:58:08.731499 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.731896 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.732350 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m12:58:08.732714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.733045 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.733379 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.733681 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m12:58:08.733983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.734282 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m12:58:08.734581 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m12:58:08.734872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.735249 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m12:58:08.735579 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m12:58:08.735888 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.736226 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.736536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.736867 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.737164 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.771538 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:58:08.771985 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.772348 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.772641 [debug] [Thread-6 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.772993 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.773329 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.773792 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.774119 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.774422 [debug] [Thread-7 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.774706 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.774998 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.775293 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.775589 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.775988 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.776325 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from prod.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.776658 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.777010 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.777322 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.777619 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.777940 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from prod.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.778282 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from prod.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.778619 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.779002 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.780362 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m12:58:08.780716 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.781042 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.781363 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.782275 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m12:58:08.782659 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783324 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783609 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.783926 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.785052 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m12:58:08.785456 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m12:58:08.785801 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.786877 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m12:58:08.787985 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m12:58:08.789063 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m12:58:08.790131 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m12:58:08.791220 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m12:58:08.791582 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m12:58:08.792083 [info ] [Thread-3 (]: 17 of 41 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m12:58:08.793270 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m12:58:08.793661 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m12:58:08.794013 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m12:58:08.794363 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m12:58:08.794712 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m12:58:08.795063 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m12:58:08.795365 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m12:58:08.795814 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.796165 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m12:58:08.796469 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m12:58:08.796763 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m12:58:08.797057 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m12:58:08.797353 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m12:58:08.797644 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m12:58:08.798047 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.798501 [info ] [Thread-4 (]: 19 of 41 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.14s]
[0m12:58:08.798954 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m12:58:08.799483 [info ] [Thread-6 (]: 20 of 41 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.800183 [info ] [Thread-1 (]: 18 of 41 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.14s]
[0m12:58:08.800754 [info ] [Thread-2 (]: 23 of 41 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.14s]
[0m12:58:08.801264 [info ] [Thread-7 (]: 22 of 41 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.14s]
[0m12:58:08.801754 [info ] [Thread-8 (]: 21 of 41 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.14s]
[0m12:58:08.802121 [info ] [Thread-3 (]: 25 of 41 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m12:58:08.802599 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.803086 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.803548 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.804087 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.804538 [info ] [Thread-5 (]: 24 of 41 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.13s]
[0m12:58:08.805010 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.805446 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.805791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m12:58:08.806157 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.806549 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.806906 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.807278 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.807749 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.808099 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.808470 [debug] [Thread-8 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.808796 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.809141 [info ] [Thread-4 (]: 26 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m12:58:08.809550 [info ] [Thread-6 (]: 27 of 41 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m12:58:08.809903 [info ] [Thread-1 (]: 28 of 41 START test not_null_stg_products_cost ................................. [RUN]
[0m12:58:08.810245 [info ] [Thread-2 (]: 29 of 41 START test not_null_stg_products_price ................................ [RUN]
[0m12:58:08.810747 [debug] [Thread-5 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.811118 [info ] [Thread-7 (]: 30 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m12:58:08.811515 [info ] [Thread-8 (]: 31 of 41 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m12:58:08.817032 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.817426 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:58:08.817775 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m12:58:08.818114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m12:58:08.818444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m12:58:08.818793 [info ] [Thread-5 (]: 32 of 41 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m12:58:08.819151 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m12:58:08.819481 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m12:58:08.819878 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.820221 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.820565 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.820889 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.821205 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.821563 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m12:58:08.821897 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.822203 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.826316 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.830541 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.834529 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.839405 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.842175 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.842530 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.846568 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.854331 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.855115 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.861242 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.861778 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.862092 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.862438 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.865288 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.865698 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.866079 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.868885 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.871743 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.872088 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.875326 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.875667 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.876046 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:58:08.878856 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.879332 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.882138 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.884998 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.885363 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.885700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.886033 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.886447 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m12:58:08.886781 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.887325 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.887638 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:58:08.888111 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.888455 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.888759 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m12:58:08.889065 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.889378 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m12:58:08.889684 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:58:08.889978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.890289 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m12:58:08.890600 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m12:58:08.890893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.891208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.891501 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.891821 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.892109 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.924986 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:58:08.925333 [debug] [Thread-6 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.925688 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.925988 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.926368 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m12:58:08.926706 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.927053 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.927362 [debug] [Thread-7 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.927737 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.928055 [debug] [Thread-5 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.928369 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.928686 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.928972 [debug] [Thread-8 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.929291 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from prod.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.929613 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.929904 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.930249 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.930641 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.930979 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from prod.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.931303 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.931577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.931985 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from prod.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.932357 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.932663 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.933005 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from prod.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from prod.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.933571 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from prod.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from prod.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.933986 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.934297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.935507 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:58:08.936835 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m12:58:08.937292 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.937695 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.938849 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:58:08.939230 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.940328 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m12:58:08.940677 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.941064 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m12:58:08.941404 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m12:58:08.942571 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m12:58:08.943674 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:58:08.944035 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m12:58:08.944457 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m12:58:08.945566 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m12:58:08.946635 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m12:58:08.946946 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:58:08.947256 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m12:58:08.947613 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m12:58:08.947962 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m12:58:08.948266 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:58:08.948558 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m12:58:08.948908 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m12:58:08.949259 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m12:58:08.949758 [info ] [Thread-3 (]: 25 of 41 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.950132 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m12:58:08.950576 [info ] [Thread-6 (]: 27 of 41 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.13s]
[0m12:58:08.950935 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:58:08.951391 [info ] [Thread-4 (]: 26 of 41 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.951770 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m12:58:08.952194 [info ] [Thread-1 (]: 28 of 41 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.952544 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m12:58:08.952994 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.953437 [info ] [Thread-2 (]: 29 of 41 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.953895 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.954355 [info ] [Thread-7 (]: 30 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.954863 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.955367 [info ] [Thread-5 (]: 32 of 41 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.13s]
[0m12:58:08.955825 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.956437 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:08.956900 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.957303 [debug] [Thread-6 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:08.957742 [info ] [Thread-8 (]: 31 of 41 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.14s]
[0m12:58:08.958256 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.958618 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:08.959097 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.959448 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:08.959815 [info ] [Thread-3 (]: 33 of 41 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m12:58:08.960205 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:08.960648 [info ] [Thread-6 (]: 34 of 41 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:58:08.961194 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.961546 [debug] [Thread-7 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:08.961899 [info ] [Thread-4 (]: 35 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m12:58:08.962323 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:08.962719 [info ] [Thread-1 (]: 36 of 41 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m12:58:08.963113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:58:08.963454 [info ] [Thread-2 (]: 37 of 41 START test unique_stg_customers_customer_id ........................... [RUN]
[0m12:58:08.963816 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:58:08.964175 [debug] [Thread-8 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:08.964522 [info ] [Thread-7 (]: 38 of 41 START test unique_stg_customers_email ................................. [RUN]
[0m12:58:08.964901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m12:58:08.965241 [info ] [Thread-5 (]: 39 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m12:58:08.965600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m12:58:08.965923 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:08.966252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m12:58:08.966567 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:08.966989 [info ] [Thread-8 (]: 40 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:58:08.967402 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m12:58:08.967740 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:08.968091 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m12:58:08.968414 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:08.975254 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:08.975608 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:08.981837 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:08.982248 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:58:08.982599 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:08.986529 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:08.986888 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:08.990772 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:08.995805 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:08.996267 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.033479 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:09.037065 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.041160 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.041560 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:09.045816 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.046232 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:09.049021 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.049351 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:09.049660 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:09.053402 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.056329 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.056847 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:09.059650 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.062509 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.062860 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:09.063226 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.063663 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.067076 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.067572 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.068013 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.070745 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.073503 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.073862 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.074221 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m12:58:09.074569 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.074942 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:58:09.075259 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:58:09.075698 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.076105 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m12:58:09.076444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:09.076810 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.077123 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m12:58:09.077428 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:09.077765 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.078065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:09.078374 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m12:58:09.078668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:09.079040 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m12:58:09.079349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:09.079693 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:58:09.080020 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:09.080343 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:09.080656 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:09.116051 [debug] [Thread-6 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.116422 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:58:09.116796 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.117108 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.117459 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.117880 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.118185 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.118518 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.118804 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.119079 [debug] [Thread-7 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.119386 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.119718 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.120018 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.120310 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.120650 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from prod.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from prod.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:09.120985 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.121279 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.121569 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.121928 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.122366 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.122731 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123214 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123593 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123996 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.124327 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:58:09.124718 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:58:09.125233 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.125685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.126243 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.126587 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.128099 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m12:58:09.129288 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:58:09.129646 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m12:58:09.129942 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m12:58:09.131045 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:58:09.132167 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m12:58:09.133234 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m12:58:09.134306 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:58:09.134702 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m12:58:09.135060 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m12:58:09.136120 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m12:58:09.137164 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m12:58:09.137514 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m12:58:09.137877 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m12:58:09.138230 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m12:58:09.138572 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m12:58:09.138881 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m12:58:09.139182 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:58:09.139520 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m12:58:09.139860 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m12:58:09.140155 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:58:09.140449 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m12:58:09.140742 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m12:58:09.141030 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:58:09.141533 [info ] [Thread-3 (]: 33 of 41 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.18s]
[0m12:58:09.141940 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m12:58:09.142362 [info ] [Thread-6 (]: 34 of 41 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.142703 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m12:58:09.143179 [info ] [Thread-4 (]: 35 of 41 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.18s]
[0m12:58:09.143669 [info ] [Thread-1 (]: 36 of 41 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.144161 [info ] [Thread-2 (]: 37 of 41 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.144623 [info ] [Thread-8 (]: 40 of 41 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.16s]
[0m12:58:09.145093 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:09.145578 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:09.146004 [info ] [Thread-7 (]: 38 of 41 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.18s]
[0m12:58:09.146668 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:09.147148 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:09.147597 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:09.148314 [info ] [Thread-5 (]: 39 of 41 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.18s]
[0m12:58:09.148858 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.149223 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.149810 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:09.150442 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:09.150839 [info ] [Thread-3 (]: 41 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m12:58:09.151353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m12:58:09.151687 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.156030 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.156596 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.160557 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.161100 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.161693 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:58:09.162007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:09.200134 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.200488 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.200819 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.201837 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.203110 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:58:09.203516 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m12:58:09.203821 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m12:58:09.204944 [info ] [Thread-3 (]: 41 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.05s]
[0m12:58:09.205476 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.206593 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:09.206905 [debug] [MainThread]: On master: BEGIN
[0m12:58:09.207164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:09.245818 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m12:58:09.246175 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.246459 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:09.246718 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.247081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:09.247409 [debug] [MainThread]: On master: Close
[0m12:58:09.248401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:09.248668 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m12:58:09.248913 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m12:58:09.249153 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:58:09.249384 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:58:09.249613 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108' was properly closed.
[0m12:58:09.249842 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:58:09.250072 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e' was properly closed.
[0m12:58:09.250297 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:58:09.250619 [info ] [MainThread]: 
[0m12:58:09.250910 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m12:58:09.255537 [debug] [MainThread]: Command end result
[0m12:58:09.328897 [info ] [MainThread]: 
[0m12:58:09.329300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:09.329624 [info ] [MainThread]: 
[0m12:58:09.329918 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 TOTAL=41
[0m12:58:09.332401 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0983748, "process_in_blocks": "0", "process_kernel_time": 0.334696, "process_mem_max_rss": "161513472", "process_out_blocks": "0", "process_user_time": 4.324152}
[0m12:58:09.332776 [debug] [MainThread]: Command `dbt test` succeeded at 12:58:09.332702 after 2.10 seconds
[0m12:58:09.333096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093958a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeeb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f5d50>]}
[0m12:58:09.333423 [debug] [MainThread]: Flushing usage events
[0m13:20:36.614816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb2d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb31f0>]}


============================== 13:20:36.619561 | b0672e7a-a637-4ba9-bbc4-adc7af9f33bc ==============================
[0m13:20:36.619561 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:20:36.620090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:36.877570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad08100>]}
[0m13:20:36.927551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac88a00>]}
[0m13:20:36.934196 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:20:37.058303 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m13:20:37.181421 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:20:37.181838 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m13:20:37.182151 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:20:37.182469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f97190>]}
[0m13:20:39.497800 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:20:39.498293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1480d0>]}
[0m13:20:39.887226 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:20:39.887726 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:20:39.888052 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:20:39.888354 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:20:39.888645 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:20:39.888927 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:20:39.889209 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:20:39.889487 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:20:39.889760 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:20:39.890039 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:20:39.890313 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:20:39.890583 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:20:39.890854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:20:39.891132 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:20:39.891402 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:20:39.891678 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:20:39.891951 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:20:39.892220 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:20:39.892488 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:20:39.892759 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:20:39.893034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:20:39.893307 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:20:39.893583 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:20:39.893854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:20:39.894124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:20:39.894396 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:20:39.894667 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:20:39.894935 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:20:40.002626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66fd60>]}
[0m13:20:40.163323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbf8e0>]}
[0m13:20:40.163802 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:20:40.168065 [info ] [MainThread]: 
[0m13:20:40.168546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:40.174298 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:20:40.174796 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:20:40.232873 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:20:40.233253 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:20:40.233577 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:20:40.233905 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:20:40.234208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.234484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.384645 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m13:20:40.385047 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m13:20:40.386975 [debug] [ThreadPool]: On list_dev: Close
[0m13:20:40.387975 [debug] [ThreadPool]: On list_dev: Close
[0m13:20:40.390031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_analytics)
[0m13:20:40.390625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "analytics"
"
[0m13:20:40.397559 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.397897 [debug] [ThreadPool]: On create_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m13:20:40.398182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.433394 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:20:40.434775 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.435081 [debug] [ThreadPool]: On create_dev_analytics: BEGIN
[0m13:20:40.435436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:40.435707 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.435973 [debug] [ThreadPool]: On create_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics"} */

    
    
        create schema if not exists dev.analytics
    
[0m13:20:40.437236 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:40.438008 [debug] [ThreadPool]: On create_dev_analytics: COMMIT
[0m13:20:40.438312 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.438584 [debug] [ThreadPool]: On create_dev_analytics: COMMIT
[0m13:20:40.439363 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:40.439643 [debug] [ThreadPool]: On create_dev_analytics: Close
[0m13:20:40.445705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m13:20:40.451413 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:20:40.451830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_analytics, now list_dev_analytics_dev)
[0m13:20:40.452136 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m13:20:40.455213 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:20:40.455519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.455801 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m13:20:40.456125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.489907 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:20:40.490264 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:20:40.490566 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:20:40.490885 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m13:20:40.491188 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:20:40.491569 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m13:20:40.504339 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:20:40.504672 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:20:40.505729 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m13:20:40.506839 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m13:20:40.507624 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m13:20:40.507981 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m13:20:40.508253 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:20:40.508532 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m13:20:40.510417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a6110>]}
[0m13:20:40.510852 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:40.511127 [debug] [MainThread]: On master: BEGIN
[0m13:20:40.511380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:40.550413 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m13:20:40.550746 [debug] [MainThread]: On master: COMMIT
[0m13:20:40.551032 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:40.551300 [debug] [MainThread]: On master: COMMIT
[0m13:20:40.551632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:40.551902 [debug] [MainThread]: On master: Close
[0m13:20:40.552877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:40.553222 [info ] [MainThread]: 
[0m13:20:40.555503 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m13:20:40.555892 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m13:20:40.556366 [info ] [Thread-1 (]: 1 of 52 START seed file analytics_dev.raw_customers ............................ [RUN]
[0m13:20:40.556785 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m13:20:40.557195 [info ] [Thread-2 (]: 2 of 52 START seed file analytics_dev.raw_order_items .......................... [RUN]
[0m13:20:40.557580 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m13:20:40.557948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m13:20:40.558385 [info ] [Thread-3 (]: 3 of 52 START seed file analytics_dev.raw_orders ............................... [RUN]
[0m13:20:40.558878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m13:20:40.559326 [info ] [Thread-4 (]: 4 of 52 START seed file analytics_dev.raw_products ............................. [RUN]
[0m13:20:40.559840 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m13:20:40.560295 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m13:20:40.560629 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m13:20:40.561034 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m13:20:40.561373 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m13:20:40.561693 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m13:20:40.562330 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m13:20:40.562674 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m13:20:40.569335 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m13:20:40.582670 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m13:20:40.632107 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.640724 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.642331 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m13:20:40.646747 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.647090 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m13:20:40.651882 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.652249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.652582 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m13:20:40.652921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:40.653279 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m13:20:40.653676 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:40.654053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:20:40.690030 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:40.690419 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:40.690776 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.691102 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:40.691399 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m13:20:40.691719 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.692043 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m13:20:40.692363 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.692669 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.692978 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m13:20:40.693385 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m13:20:40.693740 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m13:20:40.695133 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.695467 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.695783 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.696079 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.706872 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.707878 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.708830 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.709745 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.710091 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.710427 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.710760 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.711085 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.722261 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:20:40.722620 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:20:40.722945 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:20:40.723269 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m13:20:40.728368 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m13:20:40.728893 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m13:20:40.729380 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m13:20:40.729847 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m13:20:40.745475 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:20:40.747678 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:20:40.748087 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.749255 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:20:40.749600 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.750621 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:20:40.750964 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:20:40.751288 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.751605 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:20:40.751923 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.752325 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:20:40.752754 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:20:40.754250 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.756174 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m13:20:40.756581 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:40.756920 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:20:40.758009 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:20:40.758646 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m13:20:40.759205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b421f00>]}
[0m13:20:40.759843 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m13:20:40.760447 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m13:20:40.760900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61e260>]}
[0m13:20:40.761385 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file analytics_dev.raw_order_items ...................... [[32mINSERT 14[0m in 0.20s]
[0m13:20:40.761839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b422800>]}
[0m13:20:40.762798 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m13:20:40.762353 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file analytics_dev.raw_customers ........................ [[32mINSERT 10[0m in 0.20s]
[0m13:20:40.763355 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file analytics_dev.raw_orders ........................... [[32mINSERT 10[0m in 0.20s]
[0m13:20:40.763922 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m13:20:40.764396 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m13:20:40.764863 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m13:20:40.765321 [info ] [Thread-2 (]: 5 of 52 START sql view model analytics.stg_order_items ......................... [RUN]
[0m13:20:40.765975 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m13:20:40.766346 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_order_items)
[0m13:20:40.766718 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m13:20:40.767519 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m13:20:40.767202 [info ] [Thread-1 (]: 6 of 52 START sql view model analytics.stg_customers ........................... [RUN]
[0m13:20:40.777282 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m13:20:40.777738 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b422d40>]}
[0m13:20:40.778104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now model.ci_cd_project.stg_customers)
[0m13:20:40.768148 [info ] [Thread-3 (]: 7 of 52 START sql view model analytics.stg_orders .............................. [RUN]
[0m13:20:40.779075 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m13:20:40.778760 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file analytics_dev.raw_products ......................... [[32mINSERT 10[0m in 0.22s]
[0m13:20:40.779586 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_orders)
[0m13:20:40.784015 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m13:20:40.784397 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m13:20:40.784874 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m13:20:40.785195 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m13:20:40.807619 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m13:20:40.814500 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m13:20:40.815955 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m13:20:40.820426 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m13:20:40.820823 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m13:20:40.821358 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m13:20:40.825140 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m13:20:40.821785 [info ] [Thread-4 (]: 8 of 52 START sql view model analytics.stg_products ............................ [RUN]
[0m13:20:40.825743 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.826158 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.826518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m13:20:40.826875 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m13:20:40.827244 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m13:20:40.827595 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.827911 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m13:20:40.828222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:40.828579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.829002 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m13:20:40.832243 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m13:20:40.832688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:40.833188 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m13:20:40.836646 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m13:20:40.837402 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.837759 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m13:20:40.838071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:40.870584 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m13:20:40.870980 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m13:20:40.871331 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.871652 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m13:20:40.871995 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:40.872332 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.872681 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m13:20:40.873019 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.873322 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.873652 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m13:20:40.874321 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:20:40.874683 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:20:40.875023 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.882452 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.882812 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:20:40.883178 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m13:20:40.883498 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:20:40.883821 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:20:40.887107 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.890697 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.893889 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.894223 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:20:40.894555 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m13:20:40.894906 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m13:20:40.895241 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m13:20:40.896274 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:20:40.896853 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.897182 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.897491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.897795 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:20:40.898094 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.899105 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:20:40.900085 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:20:40.901124 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:20:40.901489 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.901838 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.902185 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.902527 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:20:40.902870 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:20:40.903172 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.903474 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:20:40.909566 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.909896 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:20:40.910268 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:20:40.910594 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m13:20:40.910903 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.913584 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.916252 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.918962 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.919313 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m13:20:40.919656 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m13:20:40.919968 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.920283 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m13:20:40.921525 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m13:20:40.921858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.922197 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.922693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7dd80>]}
[0m13:20:40.923793 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m13:20:40.924837 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m13:20:40.925145 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.925671 [info ] [Thread-2 (]: 5 of 52 OK created sql view model analytics.stg_order_items .................... [[32mOK[0m in 0.16s]
[0m13:20:40.926169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6410f0>]}
[0m13:20:40.927239 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m13:20:40.927609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02a0b0>]}
[0m13:20:40.928092 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m13:20:40.928610 [info ] [Thread-1 (]: 6 of 52 OK created sql view model analytics.stg_customers ...................... [[32mOK[0m in 0.15s]
[0m13:20:40.929201 [info ] [Thread-3 (]: 7 of 52 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.15s]
[0m13:20:40.929940 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m13:20:40.930310 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.930829 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m13:20:40.931198 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.931675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b43c8b0>]}
[0m13:20:40.932039 [info ] [Thread-2 (]: 9 of 52 START test not_null_stg_order_items_order_id ........................... [RUN]
[0m13:20:40.932657 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.933280 [info ] [Thread-1 (]: 10 of 52 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m13:20:40.934024 [info ] [Thread-4 (]: 8 of 52 OK created sql view model analytics.stg_products ....................... [[32mOK[0m in 0.11s]
[0m13:20:40.934419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m13:20:40.934784 [info ] [Thread-3 (]: 11 of 52 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m13:20:40.935188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m13:20:40.935671 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m13:20:40.935987 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.936349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m13:20:40.936820 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.937222 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.947054 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:40.947424 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.951428 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.951822 [info ] [Thread-4 (]: 12 of 52 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m13:20:40.956028 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.956564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m13:20:40.957005 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.957329 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.957667 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.980129 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.991356 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:40.992015 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:40.992452 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.995476 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.995900 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.998697 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:40.999128 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.999604 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.999970 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:41.000302 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m13:20:41.000644 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m13:20:41.000986 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:41.001295 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m13:20:41.001608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.001928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.002242 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m13:20:41.002587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.003004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.039833 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:41.040225 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:41.040577 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.040925 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:20:41.041296 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.041691 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.042020 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:41.042342 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:41.042665 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:41.043031 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.043435 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.043809 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.044138 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.047412 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m13:20:41.047832 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.048164 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.048519 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m13:20:41.048840 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.050013 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m13:20:41.051125 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m13:20:41.051460 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m13:20:41.051891 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m13:20:41.052957 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m13:20:41.053334 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m13:20:41.053711 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m13:20:41.054198 [info ] [Thread-1 (]: 10 of 52 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.12s]
[0m13:20:41.054683 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m13:20:41.055043 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m13:20:41.055593 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:41.056039 [info ] [Thread-2 (]: 9 of 52 PASS not_null_stg_order_items_order_id ................................. [[32mPASS[0m in 0.12s]
[0m13:20:41.056403 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m13:20:41.056819 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.057260 [info ] [Thread-4 (]: 12 of 52 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.10s]
[0m13:20:41.057808 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:41.058227 [info ] [Thread-1 (]: 13 of 52 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m13:20:41.058740 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:41.059121 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.059575 [info ] [Thread-3 (]: 11 of 52 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.12s]
[0m13:20:41.060063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m13:20:41.060474 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.061015 [info ] [Thread-2 (]: 14 of 52 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m13:20:41.061569 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:41.061894 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.062225 [info ] [Thread-4 (]: 15 of 52 START test not_null_stg_customers_email ............................... [RUN]
[0m13:20:41.062608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:20:41.062986 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.069692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m13:20:41.071106 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.071463 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.071830 [info ] [Thread-3 (]: 16 of 52 START test not_null_stg_customers_first_name .......................... [RUN]
[0m13:20:41.072211 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.076372 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.076771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m13:20:41.080838 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.081311 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.081662 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.085665 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.089688 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.090144 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.090539 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.093328 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.096122 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.096500 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.096966 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.099744 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.100158 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m13:20:41.100524 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.100958 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.101281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.101616 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:20:41.101967 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m13:20:41.102318 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.102714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.103061 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.103503 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m13:20:41.103881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.138661 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.139022 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.139339 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.139677 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.140030 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.140336 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.140678 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.141016 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.141320 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.141645 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.142145 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.142556 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.143535 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.143907 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.145172 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:20:41.145546 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.145895 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.147112 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m13:20:41.147495 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:20:41.148624 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m13:20:41.149735 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m13:20:41.150129 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m13:20:41.150446 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:20:41.150839 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m13:20:41.151229 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m13:20:41.151534 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m13:20:41.152054 [info ] [Thread-2 (]: 14 of 52 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.152408 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m13:20:41.152725 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m13:20:41.153223 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.153667 [info ] [Thread-3 (]: 16 of 52 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.08s]
[0m13:20:41.154186 [info ] [Thread-4 (]: 15 of 52 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.08s]
[0m13:20:41.154650 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.155169 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.155624 [info ] [Thread-1 (]: 13 of 52 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.10s]
[0m13:20:41.156096 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.156436 [info ] [Thread-2 (]: 17 of 52 START test not_null_stg_customers_last_name ........................... [RUN]
[0m13:20:41.156820 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.157330 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.157699 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.158084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m13:20:41.158493 [info ] [Thread-3 (]: 18 of 52 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:20:41.159122 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.159520 [info ] [Thread-4 (]: 19 of 52 START test unique_stg_customers_email ................................. [RUN]
[0m13:20:41.159893 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.160257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m13:20:41.160607 [info ] [Thread-1 (]: 20 of 52 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m13:20:41.160973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m13:20:41.166621 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.166998 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.167373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:20:41.167708 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.171956 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.172328 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.176388 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.180602 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.180969 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.181466 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.185262 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.188127 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.188496 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.188809 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.191624 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.194453 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.194865 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.195371 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.195702 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m13:20:41.196113 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:20:41.196454 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.196804 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.197200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.197512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.197832 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:20:41.198146 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m13:20:41.198555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.198875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.233401 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.233746 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.234109 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.234457 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.234784 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.235088 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.235424 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.235758 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.236061 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.236413 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.236887 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.237243 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.237680 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.238132 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.239535 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:20:41.240884 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m13:20:41.241266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.241582 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.241954 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m13:20:41.242335 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m13:20:41.243515 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:20:41.244657 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m13:20:41.244995 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:20:41.245325 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m13:20:41.245720 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m13:20:41.246096 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m13:20:41.246593 [info ] [Thread-3 (]: 18 of 52 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.247142 [info ] [Thread-2 (]: 17 of 52 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.247496 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:20:41.247829 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m13:20:41.248301 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.248753 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.249294 [info ] [Thread-1 (]: 20 of 52 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m13:20:41.249743 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.250148 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.250699 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.251164 [info ] [Thread-4 (]: 19 of 52 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.251537 [info ] [Thread-3 (]: 21 of 52 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:20:41.251898 [info ] [Thread-2 (]: 22 of 52 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m13:20:41.252327 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.252819 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.253230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:20:41.253849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m13:20:41.254232 [info ] [Thread-1 (]: 23 of 52 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:20:41.254640 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.254989 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.255345 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.255704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m13:20:41.256061 [info ] [Thread-4 (]: 24 of 52 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:20:41.261718 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.265768 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.266142 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.266508 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:20:41.271904 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.272309 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.277329 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.277703 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.322296 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.322749 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.323099 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.326037 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.326414 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.329116 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.329582 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.332342 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.332809 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m13:20:41.333342 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.333739 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.334121 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.334572 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m13:20:41.334974 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.335316 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:20:41.335655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.335997 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:20:41.336312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.336652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.370267 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.370608 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.370918 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.371257 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.371606 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.371937 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.372260 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.372615 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.372969 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.373298 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.373641 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.374137 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.375073 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.375445 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.376778 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m13:20:41.377183 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.377498 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.378614 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:20:41.379030 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m13:20:41.380180 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:20:41.381276 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m13:20:41.381663 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:20:41.381971 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m13:20:41.382365 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:20:41.382756 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m13:20:41.383055 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:20:41.383835 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:20:41.383563 [info ] [Thread-2 (]: 22 of 52 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.13s]
[0m13:20:41.384249 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m13:20:41.384735 [info ] [Thread-3 (]: 21 of 52 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m13:20:41.385194 [info ] [Thread-4 (]: 24 of 52 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.12s]
[0m13:20:41.385693 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.386179 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.386654 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.387028 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.387509 [info ] [Thread-1 (]: 23 of 52 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.13s]
[0m13:20:41.387969 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.388368 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.388718 [info ] [Thread-2 (]: 25 of 52 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:20:41.389214 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.389588 [info ] [Thread-3 (]: 26 of 52 START test not_null_stg_products_cost ................................. [RUN]
[0m13:20:41.390020 [info ] [Thread-4 (]: 27 of 52 START test not_null_stg_products_price ................................ [RUN]
[0m13:20:41.390518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:20:41.390926 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.391327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m13:20:41.391687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m13:20:41.392013 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.392363 [info ] [Thread-1 (]: 28 of 52 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:20:41.392704 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.393008 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.398425 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.398825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:20:41.402800 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.407070 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.407516 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.411665 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.412066 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.415977 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.416581 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.416909 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.417210 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.419923 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.422743 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.423147 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.425906 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.426389 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:20:41.426875 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.427220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.427573 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.427915 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m13:20:41.428360 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.428696 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m13:20:41.429015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.429354 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:20:41.429663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.430002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.464303 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.464636 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.464978 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.465318 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.465620 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.465939 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.466278 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.466616 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.466922 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.467245 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.467698 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.468066 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.468500 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.469009 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.470284 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:20:41.470608 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.471812 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m13:20:41.472196 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m13:20:41.472505 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.472915 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m13:20:41.474059 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m13:20:41.474383 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:20:41.474754 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m13:20:41.475813 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:20:41.476195 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m13:20:41.477501 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m13:20:41.476732 [info ] [Thread-4 (]: 27 of 52 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.477914 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m13:20:41.477143 [info ] [Thread-2 (]: 25 of 52 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.478339 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:20:41.478821 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.479310 [info ] [Thread-3 (]: 26 of 52 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.479776 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.480187 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.480661 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.481069 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.481550 [info ] [Thread-1 (]: 28 of 52 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m13:20:41.482027 [info ] [Thread-4 (]: 29 of 52 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m13:20:41.483082 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m13:20:41.482589 [info ] [Thread-2 (]: 30 of 52 START test unique_stg_products_product_id ............................. [RUN]
[0m13:20:41.483668 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.484048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m13:20:41.484512 [info ] [Thread-3 (]: 31 of 52 START sql table model analytics.dim_customers ......................... [RUN]
[0m13:20:41.484922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m13:20:41.485346 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.485696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now model.ci_cd_project.dim_customers)
[0m13:20:41.486019 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.492679 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.493009 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m13:20:41.497029 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.500767 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m13:20:41.502084 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.502436 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.502752 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m13:20:41.505596 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.509300 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.528595 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m13:20:41.529241 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.529639 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.530002 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:20:41.530347 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m13:20:41.530693 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.531025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.531390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.531718 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m13:20:41.532139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.567051 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.567442 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.567793 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.568145 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.568480 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.568832 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.569158 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.569647 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m13:20:41.570076 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.570461 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.572025 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:20:41.572444 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.572848 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m13:20:41.573263 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:20:41.574464 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m13:20:41.575289 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:20:41.575666 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m13:20:41.575016 [info ] [Thread-2 (]: 30 of 52 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.579206 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.579559 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m13:20:41.580115 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.580459 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m13:20:41.581108 [info ] [Thread-4 (]: 29 of 52 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.10s]
[0m13:20:41.581758 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.582207 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.586909 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:20:41.587371 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.587763 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_products
[0m13:20:41.588070 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:20:41.588380 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m13:20:41.588822 [info ] [Thread-1 (]: 32 of 52 START sql table model analytics.dim_products .......................... [RUN]
[0m13:20:41.589685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now model.ci_cd_project.dim_products)
[0m13:20:41.589340 [info ] [Thread-2 (]: 33 of 52 START sql table model analytics.fct_orders ............................ [RUN]
[0m13:20:41.590147 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_products
[0m13:20:41.590466 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.590820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now model.ci_cd_project.fct_orders)
[0m13:20:41.594575 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m13:20:41.598578 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.598933 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m13:20:41.599346 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m13:20:41.603485 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m13:20:41.604074 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_products
[0m13:20:41.604425 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.608034 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m13:20:41.609213 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m13:20:41.609811 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m13:20:41.613410 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m13:20:41.613843 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.614192 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: BEGIN
[0m13:20:41.614633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be656c0>]}
[0m13:20:41.614975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.615374 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.615861 [info ] [Thread-3 (]: 31 of 52 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.13s]
[0m13:20:41.616297 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m13:20:41.616754 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m13:20:41.617056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.617682 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.618060 [info ] [Thread-4 (]: 34 of 52 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m13:20:41.618433 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.618790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m13:20:41.619147 [info ] [Thread-3 (]: 35 of 52 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:20:41.619501 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.619866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:20:41.625473 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.660557 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.661192 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:20:41.661533 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m13:20:41.665826 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.666207 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.666569 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.667044 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m13:20:41.667466 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.667872 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m13:20:41.671095 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.671492 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.671966 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.674979 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.679182 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.679554 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:20:41.679956 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m13:20:41.680390 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.683636 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.684096 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m13:20:41.684463 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m13:20:41.684816 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.685136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.685448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.685824 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:20:41.686930 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:20:41.687266 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.687652 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.687977 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.688292 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.689332 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:20:41.689739 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.690072 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.690377 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:20:41.690698 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.691055 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m13:20:41.691399 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.691765 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:20:41.692194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.692509 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.692853 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.695647 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.696003 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.696451 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m13:20:41.697641 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m13:20:41.697989 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.700773 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.701308 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m13:20:41.701674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.702764 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:20:41.703104 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m13:20:41.703453 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m13:20:41.704513 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: Close
[0m13:20:41.704915 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m13:20:41.705512 [info ] [Thread-4 (]: 34 of 52 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.09s]
[0m13:20:41.705898 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.706315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7ac50>]}
[0m13:20:41.706631 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:20:41.707110 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.708134 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m13:20:41.708684 [info ] [Thread-1 (]: 32 of 52 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.12s]
[0m13:20:41.709199 [info ] [Thread-3 (]: 35 of 52 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.709592 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.710138 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_products
[0m13:20:41.710583 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.711078 [info ] [Thread-4 (]: 36 of 52 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m13:20:41.711606 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.712308 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.712887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m13:20:41.713259 [info ] [Thread-1 (]: 37 of 52 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m13:20:41.713622 [info ] [Thread-3 (]: 38 of 52 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m13:20:41.713987 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.714349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m13:20:41.714702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m13:20:41.720746 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.721219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a63b0>]}
[0m13:20:41.721567 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.721927 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.726552 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.722553 [info ] [Thread-2 (]: 33 of 52 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.13s]
[0m13:20:41.730800 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.731261 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.731782 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m13:20:41.734672 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.735086 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.735400 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.736372 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.740276 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.736056 [info ] [Thread-2 (]: 39 of 52 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:20:41.743146 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.743617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:20:41.743989 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.744415 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.744762 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m13:20:41.745151 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.749222 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.749630 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.749960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.750291 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m13:20:41.750677 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m13:20:41.751099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.751413 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.751713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.754665 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.755318 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.755645 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:20:41.755948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.788924 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.789286 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.789609 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m13:20:41.789921 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.790247 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.790553 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.790859 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.791164 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.791570 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.791915 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.792227 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.792545 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.792889 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.794421 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m13:20:41.794919 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m13:20:41.795252 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.795562 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.795867 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m13:20:41.796170 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.797315 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m13:20:41.798419 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:20:41.798930 [info ] [Thread-4 (]: 36 of 52 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.800177 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m13:20:41.800578 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m13:20:41.800957 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m13:20:41.801428 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.801795 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m13:20:41.802105 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m13:20:41.802415 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:20:41.802794 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.803185 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m13:20:41.803698 [info ] [Thread-1 (]: 37 of 52 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.804228 [info ] [Thread-2 (]: 39 of 52 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m13:20:41.804647 [info ] [Thread-4 (]: 40 of 52 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m13:20:41.805196 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.805643 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.806100 [info ] [Thread-3 (]: 38 of 52 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.806483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m13:20:41.806858 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.807258 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.807711 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.808056 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.808396 [info ] [Thread-1 (]: 41 of 52 START test not_null_dim_products_performance_category ................. [RUN]
[0m13:20:41.808744 [info ] [Thread-2 (]: 42 of 52 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:20:41.809172 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.815084 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.815486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m13:20:41.815846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m13:20:41.816200 [info ] [Thread-3 (]: 43 of 52 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m13:20:41.816617 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.816939 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.817306 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m13:20:41.821752 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.822123 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.826168 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.826530 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.829600 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.834941 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.835381 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.835806 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.838681 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.841458 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.841893 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.842437 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m13:20:41.842778 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.843150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.843599 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.846299 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.846673 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.847064 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m13:20:41.847451 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:20:41.847768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.848099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.848438 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.848803 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m13:20:41.849096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.886834 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m13:20:41.887299 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.887664 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.888109 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m13:20:41.888505 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.888856 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.889165 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.889620 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.889979 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.890355 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.890684 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.891021 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.891422 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.892800 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m13:20:41.893205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.893600 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.894011 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m13:20:41.894333 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.895565 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m13:20:41.896674 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:20:41.897002 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m13:20:41.897432 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m13:20:41.898487 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m13:20:41.898858 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m13:20:41.899659 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m13:20:41.899388 [info ] [Thread-4 (]: 40 of 52 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.09s]
[0m13:20:41.900117 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m13:20:41.900433 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:20:41.900903 [info ] [Thread-1 (]: 41 of 52 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.09s]
[0m13:20:41.901412 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.901734 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m13:20:41.902187 [info ] [Thread-2 (]: 42 of 52 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.902712 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.903139 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.903707 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.904102 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.904474 [info ] [Thread-4 (]: 44 of 52 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:20:41.905146 [info ] [Thread-3 (]: 43 of 52 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.905698 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.906144 [info ] [Thread-1 (]: 45 of 52 START test unique_dim_products_product_id ............................. [RUN]
[0m13:20:41.906573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:20:41.907052 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.907391 [info ] [Thread-2 (]: 46 of 52 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:20:41.907766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m13:20:41.908102 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.908462 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.908839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:20:41.909173 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.914963 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.915350 [info ] [Thread-3 (]: 47 of 52 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:20:41.915708 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.965667 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.966231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m13:20:41.970461 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.970963 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.971285 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.974215 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.978969 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.979310 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.979812 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.982590 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.985432 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.985881 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.986327 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.986734 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:20:41.987122 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.989832 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.990206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.990551 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:20:41.990912 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.991358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.991707 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:20:41.992053 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.992374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.992770 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:20:41.993104 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:42.026827 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:20:42.027210 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:42.027543 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m13:20:42.027869 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:42.028180 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m13:20:42.028462 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:42.028765 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:42.029114 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:42.029513 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:42.029874 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.030252 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.030567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.030885 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.032355 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:20:42.032868 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m13:20:42.033214 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:42.033529 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:20:42.033833 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:42.034125 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.035286 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:20:42.035835 [info ] [Thread-1 (]: 45 of 52 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.13s]
[0m13:20:42.036958 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:20:42.038051 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:20:42.038435 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m13:20:42.038899 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:42.039268 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m13:20:42.039627 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m13:20:42.039937 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:20:42.040305 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.040677 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:20:42.040999 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:20:42.041484 [info ] [Thread-3 (]: 47 of 52 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:20:42.041900 [info ] [Thread-1 (]: 48 of 52 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m13:20:42.042502 [info ] [Thread-4 (]: 44 of 52 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.14s]
[0m13:20:42.043252 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:42.043623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m13:20:42.044156 [info ] [Thread-2 (]: 46 of 52 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m13:20:42.044662 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:42.045031 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.045385 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.045849 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:42.046210 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.046579 [info ] [Thread-3 (]: 49 of 52 START test not_null_fct_orders_product_id ............................. [RUN]
[0m13:20:42.052288 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.052706 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.053088 [info ] [Thread-4 (]: 50 of 52 START test not_null_fct_orders_quantity ............................... [RUN]
[0m13:20:42.053581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m13:20:42.054211 [info ] [Thread-2 (]: 51 of 52 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m13:20:42.054627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m13:20:42.054986 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.055314 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.056094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m13:20:42.056425 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.060614 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.063440 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.063788 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.067866 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.073357 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.073894 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.076709 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.077163 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.077557 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.077893 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.080656 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.081027 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m13:20:42.081404 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.084170 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.084570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.084908 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m13:20:42.085360 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.085775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:42.086135 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.086468 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m13:20:42.086949 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m13:20:42.087289 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:42.087616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:42.125402 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:20:42.125752 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:20:42.126145 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:20:42.126493 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.126832 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:42.127144 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.127467 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.127808 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.128140 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.128469 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.128818 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.129271 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.129721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.130107 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:20:42.130508 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:20:42.131787 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m13:20:42.132112 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:20:42.133242 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m13:20:42.134395 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m13:20:42.134803 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m13:20:42.135213 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m13:20:42.136309 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m13:20:42.136704 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m13:20:42.137015 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m13:20:42.137323 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m13:20:42.137678 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m13:20:42.137984 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m13:20:42.138484 [info ] [Thread-1 (]: 48 of 52 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.09s]
[0m13:20:42.138883 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m13:20:42.139328 [info ] [Thread-3 (]: 49 of 52 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:20:42.139867 [info ] [Thread-2 (]: 51 of 52 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.08s]
[0m13:20:42.140379 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.140895 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.141398 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.141875 [info ] [Thread-4 (]: 50 of 52 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m13:20:42.142277 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.142929 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.143287 [info ] [Thread-1 (]: 52 of 52 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m13:20:42.143889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m13:20:42.144419 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.148916 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.149586 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.154137 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.154887 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.155222 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m13:20:42.155525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.193121 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:42.193489 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.193834 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:42.194762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.196065 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m13:20:42.196475 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m13:20:42.196792 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m13:20:42.197930 [info ] [Thread-1 (]: 52 of 52 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.05s]
[0m13:20:42.198482 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.199456 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:42.199746 [debug] [MainThread]: On master: BEGIN
[0m13:20:42.200002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:42.239113 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m13:20:42.239482 [debug] [MainThread]: On master: COMMIT
[0m13:20:42.239775 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:42.240042 [debug] [MainThread]: On master: COMMIT
[0m13:20:42.240377 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:42.240654 [debug] [MainThread]: On master: Close
[0m13:20:42.241637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:42.241910 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m13:20:42.242158 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m13:20:42.242400 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m13:20:42.242640 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m13:20:42.243039 [info ] [MainThread]: 
[0m13:20:42.243345 [info ] [MainThread]: Finished running 4 seeds, 4 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m13:20:42.249121 [debug] [MainThread]: Command end result
[0m13:20:42.322906 [info ] [MainThread]: 
[0m13:20:42.323323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:42.323673 [info ] [MainThread]: 
[0m13:20:42.323980 [info ] [MainThread]: Done. PASS=52 WARN=0 ERROR=0 SKIP=0 TOTAL=52
[0m13:20:42.326570 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.7717614, "process_in_blocks": "0", "process_kernel_time": 0.648976, "process_mem_max_rss": "197722112", "process_out_blocks": "0", "process_user_time": 9.237883}
[0m13:20:42.326985 [debug] [MainThread]: Command `dbt build` succeeded at 13:20:42.326906 after 5.77 seconds
[0m13:20:42.327325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a6c20>]}
[0m13:20:42.327655 [debug] [MainThread]: Flushing usage events
[0m13:39:49.858849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e69960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92ee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92f280>]}


============================== 13:39:49.863820 | c6dc236b-123a-4531-8571-ef0d66e01a11 ==============================
[0m13:39:49.863820 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:39:49.864349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:modified+ --defer --state ./', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:50.120353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6dc236b-123a-4531-8571-ef0d66e01a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a9c30>]}
[0m13:39:50.170240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6dc236b-123a-4531-8571-ef0d66e01a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ae620>]}
[0m13:39:50.174527 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:39:50.297888 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:39:50.421777 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:50.422205 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m13:39:50.422542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6dc236b-123a-4531-8571-ef0d66e01a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce3760>]}
[0m13:39:52.750386 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:39:52.750924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6dc236b-123a-4531-8571-ef0d66e01a11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc8c40>]}
[0m13:39:53.137718 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:39:53.138199 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:39:53.138533 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:39:53.138842 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:39:53.139140 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:39:53.139429 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:39:53.139720 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:39:53.140005 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:39:53.140289 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:39:53.140572 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:39:53.140853 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:39:53.141130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:39:53.141410 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:39:53.141691 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:39:53.141968 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:39:53.142245 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:39:53.142522 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:39:53.142798 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:39:53.143070 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:39:53.143347 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:39:53.143625 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:39:53.143906 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:39:53.144190 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:39:53.144469 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:39:53.144745 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:39:53.145022 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:39:53.145297 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:39:53.145572 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:39:53.252554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6dc236b-123a-4531-8571-ef0d66e01a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af0ee60>]}
[0m13:39:53.401221 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not read WritableManifest at "/Users/preben/Documents/dbt-workshop/manifest.json" as JSON: Extra data: line 1 column 4 (char 3)
[0m13:39:53.403706 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.6075509, "process_in_blocks": "0", "process_kernel_time": 0.262136, "process_mem_max_rss": "128778240", "process_out_blocks": "0", "process_user_time": 4.496716}
[0m13:39:53.404100 [debug] [MainThread]: Command `dbt build` failed at 13:39:53.404022 after 3.61 seconds
[0m13:39:53.404434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e69960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3465c0>]}
[0m13:39:53.404761 [debug] [MainThread]: Flushing usage events
[0m13:47:14.563212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c758d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a706b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a707010>]}


============================== 13:47:14.568037 | ddeb136b-64fa-49ae-8ccf-d7638b33c1e9 ==============================
[0m13:47:14.568037 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:47:14.568566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m13:47:14.827466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932af50>]}
[0m13:47:14.877295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cb8e0>]}
[0m13:47:14.881492 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:47:15.007913 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m13:47:15.132667 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:47:15.133097 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m13:47:15.133431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aef190>]}
[0m13:47:17.467983 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:17.468491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab60280>]}
[0m13:47:17.853255 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:47:17.853761 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:47:17.854094 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:47:17.854402 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:47:17.854693 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:47:17.854981 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:47:17.855267 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:47:17.855547 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:47:17.855828 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:47:17.856138 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:47:17.856413 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:47:17.856686 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:47:17.856959 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:47:17.857233 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:47:17.857507 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:47:17.857779 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:47:17.858053 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:47:17.858323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:47:17.858595 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:47:17.858867 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:47:17.859145 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:47:17.859417 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:47:17.859691 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:47:17.859966 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:47:17.860239 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:47:17.860511 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:47:17.860786 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:47:17.861060 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:47:17.967848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b198880>]}
[0m13:47:18.117852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a705f00>]}
[0m13:47:18.118342 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:47:18.118683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f48760>]}
[0m13:47:18.120860 [info ] [MainThread]: 
[0m13:47:18.121333 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:47:18.126595 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:47:18.190819 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:47:18.191197 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:47:18.191496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:18.356982 [debug] [ThreadPool]: SQL status: OK in 0.165 seconds
[0m13:47:18.358954 [debug] [ThreadPool]: On list_dev: Close
[0m13:47:18.362184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m13:47:18.368239 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:47:18.368692 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m13:47:18.369011 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m13:47:18.371922 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:47:18.372226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:18.372530 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m13:47:18.372884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:18.406694 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:47:18.407055 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:47:18.407343 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:47:18.407631 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m13:47:18.407925 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:47:18.408332 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m13:47:18.424143 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:47:18.424518 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:47:18.425801 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m13:47:18.426937 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m13:47:18.427669 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m13:47:18.428030 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m13:47:18.428295 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m13:47:18.428569 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:47:18.431197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af25120>]}
[0m13:47:18.431605 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:18.431880 [debug] [MainThread]: On master: BEGIN
[0m13:47:18.432142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:18.467252 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m13:47:18.467600 [debug] [MainThread]: On master: COMMIT
[0m13:47:18.467891 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:18.468161 [debug] [MainThread]: On master: COMMIT
[0m13:47:18.468514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:47:18.468809 [debug] [MainThread]: On master: Close
[0m13:47:18.469878 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:18.470200 [info ] [MainThread]: 
[0m13:47:18.472223 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m13:47:18.472606 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m13:47:18.473217 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m13:47:18.473621 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m13:47:18.474040 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m13:47:18.474432 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m13:47:18.474801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.stg_customers)
[0m13:47:18.475232 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m13:47:18.475696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.ci_cd_project.stg_order_items)
[0m13:47:18.476172 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m13:47:18.476552 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m13:47:18.476989 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m13:47:18.477368 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m13:47:18.477809 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m13:47:18.486742 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m13:47:18.487108 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m13:47:18.490913 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m13:47:18.491300 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m13:47:18.495606 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m13:47:18.499043 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m13:47:18.499633 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m13:47:18.499987 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m13:47:18.512081 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m13:47:18.512447 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m13:47:18.540396 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m13:47:18.541875 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m13:47:18.578879 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m13:47:18.582452 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m13:47:18.583483 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.583889 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.584268 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.584589 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m13:47:18.584948 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m13:47:18.585267 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m13:47:18.585649 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.586003 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:47:18.586338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:18.586653 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:18.586972 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m13:47:18.587426 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:47:18.624887 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:47:18.625276 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.625615 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m13:47:18.625920 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:47:18.626261 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m13:47:18.626600 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:47:18.626934 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.627248 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.627719 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.628077 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:47:18.628450 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m13:47:18.628778 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.629120 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:47:18.635863 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.636327 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:47:18.636662 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:47:18.636987 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "dev"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m13:47:18.640340 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.640666 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.644582 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.645221 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view "dev"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m13:47:18.648597 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.648960 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.649288 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "dev"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m13:47:18.649712 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m13:47:18.652988 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.653341 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.653815 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m13:47:18.656987 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.657303 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.657627 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.658013 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m13:47:18.658335 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.662043 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.665199 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.678175 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m13:47:18.681042 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:47:18.681401 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m13:47:18.681754 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m13:47:18.682847 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:47:18.683186 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.683649 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.683996 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:47:18.684317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.684631 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.684944 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:47:18.686112 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:47:18.687182 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:47:18.687500 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.687885 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.688221 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.688541 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.693643 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:47:18.694003 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:47:18.697422 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:47:18.697767 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:47:18.698108 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m13:47:18.698535 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m13:47:18.698936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.699299 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.702106 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:47:18.702473 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:47:18.705197 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:47:18.705533 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:47:18.705848 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m13:47:18.708103 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m13:47:18.708469 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m13:47:18.709551 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m13:47:18.710974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad144c0>]}
[0m13:47:18.711564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acecee0>]}
[0m13:47:18.711891 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.712411 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.23s]
[0m13:47:18.712823 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:47:18.713347 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.23s]
[0m13:47:18.714453 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m13:47:18.714946 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m13:47:18.715968 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m13:47:18.716438 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m13:47:18.716877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e3400>]}
[0m13:47:18.717949 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_products
[0m13:47:18.717645 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.24s]
[0m13:47:18.719111 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m13:47:18.718479 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m13:47:18.719670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.dim_products)
[0m13:47:18.720013 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.dim_products
[0m13:47:18.724014 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m13:47:18.725102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a49960>]}
[0m13:47:18.725840 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.25s]
[0m13:47:18.726555 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m13:47:18.727039 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.dim_products
[0m13:47:18.746650 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_customers
[0m13:47:18.749186 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m13:47:18.749566 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m13:47:18.749999 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m13:47:18.750628 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m13:47:18.751133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.dim_customers)
[0m13:47:18.751536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now model.ci_cd_project.fct_orders)
[0m13:47:18.751922 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.752295 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_customers
[0m13:47:18.752718 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.fct_orders
[0m13:47:18.753082 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: BEGIN
[0m13:47:18.756814 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m13:47:18.760947 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m13:47:18.761315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:47:18.761927 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_customers
[0m13:47:18.765639 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m13:47:18.766119 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.fct_orders
[0m13:47:18.770683 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m13:47:18.801557 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.801923 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m13:47:18.802269 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m13:47:18.802629 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:47:18.802970 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.803415 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.803807 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m13:47:18.804196 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m13:47:18.804499 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.804975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:47:18.805285 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.805713 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m13:47:18.806211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.806533 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.806896 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m13:47:18.815108 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:47:18.815520 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:47:18.815854 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:47:18.819564 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.822789 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.825915 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.826272 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table "dev"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m13:47:18.826624 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m13:47:18.826955 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m13:47:18.827516 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.831369 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.831725 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m13:47:18.832058 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:47:18.832375 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:47:18.835576 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.838815 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.839142 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:47:18.839477 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m13:47:18.839811 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m13:47:18.844108 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:47:18.844631 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.844963 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:47:18.845281 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.845700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:47:18.846879 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:47:18.847999 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:47:18.848318 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.848655 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.848989 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.851746 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:47:18.852082 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:47:18.852412 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:47:18.852749 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m13:47:18.853396 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:47:18.856950 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:47:18.857291 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:47:18.857608 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m13:47:18.857918 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:47:18.860654 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:47:18.861818 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: Close
[0m13:47:18.862164 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m13:47:18.862491 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.862945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad5d80>]}
[0m13:47:18.864035 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: Close
[0m13:47:18.864904 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:47:18.864612 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.14s]
[0m13:47:18.865419 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7147c0>]}
[0m13:47:18.866429 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: Close
[0m13:47:18.866912 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_products
[0m13:47:18.867447 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.11s]
[0m13:47:18.868081 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_customers
[0m13:47:18.879737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddeb136b-64fa-49ae-8ccf-d7638b33c1e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b757f40>]}
[0m13:47:18.880333 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.13s]
[0m13:47:18.880854 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m13:47:18.881803 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:18.882106 [debug] [MainThread]: On master: BEGIN
[0m13:47:18.882378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:18.921010 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m13:47:18.921392 [debug] [MainThread]: On master: COMMIT
[0m13:47:18.921687 [debug] [MainThread]: Using duckdb connection "master"
[0m13:47:18.921963 [debug] [MainThread]: On master: COMMIT
[0m13:47:18.922318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:47:18.922601 [debug] [MainThread]: On master: Close
[0m13:47:18.923604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:18.923931 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m13:47:18.924201 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m13:47:18.924455 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m13:47:18.924702 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m13:47:18.925070 [info ] [MainThread]: 
[0m13:47:18.925388 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m13:47:18.926636 [debug] [MainThread]: Command end result
[0m13:47:18.998510 [info ] [MainThread]: 
[0m13:47:18.998940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:18.999250 [info ] [MainThread]: 
[0m13:47:18.999567 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:47:19.002276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5026717, "process_in_blocks": "0", "process_kernel_time": 0.464924, "process_mem_max_rss": "182976512", "process_out_blocks": "0", "process_user_time": 6.071493}
[0m13:47:19.002700 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:19.002618 after 4.50 seconds
[0m13:47:19.003047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c758d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a705f00>]}
[0m13:47:19.003391 [debug] [MainThread]: Flushing usage events
[0m13:48:37.534156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087aae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ab2e0>]}


============================== 13:48:37.539088 | 3d3d9839-cb97-4b31-a963-f8ddc261fb33 ==============================
[0m13:48:37.539088 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:48:37.539608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:modified+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:48:37.793173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dfb80>]}
[0m13:48:37.842809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5d8d0>]}
[0m13:48:37.846997 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:48:37.971434 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:48:38.095082 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:48:38.095522 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m13:48:38.095863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5f760>]}
[0m13:48:40.406311 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:48:40.406811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109006170>]}
[0m13:48:40.790808 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:48:40.791294 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:48:40.791621 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:48:40.791920 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:48:40.792209 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:48:40.792493 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:48:40.792774 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:48:40.793053 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:48:40.793330 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:48:40.793608 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:48:40.793884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:48:40.794156 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:48:40.794429 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:48:40.794703 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:48:40.794974 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:48:40.795243 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:48:40.795514 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:48:40.795784 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:48:40.796052 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:48:40.796322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:48:40.796596 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:48:40.796877 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:48:40.797151 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:48:40.797425 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:48:40.797698 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:48:40.797970 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:48:40.798241 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:48:40.798509 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:48:40.905280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7ee60>]}
[0m13:48:41.061134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3d9839-cb97-4b31-a963-f8ddc261fb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a7970>]}
[0m13:48:41.061624 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:48:41.062251 [error] [MainThread]: Encountered an error:
Runtime Error
  Got a state selector method, but no comparison manifest
[0m13:48:41.065137 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.5896864, "process_in_blocks": "0", "process_kernel_time": 0.221094, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 4.47908}
[0m13:48:41.065513 [debug] [MainThread]: Command `dbt build` failed at 13:48:41.065439 after 3.59 seconds
[0m13:48:41.065837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091bfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091bcbe0>]}
[0m13:48:41.066153 [debug] [MainThread]: Flushing usage events
[0m13:49:17.698422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e5930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36eb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36ef80>]}


============================== 13:49:17.703154 | 962a6f38-779b-4d9b-81eb-599869cc100c ==============================
[0m13:49:17.703154 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:17.703689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:49:17.847103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '962a6f38-779b-4d9b-81eb-599869cc100c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc3d00>]}
[0m13:49:17.960683 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.32368165, "process_in_blocks": "0", "process_kernel_time": 0.240984, "process_mem_max_rss": "100974592", "process_out_blocks": "0", "process_user_time": 1.243019}
[0m13:49:17.961159 [debug] [MainThread]: Command `dbt clean` succeeded at 13:49:17.961069 after 0.32 seconds
[0m13:49:17.961510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e5930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e25c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b495570>]}
[0m13:49:17.961862 [debug] [MainThread]: Flushing usage events
[0m13:49:23.309849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3318a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbeef0>]}


============================== 13:49:23.314658 | 83f10f4b-9f6d-4210-a1c3-00c7eefae977 ==============================
[0m13:49:23.314658 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:23.315187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:49:23.432533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83f10f4b-9f6d-4210-a1c3-00c7eefae977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a891c60>]}
[0m13:49:23.445298 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19265084, "process_in_blocks": "0", "process_kernel_time": 0.128941, "process_mem_max_rss": "100810752", "process_out_blocks": "0", "process_user_time": 1.235329}
[0m13:49:23.445717 [debug] [MainThread]: Command `dbt clean` succeeded at 13:49:23.445640 after 0.19 seconds
[0m13:49:23.446044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3318a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce94e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce94a00>]}
[0m13:49:23.446373 [debug] [MainThread]: Flushing usage events
[0m13:49:28.200030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc2f80>]}


============================== 13:49:28.204240 | b7807195-9e55-45fc-9cd1-24d9cd62bdb2 ==============================
[0m13:49:28.204240 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:28.204776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:49:28.319774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c57d00>]}
[0m13:49:28.336229 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-48qc8om1'
[0m13:49:28.336658 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:49:28.454251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:49:28.455147 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:49:28.501827 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:49:28.508339 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m13:49:28.552166 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m13:49:28.558348 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:49:28.603539 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:49:28.605287 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:49:28.606003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14a590>]}
[0m13:49:28.611561 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:49:28.657889 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:49:28.660104 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:49:28.704418 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:49:28.707557 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:49:29.042392 [info ] [MainThread]: Installed from version 1.1.1
[0m13:49:29.042821 [info ] [MainThread]: Updated version available: 1.3.1
[0m13:49:29.043187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c578e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24bf10>]}
[0m13:49:29.043552 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m13:49:29.419436 [info ] [MainThread]: Installed from version 0.11.0
[0m13:49:29.419880 [info ] [MainThread]: Updated version available: 1.0.2
[0m13:49:29.420239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c578e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2486d0>]}
[0m13:49:29.420594 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:49:30.411762 [info ] [MainThread]: Installed from version 0.10.3
[0m13:49:30.412189 [info ] [MainThread]: Updated version available: 0.10.4
[0m13:49:30.412541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24b310>]}
[0m13:49:30.412896 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:49:30.632938 [info ] [MainThread]: Installed from version 0.12.1
[0m13:49:30.633342 [info ] [MainThread]: Updated version available: 0.13.1
[0m13:49:30.633689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24b550>]}
[0m13:49:30.634042 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:49:30.875219 [info ] [MainThread]: Installed from version 0.10.1
[0m13:49:30.875648 [info ] [MainThread]: Up to date!
[0m13:49:30.876012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7807195-9e55-45fc-9cd1-24d9cd62bdb2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b248970>]}
[0m13:49:30.876386 [info ] [MainThread]: 
[0m13:49:30.876705 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m13:49:30.880156 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7360384, "process_in_blocks": "0", "process_kernel_time": 0.296555, "process_mem_max_rss": "114769920", "process_out_blocks": "0", "process_user_time": 1.467759}
[0m13:49:30.880613 [debug] [MainThread]: Command `dbt deps` succeeded at 13:49:30.880515 after 2.74 seconds
[0m13:49:30.881099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c57d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb4a00>]}
[0m13:49:30.881454 [debug] [MainThread]: Flushing usage events
[0m13:49:36.278159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e45990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d2cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d3130>]}


============================== 13:49:36.282593 | b2632496-b506-43e3-90e9-02003084efac ==============================
[0m13:49:36.282593 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:36.283114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:36.510951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa37e50>]}
[0m13:49:36.560761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb98d0>]}
[0m13:49:36.564964 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:49:36.689276 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:49:36.690246 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:49:36.690619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0d8a0>]}
[0m13:49:39.050804 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:49:39.051321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aae6050>]}
[0m13:49:39.413606 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:49:39.414059 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:49:39.414388 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:49:39.414700 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:49:39.414997 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:49:39.415285 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:49:39.415576 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:49:39.415862 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:49:39.416148 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:49:39.416429 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:49:39.416714 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:49:39.416990 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:49:39.417274 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:49:39.417557 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:49:39.417835 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:49:39.418116 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:49:39.418395 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:49:39.418668 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:49:39.418948 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:49:39.419226 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:49:39.419506 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:49:39.419786 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:49:39.420070 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:49:39.420355 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:49:39.420633 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:49:39.420914 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:49:39.421194 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:49:39.421471 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:49:39.566449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c14cd0>]}
[0m13:49:39.719081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23ae90>]}
[0m13:49:39.719583 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:49:39.719923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109114880>]}
[0m13:49:39.722097 [info ] [MainThread]: 
[0m13:49:39.722584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:49:39.727635 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:49:39.779291 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:49:39.779678 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:49:39.779986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:39.927289 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m13:49:39.929238 [debug] [ThreadPool]: On list_dev: Close
[0m13:49:39.932498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m13:49:39.938366 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:49:39.938817 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m13:49:39.939129 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m13:49:39.941613 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:49:39.941917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:39.942211 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m13:49:39.942567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:39.979752 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m13:49:39.980110 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:49:39.980410 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m13:49:39.980732 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m13:49:39.981047 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:49:39.981447 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m13:49:39.994439 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:49:39.994773 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:49:39.996028 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m13:49:39.997077 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m13:49:39.997850 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m13:49:39.998208 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m13:49:39.998485 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:49:39.998762 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m13:49:40.001377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107731a80>]}
[0m13:49:40.001795 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:40.002067 [debug] [MainThread]: On master: BEGIN
[0m13:49:40.002325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:40.040148 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m13:49:40.040503 [debug] [MainThread]: On master: COMMIT
[0m13:49:40.040789 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:40.041066 [debug] [MainThread]: On master: COMMIT
[0m13:49:40.041406 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:40.041685 [debug] [MainThread]: On master: Close
[0m13:49:40.042685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:40.042997 [info ] [MainThread]: 
[0m13:49:40.044965 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m13:49:40.046655 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m13:49:40.047559 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m13:49:40.047931 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m13:49:40.047216 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_dev.raw_customers ............................. [RUN]
[0m13:49:40.048481 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_dev.raw_order_items ........................... [RUN]
[0m13:49:40.049178 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_dev.raw_orders ................................ [RUN]
[0m13:49:40.049712 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_dev.raw_products .............................. [RUN]
[0m13:49:40.050184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m13:49:40.050585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m13:49:40.051033 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m13:49:40.051445 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m13:49:40.051779 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m13:49:40.052094 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m13:49:40.052446 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m13:49:40.052764 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m13:49:40.053096 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m13:49:40.053415 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m13:49:40.053726 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m13:49:40.054032 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m13:49:40.104920 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:40.105360 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m13:49:40.105814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:40.109508 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:40.114817 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:40.118535 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:40.118957 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m13:49:40.119296 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m13:49:40.119617 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m13:49:40.119928 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:40.120230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:40.120525 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:40.151932 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m13:49:40.152382 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m13:49:40.152777 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:40.153134 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m13:49:40.153476 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m13:49:40.153813 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:40.154148 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m13:49:40.154477 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:40.154820 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:40.155222 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m13:49:40.155714 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m13:49:40.156053 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m13:49:40.157730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:40.158098 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:49:40.164716 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:49:40.165051 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:49:40.169817 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:40.170818 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:40.171770 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:40.172702 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:40.173047 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:40.173378 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:40.173702 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:40.174032 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:40.185884 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:49:40.186281 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m13:49:40.186627 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m13:49:40.186949 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:49:40.192066 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m13:49:40.192598 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m13:49:40.193117 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m13:49:40.193609 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m13:49:40.211599 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:49:40.213262 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:49:40.216976 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:49:40.217338 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:40.218427 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:49:40.218765 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:40.219103 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:40.219428 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:49:40.219751 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:40.220065 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:49:40.220369 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:49:40.220756 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:49:40.223776 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:40.225621 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m13:49:40.226041 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:49:40.226423 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:49:40.227097 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m13:49:40.228443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b163790>]}
[0m13:49:40.228820 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m13:49:40.229420 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m13:49:40.229854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107731a80>]}
[0m13:49:40.230943 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m13:49:40.230358 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_dev.raw_customers ......................... [[32mINSERT 10[0m in 0.18s]
[0m13:49:40.231490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af81a50>]}
[0m13:49:40.231933 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_dev.raw_order_items ....................... [[32mINSERT 14[0m in 0.18s]
[0m13:49:40.232494 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m13:49:40.233333 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m13:49:40.232937 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_dev.raw_products .......................... [[32mINSERT 10[0m in 0.18s]
[0m13:49:40.234065 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m13:49:40.244657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2632496-b506-43e3-90e9-02003084efac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12da50>]}
[0m13:49:40.245156 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_dev.raw_orders ............................ [[32mINSERT 10[0m in 0.19s]
[0m13:49:40.245677 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m13:49:40.246655 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:40.246990 [debug] [MainThread]: On master: BEGIN
[0m13:49:40.247275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:40.289656 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m13:49:40.290056 [debug] [MainThread]: On master: COMMIT
[0m13:49:40.290368 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:40.290648 [debug] [MainThread]: On master: COMMIT
[0m13:49:40.290997 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:40.291281 [debug] [MainThread]: On master: Close
[0m13:49:40.292303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:40.292627 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m13:49:40.292897 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m13:49:40.293153 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m13:49:40.293404 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m13:49:40.293720 [info ] [MainThread]: 
[0m13:49:40.294031 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m13:49:40.294960 [debug] [MainThread]: Command end result
[0m13:49:40.404226 [info ] [MainThread]: 
[0m13:49:40.404701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:40.405012 [info ] [MainThread]: 
[0m13:49:40.405320 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:49:40.407801 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.189411, "process_in_blocks": "0", "process_kernel_time": 0.379847, "process_mem_max_rss": "184942592", "process_out_blocks": "0", "process_user_time": 5.696749}
[0m13:49:40.408216 [debug] [MainThread]: Command `dbt seed` succeeded at 13:49:40.408136 after 4.19 seconds
[0m13:49:40.408554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e45990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b44d300>]}
[0m13:49:40.408890 [debug] [MainThread]: Flushing usage events
[0m13:49:52.582288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efd930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108992da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108993220>]}


============================== 13:49:52.587145 | b66a05cb-e0a0-42f0-891f-0c6bb6e72a82 ==============================
[0m13:49:52.587145 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:52.587664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:49:52.818448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106471c00>]}
[0m13:49:52.868635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d37be0>]}
[0m13:49:52.873312 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:49:53.024591 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:49:53.231533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:53.231942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:53.285392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092282b0>]}
[0m13:49:53.472235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092402e0>]}
[0m13:49:53.472735 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:49:53.477012 [info ] [MainThread]: 
[0m13:49:53.477512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:49:53.483325 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:49:53.492527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:49:53.532021 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:49:53.532398 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:49:53.532721 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:49:53.533040 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:49:53.533356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:53.533635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:53.681226 [debug] [ThreadPool]: SQL status: OK in 0.148 seconds
[0m13:49:53.681672 [debug] [ThreadPool]: SQL status: OK in 0.148 seconds
[0m13:49:53.683624 [debug] [ThreadPool]: On list_dev: Close
[0m13:49:53.684620 [debug] [ThreadPool]: On list_dev: Close
[0m13:49:53.687754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m13:49:53.693666 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:49:53.694083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m13:49:53.694411 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m13:49:53.697263 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:49:53.697575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:53.697869 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m13:49:53.698206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:53.733530 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:49:53.733913 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:49:53.734213 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:49:53.734532 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m13:49:53.734842 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:49:53.735256 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m13:49:53.748275 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:49:53.748640 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:49:53.749821 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m13:49:53.750876 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m13:49:53.751651 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m13:49:53.751994 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m13:49:53.752294 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:49:53.752583 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m13:49:53.755182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071904c0>]}
[0m13:49:53.755665 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:53.755965 [debug] [MainThread]: On master: BEGIN
[0m13:49:53.756242 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:53.792500 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m13:49:53.792855 [debug] [MainThread]: On master: COMMIT
[0m13:49:53.793150 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:53.793428 [debug] [MainThread]: On master: COMMIT
[0m13:49:53.793788 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:53.794083 [debug] [MainThread]: On master: Close
[0m13:49:53.795054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:53.795383 [info ] [MainThread]: 
[0m13:49:53.797329 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m13:49:53.797708 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m13:49:53.798449 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m13:49:53.798778 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m13:49:53.798172 [info ] [Thread-1 (]: 1 of 52 START seed file analytics_dev.raw_customers ............................ [RUN]
[0m13:49:53.799261 [info ] [Thread-2 (]: 2 of 52 START seed file analytics_dev.raw_order_items .......................... [RUN]
[0m13:49:53.799717 [info ] [Thread-3 (]: 3 of 52 START seed file analytics_dev.raw_orders ............................... [RUN]
[0m13:49:53.800193 [info ] [Thread-4 (]: 4 of 52 START seed file analytics_dev.raw_products ............................. [RUN]
[0m13:49:53.800726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m13:49:53.801139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m13:49:53.801568 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m13:49:53.801969 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m13:49:53.802360 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m13:49:53.802676 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m13:49:53.803108 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m13:49:53.803430 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m13:49:53.803763 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m13:49:53.804075 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m13:49:53.804381 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m13:49:53.804683 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m13:49:53.855789 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:53.861236 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:53.861582 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m13:49:53.865258 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:53.868767 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:53.869185 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m13:49:53.869525 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:53.869857 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m13:49:53.870170 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m13:49:53.870473 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:53.870875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:53.871205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:53.908217 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:49:53.908619 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:53.908958 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:49:53.909266 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:49:53.909606 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m13:49:53.909960 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:49:53.910297 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:53.910622 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:53.911030 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:53.911365 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m13:49:53.911695 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m13:49:53.912045 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m13:49:53.912386 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:53.918650 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:49:53.923894 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:53.924271 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:49:53.925254 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:53.925571 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m13:49:53.925897 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:53.926816 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:53.927149 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:53.928054 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:53.928493 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:53.928975 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:49:53.941991 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:49:53.947133 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m13:49:53.947522 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m13:49:53.947862 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m13:49:53.948185 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m13:49:53.948769 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m13:49:53.949281 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m13:49:53.949750 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m13:49:53.963747 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:49:53.964224 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:49:53.964563 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:49:53.965773 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:49:53.966176 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:49:53.967320 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:49:53.968386 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:49:53.968722 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:49:53.969076 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:49:53.969390 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:49:53.969721 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:49:53.971588 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m13:49:53.971961 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:49:53.972277 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:49:53.972616 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:49:53.974079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966f640>]}
[0m13:49:53.974737 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m13:49:53.975388 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file analytics_dev.raw_customers ........................ [[32mINSERT 10[0m in 0.17s]
[0m13:49:53.975967 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966fa30>]}
[0m13:49:53.976477 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m13:49:53.976845 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:53.977281 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file analytics_dev.raw_orders ........................... [[32mINSERT 10[0m in 0.17s]
[0m13:49:53.977636 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:49:53.978466 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m13:49:53.978815 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m13:49:53.979280 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m13:49:53.979877 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m13:49:53.980302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966f520>]}
[0m13:49:53.980749 [info ] [Thread-1 (]: 5 of 52 START sql view model analytics.stg_customers ........................... [RUN]
[0m13:49:53.981328 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m13:49:53.982180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now model.ci_cd_project.stg_customers)
[0m13:49:53.981859 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file analytics_dev.raw_products ......................... [[32mINSERT 10[0m in 0.18s]
[0m13:49:53.983017 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m13:49:53.982709 [info ] [Thread-3 (]: 6 of 52 START sql view model analytics.stg_orders .............................. [RUN]
[0m13:49:53.983579 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m13:49:53.994035 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m13:49:53.994525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_orders)
[0m13:49:53.995186 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m13:49:53.995592 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m13:49:53.996075 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966fb20>]}
[0m13:49:53.996517 [info ] [Thread-4 (]: 7 of 52 START sql view model analytics.stg_products ............................ [RUN]
[0m13:49:54.000020 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m13:49:54.000549 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file analytics_dev.raw_order_items ...................... [[32mINSERT 14[0m in 0.19s]
[0m13:49:54.000962 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m13:49:54.001531 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m13:49:54.001933 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m13:49:54.002456 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m13:49:54.002801 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m13:49:54.006502 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m13:49:54.013240 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m13:49:54.042311 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m13:49:54.044252 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m13:49:54.044758 [info ] [Thread-2 (]: 8 of 52 START sql view model analytics.stg_order_items ......................... [RUN]
[0m13:49:54.045387 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m13:49:54.045767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_order_items)
[0m13:49:54.049433 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m13:49:54.049826 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m13:49:54.053445 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m13:49:54.053889 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.054328 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.054752 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.055103 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m13:49:54.055460 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m13:49:54.055817 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m13:49:54.056161 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m13:49:54.056492 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.056820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.061068 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m13:49:54.061423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.062147 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.062477 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m13:49:54.062779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.100079 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m13:49:54.100453 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.100799 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:49:54.101175 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:49:54.101521 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m13:49:54.101848 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m13:49:54.102175 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.102644 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.102994 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.103332 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.103652 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m13:49:54.104013 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m13:49:54.104369 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:49:54.110800 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.111371 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.111734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.112108 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m13:49:54.115483 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.115810 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.119135 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.120242 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "dev"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m13:49:54.124080 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.124404 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:49:54.124738 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "dev"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m13:49:54.125115 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view "dev"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m13:49:54.162929 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.163369 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:49:54.163903 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m13:49:54.164244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.167518 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.167870 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.171191 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.171577 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m13:49:54.171900 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.175090 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.175449 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m13:49:54.178473 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:49:54.178852 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m13:49:54.179170 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.179576 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.179988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.181849 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:49:54.182183 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.182512 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:49:54.183573 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:49:54.183923 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.184961 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:49:54.185372 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.185700 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:49:54.186021 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.186314 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.186625 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:49:54.186991 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:49:54.187317 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.192443 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:49:54.195421 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:49:54.195778 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.196091 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.196423 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m13:49:54.196761 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m13:49:54.199522 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:49:54.202850 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:49:54.203334 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m13:49:54.203688 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.204018 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m13:49:54.204334 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.205463 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m13:49:54.206614 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m13:49:54.206927 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.207392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992e6e0>]}
[0m13:49:54.207740 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.208133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997d660>]}
[0m13:49:54.209162 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m13:49:54.210693 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m13:49:54.209731 [info ] [Thread-3 (]: 6 of 52 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.21s]
[0m13:49:54.211282 [info ] [Thread-2 (]: 8 of 52 OK created sql view model analytics.stg_order_items .................... [[32mOK[0m in 0.16s]
[0m13:49:54.211734 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7c10>]}
[0m13:49:54.212255 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m13:49:54.212721 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m13:49:54.213222 [info ] [Thread-4 (]: 7 of 52 OK created sql view model analytics.stg_products ....................... [[32mOK[0m in 0.21s]
[0m13:49:54.213962 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:49:54.214414 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m13:49:54.214844 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:54.215217 [info ] [Thread-3 (]: 9 of 52 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:49:54.215666 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:49:54.216114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966f340>]}
[0m13:49:54.217181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:49:54.216650 [info ] [Thread-2 (]: 10 of 52 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:49:54.217634 [info ] [Thread-4 (]: 11 of 52 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m13:49:54.218572 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:49:54.218231 [info ] [Thread-1 (]: 5 of 52 OK created sql view model analytics.stg_customers ...................... [[32mOK[0m in 0.23s]
[0m13:49:54.219050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:49:54.219425 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m13:49:54.230888 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:49:54.231407 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m13:49:54.231756 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:54.232083 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:49:54.232555 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:49:54.237001 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:54.241200 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:49:54.241632 [info ] [Thread-1 (]: 12 of 52 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:49:54.242133 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:49:54.242572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:49:54.260866 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:49:54.261237 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:49:54.261583 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:54.261950 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:49:54.268109 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:54.270989 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:54.273717 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:49:54.274309 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:49:54.274812 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:49:54.275228 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:54.275573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.275947 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:49:54.276296 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:49:54.276680 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:49:54.277073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.280578 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:54.280944 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m13:49:54.281381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.281816 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:54.282152 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:49:54.282458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.313076 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m13:49:54.313414 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:49:54.313733 [debug] [Thread-4 (]: SQL status: OK in 0.032 seconds
[0m13:49:54.314131 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:49:54.314507 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.314868 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:49:54.315168 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m13:49:54.315474 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:49:54.315913 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.316263 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:49:54.316601 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.317066 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:54.318046 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.318388 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.318722 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.321687 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m13:49:54.322155 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:49:54.323281 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:49:54.324350 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:49:54.324752 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m13:49:54.325916 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:49:54.326324 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m13:49:54.326704 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:49:54.327026 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m13:49:54.327406 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m13:49:54.327715 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:49:54.328028 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:49:54.328817 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:49:54.328550 [info ] [Thread-4 (]: 11 of 52 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.11s]
[0m13:49:54.329415 [info ] [Thread-3 (]: 9 of 52 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.11s]
[0m13:49:54.329929 [info ] [Thread-2 (]: 10 of 52 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.11s]
[0m13:49:54.330459 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:49:54.330941 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:49:54.331393 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:49:54.331777 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:49:54.332210 [info ] [Thread-1 (]: 12 of 52 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.09s]
[0m13:49:54.332654 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:49:54.333059 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:49:54.333442 [info ] [Thread-4 (]: 13 of 52 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m13:49:54.333958 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:49:54.334344 [info ] [Thread-3 (]: 14 of 52 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m13:49:54.334735 [info ] [Thread-2 (]: 15 of 52 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m13:49:54.335305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m13:49:54.336034 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:49:54.336569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m13:49:54.337077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m13:49:54.337464 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:49:54.337828 [info ] [Thread-1 (]: 16 of 52 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m13:49:54.338197 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:49:54.338525 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:49:54.342992 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:49:54.343408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m13:49:54.347487 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:49:54.351447 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:49:54.351914 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:49:54.357426 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:49:54.358048 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:49:54.360870 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:49:54.361235 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:49:54.361563 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:49:54.364392 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:49:54.367166 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:49:54.367515 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:49:54.371061 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:49:54.371593 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:49:54.371987 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:49:54.372357 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m13:49:54.372714 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:49:54.373050 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m13:49:54.373394 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:49:54.373713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.374047 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m13:49:54.374352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.374668 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m13:49:54.375051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.375384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.412132 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m13:49:54.412530 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:49:54.412900 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.413225 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.413574 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.413917 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:49:54.414218 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.414645 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:49:54.414982 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.415312 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:49:54.415603 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.415925 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.416367 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.416761 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.418061 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m13:49:54.418533 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.418895 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.420003 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m13:49:54.420390 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m13:49:54.421531 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m13:49:54.422551 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m13:49:54.422942 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m13:49:54.423268 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m13:49:54.423639 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m13:49:54.424001 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m13:49:54.424309 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m13:49:54.424838 [info ] [Thread-3 (]: 14 of 52 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.09s]
[0m13:49:54.425195 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m13:49:54.425511 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m13:49:54.426016 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:49:54.426463 [info ] [Thread-4 (]: 13 of 52 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.09s]
[0m13:49:54.426960 [info ] [Thread-2 (]: 15 of 52 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.09s]
[0m13:49:54.427402 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:49:54.427974 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:49:54.428451 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:49:54.428915 [info ] [Thread-1 (]: 16 of 52 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.09s]
[0m13:49:54.429302 [info ] [Thread-3 (]: 17 of 52 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:49:54.429701 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:49:54.430060 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:49:54.430559 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:49:54.430946 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m13:49:54.431425 [info ] [Thread-4 (]: 18 of 52 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m13:49:54.431825 [info ] [Thread-2 (]: 19 of 52 START test not_null_stg_products_cost ................................. [RUN]
[0m13:49:54.432351 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:49:54.432745 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:49:54.433120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m13:49:54.433474 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m13:49:54.433819 [info ] [Thread-1 (]: 20 of 52 START test not_null_stg_products_price ................................ [RUN]
[0m13:49:54.442392 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:49:54.442810 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:49:54.443184 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:49:54.443572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m13:49:54.447811 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:49:54.451832 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:49:54.452263 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:49:54.452771 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:49:54.457788 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:49:54.460621 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:49:54.461176 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:49:54.463957 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:49:54.464487 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:49:54.467256 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:49:54.467605 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:49:54.467975 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:49:54.471383 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:49:54.471808 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:49:54.472151 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m13:49:54.472570 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m13:49:54.472977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.473342 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:49:54.473684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.474045 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:49:54.474433 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m13:49:54.474794 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m13:49:54.475105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.475408 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.512373 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.512732 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:49:54.513059 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:49:54.513367 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m13:49:54.513657 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:49:54.513967 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:49:54.514322 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.514668 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:49:54.514973 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:49:54.515294 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.515806 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:54.516216 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.517356 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.517737 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.519045 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m13:49:54.519382 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.520608 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m13:49:54.520961 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:49:54.521310 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m13:49:54.522414 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m13:49:54.522805 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m13:49:54.523173 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m13:49:54.524303 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m13:49:54.524722 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m13:49:54.525027 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m13:49:54.525547 [info ] [Thread-2 (]: 19 of 52 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.09s]
[0m13:49:54.526011 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m13:49:54.526317 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m13:49:54.527218 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:49:54.526813 [info ] [Thread-4 (]: 18 of 52 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.09s]
[0m13:49:54.527640 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m13:49:54.528419 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:49:54.528109 [info ] [Thread-1 (]: 20 of 52 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.08s]
[0m13:49:54.529016 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:49:54.529399 [info ] [Thread-2 (]: 21 of 52 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:49:54.529890 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:49:54.530343 [info ] [Thread-3 (]: 17 of 52 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.10s]
[0m13:49:54.530788 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:49:54.531219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:49:54.531599 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:49:54.532116 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:49:54.532470 [info ] [Thread-4 (]: 22 of 52 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m13:49:54.532816 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:49:54.533143 [info ] [Thread-1 (]: 23 of 52 START test unique_stg_products_product_id ............................. [RUN]
[0m13:49:54.533522 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:49:54.533911 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m13:49:54.538614 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:49:54.539027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m13:49:54.539404 [info ] [Thread-3 (]: 24 of 52 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m13:49:54.539769 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:49:54.540157 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:49:54.540538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:49:54.545965 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:49:54.550018 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:49:54.550397 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:49:54.550810 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:49:54.556025 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:49:54.558789 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:49:54.559168 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:49:54.559548 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:49:54.562401 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:49:54.565153 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:49:54.565653 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:49:54.566098 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:49:54.566432 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:49:54.566781 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.570120 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:49:54.570633 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:49:54.571028 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:49:54.571446 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m13:49:54.571788 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:49:54.572126 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.572446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.572917 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:49:54.573255 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:49:54.573558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.606760 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m13:49:54.607123 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:49:54.607427 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:49:54.607753 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m13:49:54.608114 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:49:54.608430 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:49:54.608773 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.609103 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:49:54.609404 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:49:54.609751 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.610221 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.610603 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:54.611041 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.612527 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:49:54.612959 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m13:49:54.613310 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.613627 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.613923 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.614221 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:49:54.615485 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m13:49:54.616637 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:49:54.617683 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:49:54.618227 [info ] [Thread-2 (]: 21 of 52 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m13:49:54.618690 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m13:49:54.619078 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m13:49:54.619450 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:49:54.619923 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:49:54.620254 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m13:49:54.620563 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:49:54.620866 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:49:54.621234 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:49:54.621787 [info ] [Thread-4 (]: 22 of 52 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.09s]
[0m13:49:54.622313 [info ] [Thread-1 (]: 23 of 52 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.08s]
[0m13:49:54.622708 [info ] [Thread-2 (]: 25 of 52 START test not_null_stg_customers_email ............................... [RUN]
[0m13:49:54.623366 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:49:54.623831 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:49:54.624417 [info ] [Thread-3 (]: 24 of 52 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.08s]
[0m13:49:54.624842 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m13:49:54.625236 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:49:54.625603 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:49:54.626141 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:49:54.626538 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:49:54.626886 [info ] [Thread-4 (]: 26 of 52 START test not_null_stg_customers_first_name .......................... [RUN]
[0m13:49:54.627240 [info ] [Thread-1 (]: 27 of 52 START test not_null_stg_customers_last_name ........................... [RUN]
[0m13:49:54.627627 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:49:54.632126 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:49:54.632536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m13:49:54.632913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m13:49:54.633281 [info ] [Thread-3 (]: 28 of 52 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:49:54.633713 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:49:54.634068 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:49:54.634434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:49:54.639147 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:49:54.643334 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:49:54.643718 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:49:54.644074 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:49:54.647935 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:49:54.696290 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:49:54.696979 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:49:54.699838 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:49:54.700261 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:49:54.703077 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:49:54.703444 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:49:54.703861 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:49:54.707256 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:49:54.707690 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:49:54.708030 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m13:49:54.708486 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m13:49:54.708882 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:49:54.709256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.709628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.709971 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m13:49:54.710337 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:49:54.710750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.711079 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:49:54.711425 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.748764 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.749154 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:49:54.749503 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.749845 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.750209 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:49:54.750608 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:49:54.750935 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:49:54.751285 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:49:54.751605 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.751929 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:49:54.752284 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.752644 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.753076 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.754323 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m13:49:54.755055 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m13:49:54.755414 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m13:49:54.755751 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.756090 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.756446 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.756950 [info ] [Thread-2 (]: 25 of 52 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.13s]
[0m13:49:54.758216 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m13:49:54.759300 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m13:49:54.759851 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:49:54.760253 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m13:49:54.760631 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m13:49:54.761737 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:49:54.762117 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:49:54.762485 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m13:49:54.762805 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m13:49:54.763175 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:49:54.763516 [info ] [Thread-2 (]: 29 of 52 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:49:54.764175 [info ] [Thread-4 (]: 26 of 52 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.13s]
[0m13:49:54.764790 [info ] [Thread-1 (]: 27 of 52 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.13s]
[0m13:49:54.765191 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:49:54.765575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m13:49:54.766047 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:49:54.766494 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:49:54.766872 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:49:54.767243 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:49:54.767733 [info ] [Thread-3 (]: 28 of 52 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.13s]
[0m13:49:54.768249 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_products
[0m13:49:54.772832 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:49:54.773229 [info ] [Thread-4 (]: 30 of 52 START test unique_stg_customers_email ................................. [RUN]
[0m13:49:54.773759 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:49:54.774198 [info ] [Thread-1 (]: 31 of 52 START sql table model analytics.dim_products .......................... [RUN]
[0m13:49:54.774667 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m13:49:54.775147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now model.ci_cd_project.dim_products)
[0m13:49:54.775500 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:49:54.775831 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_products
[0m13:49:54.779920 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:49:54.783646 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m13:49:54.784000 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:49:54.788514 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:49:54.789040 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:49:54.791742 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:49:54.792208 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:49:54.792594 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_products
[0m13:49:54.792982 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:49:54.793337 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:49:54.805174 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.813097 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m13:49:54.813466 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m13:49:54.813973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.814546 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.814903 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: BEGIN
[0m13:49:54.815216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.850182 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m13:49:54.850573 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:49:54.850908 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:49:54.851283 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:54.851623 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:49:54.851946 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:49:54.852310 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.852729 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:54.853138 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m13:49:54.853627 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.855319 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:49:54.855760 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m13:49:54.856140 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.856470 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:49:54.857709 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m13:49:54.858509 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:49:54.858225 [info ] [Thread-2 (]: 29 of 52 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m13:49:54.858992 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m13:49:54.862278 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.862775 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:49:54.863095 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m13:49:54.863420 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table "dev"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m13:49:54.864067 [info ] [Thread-4 (]: 30 of 52 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.09s]
[0m13:49:54.864616 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:49:54.865032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.869581 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.869927 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m13:49:54.870450 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m13:49:54.870813 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m13:49:54.871257 [info ] [Thread-3 (]: 32 of 52 START sql table model analytics.dim_customers ......................... [RUN]
[0m13:49:54.871621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.872058 [info ] [Thread-2 (]: 33 of 52 START sql table model analytics.fct_orders ............................ [RUN]
[0m13:49:54.872474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.ci_cd_project.dim_customers)
[0m13:49:54.876785 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:49:54.877179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now model.ci_cd_project.fct_orders)
[0m13:49:54.877573 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m13:49:54.878032 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.878350 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m13:49:54.881926 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m13:49:54.882282 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:49:54.886413 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m13:49:54.887237 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m13:49:54.890940 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m13:49:54.891301 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.891619 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m13:49:54.895357 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:49:54.898881 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m13:49:54.899270 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m13:49:54.899818 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.900167 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m13:49:54.900495 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.900825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:54.901949 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: Close
[0m13:49:54.902336 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.902860 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m13:49:54.903300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b08e50>]}
[0m13:49:54.903637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:54.903969 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.904496 [info ] [Thread-1 (]: 31 of 52 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.13s]
[0m13:49:54.904955 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.905283 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:49:54.905723 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_products
[0m13:49:54.906099 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m13:49:54.906464 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.907080 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:49:54.907605 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m13:49:54.907986 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:49:54.908343 [info ] [Thread-4 (]: 34 of 52 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m13:49:54.908936 [info ] [Thread-1 (]: 35 of 52 START test not_null_dim_products_performance_category ................. [RUN]
[0m13:49:54.909480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m13:49:54.909873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m13:49:54.910216 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.910553 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:49:54.910895 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:49:54.914305 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.920955 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:49:54.924490 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:49:54.929540 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:49:54.929932 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m13:49:54.933206 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.933831 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m13:49:54.934522 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:49:54.934894 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.935211 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.938223 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:49:54.938602 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:49:54.942009 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.946025 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.948869 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:49:54.949240 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m13:49:54.949601 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m13:49:54.950132 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:49:54.950674 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:49:54.951040 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m13:49:54.951420 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m13:49:54.951725 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.952039 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.952360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:54.952691 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:54.953883 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:49:54.955005 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:49:54.955512 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.955825 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.956147 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:49:54.956451 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.956754 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:49:54.957060 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:49:54.957376 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:49:54.957677 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:49:54.958000 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m13:49:54.958432 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m13:49:54.958789 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:49:54.961955 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:49:54.962377 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m13:49:54.962714 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.963042 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.963368 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.966162 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:49:54.967466 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m13:49:54.967811 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:49:54.968851 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m13:49:54.969212 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m13:49:54.969648 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m13:49:54.970692 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m13:49:54.971094 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m13:49:54.971486 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m13:49:54.971968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097eba60>]}
[0m13:49:54.972288 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m13:49:54.972592 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:54.973086 [info ] [Thread-4 (]: 34 of 52 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.06s]
[0m13:49:54.973684 [info ] [Thread-3 (]: 32 of 52 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.10s]
[0m13:49:54.974833 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m13:49:54.975757 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:49:54.975322 [info ] [Thread-1 (]: 35 of 52 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.07s]
[0m13:49:54.976325 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m13:49:54.976764 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:49:54.977270 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:49:54.977628 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:49:54.978029 [info ] [Thread-4 (]: 36 of 52 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:49:54.978683 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:49:54.979071 [info ] [Thread-3 (]: 37 of 52 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m13:49:54.979506 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m13:49:54.979870 [info ] [Thread-1 (]: 38 of 52 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:49:54.980250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m13:49:54.980589 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:49:54.980959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:49:54.981286 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:49:54.987286 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:49:54.987770 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b66a05cb-e0a0-42f0-891f-0c6bb6e72a82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c4f70>]}
[0m13:49:54.988098 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:49:54.992130 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:49:54.992776 [info ] [Thread-2 (]: 33 of 52 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.11s]
[0m13:49:54.996847 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:49:54.997459 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m13:49:54.997796 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:49:54.998317 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:49:54.998665 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:49:55.001598 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:49:55.002438 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:49:55.002132 [info ] [Thread-2 (]: 39 of 52 START test unique_dim_products_product_id ............................. [RUN]
[0m13:49:55.006335 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:49:55.009166 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:49:55.009543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m13:49:55.010120 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:49:55.010515 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:49:55.014607 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:49:55.015037 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:49:55.015369 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:49:55.015706 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:49:55.016091 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:49:55.016419 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:55.016769 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m13:49:55.017099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.017418 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:49:55.017786 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:55.020895 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:49:55.021547 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:49:55.021873 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:49:55.022169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:55.057200 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:49:55.057599 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:49:55.057943 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:49:55.058256 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m13:49:55.058551 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:49:55.058875 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.059215 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:49:55.059523 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:49:55.059841 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:49:55.060277 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.060715 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.061046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.061385 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:55.062934 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:49:55.063446 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m13:49:55.063778 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.064077 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.064378 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:49:55.064682 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.065857 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m13:49:55.067028 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:49:55.068730 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:49:55.067601 [info ] [Thread-1 (]: 38 of 52 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.09s]
[0m13:49:55.069242 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m13:49:55.069598 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m13:49:55.069949 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m13:49:55.070408 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:49:55.070716 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m13:49:55.071018 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:49:55.071319 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:49:55.071686 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:49:55.072219 [info ] [Thread-3 (]: 37 of 52 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.09s]
[0m13:49:55.072713 [info ] [Thread-4 (]: 36 of 52 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m13:49:55.073180 [info ] [Thread-1 (]: 40 of 52 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m13:49:55.073735 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:49:55.074198 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:49:55.074574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m13:49:55.074976 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:49:55.075399 [info ] [Thread-2 (]: 39 of 52 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.07s]
[0m13:49:55.075817 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:49:55.076152 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:49:55.076507 [info ] [Thread-3 (]: 41 of 52 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:49:55.076972 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:49:55.077301 [info ] [Thread-4 (]: 42 of 52 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m13:49:55.085013 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:49:55.085384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:49:55.085828 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:49:55.086264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m13:49:55.086724 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:49:55.087111 [info ] [Thread-2 (]: 43 of 52 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m13:49:55.087490 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:49:55.091585 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:49:55.092005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m13:49:55.096127 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:49:55.096514 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:49:55.096915 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:49:55.099819 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:49:55.100158 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:49:55.105293 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:49:55.108108 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:49:55.108474 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:49:55.111299 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:49:55.111877 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:49:55.112238 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:49:55.112581 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m13:49:55.112975 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:49:55.115677 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:49:55.116155 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:49:55.116480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.116804 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:49:55.117195 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m13:49:55.117642 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:55.118014 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:49:55.118338 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:55.118697 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m13:49:55.119056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:55.154256 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:49:55.154645 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.154981 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:49:55.155301 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:49:55.155632 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.155934 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:49:55.156293 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m13:49:55.156641 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:49:55.156947 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:49:55.157274 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.157741 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.158123 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.158460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.159998 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m13:49:55.160441 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m13:49:55.160772 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.161069 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.161358 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.161654 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m13:49:55.162871 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:49:55.163984 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m13:49:55.165007 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m13:49:55.165438 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m13:49:55.166267 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m13:49:55.166661 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m13:49:55.166983 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:49:55.165942 [info ] [Thread-1 (]: 40 of 52 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.09s]
[0m13:49:55.167369 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m13:49:55.167671 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m13:49:55.168171 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:49:55.168617 [info ] [Thread-3 (]: 41 of 52 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.08s]
[0m13:49:55.169147 [info ] [Thread-2 (]: 43 of 52 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.08s]
[0m13:49:55.169582 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:49:55.170068 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:49:55.170559 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:49:55.170905 [info ] [Thread-1 (]: 44 of 52 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m13:49:55.171335 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:49:55.171820 [info ] [Thread-4 (]: 42 of 52 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.09s]
[0m13:49:55.172650 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:49:55.173086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m13:49:55.173460 [info ] [Thread-3 (]: 45 of 52 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:49:55.173940 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:49:55.174273 [info ] [Thread-2 (]: 46 of 52 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:49:55.174613 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:49:55.174963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:49:55.175330 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:49:55.175708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:49:55.181338 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:49:55.181715 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:49:55.182066 [info ] [Thread-4 (]: 47 of 52 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:49:55.182429 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:49:55.226408 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:49:55.226879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m13:49:55.231058 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:49:55.231541 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:49:55.231874 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:49:55.234802 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:49:55.239617 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:49:55.239966 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:49:55.242942 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:49:55.243392 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:49:55.246136 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:49:55.246592 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:49:55.246971 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m13:49:55.247328 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:49:55.247662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.250401 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:49:55.250772 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:49:55.251285 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:49:55.251665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:55.252037 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:49:55.252500 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:49:55.252830 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:49:55.253142 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:49:55.253444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:55.253762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:55.288638 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.288995 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:49:55.289306 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:49:55.289600 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m13:49:55.289906 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:49:55.290207 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:49:55.290546 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:55.290875 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:49:55.291175 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:49:55.291500 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.291967 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.292372 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.292725 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.294233 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:49:55.294656 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m13:49:55.294989 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.295297 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.295583 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:49:55.295873 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:49:55.297089 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m13:49:55.298274 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:49:55.299383 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:49:55.300220 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m13:49:55.300607 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m13:49:55.300982 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m13:49:55.299884 [info ] [Thread-3 (]: 45 of 52 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.12s]
[0m13:49:55.301388 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m13:49:55.301703 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:49:55.302010 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:49:55.302470 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:49:55.302999 [info ] [Thread-1 (]: 44 of 52 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.13s]
[0m13:49:55.303459 [info ] [Thread-2 (]: 46 of 52 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m13:49:55.303891 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:49:55.304490 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:49:55.304978 [info ] [Thread-4 (]: 47 of 52 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:49:55.305499 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:49:55.305875 [info ] [Thread-3 (]: 48 of 52 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m13:49:55.306329 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:49:55.307108 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:49:55.307492 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:49:55.307896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m13:49:55.308255 [info ] [Thread-1 (]: 49 of 52 START test not_null_fct_orders_product_id ............................. [RUN]
[0m13:49:55.308642 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:49:55.309016 [info ] [Thread-2 (]: 50 of 52 START test not_null_fct_orders_quantity ............................... [RUN]
[0m13:49:55.309393 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:49:55.309745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m13:49:55.310085 [info ] [Thread-4 (]: 51 of 52 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m13:49:55.310444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m13:49:55.316087 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:49:55.316454 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:49:55.316808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m13:49:55.317143 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:49:55.321487 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:49:55.321864 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:49:55.325918 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:49:55.326339 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:49:55.330339 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:49:55.334458 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:49:55.334798 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:49:55.337770 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:49:55.338252 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:49:55.341002 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:49:55.341406 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:49:55.341744 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:49:55.342171 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m13:49:55.342533 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:49:55.345232 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:49:55.345604 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:49:55.345948 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m13:49:55.346302 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:49:55.346749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.347115 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m13:49:55.347503 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:49:55.347808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:49:55.348127 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m13:49:55.348460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:55.384239 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.384580 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:49:55.384960 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.385309 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:49:55.385632 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.385955 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:49:55.386270 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:49:55.386633 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.386965 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:49:55.387294 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.387638 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.388092 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:49:55.388611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.389018 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:49:55.389331 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.389754 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.390994 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m13:49:55.392065 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m13:49:55.393218 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m13:49:55.394249 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m13:49:55.394654 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m13:49:55.395015 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m13:49:55.395379 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m13:49:55.395734 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m13:49:55.396044 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m13:49:55.396349 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m13:49:55.396649 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m13:49:55.396946 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m13:49:55.397440 [info ] [Thread-1 (]: 49 of 52 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:49:55.397960 [info ] [Thread-4 (]: 51 of 52 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.08s]
[0m13:49:55.398494 [info ] [Thread-3 (]: 48 of 52 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.09s]
[0m13:49:55.399053 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:49:55.399499 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:49:55.399948 [info ] [Thread-2 (]: 50 of 52 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m13:49:55.400423 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:49:55.400795 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:49:55.401351 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:49:55.401749 [info ] [Thread-1 (]: 52 of 52 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m13:49:55.402297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m13:49:55.402643 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:49:55.406923 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:49:55.407566 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:49:55.411785 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:49:55.412404 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:49:55.412737 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m13:49:55.413044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:55.449884 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:49:55.450266 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:49:55.450612 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:49:55.451496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:55.452750 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m13:49:55.453152 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m13:49:55.453463 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m13:49:55.454649 [info ] [Thread-1 (]: 52 of 52 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.05s]
[0m13:49:55.455169 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:49:55.456126 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:55.456408 [debug] [MainThread]: On master: BEGIN
[0m13:49:55.456661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:55.494101 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m13:49:55.494476 [debug] [MainThread]: On master: COMMIT
[0m13:49:55.494770 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:55.495036 [debug] [MainThread]: On master: COMMIT
[0m13:49:55.495381 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:55.495657 [debug] [MainThread]: On master: Close
[0m13:49:55.496658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:55.496953 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m13:49:55.497209 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m13:49:55.497452 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94' was properly closed.
[0m13:49:55.497691 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m13:49:55.498092 [info ] [MainThread]: 
[0m13:49:55.498400 [info ] [MainThread]: Finished running 4 seeds, 4 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m13:49:55.504263 [debug] [MainThread]: Command end result
[0m13:49:55.576901 [info ] [MainThread]: 
[0m13:49:55.577304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:55.577650 [info ] [MainThread]: 
[0m13:49:55.577944 [info ] [MainThread]: Done. PASS=52 WARN=0 ERROR=0 SKIP=0 TOTAL=52
[0m13:49:55.580641 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0563974, "process_in_blocks": "0", "process_kernel_time": 0.57448, "process_mem_max_rss": "192872448", "process_out_blocks": "0", "process_user_time": 6.286582}
[0m13:49:55.581039 [debug] [MainThread]: Command `dbt build` succeeded at 13:49:55.580962 after 3.06 seconds
[0m13:49:55.581371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efd930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b952d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092402e0>]}
[0m13:49:55.581705 [debug] [MainThread]: Flushing usage events
[0m13:50:28.271214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107199960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5ee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c5f280>]}


============================== 13:50:28.275896 | 69e77709-7dac-4269-85a8-48888693dc27 ==============================
[0m13:50:28.275896 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:50:28.276419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:modified+ --state ./state', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:28.529906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69e77709-7dac-4269-85a8-48888693dc27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d9c30>]}
[0m13:50:28.579755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69e77709-7dac-4269-85a8-48888693dc27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085de620>]}
[0m13:50:28.584201 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:50:28.705766 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:50:28.902118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:28.902556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:28.955937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69e77709-7dac-4269-85a8-48888693dc27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c04c0>]}
[0m13:50:29.243210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69e77709-7dac-4269-85a8-48888693dc27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109815c90>]}
[0m13:50:29.243729 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:50:29.245541 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m13:50:29.247089 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m13:50:29.248464 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m13:50:29.249831 [info ] [MainThread]: 
[0m13:50:29.250204 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:50:29.251838 [debug] [MainThread]: Command end result
[0m13:50:29.323166 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1127613, "process_in_blocks": "0", "process_kernel_time": 0.230206, "process_mem_max_rss": "125157376", "process_out_blocks": "0", "process_user_time": 2.031746}
[0m13:50:29.323626 [debug] [MainThread]: Command `dbt build` succeeded at 13:50:29.323544 after 1.11 seconds
[0m13:50:29.323975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107199960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107869960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982a530>]}
[0m13:50:29.324308 [debug] [MainThread]: Flushing usage events
[0m15:55:06.057770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107689930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109142f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109143400>]}


============================== 15:55:06.063320 | 658f349b-0c19-4e87-bbb7-c22a727069ca ==============================
[0m15:55:06.063320 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:55:06.063852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls -s state:modified+ --state ./state', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:06.340838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658f349b-0c19-4e87-bbb7-c22a727069ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc9c00>]}
[0m15:55:06.390597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658f349b-0c19-4e87-bbb7-c22a727069ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091da170>]}
[0m15:55:06.395008 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:55:06.526970 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:55:06.751620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:06.752030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:06.805334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658f349b-0c19-4e87-bbb7-c22a727069ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b0640>]}
[0m15:55:07.091513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658f349b-0c19-4e87-bbb7-c22a727069ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d01150>]}
[0m15:55:07.092033 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m15:55:07.092380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658f349b-0c19-4e87-bbb7-c22a727069ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d01300>]}
[0m15:55:07.094153 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m15:55:07.094502 [warn ] [MainThread]: No nodes selected!
[0m15:55:07.100358 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.1050872, "process_in_blocks": "0", "process_kernel_time": 0.280149, "process_mem_max_rss": "124321792", "process_out_blocks": "0", "process_user_time": 1.953335}
[0m15:55:07.100816 [debug] [MainThread]: Command `dbt ls` succeeded at 15:55:07.100731 after 1.11 seconds
[0m15:55:07.101169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107689930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bcbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d21240>]}
[0m15:55:07.101610 [debug] [MainThread]: Flushing usage events
[0m15:55:58.539305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0419c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb02fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb03430>]}


============================== 15:55:58.544159 | ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4 ==============================
[0m15:55:58.544159 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:55:58.544721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --output name', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:58.807064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71e620>]}
[0m15:55:58.857107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c910670>]}
[0m15:55:58.861910 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:55:58.986247 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:55:59.208717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:59.209122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:59.263326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d36c4c0>]}
[0m15:55:59.452869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d387100>]}
[0m15:55:59.453388 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m15:55:59.453728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2c7c58-a2c5-4139-9cf0-50d5c176bdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d386470>]}
[0m15:55:59.457444 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.9794451, "process_in_blocks": "0", "process_kernel_time": 0.238313, "process_mem_max_rss": "119209984", "process_out_blocks": "0", "process_user_time": 1.868185}
[0m15:55:59.457874 [debug] [MainThread]: Command `dbt ls` succeeded at 15:55:59.457790 after 0.98 seconds
[0m15:55:59.458222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0419c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d386470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71e620>]}
[0m15:55:59.458549 [debug] [MainThread]: Flushing usage events
[0m15:57:23.104146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb6fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb7430>]}


============================== 15:57:23.109062 | f6d174dd-dac2-4b22-bd92-e44542f9c713 ==============================
[0m15:57:23.109062 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:57:23.109600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s state:modified+ --state ./state', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:23.372461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3dc30>]}
[0m15:57:23.422635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da3130>]}
[0m15:57:23.429234 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:57:23.552810 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:57:23.745967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:23.746732 [debug] [MainThread]: Partial parsing: updated file: ci_cd_project://models/staging/stg_orders.sql
[0m15:57:23.973982 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:57:23.974515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109846590>]}
[0m15:57:24.164210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03f10>]}
[0m15:57:24.451386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e641f0>]}
[0m15:57:24.451927 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m15:57:24.452283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d174dd-dac2-4b22-bd92-e44542f9c713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ac2860>]}
[0m15:57:24.458612 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4162356, "process_in_blocks": "0", "process_kernel_time": 0.235178, "process_mem_max_rss": "131858432", "process_out_blocks": "0", "process_user_time": 2.32055}
[0m15:57:24.459099 [debug] [MainThread]: Command `dbt ls` succeeded at 15:57:24.459010 after 1.42 seconds
[0m15:57:24.459468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b7a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ae31c0>]}
[0m15:57:24.459827 [debug] [MainThread]: Flushing usage events
[0m15:57:26.679912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b52e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b53280>]}


============================== 15:57:26.684218 | c3f0f119-4ad5-4efa-8602-ebf01422b3e1 ==============================
[0m15:57:26.684218 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:57:26.684752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s state:modified+ --state ./state', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:57:26.891349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660dc30>]}
[0m15:57:26.941365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d2620>]}
[0m15:57:26.945257 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:57:27.062440 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:57:27.248212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:27.248653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:27.301859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b04c0>]}
[0m15:57:27.635993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f9840>]}
[0m15:57:27.636577 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m15:57:27.648991 [info ] [MainThread]: 
[0m15:57:27.653627 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:57:27.659367 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:57:27.727233 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:57:27.727651 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:57:27.727966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:27.900163 [debug] [ThreadPool]: SQL status: OK in 0.172 seconds
[0m15:57:27.902543 [debug] [ThreadPool]: On list_dev: Close
[0m15:57:27.905527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m15:57:27.911511 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:57:27.911980 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m15:57:27.912295 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m15:57:27.914818 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:57:27.915170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:27.915525 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:57:27.915905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:27.955029 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m15:57:27.955462 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:57:27.955760 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m15:57:27.956118 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m15:57:27.956442 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:57:27.956859 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:57:27.970037 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:57:27.970393 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:57:27.971636 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m15:57:27.972762 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:57:27.973561 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m15:57:27.973933 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:57:27.974220 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m15:57:27.974512 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:57:27.977261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea19f0>]}
[0m15:57:27.977677 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:27.977961 [debug] [MainThread]: On master: BEGIN
[0m15:57:27.978226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:28.013568 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m15:57:28.013977 [debug] [MainThread]: On master: COMMIT
[0m15:57:28.014299 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:28.014605 [debug] [MainThread]: On master: COMMIT
[0m15:57:28.015153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:57:28.015449 [debug] [MainThread]: On master: Close
[0m15:57:28.016485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:28.016850 [info ] [MainThread]: 
[0m15:57:28.019154 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m15:57:28.019674 [info ] [Thread-1 (]: 1 of 22 START sql view model analytics.stg_orders .............................. [RUN]
[0m15:57:28.020107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.stg_orders)
[0m15:57:28.020448 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m15:57:28.030687 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m15:57:28.031601 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m15:57:28.061677 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m15:57:28.062372 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.062735 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m15:57:28.063069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.104518 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m15:57:28.105090 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.106035 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m15:57:28.107019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.115274 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.115661 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m15:57:28.116752 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.120757 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.121125 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m15:57:28.121584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:28.136934 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m15:57:28.137538 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.137913 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m15:57:28.139511 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.144859 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:57:28.145240 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m15:57:28.145793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:28.148041 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m15:57:28.155563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af10c0>]}
[0m15:57:28.156160 [info ] [Thread-1 (]: 1 of 22 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.13s]
[0m15:57:28.156703 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m15:57:28.157442 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:57:28.157816 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:57:28.158234 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:57:28.158877 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:57:28.158593 [info ] [Thread-3 (]: 2 of 22 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m15:57:28.159320 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_orders_order_id ................................ [RUN]
[0m15:57:28.159710 [info ] [Thread-2 (]: 4 of 22 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m15:57:28.160105 [info ] [Thread-1 (]: 5 of 22 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:57:28.160579 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m15:57:28.161007 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m15:57:28.161368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m15:57:28.161795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m15:57:28.162200 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:57:28.162566 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:57:28.162916 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:57:28.163269 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:57:28.175082 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:57:28.179194 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:57:28.216117 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:57:28.224110 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:57:28.225656 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:57:28.226053 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:57:28.231958 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:57:28.244705 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:57:28.246770 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:57:28.247816 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:57:28.251443 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:57:28.254207 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:57:28.255158 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:57:28.255571 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:57:28.255944 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:57:28.256286 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:57:28.256664 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:57:28.257030 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m15:57:28.257381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:28.257746 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:57:28.258073 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:28.258384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.258787 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m15:57:28.259189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.296404 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m15:57:28.296809 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:57:28.297176 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.297517 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m15:57:28.297867 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.298211 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m15:57:28.298546 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:57:28.298872 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:57:28.299309 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:57:28.299683 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.300084 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.300471 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.301543 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.301909 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.302302 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.305302 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:57:28.306522 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m15:57:28.306910 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:57:28.308125 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:57:28.308568 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m15:57:28.308982 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m15:57:28.310245 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m15:57:28.310620 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m15:57:28.310951 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:57:28.311304 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m15:57:28.311719 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m15:57:28.312036 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:57:28.312576 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.15s]
[0m15:57:28.313407 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m15:57:28.313134 [info ] [Thread-2 (]: 4 of 22 PASS not_null_stg_orders_total_amount .................................. [[32mPASS[0m in 0.15s]
[0m15:57:28.313983 [info ] [Thread-3 (]: 2 of 22 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.15s]
[0m15:57:28.314500 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:57:28.315018 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:57:28.315528 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:57:28.315955 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:57:28.316462 [info ] [Thread-1 (]: 5 of 22 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_ . [[32mPASS[0m in 0.15s]
[0m15:57:28.316927 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:57:28.317393 [info ] [Thread-4 (]: 6 of 22 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:57:28.317900 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:57:28.318247 [info ] [Thread-2 (]: 7 of 22 START test unique_stg_orders_order_id .................................. [RUN]
[0m15:57:28.318672 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:57:28.319237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m15:57:28.319599 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:57:28.319937 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:57:28.325882 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:57:28.331969 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:57:28.332716 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:57:28.336757 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:57:28.337162 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:57:28.340060 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:57:28.340629 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:57:28.340987 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:57:28.341366 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:57:28.341701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.342044 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:57:28.342451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:28.378748 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m15:57:28.379136 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:57:28.379494 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m15:57:28.379863 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:57:28.380233 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:57:28.380746 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.382422 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.382839 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.384103 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:57:28.385247 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:57:28.385678 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m15:57:28.386077 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m15:57:28.386432 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:57:28.386768 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:57:28.387305 [info ] [Thread-4 (]: 6 of 22 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.07s]
[0m15:57:28.387902 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:57:28.388488 [info ] [Thread-2 (]: 7 of 22 PASS unique_stg_orders_order_id ........................................ [[32mPASS[0m in 0.07s]
[0m15:57:28.389025 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:57:28.389654 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m15:57:28.390056 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m15:57:28.390504 [info ] [Thread-3 (]: 8 of 22 START sql table model analytics.dim_customers .......................... [RUN]
[0m15:57:28.390965 [info ] [Thread-1 (]: 9 of 22 START sql table model analytics.fct_orders ............................. [RUN]
[0m15:57:28.391378 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now model.ci_cd_project.dim_customers)
[0m15:57:28.391749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.ci_cd_project.fct_orders)
[0m15:57:28.392094 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m15:57:28.392418 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.fct_orders
[0m15:57:28.396386 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m15:57:28.400685 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m15:57:28.401341 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m15:57:28.401696 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.fct_orders
[0m15:57:28.428428 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m15:57:28.430792 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m15:57:28.431416 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.431811 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.432155 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m15:57:28.432493 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m15:57:28.432830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:28.433167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.470606 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.471016 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.471390 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.471812 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m15:57:28.472221 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.472782 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m15:57:28.476487 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:57:28.479999 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.480384 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:57:28.480744 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m15:57:28.484591 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.485046 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m15:57:28.485408 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:57:28.488672 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.489026 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m15:57:28.489360 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:57:28.492580 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.492928 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m15:57:28.493313 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:57:28.497594 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m15:57:28.497981 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.498326 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m15:57:28.498698 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:57:28.500071 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m15:57:28.500462 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.500802 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.501118 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m15:57:28.503853 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:57:28.504272 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m15:57:28.504662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:28.508169 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:57:28.508520 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:57:28.508841 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m15:57:28.509928 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m15:57:28.510516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf1480>]}
[0m15:57:28.511405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.511112 [info ] [Thread-3 (]: 8 of 22 OK created sql table model analytics.dim_customers ..................... [[32mOK[0m in 0.12s]
[0m15:57:28.512601 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: Close
[0m15:57:28.513096 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m15:57:28.513774 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:57:28.514146 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:57:28.514489 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:57:28.514833 [info ] [Thread-2 (]: 10 of 22 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m15:57:28.515232 [info ] [Thread-4 (]: 11 of 22 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m15:57:28.515635 [info ] [Thread-3 (]: 12 of 22 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m15:57:28.516109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m15:57:28.516528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:57:28.516936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m15:57:28.517506 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:57:28.517896 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:57:28.518241 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:57:28.524972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f0f119-4ad5-4efa-8602-ebf01422b3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9e530>]}
[0m15:57:28.528618 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:57:28.532807 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:57:28.537207 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:57:28.537840 [info ] [Thread-1 (]: 9 of 22 OK created sql table model analytics.fct_orders ........................ [[32mOK[0m in 0.13s]
[0m15:57:28.538741 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m15:57:28.539193 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:57:28.539699 [info ] [Thread-1 (]: 13 of 22 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m15:57:28.540471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m15:57:28.540899 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:57:28.541272 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:57:28.541649 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:57:28.545560 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:57:28.545918 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:57:28.550219 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:57:28.553048 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:57:28.555896 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:57:28.556530 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:57:28.556988 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:57:28.557356 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m15:57:28.557781 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:57:28.561290 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:57:28.561696 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:57:28.562029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.562359 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m15:57:28.562752 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m15:57:28.563181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:28.563577 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:57:28.563901 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:28.564271 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m15:57:28.564620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.601214 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m15:57:28.601623 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:57:28.601992 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.602453 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m15:57:28.602816 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m15:57:28.603157 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:57:28.603461 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m15:57:28.603911 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:57:28.604281 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.604652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.604963 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:57:28.605309 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.606726 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m15:57:28.607093 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.607518 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.607898 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:57:28.608284 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m15:57:28.609566 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m15:57:28.609973 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m15:57:28.610293 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.611363 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m15:57:28.611767 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m15:57:28.612698 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m15:57:28.612346 [info ] [Thread-2 (]: 10 of 22 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.10s]
[0m15:57:28.613858 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m15:57:28.614188 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m15:57:28.614510 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m15:57:28.614989 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:57:28.615371 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m15:57:28.615842 [info ] [Thread-3 (]: 12 of 22 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.10s]
[0m15:57:28.616307 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:57:28.616762 [info ] [Thread-4 (]: 11 of 22 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.10s]
[0m15:57:28.617196 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m15:57:28.617690 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:57:28.618062 [info ] [Thread-2 (]: 14 of 22 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m15:57:28.618691 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:57:28.619177 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:57:28.619620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m15:57:28.620126 [info ] [Thread-1 (]: 13 of 22 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.08s]
[0m15:57:28.620544 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:57:28.620941 [info ] [Thread-3 (]: 15 of 22 START test unique_dim_customers_customer_id ........................... [RUN]
[0m15:57:28.621314 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:57:28.621774 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:57:28.622117 [info ] [Thread-4 (]: 16 of 22 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m15:57:28.622502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m15:57:28.626944 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:57:28.627386 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:57:28.627806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m15:57:28.628171 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:57:28.628612 [info ] [Thread-1 (]: 17 of 22 START test not_null_fct_orders_order_id ............................... [RUN]
[0m15:57:28.629015 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:57:28.633421 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:57:28.633919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m15:57:28.634271 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:57:28.638366 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:57:28.638814 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:57:28.642658 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:57:28.643147 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:57:28.647271 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:57:28.650494 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:57:28.650895 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:57:28.651462 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:57:28.654317 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:57:28.654723 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m15:57:28.655076 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:57:28.655465 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:57:28.655856 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.659268 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:57:28.659657 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m15:57:28.660022 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:57:28.660575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:28.660952 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m15:57:28.661351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:28.661744 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:57:28.662100 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m15:57:28.662418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.697839 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m15:57:28.698251 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:57:28.698598 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.698925 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m15:57:28.699291 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m15:57:28.699635 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.699984 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:57:28.700314 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:57:28.700635 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:57:28.701091 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:57:28.701481 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.701807 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.702151 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.703712 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m15:57:28.704151 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.704468 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.704866 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m15:57:28.705254 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.706449 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m15:57:28.706839 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m15:57:28.707988 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m15:57:28.709134 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m15:57:28.709546 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m15:57:28.709984 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m15:57:28.710835 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m15:57:28.711179 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m15:57:28.710503 [info ] [Thread-2 (]: 14 of 22 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.09s]
[0m15:57:28.711584 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m15:57:28.711904 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m15:57:28.712416 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:57:28.712863 [info ] [Thread-3 (]: 15 of 22 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m15:57:28.713405 [info ] [Thread-4 (]: 16 of 22 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.09s]
[0m15:57:28.713872 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:57:28.714411 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:57:28.714885 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:57:28.715332 [info ] [Thread-1 (]: 17 of 22 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m15:57:28.715720 [info ] [Thread-2 (]: 18 of 22 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m15:57:28.716177 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:57:28.716556 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:57:28.717160 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:57:28.717659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m15:57:28.718031 [info ] [Thread-3 (]: 19 of 22 START test not_null_fct_orders_product_id ............................. [RUN]
[0m15:57:28.718395 [info ] [Thread-4 (]: 20 of 22 START test not_null_fct_orders_quantity ............................... [RUN]
[0m15:57:28.718790 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:57:28.719128 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:57:28.719511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m15:57:28.719872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m15:57:28.720222 [info ] [Thread-1 (]: 21 of 22 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m15:57:28.724665 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:57:28.725048 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:57:28.725391 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:57:28.725768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m15:57:28.730047 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:57:28.734270 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:57:28.734661 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:57:28.735024 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:57:28.740184 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:57:28.742960 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:57:28.743354 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:57:28.743802 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:57:28.746635 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:57:28.749467 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:57:28.749951 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:57:28.750370 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:57:28.753784 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:57:28.754181 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m15:57:28.754568 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:57:28.755017 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:57:28.755345 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.755701 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m15:57:28.793713 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:57:28.756038 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m15:57:28.794447 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:28.794807 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m15:57:28.795138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:28.795504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:28.829596 [debug] [Thread-2 (]: SQL status: OK in 0.074 seconds
[0m15:57:28.829995 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:57:28.830420 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m15:57:28.830809 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.831151 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m15:57:28.831472 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m15:57:28.831802 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:57:28.832232 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:57:28.832596 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:57:28.832909 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.833251 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.833610 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.833968 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m15:57:28.835263 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m15:57:28.836048 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m15:57:28.836423 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m15:57:28.836764 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.837096 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.837433 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:28.837947 [info ] [Thread-2 (]: 18 of 22 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.12s]
[0m15:57:28.839189 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m15:57:28.840228 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m15:57:28.841307 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m15:57:28.841802 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:57:28.842194 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m15:57:28.842574 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m15:57:28.842949 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m15:57:28.843338 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:57:28.843683 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m15:57:28.844057 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m15:57:28.844380 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m15:57:28.844787 [info ] [Thread-2 (]: 22 of 22 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m15:57:28.845391 [info ] [Thread-1 (]: 21 of 22 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.12s]
[0m15:57:28.846210 [info ] [Thread-3 (]: 19 of 22 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.13s]
[0m15:57:28.849889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m15:57:28.864693 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:57:28.851229 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:57:28.882829 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:57:28.889759 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:57:28.895057 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:57:28.899776 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:57:28.900469 [info ] [Thread-4 (]: 20 of 22 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.18s]
[0m15:57:28.901159 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:57:28.901746 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:57:28.902113 [debug] [Thread-2 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m15:57:28.902439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:28.942686 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m15:57:28.943125 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:57:28.943504 [debug] [Thread-2 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:57:28.944473 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:28.945796 [debug] [Thread-2 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m15:57:28.946244 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m15:57:28.946577 [debug] [Thread-2 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m15:57:28.947748 [info ] [Thread-2 (]: 22 of 22 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.10s]
[0m15:57:28.948284 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:57:28.949255 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:28.949596 [debug] [MainThread]: On master: BEGIN
[0m15:57:28.949881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:28.989517 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m15:57:28.989915 [debug] [MainThread]: On master: COMMIT
[0m15:57:28.990222 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:28.990501 [debug] [MainThread]: On master: COMMIT
[0m15:57:28.990877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:57:28.991194 [debug] [MainThread]: On master: Close
[0m15:57:28.992216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:28.992509 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m15:57:28.992768 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m15:57:28.993020 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m15:57:28.993268 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m15:57:28.993621 [info ] [MainThread]: 
[0m15:57:28.993937 [info ] [MainThread]: Finished running 1 view model, 19 data tests, 2 table models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m15:57:28.996744 [debug] [MainThread]: Command end result
[0m15:57:29.069436 [info ] [MainThread]: 
[0m15:57:29.069881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:29.070214 [info ] [MainThread]: 
[0m15:57:29.070531 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m15:57:29.073314 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.4490411, "process_in_blocks": "0", "process_kernel_time": 0.468294, "process_mem_max_rss": "170049536", "process_out_blocks": "0", "process_user_time": 4.863163}
[0m15:57:29.073707 [debug] [MainThread]: Command `dbt build` succeeded at 15:57:29.073633 after 2.45 seconds
[0m15:57:29.074045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109706470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109706560>]}
[0m15:57:29.074384 [debug] [MainThread]: Flushing usage events
[0m15:57:42.792948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b105960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbbefb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbbf430>]}


============================== 15:57:42.797686 | 54fd3133-9278-40ee-91ea-6f321b4e9f26 ==============================
[0m15:57:42.797686 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:57:42.798215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls -s state:new+ --state ./state', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:43.028305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54fd3133-9278-40ee-91ea-6f321b4e9f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a645c30>]}
[0m15:57:43.078318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54fd3133-9278-40ee-91ea-6f321b4e9f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a7130>]}
[0m15:57:43.082666 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:57:43.206802 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:57:43.399226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:57:43.399883 [debug] [MainThread]: Partial parsing: added file: ci_cd_project://models/tmp_new.sql
[0m15:57:43.670993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54fd3133-9278-40ee-91ea-6f321b4e9f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4467d0>]}
[0m15:57:43.922393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54fd3133-9278-40ee-91ea-6f321b4e9f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8840d0>]}
[0m15:57:43.922892 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:57:43.923240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fd3133-9278-40ee-91ea-6f321b4e9f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d522140>]}
[0m15:57:43.927169 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.1937091, "process_in_blocks": "0", "process_kernel_time": 0.204963, "process_mem_max_rss": "129253376", "process_out_blocks": "0", "process_user_time": 2.127921}
[0m15:57:43.927584 [debug] [MainThread]: Command `dbt ls` succeeded at 15:57:43.927504 after 1.19 seconds
[0m15:57:43.927926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b105960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65bb20>]}
[0m15:57:43.928255 [debug] [MainThread]: Flushing usage events
[0m15:57:45.996038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b18d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4ee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4f2b0>]}


============================== 15:57:46.000315 | 4be52804-73d7-4aa0-989d-ca433309cea2 ==============================
[0m15:57:46.000315 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:57:46.000867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:new+ --state ./state', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:46.203954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd50c0>]}
[0m15:57:46.253739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0018d0>]}
[0m15:57:46.257476 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:57:46.373977 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:57:46.555334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:46.555769 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:46.608763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b7e50>]}
[0m15:57:46.888671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7f5c60>]}
[0m15:57:46.889205 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:57:46.891128 [info ] [MainThread]: 
[0m15:57:46.891636 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:57:46.892351 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:57:46.945367 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:57:46.945775 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:57:46.946088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:47.089871 [debug] [ThreadPool]: SQL status: OK in 0.144 seconds
[0m15:57:47.091597 [debug] [ThreadPool]: On list_dev: Close
[0m15:57:47.099377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m15:57:47.105675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m15:57:47.105288 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:57:47.108321 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:57:47.108641 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m15:57:47.108930 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:57:47.109201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:47.109466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:47.145980 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:57:47.146316 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:57:47.146628 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:57:47.146958 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m15:57:47.147281 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:57:47.147678 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:57:47.160102 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:57:47.160456 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m15:57:47.161756 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:57:47.162835 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m15:57:47.163660 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:57:47.164029 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m15:57:47.164313 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:57:47.164613 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m15:57:47.167264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7f6cb0>]}
[0m15:57:47.167686 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:47.167972 [debug] [MainThread]: On master: BEGIN
[0m15:57:47.168238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:47.204695 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m15:57:47.205052 [debug] [MainThread]: On master: COMMIT
[0m15:57:47.205363 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:47.205652 [debug] [MainThread]: On master: COMMIT
[0m15:57:47.206008 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:57:47.206296 [debug] [MainThread]: On master: Close
[0m15:57:47.207280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:47.207617 [info ] [MainThread]: 
[0m15:57:47.209386 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m15:57:47.209865 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.tmp_new ................................. [RUN]
[0m15:57:47.210272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.tmp_new)
[0m15:57:47.210769 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m15:57:47.218838 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m15:57:47.219502 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m15:57:47.253262 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m15:57:47.253982 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:57:47.254343 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m15:57:47.254672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:47.291835 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m15:57:47.292267 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:57:47.292632 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m15:57:47.295321 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:57:47.301808 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:57:47.302206 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m15:57:47.302785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:47.319181 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:57:47.319564 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:57:47.319907 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:57:47.321633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:47.327528 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:57:47.327909 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m15:57:47.328386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:47.330575 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m15:57:47.336388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be52804-73d7-4aa0-989d-ca433309cea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe14b0>]}
[0m15:57:47.336973 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.tmp_new ............................ [[32mOK[0m in 0.13s]
[0m15:57:47.337506 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m15:57:47.338425 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:47.338738 [debug] [MainThread]: On master: BEGIN
[0m15:57:47.339023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:47.377784 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m15:57:47.378172 [debug] [MainThread]: On master: COMMIT
[0m15:57:47.378474 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:47.378759 [debug] [MainThread]: On master: COMMIT
[0m15:57:47.379145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:57:47.379499 [debug] [MainThread]: On master: Close
[0m15:57:47.380527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:47.380850 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m15:57:47.381124 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m15:57:47.381435 [info ] [MainThread]: 
[0m15:57:47.381757 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:57:47.382351 [debug] [MainThread]: Command end result
[0m15:57:47.487680 [info ] [MainThread]: 
[0m15:57:47.488167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:47.488489 [info ] [MainThread]: 
[0m15:57:47.488811 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:47.491548 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5508159, "process_in_blocks": "0", "process_kernel_time": 0.317884, "process_mem_max_rss": "156467200", "process_out_blocks": "0", "process_user_time": 3.110897}
[0m15:57:47.491947 [debug] [MainThread]: Command `dbt build` succeeded at 15:57:47.491872 after 1.55 seconds
[0m15:57:47.492286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b18d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b859450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d820100>]}
[0m15:57:47.492623 [debug] [MainThread]: Flushing usage events
[0m15:58:19.837665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a786fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a787430>]}


============================== 15:58:19.842359 | 47d7fc64-39c7-4767-b568-0802ed6d461d ==============================
[0m15:58:19.842359 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:19.842884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls -s state:new+ --state ./state', 'send_anonymous_usage_stats': 'True'}
[0m15:58:20.069727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47d7fc64-39c7-4767-b568-0802ed6d461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820dc30>]}
[0m15:58:20.119462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47d7fc64-39c7-4767-b568-0802ed6d461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a573130>]}
[0m15:58:20.123739 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:20.246273 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:20.439519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:20.439940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:20.492544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47d7fc64-39c7-4767-b568-0802ed6d461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff4af0>]}
[0m15:58:20.776072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d7fc64-39c7-4767-b568-0802ed6d461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b331720>]}
[0m15:58:20.776583 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:20.776922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d7fc64-39c7-4767-b568-0802ed6d461d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3316c0>]}
[0m15:58:20.780853 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.0017135, "process_in_blocks": "0", "process_kernel_time": 0.214937, "process_mem_max_rss": "124157952", "process_out_blocks": "0", "process_user_time": 1.945556}
[0m15:58:20.781262 [debug] [MainThread]: Command `dbt ls` succeeded at 15:58:20.781183 after 1.00 seconds
[0m15:58:20.781596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccd960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108efa0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b351600>]}
[0m15:58:20.781917 [debug] [MainThread]: Flushing usage events
[0m15:58:22.816195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a832e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8332b0>]}


============================== 15:58:22.820482 | 9fc616cd-4f72-4c4b-8309-1f6d1cebf395 ==============================
[0m15:58:22.820482 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:22.821021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build -s state:new+ --state ./state', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:23.026706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b50c0>]}
[0m15:58:23.076590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be58d0>]}
[0m15:58:23.080438 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:23.197634 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:23.383556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:23.384000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:23.437166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09be50>]}
[0m15:58:23.720611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d9c60>]}
[0m15:58:23.721161 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:23.723115 [info ] [MainThread]: 
[0m15:58:23.723641 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:23.724378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:58:23.778394 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:58:23.778813 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:58:23.779123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:23.916773 [debug] [ThreadPool]: SQL status: OK in 0.138 seconds
[0m15:58:23.918556 [debug] [ThreadPool]: On list_dev: Close
[0m15:58:23.925887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m15:58:23.931850 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:23.932375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m15:58:23.932743 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m15:58:23.935212 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:23.935529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:23.935818 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:58:23.936171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:23.972520 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:58:23.972906 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:23.973221 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m15:58:23.973553 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m15:58:23.973872 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:23.974218 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:58:23.987776 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:58:23.988171 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m15:58:23.989413 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m15:58:23.990557 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:58:23.991387 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m15:58:23.991755 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:58:23.992035 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m15:58:23.992322 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:58:23.995066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dacb0>]}
[0m15:58:23.995500 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:23.995783 [debug] [MainThread]: On master: BEGIN
[0m15:58:23.996051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:24.032130 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m15:58:24.032465 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.032770 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:24.033048 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.033427 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:24.033783 [debug] [MainThread]: On master: Close
[0m15:58:24.034812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:24.035162 [info ] [MainThread]: 
[0m15:58:24.036964 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m15:58:24.037460 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.tmp_new ................................. [RUN]
[0m15:58:24.038017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.tmp_new)
[0m15:58:24.038360 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m15:58:24.046410 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m15:58:24.047041 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m15:58:24.080622 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m15:58:24.081292 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.081649 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m15:58:24.081973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.118719 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m15:58:24.119117 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.119458 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m15:58:24.121881 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:24.128304 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.128692 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "dev"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m15:58:24.129255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:24.132486 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.132844 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m15:58:24.133286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:24.152206 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:24.152602 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.152941 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:24.154524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:24.159638 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:24.160016 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m15:58:24.160618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:24.162806 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m15:58:24.168709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fc616cd-4f72-4c4b-8309-1f6d1cebf395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c5660>]}
[0m15:58:24.169297 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.tmp_new ............................ [[32mOK[0m in 0.13s]
[0m15:58:24.169835 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m15:58:24.170754 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:24.171056 [debug] [MainThread]: On master: BEGIN
[0m15:58:24.171326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:24.207956 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m15:58:24.208365 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.208678 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:24.208960 [debug] [MainThread]: On master: COMMIT
[0m15:58:24.209318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:24.209605 [debug] [MainThread]: On master: Close
[0m15:58:24.210605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:24.210925 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m15:58:24.211194 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m15:58:24.211493 [info ] [MainThread]: 
[0m15:58:24.211811 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:58:24.212396 [debug] [MainThread]: Command end result
[0m15:58:24.317071 [info ] [MainThread]: 
[0m15:58:24.317561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:24.317881 [info ] [MainThread]: 
[0m15:58:24.318203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:24.320951 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.561043, "process_in_blocks": "0", "process_kernel_time": 0.343258, "process_mem_max_rss": "157155328", "process_out_blocks": "0", "process_user_time": 3.139398}
[0m15:58:24.321348 [debug] [MainThread]: Command `dbt build` succeeded at 15:58:24.321272 after 1.56 seconds
[0m15:58:24.321689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b404100>]}
[0m15:58:24.322042 [debug] [MainThread]: Flushing usage events
[0m15:58:39.608462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac3d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f74c0>]}


============================== 15:58:39.613131 | b7b0ec13-338b-47bb-b5cb-242849c69e86 ==============================
[0m15:58:39.613131 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:39.613665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls -s state:new+ --state ./state', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:39.845610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b0ec13-338b-47bb-b5cb-242849c69e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c820490>]}
[0m15:58:39.895271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b0ec13-338b-47bb-b5cb-242849c69e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c080b20>]}
[0m15:58:39.899546 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:40.022352 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:40.215655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:40.216092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:40.269011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b0ec13-338b-47bb-b5cb-242849c69e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf64b80>]}
[0m15:58:40.550832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b0ec13-338b-47bb-b5cb-242849c69e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a17b0>]}
[0m15:58:40.551361 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:40.551721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b0ec13-338b-47bb-b5cb-242849c69e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a1750>]}
[0m15:58:40.556695 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.0063143, "process_in_blocks": "0", "process_kernel_time": 0.218871, "process_mem_max_rss": "123420672", "process_out_blocks": "0", "process_user_time": 1.947345}
[0m15:58:40.557158 [debug] [MainThread]: Command `dbt ls` succeeded at 15:58:40.557070 after 1.01 seconds
[0m15:58:40.557515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac3d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2c1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2c1630>]}
[0m15:58:40.557857 [debug] [MainThread]: Flushing usage events
[0m15:58:42.639201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109add9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a2ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a3340>]}


============================== 15:58:42.643469 | 101038c0-e881-4f0a-b0eb-a0811aa18404 ==============================
[0m15:58:42.643469 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:42.644024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:new+ --state ./state', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:42.868511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b632230>]}
[0m15:58:42.918449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a93ff40>]}
[0m15:58:42.922475 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:43.045379 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:43.231573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:43.232034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:43.285755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0be50>]}
[0m15:58:43.574805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c149c90>]}
[0m15:58:43.575362 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:43.577327 [info ] [MainThread]: 
[0m15:58:43.577842 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:43.578574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:58:43.631543 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:58:43.631995 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:58:43.632368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:43.757788 [debug] [ThreadPool]: SQL status: OK in 0.125 seconds
[0m15:58:43.759753 [debug] [ThreadPool]: On list_dev: Close
[0m15:58:43.766758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m15:58:43.767258 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m15:58:43.773254 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:43.775752 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:43.776073 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:58:43.776366 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m15:58:43.776642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:43.776915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:43.815631 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m15:58:43.815996 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:43.816304 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m15:58:43.816603 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:58:43.816908 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:43.817330 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m15:58:43.828590 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:58:43.828924 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:58:43.830084 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m15:58:43.831206 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:58:43.831993 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m15:58:43.832356 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:58:43.832641 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m15:58:43.832931 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:58:43.835779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b648490>]}
[0m15:58:43.836191 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:43.836479 [debug] [MainThread]: On master: BEGIN
[0m15:58:43.836748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:43.874116 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m15:58:43.874486 [debug] [MainThread]: On master: COMMIT
[0m15:58:43.874791 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:43.875077 [debug] [MainThread]: On master: COMMIT
[0m15:58:43.875477 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:43.875847 [debug] [MainThread]: On master: Close
[0m15:58:43.876855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:43.877205 [info ] [MainThread]: 
[0m15:58:43.879578 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m15:58:43.880058 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.tmp_new ................................. [RUN]
[0m15:58:43.880628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.ci_cd_project.tmp_new)
[0m15:58:43.880974 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m15:58:43.889001 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m15:58:43.889656 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m15:58:43.923135 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m15:58:43.923839 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:43.924200 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m15:58:43.924536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:43.962664 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m15:58:43.963070 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:43.963422 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m15:58:43.966742 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:43.973191 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:43.973575 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "dev"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m15:58:43.974139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:43.977467 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:43.977827 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m15:58:43.978269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:43.996893 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:43.997276 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:43.997615 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:43.999021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:44.004103 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:44.004476 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m15:58:44.005293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:44.007538 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m15:58:44.013787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101038c0-e881-4f0a-b0eb-a0811aa18404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b83ac0>]}
[0m15:58:44.014403 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.tmp_new ............................ [[32mOK[0m in 0.13s]
[0m15:58:44.014957 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m15:58:44.015887 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:44.016187 [debug] [MainThread]: On master: BEGIN
[0m15:58:44.016459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:44.059669 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m15:58:44.060060 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.060366 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:44.060644 [debug] [MainThread]: On master: COMMIT
[0m15:58:44.060996 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:44.061281 [debug] [MainThread]: On master: Close
[0m15:58:44.062277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:44.062559 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m15:58:44.062817 [debug] [MainThread]: Connection 'list_dev_analytics_dev' was properly closed.
[0m15:58:44.063115 [info ] [MainThread]: 
[0m15:58:44.063432 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:58:44.064020 [debug] [MainThread]: Command end result
[0m15:58:44.168749 [info ] [MainThread]: 
[0m15:58:44.169244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:44.169566 [info ] [MainThread]: 
[0m15:58:44.169893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:44.172625 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5891615, "process_in_blocks": "0", "process_kernel_time": 0.347014, "process_mem_max_rss": "156991488", "process_out_blocks": "0", "process_user_time": 3.148906}
[0m15:58:44.173026 [debug] [MainThread]: Command `dbt build` succeeded at 15:58:44.172951 after 1.59 seconds
[0m15:58:44.173365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109add9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1741f0>]}
[0m15:58:44.173703 [debug] [MainThread]: Flushing usage events
[0m15:58:54.582685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba71900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d52af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d52b3d0>]}


============================== 15:58:54.587182 | 497ecfd9-992c-443e-ae89-899125dce56c ==============================
[0m15:58:54.587182 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:54.587710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ls -s state:new+ --state ./state', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:54.792153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497ecfd9-992c-443e-ae89-899125dce56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0e0340>]}
[0m15:58:54.841737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '497ecfd9-992c-443e-ae89-899125dce56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb6170>]}
[0m15:58:54.845526 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:54.962784 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:55.158484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:55.158990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:55.213148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '497ecfd9-992c-443e-ae89-899125dce56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd94a90>]}
[0m15:58:55.501963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '497ecfd9-992c-443e-ae89-899125dce56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d96c0>]}
[0m15:58:55.502503 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:55.502860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '497ecfd9-992c-443e-ae89-899125dce56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d9660>]}
[0m15:58:55.506909 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.9814333, "process_in_blocks": "0", "process_kernel_time": 0.179332, "process_mem_max_rss": "124026880", "process_out_blocks": "0", "process_user_time": 1.941549}
[0m15:58:55.507366 [debug] [MainThread]: Command `dbt ls` succeeded at 15:58:55.507280 after 0.98 seconds
[0m15:58:55.507728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba71900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c140340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f9570>]}
[0m15:58:55.508070 [debug] [MainThread]: Flushing usage events
[0m15:58:57.491741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093659c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2b340>]}


============================== 15:58:57.496054 | 2e80a55a-6702-4b16-b1e5-3c624c0cff00 ==============================
[0m15:58:57.496054 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:58:57.496589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s state:new+ --state ./state', 'send_anonymous_usage_stats': 'True'}
[0m15:58:57.702681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb6230>]}
[0m15:58:57.752289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1c7f40>]}
[0m15:58:57.756064 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:58:57.876443 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:58:58.062929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:58.063367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:58.116917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b693e50>]}
[0m15:58:58.400817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d1c90>]}
[0m15:58:58.401346 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m15:58:58.403264 [info ] [MainThread]: 
[0m15:58:58.403769 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:58.404479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:58:58.457023 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:58:58.457429 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:58:58.457729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:58.522495 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m15:58:58.523755 [debug] [ThreadPool]: On list_dev: Close
[0m15:58:58.530386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m15:58:58.536260 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:58.536771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m15:58:58.537063 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m15:58:58.539564 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:58.539862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:58.540144 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:58:58.540485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:58.638010 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m15:58:58.638489 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m15:58:58.638829 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m15:58:58.639224 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m15:58:58.639630 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:58:58.640110 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:58:58.650451 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:58:58.650900 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:58:58.652213 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m15:58:58.653469 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:58:58.654341 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m15:58:58.654676 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m15:58:58.654987 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:58:58.655463 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:58:58.658397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d2ce0>]}
[0m15:58:58.658897 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:58.659204 [debug] [MainThread]: On master: BEGIN
[0m15:58:58.659485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:58.701702 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m15:58:58.702095 [debug] [MainThread]: On master: COMMIT
[0m15:58:58.702402 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:58.702686 [debug] [MainThread]: On master: COMMIT
[0m15:58:58.703044 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:58.703339 [debug] [MainThread]: On master: Close
[0m15:58:58.704437 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:58.704809 [info ] [MainThread]: 
[0m15:58:58.706614 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m15:58:58.707138 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.tmp_new ................................. [RUN]
[0m15:58:58.707730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.tmp_new)
[0m15:58:58.708086 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m15:58:58.716724 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m15:58:58.717372 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m15:58:58.751383 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m15:58:58.752059 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.752407 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m15:58:58.752718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:58.788192 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m15:58:58.788589 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.788939 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m15:58:58.789577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:58.795942 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.796320 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "dev"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m15:58:58.796802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:58.800191 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.800583 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m15:58:58.801074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:58.820421 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:58.820811 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.821145 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m15:58:58.821947 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:58.827106 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m15:58:58.827470 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m15:58:58.828053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:58.830334 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m15:58:58.835446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e80a55a-6702-4b16-b1e5-3c624c0cff00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb9690>]}
[0m15:58:58.836034 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.tmp_new ............................ [[32mOK[0m in 0.13s]
[0m15:58:58.836563 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m15:58:58.837469 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:58.837775 [debug] [MainThread]: On master: BEGIN
[0m15:58:58.838045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:58.875398 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m15:58:58.875787 [debug] [MainThread]: On master: COMMIT
[0m15:58:58.876088 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:58.876364 [debug] [MainThread]: On master: COMMIT
[0m15:58:58.876706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:58.876985 [debug] [MainThread]: On master: Close
[0m15:58:58.877977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:58.878293 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m15:58:58.878555 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m15:58:58.878847 [info ] [MainThread]: 
[0m15:58:58.879155 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m15:58:58.879741 [debug] [MainThread]: Command end result
[0m15:58:58.984351 [info ] [MainThread]: 
[0m15:58:58.984831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:58.985135 [info ] [MainThread]: 
[0m15:58:58.985446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:58.988238 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5518692, "process_in_blocks": "0", "process_kernel_time": 0.335748, "process_mem_max_rss": "152092672", "process_out_blocks": "0", "process_user_time": 3.127894}
[0m15:58:58.988642 [debug] [MainThread]: Command `dbt build` succeeded at 15:58:58.988564 after 1.55 seconds
[0m15:58:58.988983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093659c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9fc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9fc1f0>]}
[0m15:58:58.989321 [debug] [MainThread]: Flushing usage events
[0m16:03:11.062073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b665c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b665180>]}


============================== 16:03:11.067046 | fa1e19aa-0a93-4a59-a444-5dcde3445371 ==============================
[0m16:03:11.067046 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:03:11.067565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:11.326035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a26ce50>]}
[0m16:03:11.375396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1d8d0>]}
[0m16:03:11.379717 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:03:11.502809 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:03:11.713198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:11.713616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:11.766059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec8640>]}
[0m16:03:11.943754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec9ae0>]}
[0m16:03:11.944262 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:03:11.944597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec9ab0>]}
[0m16:03:11.946666 [info ] [MainThread]: 
[0m16:03:11.947151 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:11.952417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:03:12.005163 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:03:12.005545 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m16:03:12.005852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:12.165717 [debug] [ThreadPool]: SQL status: OK in 0.160 seconds
[0m16:03:12.167700 [debug] [ThreadPool]: On list_dev: Close
[0m16:03:12.171001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m16:03:12.176980 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:12.177458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m16:03:12.177855 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m16:03:12.180855 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:12.181178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:12.181483 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m16:03:12.181908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:12.218616 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:03:12.218988 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:12.219293 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:03:12.219622 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m16:03:12.219946 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:12.220349 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m16:03:12.233914 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:03:12.234258 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:03:12.235552 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m16:03:12.236685 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m16:03:12.237468 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m16:03:12.237830 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m16:03:12.238098 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m16:03:12.238389 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m16:03:12.241195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848da80>]}
[0m16:03:12.241605 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:12.241881 [debug] [MainThread]: On master: BEGIN
[0m16:03:12.242144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:12.278637 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m16:03:12.278971 [debug] [MainThread]: On master: COMMIT
[0m16:03:12.279255 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:12.279523 [debug] [MainThread]: On master: COMMIT
[0m16:03:12.279901 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:12.280265 [debug] [MainThread]: On master: Close
[0m16:03:12.281295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:12.281646 [info ] [MainThread]: 
[0m16:03:12.283466 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m16:03:12.284002 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m16:03:12.284472 [info ] [Thread-1 (]: 1 of 8 START sql view model analytics.stg_customers ............................ [RUN]
[0m16:03:12.284884 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m16:03:12.285224 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m16:03:12.285636 [info ] [Thread-2 (]: 2 of 8 START sql view model analytics.stg_order_items .......................... [RUN]
[0m16:03:12.286069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.stg_customers)
[0m16:03:12.286527 [info ] [Thread-3 (]: 3 of 8 START sql view model analytics.stg_orders ............................... [RUN]
[0m16:03:12.287076 [info ] [Thread-4 (]: 4 of 8 START sql view model analytics.stg_products ............................. [RUN]
[0m16:03:12.287534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.ci_cd_project.stg_order_items)
[0m16:03:12.287889 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m16:03:12.288320 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m16:03:12.288755 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m16:03:12.289097 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m16:03:12.298505 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m16:03:12.298876 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:03:12.299215 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m16:03:12.302873 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m16:03:12.306363 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:03:12.310634 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m16:03:12.311115 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m16:03:12.330125 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m16:03:12.347569 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m16:03:12.348661 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m16:03:12.349015 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m16:03:12.349337 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:03:12.353170 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m16:03:12.356845 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:03:12.357282 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.357771 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.358172 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m16:03:12.358517 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m16:03:12.358904 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.359232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:12.359580 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:12.359917 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.360238 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m16:03:12.360663 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:03:12.360979 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:12.361283 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:12.397029 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m16:03:12.397410 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.397766 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m16:03:12.398119 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:03:12.398429 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m16:03:12.398762 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m16:03:12.399119 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.399442 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.399755 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.400607 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m16:03:12.400994 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m16:03:12.401363 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:03:12.401685 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.408448 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.408817 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:03:12.409155 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "dev"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m16:03:12.409477 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:03:12.413362 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.413670 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:03:12.417142 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.417504 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "dev"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m16:03:12.417817 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:03:12.421062 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.421413 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m16:03:12.424659 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.425015 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view "dev"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m16:03:12.425324 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:12.425720 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m16:03:12.426153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.429776 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.430130 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:12.433384 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.433743 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m16:03:12.434056 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:03:12.437200 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.437547 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:03:12.444190 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m16:03:12.453025 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:03:12.453405 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m16:03:12.453856 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.454219 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.454555 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.455652 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:03:12.456826 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:03:12.457172 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:03:12.458217 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:03:12.458556 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.458875 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.459264 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.459612 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:03:12.459951 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.460251 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:03:12.460558 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:03:12.465679 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:12.466090 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:03:12.466480 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.466791 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m16:03:12.470331 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:12.470655 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:12.473333 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:12.473738 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m16:03:12.476488 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:12.476828 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.477140 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m16:03:12.477534 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m16:03:12.479719 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m16:03:12.480090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.481578 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cf430>]}
[0m16:03:12.481959 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.483017 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m16:03:12.483327 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.483870 [info ] [Thread-2 (]: 2 of 8 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.19s]
[0m16:03:12.484983 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m16:03:12.485427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c231930>]}
[0m16:03:12.486445 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m16:03:12.486926 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m16:03:12.487336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3f0940>]}
[0m16:03:12.487851 [info ] [Thread-1 (]: 1 of 8 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.20s]
[0m16:03:12.488306 [debug] [Thread-2 (]: Began running node model.ci_cd_project.tmp_new
[0m16:03:12.488858 [info ] [Thread-3 (]: 3 of 8 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.20s]
[0m16:03:12.489436 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m16:03:12.489882 [info ] [Thread-2 (]: 5 of 8 START sql table model analytics.tmp_new ................................. [RUN]
[0m16:03:12.490458 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:03:12.490934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.tmp_new)
[0m16:03:12.491422 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:03:12.494282 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:03:12.494699 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_customers
[0m16:03:12.495295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ed480>]}
[0m16:03:12.495750 [info ] [Thread-1 (]: 6 of 8 START sql table model analytics.dim_customers ........................... [RUN]
[0m16:03:12.496958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now model.ci_cd_project.dim_customers)
[0m16:03:12.497343 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:03:12.496484 [info ] [Thread-4 (]: 4 of 8 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.21s]
[0m16:03:12.497761 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:03:12.510454 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m16:03:12.519315 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:03:12.522948 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:03:12.523707 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_products
[0m16:03:12.524229 [info ] [Thread-3 (]: 7 of 8 START sql table model analytics.dim_products ............................ [RUN]
[0m16:03:12.524644 [debug] [Thread-4 (]: Began running node model.ci_cd_project.fct_orders
[0m16:03:12.525058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now model.ci_cd_project.dim_products)
[0m16:03:12.525511 [info ] [Thread-4 (]: 8 of 8 START sql table model analytics.fct_orders .............................. [RUN]
[0m16:03:12.525887 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:03:12.526191 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_products
[0m16:03:12.526534 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.526892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.fct_orders)
[0m16:03:12.530800 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:03:12.535128 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m16:03:12.535506 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:03:12.535847 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:03:12.536308 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:12.575713 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:03:12.576285 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.576757 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_products
[0m16:03:12.577076 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:03:12.580739 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m16:03:12.581164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:12.581530 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:03:12.585218 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:03:12.616793 [debug] [Thread-2 (]: SQL status: OK in 0.080 seconds
[0m16:03:12.617292 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.617628 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.617983 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m16:03:12.618353 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: BEGIN
[0m16:03:12.618723 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.619048 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:03:12.619390 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.619701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:12.620016 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:03:12.620482 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:03:12.620918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:12.621394 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.621741 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.622104 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.622425 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.625646 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.626071 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m16:03:12.626479 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.626833 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "dev"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m16:03:12.627463 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:03:12.628176 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.632275 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.632639 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m16:03:12.632994 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:03:12.633330 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:03:12.633700 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:03:12.634010 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.637143 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.640249 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.643341 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.648297 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:03:12.648681 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m16:03:12.649036 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table "dev"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m16:03:12.649379 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m16:03:12.649710 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.650299 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.650650 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:03:12.650955 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.651294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.654540 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.657816 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.660935 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.661247 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:03:12.661579 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:03:12.661931 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m16:03:12.662265 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:03:12.664984 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:12.665504 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.665849 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m16:03:12.667687 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:03:12.668003 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.668379 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.668713 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.669870 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:03:12.670181 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.671290 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:03:12.671621 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:03:12.671938 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.672983 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: Close
[0m16:03:12.673323 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.673703 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:03:12.674025 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:03:12.674460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3102e0>]}
[0m16:03:12.674780 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:03:12.677608 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:12.677931 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.678463 [info ] [Thread-2 (]: 5 of 8 OK created sql table model analytics.tmp_new ............................ [[32mOK[0m in 0.18s]
[0m16:03:12.678892 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m16:03:12.679222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:12.681892 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:12.682366 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:03:12.685115 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:12.685515 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m16:03:12.685895 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:03:12.686345 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m16:03:12.687742 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: Close
[0m16:03:12.688275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c595930>]}
[0m16:03:12.688636 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.690234 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: Close
[0m16:03:12.690573 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:03:12.689192 [info ] [Thread-4 (]: 8 of 8 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.16s]
[0m16:03:12.691072 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a3670>]}
[0m16:03:12.692143 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: Close
[0m16:03:12.692616 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:03:12.693133 [info ] [Thread-3 (]: 7 of 8 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.17s]
[0m16:03:12.693754 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_products
[0m16:03:12.705852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1e19aa-0a93-4a59-a444-5dcde3445371', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c5930>]}
[0m16:03:12.706446 [info ] [Thread-1 (]: 6 of 8 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.21s]
[0m16:03:12.706960 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:03:12.707906 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:12.708195 [debug] [MainThread]: On master: BEGIN
[0m16:03:12.708461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:12.745847 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m16:03:12.746233 [debug] [MainThread]: On master: COMMIT
[0m16:03:12.746529 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:12.746894 [debug] [MainThread]: On master: COMMIT
[0m16:03:12.747396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:12.747720 [debug] [MainThread]: On master: Close
[0m16:03:12.748753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:12.749038 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m16:03:12.749293 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m16:03:12.749538 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m16:03:12.749782 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m16:03:12.750154 [info ] [MainThread]: 
[0m16:03:12.750465 [info ] [MainThread]: Finished running 4 view models, 4 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m16:03:12.751802 [debug] [MainThread]: Command end result
[0m16:03:12.823358 [info ] [MainThread]: 
[0m16:03:12.823815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:12.824129 [info ] [MainThread]: 
[0m16:03:12.824440 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:03:12.827447 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8254759, "process_in_blocks": "0", "process_kernel_time": 0.430086, "process_mem_max_rss": "171704320", "process_out_blocks": "0", "process_user_time": 3.43763}
[0m16:03:12.827862 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:12.827781 after 1.83 seconds
[0m16:03:12.828209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee5db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1d8d0>]}
[0m16:03:12.828549 [debug] [MainThread]: Flushing usage events
[0m16:03:41.695743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1aeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1af010>]}


============================== 16:03:41.700528 | 5830247b-df12-4d1e-bf18-626041346f71 ==============================
[0m16:03:41.700528 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:03:41.701065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:03:41.830808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1afe20>]}
[0m16:03:41.918437 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-eraa8srp'
[0m16:03:41.918897 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:03:42.118488 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:03:42.119236 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:03:42.169930 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:03:42.176953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m16:03:42.227555 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m16:03:42.233938 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m16:03:42.281440 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m16:03:42.283038 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m16:03:42.283732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b332cb0>]}
[0m16:03:42.289399 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:03:42.337803 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:03:42.340125 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:03:42.386056 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:03:42.389049 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:03:42.827605 [info ] [MainThread]: Installed from version 1.1.1
[0m16:03:42.828024 [info ] [MainThread]: Updated version available: 1.3.1
[0m16:03:42.828382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b433f10>]}
[0m16:03:42.828739 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m16:03:43.176957 [info ] [MainThread]: Installed from version 0.11.0
[0m16:03:43.177382 [info ] [MainThread]: Updated version available: 1.0.2
[0m16:03:43.177739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b430760>]}
[0m16:03:43.178104 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m16:03:44.524970 [info ] [MainThread]: Installed from version 0.10.3
[0m16:03:44.525417 [info ] [MainThread]: Updated version available: 0.10.4
[0m16:03:44.525777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4334f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b433310>]}
[0m16:03:44.526137 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:03:44.882329 [info ] [MainThread]: Installed from version 0.12.1
[0m16:03:44.882762 [info ] [MainThread]: Updated version available: 0.13.1
[0m16:03:44.883122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b433550>]}
[0m16:03:44.883485 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:03:45.176838 [info ] [MainThread]: Installed from version 0.10.1
[0m16:03:45.177261 [info ] [MainThread]: Up to date!
[0m16:03:45.177624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5830247b-df12-4d1e-bf18-626041346f71', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4331f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b430a90>]}
[0m16:03:45.177992 [info ] [MainThread]: 
[0m16:03:45.178311 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m16:03:45.181820 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.5472455, "process_in_blocks": "0", "process_kernel_time": 0.408058, "process_mem_max_rss": "114049024", "process_out_blocks": "0", "process_user_time": 1.480837}
[0m16:03:45.182299 [debug] [MainThread]: Command `dbt deps` succeeded at 16:03:45.182200 after 3.55 seconds
[0m16:03:45.182656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097219c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de2da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfc100>]}
[0m16:03:45.183005 [debug] [MainThread]: Flushing usage events
[0m16:03:47.340676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d735c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d735180>]}


============================== 16:03:47.345035 | 4f3312de-32f9-41e4-998d-493a1cd8027e ==============================
[0m16:03:47.345035 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:03:47.345569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:47.575837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c344e50>]}
[0m16:03:47.625283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caed8d0>]}
[0m16:03:47.629996 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:03:47.751038 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:03:47.950196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:47.950627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:48.003962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df98640>]}
[0m16:03:48.181284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deb8070>]}
[0m16:03:48.181792 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:03:48.182132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deb9f90>]}
[0m16:03:48.184180 [info ] [MainThread]: 
[0m16:03:48.184666 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:48.189756 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:03:48.247520 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:03:48.247922 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m16:03:48.248239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:48.392651 [debug] [ThreadPool]: SQL status: OK in 0.144 seconds
[0m16:03:48.440107 [debug] [ThreadPool]: On list_dev: Close
[0m16:03:48.460943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m16:03:48.461658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m16:03:48.468236 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:48.472745 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m16:03:48.473220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:48.471914 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:48.476488 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m16:03:48.476987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:48.515262 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:03:48.515688 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:03:48.516008 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:48.516313 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:48.516621 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m16:03:48.516941 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m16:03:48.531211 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:03:48.531612 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:03:48.532942 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m16:03:48.534016 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m16:03:48.534811 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m16:03:48.535187 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m16:03:48.535460 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m16:03:48.535755 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m16:03:48.538564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b2f50>]}
[0m16:03:48.538993 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:48.539273 [debug] [MainThread]: On master: BEGIN
[0m16:03:48.539536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:48.574885 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m16:03:48.575239 [debug] [MainThread]: On master: COMMIT
[0m16:03:48.575533 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:48.575812 [debug] [MainThread]: On master: COMMIT
[0m16:03:48.576192 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:48.576555 [debug] [MainThread]: On master: Close
[0m16:03:48.577599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:48.577957 [info ] [MainThread]: 
[0m16:03:48.579818 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:03:48.580370 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:03:48.580839 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_dev.raw_customers ............................. [RUN]
[0m16:03:48.581235 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:03:48.581574 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m16:03:48.581991 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_dev.raw_order_items ........................... [RUN]
[0m16:03:48.582425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m16:03:48.582867 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_dev.raw_orders ................................ [RUN]
[0m16:03:48.583415 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_dev.raw_products .............................. [RUN]
[0m16:03:48.583922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m16:03:48.584320 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:03:48.584771 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m16:03:48.585193 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m16:03:48.585520 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:03:48.585846 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:03:48.586162 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:03:48.586469 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:03:48.586780 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:03:48.601460 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:03:48.604419 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:03:48.628094 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:48.632022 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:48.637322 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:48.637704 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:03:48.641270 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:48.641629 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:03:48.641950 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:03:48.642266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:48.642585 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:03:48.642888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:48.643186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:48.643592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:48.680189 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:03:48.680585 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:48.680937 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m16:03:48.681283 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m16:03:48.681598 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m16:03:48.681890 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:03:48.682211 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:48.683339 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:48.683713 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:48.684060 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m16:03:48.684418 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m16:03:48.684792 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m16:03:48.685702 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:48.686040 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:48.686353 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:48.686649 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:48.697565 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:48.698585 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:48.699534 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:48.700457 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:48.700806 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:48.701148 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:48.701482 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:48.701810 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:48.713050 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:03:48.713433 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:03:48.713788 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m16:03:48.714118 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:03:48.719186 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:03:48.719726 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:03:48.720222 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:03:48.720702 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:03:48.739077 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:03:48.740715 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:03:48.744115 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:03:48.745204 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:03:48.745547 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:48.745890 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:48.746221 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:48.746550 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:48.746868 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:03:48.747176 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:03:48.747511 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:03:48.747845 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:03:48.750993 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:48.752860 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:03:48.753840 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:03:48.754203 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:03:48.754762 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:03:48.755325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2bdab0>]}
[0m16:03:48.755967 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m16:03:48.756582 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:03:48.757183 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:03:48.757644 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_dev.raw_orders ............................ [[32mINSERT 10[0m in 0.17s]
[0m16:03:48.758148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2bdbd0>]}
[0m16:03:48.758592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df0cb20>]}
[0m16:03:48.759158 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:03:48.759627 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_dev.raw_products .......................... [[32mINSERT 10[0m in 0.17s]
[0m16:03:48.759999 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_dev.raw_order_items ....................... [[32mINSERT 14[0m in 0.17s]
[0m16:03:48.760726 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:03:48.761239 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:03:48.773370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f3312de-32f9-41e4-998d-493a1cd8027e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2f4400>]}
[0m16:03:48.773933 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_dev.raw_customers ......................... [[32mINSERT 10[0m in 0.19s]
[0m16:03:48.774478 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:03:48.775484 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:48.775816 [debug] [MainThread]: On master: BEGIN
[0m16:03:48.776104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:48.815009 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m16:03:48.815395 [debug] [MainThread]: On master: COMMIT
[0m16:03:48.815696 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:48.815977 [debug] [MainThread]: On master: COMMIT
[0m16:03:48.816364 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:48.816717 [debug] [MainThread]: On master: Close
[0m16:03:48.817736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:48.818016 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m16:03:48.818270 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m16:03:48.818522 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m16:03:48.818768 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m16:03:48.819087 [info ] [MainThread]: 
[0m16:03:48.819398 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:03:48.820317 [debug] [MainThread]: Command end result
[0m16:03:48.891179 [info ] [MainThread]: 
[0m16:03:48.891643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:48.891959 [info ] [MainThread]: 
[0m16:03:48.892276 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:03:48.894413 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.6091015, "process_in_blocks": "0", "process_kernel_time": 0.376581, "process_mem_max_rss": "180387840", "process_out_blocks": "0", "process_user_time": 3.048703}
[0m16:03:48.894798 [debug] [MainThread]: Command `dbt seed` succeeded at 16:03:48.894723 after 1.61 seconds
[0m16:03:48.895137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d09be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caed8d0>]}
[0m16:03:48.895469 [debug] [MainThread]: Flushing usage events
[0m16:03:50.932764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1bd930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc52dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc53250>]}


============================== 16:03:50.936918 | 124fbcd8-a66c-4ae8-aa07-22f25c537bb3 ==============================
[0m16:03:50.936918 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:03:50.937459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --target dev', 'send_anonymous_usage_stats': 'True'}
[0m16:03:51.140719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdb0490>]}
[0m16:03:51.190617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd1abf0>]}
[0m16:03:51.194418 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:03:51.311308 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m16:03:51.433058 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:03:51.433489 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m16:03:51.433827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c037d60>]}
[0m16:03:53.716737 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:03:53.717261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0169b0>]}
[0m16:03:54.101124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:03:54.101611 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:03:54.101944 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:03:54.102247 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:03:54.102539 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:03:54.102825 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:03:54.103114 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:03:54.103398 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:03:54.103674 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:03:54.103952 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:03:54.104228 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:03:54.104504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:03:54.104784 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:03:54.105064 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:03:54.105339 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:03:54.105615 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:03:54.105889 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:03:54.106161 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:03:54.106432 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:03:54.106706 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:03:54.106980 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:03:54.107256 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:03:54.107532 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:03:54.107807 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:03:54.108080 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:03:54.108351 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:03:54.108626 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:03:54.108903 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:03:54.216006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d70ec50>]}
[0m16:03:54.370953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d66e710>]}
[0m16:03:54.371442 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:03:54.375720 [info ] [MainThread]: 
[0m16:03:54.376278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:54.382289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:03:54.389026 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:03:54.427998 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:03:54.428362 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:03:54.428694 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m16:03:54.429029 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m16:03:54.429336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:54.429617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:54.477841 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m16:03:54.478215 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m16:03:54.479355 [debug] [ThreadPool]: On list_dev: Close
[0m16:03:54.480418 [debug] [ThreadPool]: On list_dev: Close
[0m16:03:54.482877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics_dev)
[0m16:03:54.488725 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:54.489151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m16:03:54.489473 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m16:03:54.491930 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:54.492224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:54.492499 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m16:03:54.492833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:54.528382 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m16:03:54.528717 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m16:03:54.529009 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m16:03:54.529318 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m16:03:54.529626 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m16:03:54.530030 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m16:03:54.538965 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m16:03:54.539325 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m16:03:54.540438 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m16:03:54.541653 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m16:03:54.542141 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m16:03:54.542563 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m16:03:54.542839 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m16:03:54.543109 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m16:03:54.545830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6fe1d0>]}
[0m16:03:54.546288 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:54.546589 [debug] [MainThread]: On master: BEGIN
[0m16:03:54.546867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:54.583235 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m16:03:54.583550 [debug] [MainThread]: On master: COMMIT
[0m16:03:54.583832 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:54.584101 [debug] [MainThread]: On master: COMMIT
[0m16:03:54.584470 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:54.584743 [debug] [MainThread]: On master: Close
[0m16:03:54.585750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:54.586062 [info ] [MainThread]: 
[0m16:03:54.589193 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m16:03:54.589656 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:03:54.590063 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:03:54.590888 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:03:54.590558 [info ] [Thread-1 (]: 1 of 53 START sql table model analytics.tmp_new ................................ [RUN]
[0m16:03:54.591812 [info ] [Thread-2 (]: 2 of 53 START seed file analytics_dev.raw_customers ............................ [RUN]
[0m16:03:54.592348 [info ] [Thread-3 (]: 3 of 53 START seed file analytics_dev.raw_order_items .......................... [RUN]
[0m16:03:54.592816 [info ] [Thread-4 (]: 4 of 53 START seed file analytics_dev.raw_orders ............................... [RUN]
[0m16:03:54.593788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now model.ci_cd_project.tmp_new)
[0m16:03:54.594266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m16:03:54.594708 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_order_items'
[0m16:03:54.595200 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m16:03:54.595540 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:03:54.595862 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:03:54.596177 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:03:54.607069 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:03:54.596557 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:03:54.606203 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:03:54.623282 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:03:54.604918 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:03:54.681999 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:54.683922 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:54.684326 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:03:54.685304 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:03:54.688975 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:54.689314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:54.689664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:54.690039 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:03:54.690360 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:03:54.735039 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:54.748164 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m16:03:54.748536 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:54.752614 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:03:54.752984 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m16:03:54.753313 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m16:03:54.753642 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m16:03:54.754158 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:54.754559 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:54.754947 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.755268 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.755581 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m16:03:54.755917 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m16:03:54.756239 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:03:54.766909 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:54.767484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:54.767894 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.768233 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:54.768546 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.769643 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:54.769990 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:54.771062 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:54.771415 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:54.771738 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.772062 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:54.772522 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      dev.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:03:54.773615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.779945 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.780328 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m16:03:54.780698 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "dev"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m16:03:54.781072 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:03:54.781383 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:03:54.786288 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:03:54.786902 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:03:54.787387 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:03:54.787702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.791258 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.791726 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table dev.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m16:03:54.809404 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:03:54.811156 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:03:54.815034 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:03:54.815390 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:03:54.815756 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:03:54.816095 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:03:54.816434 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:03:54.816755 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:03:54.822381 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:03:54.822756 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:03:54.823085 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:03:54.823484 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.823993 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:03:54.824796 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.826849 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:03:54.827291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:54.827665 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:54.827990 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:03:54.833307 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:03:54.834647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65f9a0>]}
[0m16:03:54.835350 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:03:54.835980 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:03:54.836329 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists dev.analytics.tmp_new__dbt_backup cascade
[0m16:03:54.836798 [info ] [Thread-2 (]: 2 of 53 OK loaded seed file analytics_dev.raw_customers ........................ [[32mINSERT 10[0m in 0.24s]
[0m16:03:54.837320 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65cd00>]}
[0m16:03:54.837747 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65fd60>]}
[0m16:03:54.838356 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:03:54.838821 [info ] [Thread-4 (]: 4 of 53 OK loaded seed file analytics_dev.raw_orders ........................... [[32mINSERT 10[0m in 0.24s]
[0m16:03:54.839179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.839607 [info ] [Thread-3 (]: 3 of 53 OK loaded seed file analytics_dev.raw_order_items ...................... [[32mINSERT 14[0m in 0.24s]
[0m16:03:54.840027 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_products
[0m16:03:54.840545 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:03:54.841753 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m16:03:54.842357 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:03:54.842900 [info ] [Thread-2 (]: 5 of 53 START seed file analytics_dev.raw_products ............................. [RUN]
[0m16:03:54.843379 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_customers
[0m16:03:54.843931 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m16:03:54.844437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.raw_products)
[0m16:03:54.845310 [info ] [Thread-4 (]: 6 of 53 START sql view model analytics.stg_customers ........................... [RUN]
[0m16:03:54.846207 [info ] [Thread-3 (]: 7 of 53 START sql view model analytics.stg_orders .............................. [RUN]
[0m16:03:54.846845 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:03:54.847300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_customers)
[0m16:03:54.847737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_orders)
[0m16:03:54.848139 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:03:54.848513 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_customers
[0m16:03:54.848854 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:03:54.855962 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m16:03:54.856458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d65d390>]}
[0m16:03:54.860877 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:03:54.866074 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:54.866738 [info ] [Thread-1 (]: 1 of 53 OK created sql table model analytics.tmp_new ........................... [[32mOK[0m in 0.26s]
[0m16:03:54.867250 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:03:54.867760 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:03:54.868106 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_customers
[0m16:03:54.868429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:54.868732 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:03:54.869109 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_order_items
[0m16:03:54.887377 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m16:03:54.891240 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:03:54.921475 [info ] [Thread-1 (]: 8 of 53 START sql view model analytics.stg_order_items ......................... [RUN]
[0m16:03:54.922094 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m16:03:54.922631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.tmp_new, now model.ci_cd_project.stg_order_items)
[0m16:03:54.923069 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:54.923484 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.923846 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m16:03:54.924198 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.924547 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m16:03:54.924874 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:03:54.929278 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m16:03:54.929678 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m16:03:54.930207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:54.930623 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.930968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:54.932176 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:54.932552 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_order_items
[0m16:03:54.932874 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:54.933292 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:03:54.933632 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:03:54.937283 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m16:03:54.937645 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.938060 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.938483 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:03:54.938868 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m16:03:54.939393 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:54.939745 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:03:54.940161 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m16:03:54.943546 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.943879 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:54.944218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:54.944568 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:03:54.944879 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m16:03:54.948238 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.948836 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:03:54.949187 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:03:54.949829 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "dev"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m16:03:54.950208 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.950531 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:54.951727 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:03:54.955588 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.955940 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:03:54.956273 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m16:03:54.956635 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:03:54.956970 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:03:54.960186 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.960632 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:03:54.961027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:03:54.961377 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m16:03:54.961711 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.965111 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:54.965457 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:03:54.966608 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:03:54.966966 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "dev"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m16:03:54.967292 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.967993 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_products: Close
[0m16:03:54.968371 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.969593 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:03:54.969938 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.970384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c021de0>]}
[0m16:03:54.970724 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:03:54.971059 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.974342 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:54.974845 [info ] [Thread-2 (]: 5 of 53 OK loaded seed file analytics_dev.raw_products ......................... [[32mINSERT 10[0m in 0.13s]
[0m16:03:54.975309 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:03:54.975666 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:03:54.975992 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m16:03:54.976486 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:03:54.980064 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:03:54.980484 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:54.981248 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.981675 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m16:03:54.982065 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_products
[0m16:03:54.984908 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:03:54.986034 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:03:54.986584 [info ] [Thread-2 (]: 9 of 53 START sql view model analytics.stg_products ............................ [RUN]
[0m16:03:54.986987 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m16:03:54.987347 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:54.987662 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:54.988028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m16:03:54.997715 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m16:03:54.998146 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m16:03:54.999138 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:03:54.999654 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_products
[0m16:03:55.012236 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddc5e10>]}
[0m16:03:55.020898 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: Close
[0m16:03:55.029440 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd8e770>]}
[0m16:03:55.026756 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m16:03:55.027913 [info ] [Thread-3 (]: 7 of 53 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.16s]
[0m16:03:55.030060 [info ] [Thread-4 (]: 6 of 53 OK created sql view model analytics.stg_customers ...................... [[32mOK[0m in 0.18s]
[0m16:03:55.027266 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.031599 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_products
[0m16:03:55.035181 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:03:55.035985 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_customers
[0m16:03:55.039441 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:03:55.044146 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m16:03:55.044974 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m16:03:55.045404 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:03:55.045840 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:03:55.046520 [info ] [Thread-3 (]: 10 of 53 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:03:55.047021 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.047569 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.047948 [info ] [Thread-4 (]: 11 of 53 START test not_null_stg_customers_email ............................... [RUN]
[0m16:03:55.048398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:03:55.048780 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: BEGIN
[0m16:03:55.049996 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: Close
[0m16:03:55.050407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m16:03:55.050778 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:03:55.051105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.051493 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:03:55.058554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d48c970>]}
[0m16:03:55.060812 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:03:55.065415 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:03:55.066051 [info ] [Thread-1 (]: 8 of 53 OK created sql view model analytics.stg_order_items .................... [[32mOK[0m in 0.14s]
[0m16:03:55.066863 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_order_items
[0m16:03:55.067325 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:03:55.067809 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:03:55.068293 [info ] [Thread-1 (]: 12 of 53 START test not_null_stg_customers_first_name .......................... [RUN]
[0m16:03:55.082029 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:03:55.118241 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:03:55.118801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m16:03:55.119234 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m16:03:55.122334 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:03:55.122808 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:03:55.123199 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.123699 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:03:55.127821 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:03:55.128259 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m16:03:55.128647 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:03:55.129016 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:03:55.129574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.129960 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m16:03:55.130300 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:03:55.130653 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.131027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.131361 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.134156 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:03:55.138304 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.138758 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:03:55.139112 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:03:55.139504 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view "dev"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m16:03:55.139886 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.140229 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:03:55.140580 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:03:55.141054 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:03:55.141395 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.141741 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m16:03:55.145020 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.145372 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.145754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.146105 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m16:03:55.146488 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.149338 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:03:55.149828 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.150184 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:03:55.151286 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m16:03:55.151725 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m16:03:55.152051 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:03:55.153149 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:03:55.153559 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m16:03:55.153870 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:03:55.154228 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.154580 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.154890 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m16:03:55.155405 [info ] [Thread-3 (]: 10 of 53 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.11s]
[0m16:03:55.155884 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:03:55.156391 [info ] [Thread-4 (]: 11 of 53 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.11s]
[0m16:03:55.156881 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:03:55.157255 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.157713 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:03:55.158010 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.158382 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:03:55.159626 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m16:03:55.160000 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:03:55.163031 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:03:55.163432 [info ] [Thread-3 (]: 13 of 53 START test not_null_stg_customers_last_name ........................... [RUN]
[0m16:03:55.164221 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m16:03:55.164561 [info ] [Thread-4 (]: 14 of 53 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m16:03:55.164951 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m16:03:55.165331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m16:03:55.165660 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m16:03:55.165998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m16:03:55.166412 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:03:55.166795 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:03:55.167270 [info ] [Thread-1 (]: 12 of 53 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.05s]
[0m16:03:55.171569 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:03:55.171919 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:03:55.176813 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:03:55.177328 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:03:55.178534 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: Close
[0m16:03:55.179004 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:03:55.179457 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:03:55.179942 [info ] [Thread-1 (]: 15 of 53 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:03:55.183198 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:03:55.183543 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:03:55.184002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec7820>]}
[0m16:03:55.184377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:03:55.187328 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:03:55.187919 [info ] [Thread-2 (]: 9 of 53 OK created sql view model analytics.stg_products ....................... [[32mOK[0m in 0.20s]
[0m16:03:55.188326 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:03:55.188879 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_products
[0m16:03:55.189245 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:03:55.193435 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:03:55.193880 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:03:55.194305 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m16:03:55.194700 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:03:55.195278 [info ] [Thread-2 (]: 16 of 53 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m16:03:55.195686 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.196030 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:03:55.196367 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m16:03:55.196759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m16:03:55.200691 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:03:55.201116 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.201567 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:03:55.278879 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:03:55.279453 [debug] [Thread-3 (]: SQL status: OK in 0.084 seconds
[0m16:03:55.279948 [debug] [Thread-4 (]: SQL status: OK in 0.079 seconds
[0m16:03:55.280370 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:03:55.280739 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:03:55.281102 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:03:55.281460 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:03:55.281793 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:03:55.282136 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.282514 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.282850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.285729 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:03:55.286475 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.286845 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.287166 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.287504 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:03:55.287909 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:03:55.289182 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m16:03:55.290330 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m16:03:55.290681 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.291040 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m16:03:55.291490 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:03:55.291838 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m16:03:55.292221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.292545 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m16:03:55.292869 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m16:03:55.293191 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.294100 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.293820 [info ] [Thread-4 (]: 14 of 53 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m16:03:55.294642 [info ] [Thread-3 (]: 13 of 53 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.13s]
[0m16:03:55.295808 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:03:55.296122 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:03:55.296631 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:03:55.297116 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:03:55.297521 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:03:55.297863 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.298269 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:03:55.298685 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:03:55.299037 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:03:55.299475 [info ] [Thread-4 (]: 17 of 53 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m16:03:55.300278 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.299941 [info ] [Thread-3 (]: 18 of 53 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:03:55.300863 [info ] [Thread-1 (]: 15 of 53 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.12s]
[0m16:03:55.301243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:03:55.301680 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m16:03:55.302822 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m16:03:55.303284 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:03:55.303620 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:03:55.303938 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:03:55.304349 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m16:03:55.304704 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:03:55.309822 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:03:55.316053 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:03:55.316461 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m16:03:55.316845 [info ] [Thread-1 (]: 19 of 53 START test unique_stg_customers_email ................................. [RUN]
[0m16:03:55.317602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m16:03:55.317987 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:03:55.318326 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:03:55.318790 [info ] [Thread-2 (]: 16 of 53 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.12s]
[0m16:03:55.319171 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:03:55.323140 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:03:55.327131 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:03:55.327651 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:03:55.330580 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:03:55.331283 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:03:55.332152 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:03:55.333080 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:03:55.332749 [info ] [Thread-2 (]: 20 of 53 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:03:55.333630 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:03:55.336490 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:03:55.336901 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:03:55.337269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m16:03:55.337606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.338019 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m16:03:55.338377 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:03:55.338899 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:03:55.339260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.344221 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:03:55.344602 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m16:03:55.345037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.345459 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:03:55.348283 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:03:55.380695 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m16:03:55.381097 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m16:03:55.381457 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:03:55.381869 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:03:55.382192 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.382524 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:03:55.382890 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.383241 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:03:55.383588 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:03:55.383980 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.384460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.384818 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.385483 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.385829 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:03:55.386163 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.388104 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.388506 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.388860 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.389167 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.390469 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:03:55.391694 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m16:03:55.392890 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:03:55.393963 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m16:03:55.394372 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m16:03:55.394741 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m16:03:55.395113 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m16:03:55.395482 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m16:03:55.395795 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:03:55.396119 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m16:03:55.396457 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:03:55.396789 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m16:03:55.397312 [info ] [Thread-2 (]: 20 of 53 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m16:03:55.397843 [info ] [Thread-1 (]: 19 of 53 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.08s]
[0m16:03:55.398359 [info ] [Thread-3 (]: 18 of 53 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.10s]
[0m16:03:55.398918 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:03:55.399374 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:03:55.399831 [info ] [Thread-4 (]: 17 of 53 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.10s]
[0m16:03:55.400304 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:03:55.400677 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:03:55.401089 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:03:55.401586 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:03:55.401949 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:03:55.402313 [info ] [Thread-2 (]: 21 of 53 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m16:03:55.402726 [info ] [Thread-1 (]: 22 of 53 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m16:03:55.403166 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:03:55.403554 [info ] [Thread-3 (]: 23 of 53 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m16:03:55.404018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m16:03:55.404384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m16:03:55.404732 [info ] [Thread-4 (]: 24 of 53 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m16:03:55.405097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m16:03:55.405430 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:03:55.405738 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:03:55.406078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m16:03:55.406405 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:03:55.410899 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:03:55.415276 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:03:55.415656 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:03:55.420909 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:03:55.425188 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:03:55.425757 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:03:55.426124 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:03:55.428945 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:03:55.431820 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:03:55.432166 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:03:55.432513 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:03:55.436068 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:03:55.438869 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:03:55.439254 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:03:55.439703 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:03:55.440137 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m16:03:55.440489 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m16:03:55.440924 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:03:55.441246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.441594 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:03:55.441894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.442225 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m16:03:55.442623 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m16:03:55.442974 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.443288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.478532 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.478923 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:03:55.479264 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m16:03:55.479567 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:03:55.479859 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.480175 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.480514 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:03:55.480823 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:03:55.481127 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:03:55.481556 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.481942 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.482278 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.482604 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.484155 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m16:03:55.484605 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m16:03:55.484939 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.485247 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m16:03:55.485556 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.485878 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.487061 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m16:03:55.487601 [info ] [Thread-2 (]: 21 of 53 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.08s]
[0m16:03:55.488754 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m16:03:55.489211 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m16:03:55.489709 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:03:55.490764 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m16:03:55.491155 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m16:03:55.491474 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m16:03:55.491863 [debug] [Thread-2 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:03:55.492299 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m16:03:55.492634 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m16:03:55.493112 [info ] [Thread-3 (]: 23 of 53 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.09s]
[0m16:03:55.493548 [info ] [Thread-2 (]: 25 of 53 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m16:03:55.493934 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m16:03:55.494437 [info ] [Thread-4 (]: 24 of 53 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.09s]
[0m16:03:55.494922 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:03:55.495373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m16:03:55.495927 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:03:55.496319 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:03:55.496792 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:03:55.497283 [info ] [Thread-1 (]: 22 of 53 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.09s]
[0m16:03:55.497689 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:03:55.498040 [info ] [Thread-3 (]: 26 of 53 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m16:03:55.503470 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:03:55.504002 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:03:55.504358 [info ] [Thread-4 (]: 27 of 53 START test not_null_stg_products_cost ................................. [RUN]
[0m16:03:55.504755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m16:03:55.505207 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:03:55.505605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m16:03:55.505976 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:03:55.506325 [info ] [Thread-1 (]: 28 of 53 START test not_null_stg_products_price ................................ [RUN]
[0m16:03:55.506662 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:03:55.506980 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:03:55.511161 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:03:55.511546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m16:03:55.515691 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:03:55.519681 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:03:55.520115 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:03:55.524529 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:03:55.524963 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:03:55.527768 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:03:55.528193 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:03:55.528627 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:03:55.528964 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:03:55.529338 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m16:03:55.533172 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:03:55.533556 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:03:55.536268 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:03:55.536624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.537029 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m16:03:55.537626 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:03:55.537940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.538289 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:03:55.538628 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m16:03:55.538984 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m16:03:55.539306 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.539615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.576782 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.577188 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:03:55.577542 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m16:03:55.577878 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.578200 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.578489 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.578810 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:03:55.579238 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:03:55.579571 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:03:55.579963 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.580367 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.580726 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.581043 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.582968 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m16:03:55.583445 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m16:03:55.583796 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.584145 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.584456 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.584760 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m16:03:55.585975 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m16:03:55.587160 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m16:03:55.588216 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m16:03:55.588639 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m16:03:55.589478 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m16:03:55.589156 [info ] [Thread-3 (]: 26 of 53 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.08s]
[0m16:03:55.589971 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m16:03:55.590296 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m16:03:55.590613 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m16:03:55.591073 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:03:55.591396 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m16:03:55.591892 [info ] [Thread-1 (]: 28 of 53 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.08s]
[0m16:03:55.592383 [info ] [Thread-4 (]: 27 of 53 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.09s]
[0m16:03:55.592798 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:03:55.593354 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:03:55.593806 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:03:55.594254 [info ] [Thread-2 (]: 25 of 53 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.10s]
[0m16:03:55.594685 [info ] [Thread-3 (]: 29 of 53 START test not_null_stg_products_product_id ........................... [RUN]
[0m16:03:55.595195 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:03:55.595618 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:03:55.596163 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:03:55.596598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m16:03:55.596974 [info ] [Thread-1 (]: 30 of 53 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m16:03:55.597608 [info ] [Thread-4 (]: 31 of 53 START test unique_stg_products_product_id ............................. [RUN]
[0m16:03:55.598078 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_customers
[0m16:03:55.598449 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:03:55.598813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m16:03:55.599168 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m16:03:55.599625 [info ] [Thread-2 (]: 32 of 53 START sql table model analytics.dim_customers ......................... [RUN]
[0m16:03:55.604177 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:03:55.604557 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:03:55.604888 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:03:55.605251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.ci_cd_project.dim_customers)
[0m16:03:55.610317 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:03:55.616008 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:03:55.616394 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:03:55.616737 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:03:55.620509 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:03:55.623394 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:03:55.623758 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:03:55.624235 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:03:55.626983 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:03:55.630658 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:03:55.631039 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:03:55.631460 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:03:55.635194 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:03:55.635622 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:03:55.636051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.636434 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:03:55.636821 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:03:55.637285 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.637606 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:03:55.637956 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m16:03:55.638283 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:03:55.638600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.638917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.639226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.674846 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.675266 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:03:55.675601 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.675909 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.676241 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.676562 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m16:03:55.676888 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:03:55.677198 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:03:55.677638 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.678061 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.678430 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.678773 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.679171 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:03:55.680735 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:03:55.681192 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.681785 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m16:03:55.682118 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.682505 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:03:55.683697 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m16:03:55.684964 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:03:55.685348 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.685847 [info ] [Thread-3 (]: 29 of 53 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m16:03:55.686337 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m16:03:55.686718 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m16:03:55.690225 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.690728 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:03:55.691054 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m16:03:55.691377 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m16:03:55.691705 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m16:03:55.692318 [info ] [Thread-4 (]: 31 of 53 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:03:55.692852 [info ] [Thread-1 (]: 30 of 53 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.09s]
[0m16:03:55.693466 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:03:55.693932 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:03:55.694259 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.697893 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.698274 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:03:55.698839 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_products
[0m16:03:55.699241 [debug] [Thread-4 (]: Began running node model.ci_cd_project.fct_orders
[0m16:03:55.699688 [info ] [Thread-3 (]: 33 of 53 START sql table model analytics.dim_products .......................... [RUN]
[0m16:03:55.700027 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.700428 [info ] [Thread-4 (]: 34 of 53 START sql table model analytics.fct_orders ............................ [RUN]
[0m16:03:55.700820 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now model.ci_cd_project.dim_products)
[0m16:03:55.702102 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:03:55.702469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now model.ci_cd_project.fct_orders)
[0m16:03:55.702804 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_products
[0m16:03:55.703126 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.703437 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:03:55.708374 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m16:03:55.708738 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:03:55.712658 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:03:55.713479 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:03:55.713886 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_products
[0m16:03:55.717711 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:03:55.718049 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:03:55.721580 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m16:03:55.725203 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:03:55.725679 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m16:03:55.726064 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.726499 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:03:55.726859 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.727179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.727487 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.727790 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: BEGIN
[0m16:03:55.728989 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: Close
[0m16:03:55.729329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.729653 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.730139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df58d60>]}
[0m16:03:55.730584 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.730945 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.731474 [info ] [Thread-2 (]: 32 of 53 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.12s]
[0m16:03:55.731914 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:03:55.732303 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.732765 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:03:55.733309 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m16:03:55.734144 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:03:55.734508 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:03:55.734893 [info ] [Thread-1 (]: 35 of 53 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m16:03:55.735775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m16:03:55.735250 [info ] [Thread-2 (]: 36 of 53 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m16:03:55.736304 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:03:55.736687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:03:55.737013 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.737361 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.741842 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:03:55.742218 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:03:55.745469 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.748754 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.796354 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:03:55.796847 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table "dev"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m16:03:55.797217 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m16:03:55.797592 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:03:55.800805 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:03:55.801300 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.801674 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.805020 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.808366 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.808741 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:03:55.809081 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m16:03:55.809474 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:03:55.809799 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:03:55.813207 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:03:55.813650 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m16:03:55.814061 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.814415 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:03:55.814742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.815927 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:03:55.817036 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:03:55.817410 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:03:55.817823 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.818154 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:55.818450 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.818766 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:03:55.819079 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:03:55.819394 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:03:55.819700 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:03:55.820000 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.820393 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m16:03:55.820734 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:03:55.821383 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.824177 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:03:55.824533 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.824834 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:03:55.825134 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:03:55.825457 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m16:03:55.828183 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:03:55.828598 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.829788 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m16:03:55.830215 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m16:03:55.830757 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m16:03:55.831095 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m16:03:55.831421 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.831751 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.832075 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.833585 [debug] [Thread-3 (]: On model.ci_cd_project.dim_products: Close
[0m16:03:55.832573 [info ] [Thread-1 (]: 35 of 53 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.10s]
[0m16:03:55.834746 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: Close
[0m16:03:55.835798 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:03:55.836254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd82b30>]}
[0m16:03:55.836741 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:03:55.837142 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '124fbcd8-a66c-4ae8-aa07-22f25c537bb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd82c80>]}
[0m16:03:55.837538 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m16:03:55.838063 [info ] [Thread-3 (]: 33 of 53 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.14s]
[0m16:03:55.838520 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:03:55.839132 [info ] [Thread-4 (]: 34 of 53 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.13s]
[0m16:03:55.839497 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:03:55.840008 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_products
[0m16:03:55.840527 [info ] [Thread-1 (]: 37 of 53 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m16:03:55.841074 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:03:55.841489 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:03:55.841954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m16:03:55.842476 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:03:55.843010 [info ] [Thread-3 (]: 38 of 53 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m16:03:55.843387 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:03:55.843737 [info ] [Thread-4 (]: 39 of 53 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m16:03:55.844187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m16:03:55.849149 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:03:55.849576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m16:03:55.849952 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:03:55.850375 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:03:55.855745 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:03:55.856295 [info ] [Thread-2 (]: 36 of 53 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.12s]
[0m16:03:55.860368 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:03:55.860846 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:03:55.861338 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:03:55.864557 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:03:55.865000 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:03:55.865406 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:03:55.865737 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:03:55.866104 [info ] [Thread-2 (]: 40 of 53 START test unique_dim_customers_customer_id ........................... [RUN]
[0m16:03:55.868964 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:03:55.872614 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:03:55.873024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m16:03:55.873396 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:03:55.873877 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:03:55.874267 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m16:03:55.878308 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:03:55.878709 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:03:55.879086 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:03:55.879408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.879843 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m16:03:55.880232 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m16:03:55.880674 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:03:55.881015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.881327 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.884151 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:03:55.884750 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:03:55.885078 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m16:03:55.885378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:55.918523 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.918915 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:03:55.919254 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m16:03:55.919654 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.919974 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:03:55.920292 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:03:55.920583 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m16:03:55.920943 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:03:55.921362 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.921709 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:03:55.921996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.922319 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m16:03:55.922771 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:55.923189 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.924528 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m16:03:55.924950 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:55.926205 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m16:03:55.926600 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m16:03:55.926938 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:03:55.928064 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m16:03:55.928446 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m16:03:55.928771 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m16:03:55.929941 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m16:03:55.930311 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m16:03:55.930627 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m16:03:55.931041 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m16:03:55.931545 [info ] [Thread-1 (]: 37 of 53 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.09s]
[0m16:03:55.931914 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m16:03:55.932420 [info ] [Thread-3 (]: 38 of 53 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.09s]
[0m16:03:55.932779 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m16:03:55.933240 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:03:55.933695 [info ] [Thread-4 (]: 39 of 53 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.08s]
[0m16:03:55.934160 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:03:55.934599 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:03:55.935108 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:03:55.935485 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:03:55.935903 [info ] [Thread-2 (]: 40 of 53 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m16:03:55.936311 [info ] [Thread-1 (]: 41 of 53 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m16:03:55.936696 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:03:55.937063 [info ] [Thread-3 (]: 42 of 53 START test not_null_dim_products_performance_category ................. [RUN]
[0m16:03:55.937575 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:03:55.937959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m16:03:55.938343 [info ] [Thread-4 (]: 43 of 53 START test not_null_dim_products_product_id ........................... [RUN]
[0m16:03:55.938729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m16:03:55.939117 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:03:55.939482 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:03:55.939836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m16:03:55.940159 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:03:55.940482 [info ] [Thread-2 (]: 44 of 53 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m16:03:55.945180 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:03:55.945548 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:03:55.951209 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:03:55.951584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m16:03:55.955626 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:03:55.956063 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:03:55.960154 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:03:55.960522 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:03:55.960894 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:03:55.963787 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:03:55.964165 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:03:55.967933 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:03:55.968372 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:03:55.971048 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:03:55.973876 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:03:55.974373 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:03:55.974754 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:03:55.975163 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m16:03:55.975622 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:03:55.975957 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m16:03:55.976290 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:03:55.976618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:55.976947 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m16:03:55.977256 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:55.977569 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m16:03:55.977939 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:55.978272 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:56.013553 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m16:03:56.013907 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m16:03:56.014231 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:03:56.014593 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m16:03:56.014943 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:03:56.015284 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m16:03:56.015632 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m16:03:56.015981 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:03:56.016313 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.016643 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:03:56.017085 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.017619 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.018025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.018345 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.019818 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m16:03:56.021030 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m16:03:56.021417 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m16:03:56.021739 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:03:56.022033 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:03:56.022396 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m16:03:56.022722 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m16:03:56.023919 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m16:03:56.025002 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m16:03:56.025329 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m16:03:56.026244 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m16:03:56.026586 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m16:03:56.025884 [info ] [Thread-3 (]: 42 of 53 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.09s]
[0m16:03:56.027060 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m16:03:56.027504 [info ] [Thread-1 (]: 41 of 53 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.09s]
[0m16:03:56.027866 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m16:03:56.028342 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:03:56.028814 [info ] [Thread-4 (]: 43 of 53 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m16:03:56.029298 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:03:56.029711 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:03:56.030199 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:03:56.030658 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:03:56.031146 [info ] [Thread-2 (]: 44 of 53 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.08s]
[0m16:03:56.031574 [info ] [Thread-3 (]: 45 of 53 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m16:03:56.032071 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:03:56.032464 [info ] [Thread-1 (]: 46 of 53 START test unique_dim_products_product_id ............................. [RUN]
[0m16:03:56.032957 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:03:56.033496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m16:03:56.033889 [info ] [Thread-4 (]: 47 of 53 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m16:03:56.034307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m16:03:56.034695 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:03:56.035056 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:03:56.035423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m16:03:56.035755 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:03:56.036086 [info ] [Thread-2 (]: 48 of 53 START test not_null_fct_orders_order_id ............................... [RUN]
[0m16:03:56.040622 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:03:56.040992 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:03:56.046234 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:03:56.046684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m16:03:56.051145 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:03:56.051618 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:03:56.055662 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:03:56.056090 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:03:56.056451 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:03:56.059183 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:03:56.063032 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:03:56.063432 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:03:56.063817 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:03:56.066591 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:03:56.069350 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:03:56.069845 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:03:56.070203 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:03:56.070700 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m16:03:56.071096 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m16:03:56.071456 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:03:56.071760 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:56.072094 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:03:56.072419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:56.072744 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m16:03:56.073131 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m16:03:56.073471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:56.073776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:56.110852 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:03:56.111195 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m16:03:56.111505 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:03:56.111833 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:03:56.112177 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m16:03:56.112512 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:03:56.112828 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:03:56.113184 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.113523 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:03:56.113851 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.114202 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:56.114653 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.115088 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.115491 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:03:56.116911 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m16:03:56.118127 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m16:03:56.118508 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m16:03:56.118829 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:03:56.119186 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m16:03:56.119511 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:03:56.119819 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m16:03:56.120932 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m16:03:56.121246 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m16:03:56.121810 [info ] [Thread-3 (]: 45 of 53 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.09s]
[0m16:03:56.122221 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m16:03:56.123350 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m16:03:56.123824 [info ] [Thread-4 (]: 47 of 53 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.09s]
[0m16:03:56.124325 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:03:56.124643 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m16:03:56.125145 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:03:56.125472 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m16:03:56.125842 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:03:56.126351 [info ] [Thread-1 (]: 46 of 53 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:03:56.126747 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:03:56.127070 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m16:03:56.127432 [info ] [Thread-3 (]: 49 of 53 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m16:03:56.127919 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:03:56.128256 [info ] [Thread-4 (]: 50 of 53 START test not_null_fct_orders_product_id ............................. [RUN]
[0m16:03:56.128701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m16:03:56.129084 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:03:56.129711 [info ] [Thread-2 (]: 48 of 53 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m16:03:56.130265 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m16:03:56.130608 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:03:56.130946 [info ] [Thread-1 (]: 51 of 53 START test not_null_fct_orders_quantity ............................... [RUN]
[0m16:03:56.131413 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:03:56.131721 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:03:56.136166 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:03:56.136575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m16:03:56.136976 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:03:56.142395 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:03:56.142842 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:03:56.143192 [info ] [Thread-2 (]: 52 of 53 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m16:03:56.147466 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:03:56.147866 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:03:56.148254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m16:03:56.148685 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:03:56.151530 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:03:56.151912 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:03:56.152234 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:03:56.154963 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:03:56.159895 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:03:56.162679 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:03:56.163193 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:03:56.163898 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:03:56.164263 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m16:03:56.164647 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m16:03:56.165019 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:03:56.165347 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:03:56.165664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:56.165989 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:56.166309 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m16:03:56.169041 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:03:56.169475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:56.169993 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:03:56.170311 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m16:03:56.170607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:56.208404 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m16:03:56.208819 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:03:56.209147 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m16:03:56.209474 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.209781 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m16:03:56.210064 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m16:03:56.210372 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:03:56.210809 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:03:56.211182 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:03:56.211494 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.211830 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.212185 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.212535 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m16:03:56.213893 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m16:03:56.214626 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m16:03:56.214987 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m16:03:56.215337 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.215656 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.215983 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:03:56.217121 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m16:03:56.217613 [info ] [Thread-3 (]: 49 of 53 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.09s]
[0m16:03:56.218842 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m16:03:56.219947 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m16:03:56.220325 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m16:03:56.220799 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:03:56.221168 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m16:03:56.221522 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m16:03:56.221831 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m16:03:56.222203 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:03:56.222569 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m16:03:56.222906 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m16:03:56.223283 [info ] [Thread-3 (]: 53 of 53 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m16:03:56.223810 [info ] [Thread-2 (]: 52 of 53 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.08s]
[0m16:03:56.224323 [info ] [Thread-4 (]: 50 of 53 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:03:56.224805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m16:03:56.225286 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:03:56.225736 [info ] [Thread-1 (]: 51 of 53 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m16:03:56.226208 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:03:56.226528 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:03:56.227046 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:03:56.231926 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:03:56.232658 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:03:56.235527 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:03:56.236078 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:03:56.236407 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m16:03:56.236712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:56.276930 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m16:03:56.277323 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:03:56.277673 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:03:56.278556 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:03:56.279878 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m16:03:56.280291 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m16:03:56.280606 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m16:03:56.281726 [info ] [Thread-3 (]: 53 of 53 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.06s]
[0m16:03:56.282264 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:03:56.283274 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:56.283555 [debug] [MainThread]: On master: BEGIN
[0m16:03:56.283810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:56.320532 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m16:03:56.320910 [debug] [MainThread]: On master: COMMIT
[0m16:03:56.321196 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:56.321462 [debug] [MainThread]: On master: COMMIT
[0m16:03:56.321795 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:03:56.322065 [debug] [MainThread]: On master: Close
[0m16:03:56.323073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:56.323387 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m16:03:56.323646 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m16:03:56.323891 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m16:03:56.324132 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m16:03:56.324541 [info ] [MainThread]: 
[0m16:03:56.324853 [info ] [MainThread]: Finished running 4 seeds, 4 table models, 4 view models, 41 data tests in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m16:03:56.330879 [debug] [MainThread]: Command end result
[0m16:03:56.448778 [info ] [MainThread]: 
[0m16:03:56.449237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:56.449600 [info ] [MainThread]: 
[0m16:03:56.449920 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=0 SKIP=0 TOTAL=53
[0m16:03:56.452477 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.576114, "process_in_blocks": "0", "process_kernel_time": 0.453479, "process_mem_max_rss": "195346432", "process_out_blocks": "0", "process_user_time": 8.978223}
[0m16:03:56.452889 [debug] [MainThread]: Command `dbt build` succeeded at 16:03:56.452810 after 5.58 seconds
[0m16:03:56.453229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1bd930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8713f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d871c00>]}
[0m16:03:56.453571 [debug] [MainThread]: Flushing usage events
[0m16:04:55.705580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f3250>]}


============================== 16:04:55.710353 | 8a0fac9a-b47a-46d0-a81e-5afce355fbe0 ==============================
[0m16:04:55.710353 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:04:55.710923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build -s state:modified+ --state ./state --target pr --vars schema_id: pr_999__local', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:55.971213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d28bca0>]}
[0m16:04:56.020846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb72620>]}
[0m16:04:56.024952 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:04:56.147922 [debug] [MainThread]: checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, vars: {'schema_id': 'pr_999__local'}, profile: , target: pr, version: 1.8.9
[0m16:04:56.271868 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:04:56.272291 [debug] [MainThread]: previous checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m16:04:56.272583 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:04:56.272912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a7760>]}
[0m16:04:58.589802 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:04:58.590315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d586c80>]}
[0m16:04:58.979240 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:04:58.979727 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:04:58.980065 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:04:58.980373 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:04:58.980663 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:04:58.980952 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:04:58.981241 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:04:58.981527 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:04:58.981809 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:04:58.982094 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:04:58.982375 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:04:58.982655 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:04:58.982937 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:04:58.983218 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:04:58.983497 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:04:58.983773 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:04:58.984052 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:04:58.984327 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:04:58.984603 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:04:58.984882 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:04:58.985161 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:04:58.985441 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:04:58.985721 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:04:58.986009 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:04:58.986287 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:04:58.986563 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:04:58.986841 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:04:58.987119 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:04:59.096639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7be20>]}
[0m16:04:59.383953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da69ae0>]}
[0m16:04:59.384482 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:04:59.393456 [info ] [MainThread]: 
[0m16:04:59.394009 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:04:59.399280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:04:59.451189 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:04:59.451591 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:04:59.451900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:59.606271 [debug] [ThreadPool]: SQL status: OK in 0.154 seconds
[0m16:04:59.608197 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:04:59.610428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now create_pr_999__local_analytics__pr_999__local)
[0m16:04:59.611059 [debug] [ThreadPool]: Creating schema "database: "pr_999__local"
schema: "analytics__pr_999__local"
"
[0m16:04:59.618122 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics__pr_999__local"
[0m16:04:59.618487 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_analytics__pr_999__local"} */

    
        select type from duckdb_databases()
        where database_name='pr_999__local'
        and type='sqlite'
    
  
[0m16:04:59.618882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:59.657805 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:04:59.659197 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics__pr_999__local"
[0m16:04:59.659512 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: BEGIN
[0m16:04:59.659905 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:04:59.660249 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics__pr_999__local"
[0m16:04:59.660556 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_analytics__pr_999__local"} */

    
    
        create schema if not exists pr_999__local.analytics__pr_999__local
    
[0m16:04:59.661852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:04:59.662664 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: COMMIT
[0m16:04:59.663026 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics__pr_999__local"
[0m16:04:59.663329 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: COMMIT
[0m16:04:59.663958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:04:59.664268 [debug] [ThreadPool]: On create_pr_999__local_analytics__pr_999__local: Close
[0m16:04:59.666903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pr_999__local_analytics__pr_999__local, now list_pr_999__local_analytics__pr_999__local)
[0m16:04:59.667383 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_pr_999__local__pr_999__local'
[0m16:04:59.673048 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics__pr_999__local"
[0m16:04:59.676271 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_pr_999__local__pr_999__local"
[0m16:04:59.676586 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: BEGIN
[0m16:04:59.676882 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: BEGIN
[0m16:04:59.677177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:59.677451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:59.715337 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:04:59.715677 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics__pr_999__local"
[0m16:04:59.715966 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:04:59.716260 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics__pr_999__local"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics__pr_999__local'
    and table_catalog = 'pr_999__local'
  
[0m16:04:59.716562 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_pr_999__local__pr_999__local"
[0m16:04:59.716959 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_pr_999__local__pr_999__local"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'pr_999__local__pr_999__local'
    and table_catalog = 'pr_999__local'
  
[0m16:04:59.731235 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:04:59.731569 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:04:59.732623 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: ROLLBACK
[0m16:04:59.733654 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: ROLLBACK
[0m16:04:59.734450 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics__pr_999__local'
[0m16:04:59.734815 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_pr_999__local__pr_999__local'
[0m16:04:59.735083 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: Close
[0m16:04:59.735386 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: Close
[0m16:04:59.736707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2a8af0>]}
[0m16:04:59.737127 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:59.737410 [debug] [MainThread]: On master: BEGIN
[0m16:04:59.737680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:59.775974 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m16:04:59.776355 [debug] [MainThread]: On master: COMMIT
[0m16:04:59.776652 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:59.776932 [debug] [MainThread]: On master: COMMIT
[0m16:04:59.777481 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:04:59.777907 [debug] [MainThread]: On master: Close
[0m16:04:59.779002 [info ] [MainThread]: Concurrency: 4 threads (target='pr')
[0m16:04:59.779349 [info ] [MainThread]: 
[0m16:04:59.781168 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m16:04:59.781575 [debug] [Thread-2 (]: Began running node model.ci_cd_project.tmp_new
[0m16:04:59.782097 [info ] [Thread-1 (]: 1 of 23 START sql view model analytics__pr_999__local.stg_orders ............... [RUN]
[0m16:04:59.782575 [info ] [Thread-2 (]: 2 of 23 START sql table model analytics__pr_999__local.tmp_new ................. [RUN]
[0m16:04:59.783048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics__pr_999__local, now model.ci_cd_project.stg_orders)
[0m16:04:59.783611 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_pr_999__local__pr_999__local, now model.ci_cd_project.tmp_new)
[0m16:04:59.784018 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:04:59.784533 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:04:59.793722 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:04:59.796248 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:04:59.796959 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:04:59.797329 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:04:59.846387 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:04:59.853631 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:04:59.854943 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:04:59.855351 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:04:59.855714 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:04:59.856064 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:04:59.856401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:59.856726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:59.893681 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m16:04:59.894080 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:04:59.894418 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:04:59.894752 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      pr_999__local.analytics__pr_999__local.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:04:59.895088 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:04:59.895486 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics__pr_999__local.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:04:59.899108 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:04:59.905638 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:04:59.906017 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
alter table pr_999__local.analytics__pr_999__local.tmp_new__dbt_tmp rename to tmp_new
[0m16:04:59.907043 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:04:59.914705 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics__pr_999__local.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:04:59.921530 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:04:59.924551 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:04:59.925020 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: ROLLBACK
[0m16:04:59.925382 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:04:59.925836 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:04:59.927036 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:04:59.932971 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:04:59.933385 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists pr_999__local.analytics__pr_999__local.tmp_new__dbt_backup cascade
[0m16:04:59.933896 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:04:59.936217 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: Close
[0m16:04:59.937525 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da686d0>]}
[0m16:04:59.938104 [info ] [Thread-2 (]: 2 of 23 OK created sql table model analytics__pr_999__local.tmp_new ............ [[32mOK[0m in 0.15s]
[0m16:04:59.938727 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:04:59.942030 [debug] [Thread-1 (]: Failed to rollback 'model.ci_cd_project.stg_orders'
[0m16:04:59.942389 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m16:04:59.945119 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "prod.analytics.raw_orders"?
  
  LINE 8:     select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
                            ^
[0m16:04:59.945587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a0fac9a-b47a-46d0-a81e-5afce355fbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbe5c90>]}
[0m16:04:59.946460 [error] [Thread-1 (]: 1 of 23 ERROR creating sql view model analytics__pr_999__local.stg_orders ...... [[31mERROR[0m in 0.16s]
[0m16:04:59.947137 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:04:59.948106 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:04:59.948502 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:04:59.948900 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:04:59.949558 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:04:59.949269 [info ] [Thread-4 (]: 3 of 23 SKIP test not_null_stg_orders_customer_id .............................. [[33mSKIP[0m]
[0m16:04:59.950025 [info ] [Thread-3 (]: 4 of 23 SKIP test not_null_stg_orders_order_id ................................. [[33mSKIP[0m]
[0m16:04:59.950427 [info ] [Thread-2 (]: 5 of 23 SKIP test not_null_stg_orders_total_amount ............................. [[33mSKIP[0m]
[0m16:04:59.950846 [info ] [Thread-1 (]: 6 of 23 SKIP test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mSKIP[0m]
[0m16:04:59.951239 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:04:59.951623 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:04:59.952003 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:04:59.952372 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:04:59.952795 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:04:59.953225 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:04:59.953831 [info ] [Thread-4 (]: 7 of 23 SKIP test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mSKIP[0m]
[0m16:04:59.954246 [info ] [Thread-3 (]: 8 of 23 SKIP test unique_stg_orders_order_id ................................... [[33mSKIP[0m]
[0m16:04:59.954652 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:04:59.955011 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:04:59.955630 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_customers
[0m16:04:59.955989 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m16:04:59.956382 [info ] [Thread-2 (]: 9 of 23 SKIP relation analytics__pr_999__local.dim_customers ................... [[33mSKIP[0m]
[0m16:04:59.956802 [info ] [Thread-1 (]: 10 of 23 SKIP relation analytics__pr_999__local.fct_orders ..................... [[33mSKIP[0m]
[0m16:04:59.957194 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:04:59.957551 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:04:59.958208 [debug] [Thread-3 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:04:59.958563 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:04:59.959049 [info ] [Thread-3 (]: 11 of 23 SKIP test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[33mSKIP[0m]
[0m16:04:59.959473 [info ] [Thread-4 (]: 12 of 23 SKIP test not_null_dim_customers_customer_id .......................... [[33mSKIP[0m]
[0m16:04:59.959879 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:04:59.960212 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:04:59.960552 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:04:59.960903 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:04:59.961250 [info ] [Thread-2 (]: 13 of 23 SKIP test not_null_dim_customers_customer_tier ........................ [[33mSKIP[0m]
[0m16:04:59.961622 [info ] [Thread-1 (]: 14 of 23 SKIP test not_null_dim_customers_total_orders ......................... [[33mSKIP[0m]
[0m16:04:59.962000 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:04:59.962399 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:04:59.962826 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:04:59.963242 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:04:59.963604 [info ] [Thread-3 (]: 15 of 23 SKIP test not_null_dim_customers_total_spent .......................... [[33mSKIP[0m]
[0m16:04:59.964165 [info ] [Thread-4 (]: 16 of 23 SKIP test unique_dim_customers_customer_id ............................ [[33mSKIP[0m]
[0m16:04:59.964599 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:04:59.965046 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:04:59.965510 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:04:59.965908 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:04:59.966285 [info ] [Thread-2 (]: 17 of 23 SKIP test not_null_fct_orders_customer_id ............................. [[33mSKIP[0m]
[0m16:04:59.967016 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:04:59.966598 [info ] [Thread-1 (]: 18 of 23 SKIP test not_null_fct_orders_order_id ................................ [[33mSKIP[0m]
[0m16:04:59.967526 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:04:59.967932 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:04:59.968293 [info ] [Thread-3 (]: 19 of 23 SKIP test not_null_fct_orders_order_item_id ........................... [[33mSKIP[0m]
[0m16:04:59.968669 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:04:59.969016 [info ] [Thread-4 (]: 20 of 23 SKIP test not_null_fct_orders_product_id .............................. [[33mSKIP[0m]
[0m16:04:59.969400 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:04:59.969792 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:04:59.970163 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:04:59.970554 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:04:59.970908 [info ] [Thread-2 (]: 21 of 23 SKIP test not_null_fct_orders_quantity ................................ [[33mSKIP[0m]
[0m16:04:59.971293 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:04:59.971683 [info ] [Thread-1 (]: 22 of 23 SKIP test not_null_fct_orders_unit_price .............................. [[33mSKIP[0m]
[0m16:04:59.972184 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:04:59.972586 [info ] [Thread-3 (]: 23 of 23 SKIP test unique_fct_orders_order_item_id ............................. [[33mSKIP[0m]
[0m16:04:59.973001 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:04:59.973466 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:04:59.974432 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:59.974720 [debug] [MainThread]: On master: BEGIN
[0m16:04:59.974985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:00.015528 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m16:05:00.015910 [debug] [MainThread]: On master: COMMIT
[0m16:05:00.016210 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:00.016490 [debug] [MainThread]: On master: COMMIT
[0m16:05:00.016860 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:00.017198 [debug] [MainThread]: On master: Close
[0m16:05:00.018230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:00.018505 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m16:05:00.018759 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m16:05:00.019129 [info ] [MainThread]: 
[0m16:05:00.019445 [info ] [MainThread]: Finished running 3 table models, 1 view model, 19 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:05:00.020668 [debug] [MainThread]: Command end result
[0m16:05:00.092845 [info ] [MainThread]: 
[0m16:05:00.093275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:00.093579 [info ] [MainThread]: 
[0m16:05:00.093952 [error] [MainThread]:   Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "prod.analytics.raw_orders"?
  
  LINE 8:     select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
                            ^
[0m16:05:00.094265 [info ] [MainThread]: 
[0m16:05:00.094569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=21 TOTAL=23
[0m16:05:00.098010 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.4518785, "process_in_blocks": "0", "process_kernel_time": 0.417219, "process_mem_max_rss": "167198720", "process_out_blocks": "0", "process_user_time": 6.04587}
[0m16:05:00.098414 [debug] [MainThread]: Command `dbt build` failed at 16:05:00.098336 after 4.45 seconds
[0m16:05:00.098812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb72620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7b730>]}
[0m16:05:00.099245 [debug] [MainThread]: Flushing usage events
[0m16:06:03.572363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63ee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d63f2b0>]}


============================== 16:06:03.577234 | addeb4f8-9924-4da7-989c-66b80be80db7 ==============================
[0m16:06:03.577234 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:06:03.577798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --target dev', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:06:03.837176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0edcc0>]}
[0m16:06:03.886767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5a560>]}
[0m16:06:03.890981 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:06:04.014150 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m16:06:04.138116 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:06:04.138536 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84
[0m16:06:04.138827 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:06:04.139151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c6e30>]}
[0m16:06:06.490679 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:06:06.491186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d847f40>]}
[0m16:06:06.876330 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:06:06.876828 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:06:06.877164 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:06:06.877475 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:06:06.877770 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:06:06.878058 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:06:06.878343 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:06:06.878630 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:06:06.878913 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:06:06.879193 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:06:06.879471 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:06:06.879919 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:06:06.880291 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:06:06.880613 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:06:06.880912 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:06:06.881204 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:06:06.881488 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:06:06.881768 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:06:06.882046 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:06:06.882323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:06:06.882606 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:06:06.882884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:06:06.883161 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:06:06.883444 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:06:06.883717 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:06:06.883995 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:06:06.884271 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:06:06.884544 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:06:06.991793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e041660>]}
[0m16:06:07.154072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df35150>]}
[0m16:06:07.154606 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:06:07.159015 [info ] [MainThread]: 
[0m16:06:07.159523 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:06:07.165424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:06:07.177105 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:06:07.219989 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:06:07.220367 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:06:07.220695 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:06:07.221027 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:06:07.221333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:07.221614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:07.370783 [debug] [ThreadPool]: SQL status: OK in 0.149 seconds
[0m16:06:07.371208 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m16:06:07.372632 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:06:07.373639 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:06:07.375749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now create_pr_999__local_analytics_dev)
[0m16:06:07.376122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now create_pr_999__local_analytics)
[0m16:06:07.376737 [debug] [ThreadPool]: Creating schema "database: "pr_999__local"
schema: "analytics_dev"
"
[0m16:06:07.377142 [debug] [ThreadPool]: Creating schema "database: "pr_999__local"
schema: "analytics"
"
[0m16:06:07.384113 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_dev"
[0m16:06:07.387176 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics"
[0m16:06:07.387492 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_pr_999__local_analytics_dev"} */

    
        select type from duckdb_databases()
        where database_name='pr_999__local'
        and type='sqlite'
    
  
[0m16:06:07.387810 [debug] [ThreadPool]: On create_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_pr_999__local_analytics"} */

    
        select type from duckdb_databases()
        where database_name='pr_999__local'
        and type='sqlite'
    
  
[0m16:06:07.388104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:07.388373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:07.425911 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:07.426289 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:07.428273 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_dev"
[0m16:06:07.429359 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics"
[0m16:06:07.429674 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: BEGIN
[0m16:06:07.429978 [debug] [ThreadPool]: On create_pr_999__local_analytics: BEGIN
[0m16:06:07.430398 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:06:07.430683 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_dev"
[0m16:06:07.430962 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:06:07.431257 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_pr_999__local_analytics_dev"} */

    
    
        create schema if not exists pr_999__local.analytics_dev
    
[0m16:06:07.431555 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics"
[0m16:06:07.432155 [debug] [ThreadPool]: On create_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_pr_999__local_analytics"} */

    
    
        create schema if not exists pr_999__local.analytics
    
[0m16:06:07.432516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:06:07.433254 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: COMMIT
[0m16:06:07.433554 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_dev"
[0m16:06:07.433834 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: COMMIT
[0m16:06:07.434105 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:06:07.434848 [debug] [ThreadPool]: On create_pr_999__local_analytics: COMMIT
[0m16:06:07.435134 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics"
[0m16:06:07.435410 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:06:07.435677 [debug] [ThreadPool]: On create_pr_999__local_analytics: COMMIT
[0m16:06:07.435965 [debug] [ThreadPool]: On create_pr_999__local_analytics_dev: Close
[0m16:06:07.436515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:06:07.436793 [debug] [ThreadPool]: On create_pr_999__local_analytics: Close
[0m16:06:07.441313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pr_999__local_analytics_dev, now list_pr_999__local_analytics_dev)
[0m16:06:07.441756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pr_999__local_analytics, now list_pr_999__local_analytics)
[0m16:06:07.447426 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics_dev"
[0m16:06:07.449894 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:06:07.450228 [debug] [ThreadPool]: On list_pr_999__local_analytics_dev: BEGIN
[0m16:06:07.450550 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m16:06:07.450837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:07.451117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:07.489229 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:07.489568 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics_dev"
[0m16:06:07.489856 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:06:07.490179 [debug] [ThreadPool]: On list_pr_999__local_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_pr_999__local_analytics_dev"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'pr_999__local'
  
[0m16:06:07.490496 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:06:07.490892 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m16:06:07.503553 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:06:07.503933 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:06:07.505248 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m16:06:07.506238 [debug] [ThreadPool]: On list_pr_999__local_analytics_dev: ROLLBACK
[0m16:06:07.507108 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m16:06:07.507458 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics_dev'
[0m16:06:07.507744 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m16:06:07.508033 [debug] [ThreadPool]: On list_pr_999__local_analytics_dev: Close
[0m16:06:07.509394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e042b00>]}
[0m16:06:07.509847 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:07.510138 [debug] [MainThread]: On master: BEGIN
[0m16:06:07.510408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:07.552322 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m16:06:07.552703 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.553003 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:07.553282 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.553659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:06:07.553951 [debug] [MainThread]: On master: Close
[0m16:06:07.555104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:07.555510 [info ] [MainThread]: 
[0m16:06:07.557566 [debug] [Thread-1 (]: Began running node model.ci_cd_project.tmp_new
[0m16:06:07.557969 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:06:07.558740 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:06:07.558453 [info ] [Thread-1 (]: 1 of 53 START sql table model analytics.tmp_new ................................ [RUN]
[0m16:06:07.559331 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:06:07.559757 [info ] [Thread-2 (]: 2 of 53 START seed file analytics_dev.raw_customers ............................ [RUN]
[0m16:06:07.560817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics_dev, now model.ci_cd_project.tmp_new)
[0m16:06:07.560308 [info ] [Thread-3 (]: 3 of 53 START seed file analytics_dev.raw_order_items .......................... [RUN]
[0m16:06:07.561371 [info ] [Thread-4 (]: 4 of 53 START seed file analytics_dev.raw_orders ............................... [RUN]
[0m16:06:07.561948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now seed.ci_cd_project.raw_customers)
[0m16:06:07.562361 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:06:07.562826 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_order_items'
[0m16:06:07.563263 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m16:06:07.563610 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:06:07.571793 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:06:07.572173 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:06:07.572527 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:06:07.572867 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:06:07.573346 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:06:07.573674 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:06:07.617573 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:06:07.679895 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:07.690630 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:06:07.691026 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:06:07.693237 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:07.695351 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:07.695848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:07.696195 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:06:07.696580 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:06:07.697037 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:06:07.697377 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:06:07.697691 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:07.698033 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:06:07.698424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:07.737150 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m16:06:07.737645 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m16:06:07.738070 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m16:06:07.738407 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:07.738754 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m16:06:07.739068 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:07.739391 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:07.739729 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table pr_999__local.analytics_dev.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m16:06:07.740064 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:06:07.740395 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table pr_999__local.analytics_dev.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m16:06:07.740745 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table pr_999__local.analytics_dev.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m16:06:07.741219 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      pr_999__local.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:06:07.741693 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.742182 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.753290 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:07.753706 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:06:07.754024 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:06:07.755005 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:07.755392 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: 
          COPY pr_999__local.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:07.756389 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:07.762883 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:06:07.763245 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: 
          COPY pr_999__local.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:07.763706 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: 
          COPY pr_999__local.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:07.764060 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
alter table pr_999__local.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m16:06:07.764957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:07.783075 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:06:07.783510 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m16:06:07.783903 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:06:07.784261 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m16:06:07.784591 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:06:07.789444 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:06:07.789826 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:06:07.790321 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:06:07.790803 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:06:07.792676 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:06:07.793101 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:07.794425 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:06:07.794790 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:06:07.795109 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:06:07.796367 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:06:07.796722 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:07.803496 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:06:07.803961 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:07.804350 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:06:07.804685 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:06:07.805036 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists pr_999__local.analytics.tmp_new__dbt_backup cascade
[0m16:06:07.805387 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:06:07.807140 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:06:07.808736 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc4faf0>]}
[0m16:06:07.809101 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.809450 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.809764 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.811292 [debug] [Thread-1 (]: On model.ci_cd_project.tmp_new: Close
[0m16:06:07.810206 [info ] [Thread-4 (]: 4 of 53 OK loaded seed file analytics_dev.raw_orders ........................... [[32mINSERT 10[0m in 0.24s]
[0m16:06:07.812001 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:06:07.812694 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:06:07.813143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2f1f0>]}
[0m16:06:07.813648 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:06:07.814071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da50850>]}
[0m16:06:07.815039 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m16:06:07.814678 [info ] [Thread-1 (]: 1 of 53 OK created sql table model analytics.tmp_new ........................... [[32mOK[0m in 0.25s]
[0m16:06:07.815727 [info ] [Thread-2 (]: 2 of 53 OK loaded seed file analytics_dev.raw_customers ........................ [[32mINSERT 10[0m in 0.25s]
[0m16:06:07.816323 [info ] [Thread-4 (]: 5 of 53 START seed file analytics_dev.raw_products ............................. [RUN]
[0m16:06:07.817173 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:06:07.817920 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:06:07.818371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now seed.ci_cd_project.raw_products)
[0m16:06:07.818902 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m16:06:07.819374 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:06:07.820176 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_customers
[0m16:06:07.819873 [info ] [Thread-1 (]: 6 of 53 START sql view model analytics.stg_orders .............................. [RUN]
[0m16:06:07.820606 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:06:07.821029 [info ] [Thread-2 (]: 7 of 53 START sql view model analytics.stg_customers ........................... [RUN]
[0m16:06:07.821447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.tmp_new, now model.ci_cd_project.stg_orders)
[0m16:06:07.825924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e012aa0>]}
[0m16:06:07.826301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now model.ci_cd_project.stg_customers)
[0m16:06:07.827278 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:06:07.827774 [info ] [Thread-3 (]: 3 of 53 OK loaded seed file analytics_dev.raw_order_items ...................... [[32mINSERT 14[0m in 0.26s]
[0m16:06:07.831862 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:07.832197 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_customers
[0m16:06:07.835936 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:06:07.836469 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:06:07.836815 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:06:07.840206 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m16:06:07.840946 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:07.841331 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_order_items
[0m16:06:07.841868 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:06:07.842300 [info ] [Thread-3 (]: 8 of 53 START sql view model analytics.stg_order_items ......................... [RUN]
[0m16:06:07.855546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_order_items)
[0m16:06:07.892208 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_customers
[0m16:06:07.892622 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m16:06:07.900231 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:06:07.904311 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m16:06:07.907853 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m16:06:07.908273 [debug] [Thread-4 (]: SQL status: OK in 0.067 seconds
[0m16:06:07.908875 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:07.909273 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */

    create table pr_999__local.analytics_dev.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m16:06:07.910071 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:06:07.911130 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:07.911485 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_order_items
[0m16:06:07.911858 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:06:07.912398 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:06:07.912779 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY pr_999__local.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:07.916409 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m16:06:07.916783 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:06:07.917116 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m16:06:07.917640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:07.917984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:07.918487 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:06:07.918972 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m16:06:07.919314 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.919623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:07.919939 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.920262 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:06:07.920697 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:06:07.921048 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.921394 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:06:07.923023 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:06:07.923482 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view pr_999__local.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from pr_999__local.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m16:06:07.923844 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:06:07.924352 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:06:07.924989 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view pr_999__local.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from pr_999__local.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m16:06:07.925363 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.925727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.930388 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:06:07.931813 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:06:07.935013 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:06:07.935356 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:06:07.935704 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view pr_999__local.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m16:06:07.936048 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:07.936380 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view pr_999__local.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:06:07.939601 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:06:07.940258 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:06:07.940630 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.941011 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view pr_999__local.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m16:06:07.941435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.942669 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:06:07.943052 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.944132 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:06:07.944481 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:06:07.944787 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.945536 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m16:06:07.945936 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:06:07.946276 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:06:07.947290 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:06:07.947787 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb8760>]}
[0m16:06:07.948122 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:06:07.948533 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:06:07.949068 [info ] [Thread-4 (]: 5 of 53 OK loaded seed file analytics_dev.raw_products ......................... [[32mINSERT 10[0m in 0.13s]
[0m16:06:07.949608 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:06:07.949953 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.950432 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:06:07.950744 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.953687 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:06:07.954042 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:07.958712 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:06:07.959118 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m16:06:07.959488 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists pr_999__local.analytics.stg_customers__dbt_backup cascade
[0m16:06:07.962592 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:06:07.962967 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists pr_999__local.analytics.stg_orders__dbt_backup cascade
[0m16:06:07.963447 [info ] [Thread-4 (]: 9 of 53 START sql view model analytics.stg_products ............................ [RUN]
[0m16:06:07.963962 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists pr_999__local.analytics.stg_order_items__dbt_backup cascade
[0m16:06:07.964356 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:06:07.964774 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m16:06:07.965119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:07.966347 [debug] [Thread-2 (]: On model.ci_cd_project.stg_customers: Close
[0m16:06:07.966710 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m16:06:07.967026 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:07.968087 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m16:06:07.971725 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m16:06:07.972189 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df7ff10>]}
[0m16:06:07.973366 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: Close
[0m16:06:07.973831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e6bc0>]}
[0m16:06:07.974493 [info ] [Thread-2 (]: 7 of 53 OK created sql view model analytics.stg_customers ...................... [[32mOK[0m in 0.15s]
[0m16:06:07.975133 [info ] [Thread-1 (]: 6 of 53 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.15s]
[0m16:06:07.975707 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_customers
[0m16:06:07.976192 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:06:07.976648 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m16:06:07.977700 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:06:07.978246 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:06:07.983120 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m16:06:07.983631 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e013880>]}
[0m16:06:07.984031 [info ] [Thread-2 (]: 10 of 53 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:06:07.984429 [info ] [Thread-1 (]: 11 of 53 START test not_null_stg_customers_email ............................... [RUN]
[0m16:06:07.985383 [info ] [Thread-3 (]: 8 of 53 OK created sql view model analytics.stg_order_items .................... [[32mOK[0m in 0.13s]
[0m16:06:07.985938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:06:07.986436 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:06:07.986786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m16:06:07.987282 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_order_items
[0m16:06:07.987611 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:06:07.987945 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m16:06:07.988328 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:06:07.988715 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:06:08.002315 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:06:08.002718 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.006897 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:06:08.007327 [info ] [Thread-3 (]: 12 of 53 START test not_null_stg_customers_first_name .......................... [RUN]
[0m16:06:08.008055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m16:06:08.008459 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:06:08.013081 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:06:08.013669 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:06:08.020365 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:06:08.069577 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:06:08.070288 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:06:08.071040 [debug] [Thread-4 (]: SQL status: OK in 0.068 seconds
[0m16:06:08.071439 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:06:08.071791 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:06:08.074738 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:06:08.075153 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:06:08.075550 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:06:08.075911 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view pr_999__local.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from pr_999__local.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m16:06:08.076348 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:06:08.076700 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m16:06:08.077160 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:06:08.077484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.077835 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.078132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.078454 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m16:06:08.082035 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:06:08.082493 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:06:08.082798 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.083128 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:06:08.083513 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view pr_999__local.analytics.stg_products__dbt_tmp rename to stg_products
[0m16:06:08.083848 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:06:08.084266 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:06:08.084600 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.084970 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.085330 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from pr_999__local.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.085670 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.085964 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:06:08.087291 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:06:08.087670 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from pr_999__local.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.088202 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:06:08.088528 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.088854 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.089230 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:06:08.092210 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m16:06:08.092631 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.093810 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:06:08.094335 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m16:06:08.094712 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.095858 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m16:06:08.096264 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m16:06:08.096591 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m16:06:08.099566 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:06:08.099984 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m16:06:08.100289 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:06:08.101100 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists pr_999__local.analytics.stg_products__dbt_backup cascade
[0m16:06:08.100817 [info ] [Thread-1 (]: 11 of 53 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.11s]
[0m16:06:08.101528 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m16:06:08.102034 [info ] [Thread-2 (]: 10 of 53 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.12s]
[0m16:06:08.102637 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:06:08.102967 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.103817 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:06:08.103429 [info ] [Thread-3 (]: 12 of 53 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.10s]
[0m16:06:08.104286 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:06:08.105471 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m16:06:08.105868 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:06:08.106378 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:06:08.106814 [info ] [Thread-1 (]: 13 of 53 START test not_null_stg_customers_last_name ........................... [RUN]
[0m16:06:08.107364 [info ] [Thread-2 (]: 14 of 53 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:06:08.107864 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:06:08.108676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m16:06:08.109157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m16:06:08.109530 [info ] [Thread-3 (]: 15 of 53 START test unique_stg_customers_email ................................. [RUN]
[0m16:06:08.109946 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:06:08.110392 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2b29b0>]}
[0m16:06:08.110734 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:06:08.111103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m16:06:08.117698 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:06:08.118392 [info ] [Thread-4 (]: 9 of 53 OK created sql view model analytics.stg_products ....................... [[32mOK[0m in 0.15s]
[0m16:06:08.125586 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:06:08.125991 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:06:08.126664 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m16:06:08.131370 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:06:08.131868 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:06:08.132251 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:06:08.132867 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:06:08.133293 [info ] [Thread-4 (]: 16 of 53 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m16:06:08.136260 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:06:08.140200 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:06:08.140646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m16:06:08.140994 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:06:08.141521 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:06:08.144372 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:06:08.149398 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:06:08.150075 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:06:08.150627 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:06:08.151023 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:06:08.151383 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m16:06:08.151949 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:06:08.152331 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m16:06:08.154856 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:06:08.155222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.155592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.155974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.159688 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:06:08.160527 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:06:08.160888 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m16:06:08.161365 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.203884 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m16:06:08.204333 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:06:08.204712 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m16:06:08.205109 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m16:06:08.205500 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from pr_999__local.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.205841 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m16:06:08.206186 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:06:08.206513 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:06:08.206961 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:06:08.207324 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.207700 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.208016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.208358 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.209976 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m16:06:08.210604 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m16:06:08.211067 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m16:06:08.211467 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.212321 [info ] [Thread-1 (]: 13 of 53 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.10s]
[0m16:06:08.213024 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:06:08.213378 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.214587 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m16:06:08.215091 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:06:08.218323 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:06:08.217483 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m16:06:08.217931 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:06:08.216356 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:06:08.218750 [info ] [Thread-1 (]: 17 of 53 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:06:08.219443 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m16:06:08.219985 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m16:06:08.220430 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m16:06:08.221244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:06:08.221676 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m16:06:08.222193 [info ] [Thread-4 (]: 16 of 53 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m16:06:08.222539 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:06:08.222863 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:06:08.223329 [info ] [Thread-3 (]: 15 of 53 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.11s]
[0m16:06:08.223821 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:06:08.230744 [info ] [Thread-2 (]: 14 of 53 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.12s]
[0m16:06:08.231803 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:06:08.232339 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:06:08.232734 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:06:08.233290 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:06:08.233771 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:06:08.234205 [info ] [Thread-4 (]: 18 of 53 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m16:06:08.234850 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:06:08.235375 [info ] [Thread-3 (]: 19 of 53 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m16:06:08.235896 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:06:08.236317 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m16:06:08.236693 [info ] [Thread-2 (]: 20 of 53 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:06:08.237128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:06:08.240326 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:06:08.240683 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:06:08.241068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m16:06:08.241438 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:06:08.247231 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:06:08.247674 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:06:08.253201 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:06:08.329596 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:06:08.336708 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:06:08.255233 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:06:08.351436 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:06:08.353257 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:06:08.353979 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:06:08.354578 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m16:06:08.355061 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:06:08.355480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.355868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.360430 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:06:08.360822 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:06:08.364518 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:06:08.365560 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:06:08.365943 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m16:06:08.366328 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:06:08.366665 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.367356 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:06:08.367760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.413025 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m16:06:08.413514 [debug] [Thread-3 (]: SQL status: OK in 0.058 seconds
[0m16:06:08.413936 [debug] [Thread-2 (]: SQL status: OK in 0.046 seconds
[0m16:06:08.414296 [debug] [Thread-4 (]: SQL status: OK in 0.048 seconds
[0m16:06:08.414666 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:06:08.415093 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:06:08.415436 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:06:08.415765 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:06:08.416108 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from pr_999__local.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.416490 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from pr_999__local.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from pr_999__local.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.416860 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.417212 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from pr_999__local.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.418298 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.418680 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.419999 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:06:08.420376 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.421585 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m16:06:08.422030 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:06:08.422399 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:06:08.423545 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:06:08.423936 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m16:06:08.424315 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:06:08.425406 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m16:06:08.425785 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m16:06:08.426102 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m16:06:08.426636 [info ] [Thread-1 (]: 17 of 53 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.21s]
[0m16:06:08.427096 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m16:06:08.427417 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:06:08.427932 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:06:08.428372 [info ] [Thread-4 (]: 18 of 53 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.19s]
[0m16:06:08.428774 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m16:06:08.429270 [info ] [Thread-2 (]: 20 of 53 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m16:06:08.429870 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:06:08.430426 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:06:08.430957 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:06:08.431312 [info ] [Thread-1 (]: 21 of 53 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m16:06:08.432300 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:06:08.431812 [info ] [Thread-3 (]: 19 of 53 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.19s]
[0m16:06:08.432799 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:06:08.433218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m16:06:08.433704 [info ] [Thread-4 (]: 22 of 53 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m16:06:08.434227 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:06:08.434563 [info ] [Thread-2 (]: 23 of 53 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m16:06:08.434907 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:06:08.435269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m16:06:08.435640 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:06:08.436025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m16:06:08.441982 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:06:08.442430 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:06:08.442789 [info ] [Thread-3 (]: 24 of 53 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m16:06:08.443151 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:06:08.447847 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:06:08.448304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m16:06:08.453032 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:06:08.453541 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:06:08.453905 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:06:08.454333 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:06:08.457243 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:06:08.462442 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:06:08.465956 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:06:08.466352 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:06:08.469344 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:06:08.469928 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:06:08.470350 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:06:08.470706 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:06:08.473472 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:06:08.473863 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:06:08.474216 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m16:06:08.474558 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m16:06:08.474953 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m16:06:08.475278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.475630 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.475961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.476303 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:06:08.476761 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m16:06:08.477069 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.519908 [debug] [Thread-1 (]: SQL status: OK in 0.045 seconds
[0m16:06:08.520351 [debug] [Thread-4 (]: SQL status: OK in 0.045 seconds
[0m16:06:08.520733 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:06:08.521101 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m16:06:08.521417 [debug] [Thread-2 (]: SQL status: OK in 0.045 seconds
[0m16:06:08.521764 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:06:08.522124 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from pr_999__local.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.522477 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:06:08.522794 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:06:08.523135 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from pr_999__local.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.523642 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from pr_999__local.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.524042 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from pr_999__local.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.524479 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.525276 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.525828 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.527162 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m16:06:08.527531 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.528650 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m16:06:08.529979 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m16:06:08.530409 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m16:06:08.531565 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m16:06:08.531958 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m16:06:08.532408 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m16:06:08.532790 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m16:06:08.533227 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m16:06:08.533553 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m16:06:08.533879 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m16:06:08.534416 [info ] [Thread-1 (]: 21 of 53 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.10s]
[0m16:06:08.534942 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m16:06:08.535509 [info ] [Thread-4 (]: 22 of 53 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.10s]
[0m16:06:08.536127 [info ] [Thread-3 (]: 24 of 53 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.09s]
[0m16:06:08.536643 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:06:08.537183 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:06:08.537653 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:06:08.538062 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:06:08.538522 [info ] [Thread-2 (]: 23 of 53 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.10s]
[0m16:06:08.538927 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:06:08.539358 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:06:08.539784 [info ] [Thread-1 (]: 25 of 53 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m16:06:08.540393 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:06:08.540815 [info ] [Thread-4 (]: 26 of 53 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m16:06:08.541194 [info ] [Thread-3 (]: 27 of 53 START test not_null_stg_products_cost ................................. [RUN]
[0m16:06:08.541625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m16:06:08.542435 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:06:08.543007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m16:06:08.543383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m16:06:08.543740 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:06:08.544076 [info ] [Thread-2 (]: 28 of 53 START test not_null_stg_products_price ................................ [RUN]
[0m16:06:08.544424 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:06:08.544767 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:06:08.552293 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:06:08.552732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m16:06:08.557000 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:06:08.561022 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:06:08.561473 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:06:08.566363 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:06:08.566948 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:06:08.570973 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:06:08.571366 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:06:08.571813 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:06:08.574606 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:06:08.574936 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:06:08.577635 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:06:08.578178 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:06:08.581385 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:06:08.581871 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m16:06:08.582265 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:06:08.582723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.583105 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m16:06:08.583566 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:06:08.583933 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:06:08.584260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.584586 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m16:06:08.584917 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m16:06:08.585266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.585581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.623307 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:06:08.623806 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:06:08.624185 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m16:06:08.624525 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:06:08.624837 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:06:08.625177 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.625689 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:06:08.626015 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:06:08.626331 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:06:08.626825 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from pr_999__local.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from pr_999__local.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.627219 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from pr_999__local.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.627586 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from pr_999__local.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.627904 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.629833 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m16:06:08.630277 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.630685 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m16:06:08.631115 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.631461 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.632624 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m16:06:08.632958 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m16:06:08.634128 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m16:06:08.635296 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m16:06:08.635706 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m16:06:08.636233 [info ] [Thread-4 (]: 26 of 53 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.09s]
[0m16:06:08.636722 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m16:06:08.637062 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m16:06:08.637415 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m16:06:08.637895 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:06:08.638215 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m16:06:08.638574 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m16:06:08.639021 [info ] [Thread-2 (]: 28 of 53 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.09s]
[0m16:06:08.639468 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:06:08.640011 [info ] [Thread-3 (]: 27 of 53 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.10s]
[0m16:06:08.640531 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:06:08.641319 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:06:08.642134 [debug] [Thread-2 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:06:08.640904 [info ] [Thread-4 (]: 29 of 53 START test not_null_stg_products_product_id ........................... [RUN]
[0m16:06:08.642637 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:06:08.641809 [info ] [Thread-1 (]: 25 of 53 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.10s]
[0m16:06:08.643186 [info ] [Thread-2 (]: 30 of 53 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m16:06:08.643609 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m16:06:08.644697 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:06:08.644014 [info ] [Thread-3 (]: 31 of 53 START test unique_stg_products_product_id ............................. [RUN]
[0m16:06:08.645337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m16:06:08.645736 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:06:08.646116 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_customers
[0m16:06:08.646509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m16:06:08.646859 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:06:08.652958 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:06:08.653461 [info ] [Thread-1 (]: 32 of 53 START sql table model analytics.dim_customers ......................... [RUN]
[0m16:06:08.653849 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:06:08.658793 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:06:08.659279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.ci_cd_project.dim_customers)
[0m16:06:08.663736 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:06:08.664231 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:06:08.668037 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:06:08.668522 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:06:08.668892 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:06:08.672912 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:06:08.673259 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:06:08.676045 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:06:08.676498 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:06:08.679579 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:06:08.683290 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:06:08.683837 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:06:08.684254 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:06:08.684698 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:06:08.685071 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m16:06:08.685468 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:06:08.685817 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:06:08.686162 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:06:08.686648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.687010 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.687337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.687694 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:06:08.688184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.728172 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m16:06:08.728612 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m16:06:08.729092 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m16:06:08.729462 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:06:08.729781 [debug] [Thread-3 (]: SQL status: OK in 0.042 seconds
[0m16:06:08.730119 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:06:08.730448 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:06:08.730819 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from pr_999__local.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from pr_999__local.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.731178 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:06:08.731545 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      pr_999__local.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from pr_999__local.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from pr_999__local.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:06:08.731933 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from pr_999__local.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.732432 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.733803 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.734229 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.735673 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:06:08.736056 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:06:08.736487 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m16:06:08.737689 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:06:08.738109 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:06:08.738428 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:06:08.739510 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m16:06:08.739923 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m16:06:08.744609 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:06:08.745535 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m16:06:08.745169 [info ] [Thread-4 (]: 29 of 53 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.10s]
[0m16:06:08.745962 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m16:06:08.746298 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table pr_999__local.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:06:08.746635 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m16:06:08.747102 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:06:08.747595 [info ] [Thread-3 (]: 31 of 53 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.10s]
[0m16:06:08.748326 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:06:08.748661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.749146 [info ] [Thread-2 (]: 30 of 53 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.10s]
[0m16:06:08.750896 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:06:08.751506 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:06:08.751869 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:06:08.752297 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:06:08.752814 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_products
[0m16:06:08.753336 [info ] [Thread-4 (]: 33 of 53 START sql table model analytics.dim_products .......................... [RUN]
[0m16:06:08.753754 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now model.ci_cd_project.dim_products)
[0m16:06:08.754136 [debug] [Thread-3 (]: Began running node model.ci_cd_project.fct_orders
[0m16:06:08.754495 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.754828 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_products
[0m16:06:08.755280 [info ] [Thread-3 (]: 34 of 53 START sql table model analytics.fct_orders ............................ [RUN]
[0m16:06:08.758330 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:06:08.762224 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m16:06:08.762694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now model.ci_cd_project.fct_orders)
[0m16:06:08.763271 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists pr_999__local.analytics.dim_customers__dbt_backup cascade
[0m16:06:08.763715 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:06:08.768016 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:06:08.768466 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:06:08.769655 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: Close
[0m16:06:08.770008 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_products
[0m16:06:08.770347 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:06:08.775461 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m16:06:08.775920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da749d0>]}
[0m16:06:08.779836 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:06:08.780492 [info ] [Thread-1 (]: 32 of 53 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.12s]
[0m16:06:08.781210 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:06:08.781614 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:06:08.782039 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: BEGIN
[0m16:06:08.782421 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:06:08.782818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.783329 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:06:08.783659 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:06:08.783960 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:06:08.784387 [info ] [Thread-2 (]: 35 of 53 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m16:06:08.784760 [info ] [Thread-1 (]: 36 of 53 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m16:06:08.785147 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.785523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m16:06:08.785903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:06:08.786274 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:06:08.786700 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:06:08.791235 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:06:08.795445 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:06:08.829518 [debug] [Thread-4 (]: SQL status: OK in 0.047 seconds
[0m16:06:08.829939 [debug] [Thread-3 (]: SQL status: OK in 0.045 seconds
[0m16:06:08.830299 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:06:08.830708 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:06:08.831052 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:06:08.831372 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:06:08.831764 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      pr_999__local.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from pr_999__local.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from pr_999__local.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m16:06:08.832260 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      pr_999__local.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from pr_999__local.analytics.stg_orders
),

order_items as (
    select * from pr_999__local.analytics.stg_order_items
),

products as (
    select * from pr_999__local.analytics.stg_products
),

customers as (
    select * from pr_999__local.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:06:08.836546 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:06:08.839442 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:06:08.840448 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:06:08.840840 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m16:06:08.841228 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:06:08.841586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.841981 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:06:08.842587 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.842898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.843236 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.846857 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:06:08.847312 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:06:08.847670 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:06:08.848018 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:06:08.848356 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table pr_999__local.analytics.dim_products__dbt_tmp rename to dim_products
[0m16:06:08.851660 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:06:08.852049 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from pr_999__local.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m16:06:08.852413 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:06:08.852828 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table pr_999__local.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:06:08.853149 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:06:08.853563 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.854813 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:06:08.855153 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.855665 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:06:08.855975 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.856340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.856661 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:06:08.857820 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m16:06:08.858892 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:06:08.860023 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:06:08.860531 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m16:06:08.860856 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:06:08.861183 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.861545 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m16:06:08.861871 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m16:06:08.862212 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:06:08.866209 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:06:08.866575 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:06:08.867157 [info ] [Thread-2 (]: 35 of 53 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.08s]
[0m16:06:08.867634 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists pr_999__local.analytics.dim_products__dbt_backup cascade
[0m16:06:08.867999 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.868955 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:06:08.868451 [info ] [Thread-1 (]: 36 of 53 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.08s]
[0m16:06:08.871772 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:06:08.872228 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:06:08.872657 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.873129 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:06:08.873582 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists pr_999__local.analytics.fct_orders__dbt_backup cascade
[0m16:06:08.873984 [info ] [Thread-2 (]: 37 of 53 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m16:06:08.875322 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: Close
[0m16:06:08.875726 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:06:08.876226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m16:06:08.876575 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:06:08.877014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8356f0>]}
[0m16:06:08.877359 [info ] [Thread-1 (]: 38 of 53 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m16:06:08.877735 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:06:08.878953 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: Close
[0m16:06:08.880146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m16:06:08.879836 [info ] [Thread-4 (]: 33 of 53 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.12s]
[0m16:06:08.884526 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:06:08.884947 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:06:08.885476 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_products
[0m16:06:08.889727 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:06:08.890171 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:06:08.891107 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:06:08.890834 [info ] [Thread-4 (]: 39 of 53 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m16:06:08.895287 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:06:08.895775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'addeb4f8-9924-4da7-989c-66b80be80db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e834580>]}
[0m16:06:08.896479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m16:06:08.896928 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:06:08.897797 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:06:08.897509 [info ] [Thread-3 (]: 34 of 53 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.13s]
[0m16:06:08.900730 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:06:08.901140 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:06:08.905281 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:06:08.905820 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:06:08.906231 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m16:06:08.906731 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:06:08.907104 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:06:08.907641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:08.908296 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:06:08.908008 [info ] [Thread-3 (]: 40 of 53 START test unique_dim_customers_customer_id ........................... [RUN]
[0m16:06:08.908709 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m16:06:08.911600 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:06:08.911991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m16:06:08.912382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:08.912904 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:06:08.913454 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:06:08.918531 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:06:08.948817 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m16:06:08.949337 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m16:06:08.949701 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:08.950042 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:06:08.950415 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:06:08.950828 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:06:08.951171 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:06:08.951472 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:06:08.951813 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from pr_999__local.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.954793 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:06:08.955152 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from pr_999__local.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.955492 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:06:08.956152 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from pr_999__local.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m16:06:08.956555 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.956879 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.957226 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:06:08.958652 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m16:06:08.959736 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m16:06:08.960065 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m16:06:08.960376 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.960792 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m16:06:08.961161 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m16:06:08.961459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:08.962665 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m16:06:08.962982 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m16:06:08.963313 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m16:06:08.963815 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m16:06:08.964121 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:08.964611 [info ] [Thread-2 (]: 37 of 53 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.09s]
[0m16:06:08.965126 [info ] [Thread-1 (]: 38 of 53 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.08s]
[0m16:06:08.965462 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m16:06:08.965813 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:06:08.966338 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:06:08.966799 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:06:08.967277 [info ] [Thread-4 (]: 39 of 53 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.07s]
[0m16:06:08.967671 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:08.968088 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:06:08.968493 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:06:08.968985 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:06:08.969455 [info ] [Thread-2 (]: 41 of 53 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m16:06:08.970263 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:08.969968 [info ] [Thread-1 (]: 42 of 53 START test not_null_dim_products_performance_category ................. [RUN]
[0m16:06:08.970717 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:06:08.971132 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m16:06:08.972629 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m16:06:08.973004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m16:06:08.973370 [info ] [Thread-4 (]: 43 of 53 START test not_null_dim_products_product_id ........................... [RUN]
[0m16:06:08.973746 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:06:08.974144 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:06:08.974491 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m16:06:08.974851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m16:06:08.979636 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:06:08.983718 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:06:08.984078 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m16:06:08.984411 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:06:08.989531 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:06:08.990122 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:06:08.990473 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:06:08.990819 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:06:08.993610 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:06:08.994110 [info ] [Thread-3 (]: 40 of 53 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.08s]
[0m16:06:08.997011 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:06:08.999731 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:06:09.000298 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:06:09.000910 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:06:09.001311 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:06:09.001756 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m16:06:09.002123 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:06:09.002484 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:06:09.002854 [info ] [Thread-3 (]: 44 of 53 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m16:06:09.003226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:09.003547 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m16:06:09.003879 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m16:06:09.004241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m16:06:09.004637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:09.004972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:09.005304 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:06:09.010121 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:06:09.010681 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:06:09.094913 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:06:09.095827 [debug] [Thread-4 (]: SQL status: OK in 0.091 seconds
[0m16:06:09.096236 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m16:06:09.096611 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:06:09.096992 [debug] [Thread-2 (]: SQL status: OK in 0.092 seconds
[0m16:06:09.097370 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:06:09.097735 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from pr_999__local.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.098147 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:06:09.098486 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:06:09.098845 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from pr_999__local.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.099301 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m16:06:09.099631 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m16:06:09.099975 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from pr_999__local.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m16:06:09.100426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:09.100765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:09.102062 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m16:06:09.102696 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.103858 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m16:06:09.104230 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.104593 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m16:06:09.104908 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:06:09.105297 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m16:06:09.106471 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m16:06:09.106795 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m16:06:09.107149 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from pr_999__local.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.107493 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m16:06:09.107897 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m16:06:09.108404 [info ] [Thread-4 (]: 43 of 53 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.13s]
[0m16:06:09.109071 [info ] [Thread-1 (]: 42 of 53 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.14s]
[0m16:06:09.109434 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m16:06:09.109919 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:06:09.110230 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.110667 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:06:09.111143 [info ] [Thread-2 (]: 41 of 53 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.14s]
[0m16:06:09.111552 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:06:09.112005 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:06:09.113136 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m16:06:09.113677 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:06:09.114049 [info ] [Thread-4 (]: 45 of 53 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m16:06:09.114690 [info ] [Thread-1 (]: 46 of 53 START test unique_dim_products_product_id ............................. [RUN]
[0m16:06:09.115289 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m16:06:09.115651 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:06:09.116068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m16:06:09.116674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m16:06:09.117062 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m16:06:09.117430 [info ] [Thread-2 (]: 47 of 53 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m16:06:09.117809 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:06:09.118131 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:06:09.118542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m16:06:09.123173 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:06:09.127409 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:06:09.127931 [info ] [Thread-3 (]: 44 of 53 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.12s]
[0m16:06:09.128347 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:06:09.129009 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:06:09.134248 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:06:09.134817 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:06:09.135241 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:06:09.135566 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:06:09.135965 [info ] [Thread-3 (]: 48 of 53 START test not_null_fct_orders_order_id ............................... [RUN]
[0m16:06:09.138886 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:06:09.141637 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:06:09.141965 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:06:09.142338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m16:06:09.145317 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:06:09.145713 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:06:09.146275 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:06:09.146715 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:06:09.151584 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:06:09.152010 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m16:06:09.152375 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m16:06:09.152747 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:06:09.153121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:09.153477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:09.153848 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m16:06:09.154170 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:06:09.154582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:09.157439 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:06:09.158038 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:06:09.158366 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m16:06:09.158671 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:09.193803 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m16:06:09.194212 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:06:09.194604 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:06:09.194953 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from pr_999__local.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.195289 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m16:06:09.195681 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m16:06:09.196033 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:06:09.196465 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:06:09.196788 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:06:09.197081 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:09.197412 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.197767 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:09.198116 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from pr_999__local.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.199426 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m16:06:09.200162 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m16:06:09.200511 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m16:06:09.200846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:09.201171 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:09.201497 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.201996 [info ] [Thread-4 (]: 45 of 53 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.09s]
[0m16:06:09.203205 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m16:06:09.204437 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m16:06:09.205511 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m16:06:09.205981 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:06:09.206371 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m16:06:09.206741 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m16:06:09.207124 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m16:06:09.207494 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:06:09.207866 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m16:06:09.208193 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m16:06:09.208507 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m16:06:09.208956 [info ] [Thread-4 (]: 49 of 53 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m16:06:09.209581 [info ] [Thread-1 (]: 46 of 53 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:06:09.210076 [info ] [Thread-2 (]: 47 of 53 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.09s]
[0m16:06:09.210522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m16:06:09.211068 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:06:09.211524 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:06:09.211981 [info ] [Thread-3 (]: 48 of 53 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.07s]
[0m16:06:09.212412 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:06:09.212884 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:06:09.213594 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:06:09.214149 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:06:09.219478 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:06:09.219902 [info ] [Thread-1 (]: 50 of 53 START test not_null_fct_orders_product_id ............................. [RUN]
[0m16:06:09.220294 [info ] [Thread-2 (]: 51 of 53 START test not_null_fct_orders_quantity ............................... [RUN]
[0m16:06:09.220695 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:06:09.221182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m16:06:09.221648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m16:06:09.222106 [info ] [Thread-3 (]: 52 of 53 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m16:06:09.222524 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:06:09.222866 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:06:09.223178 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:06:09.223538 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m16:06:09.228115 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:06:09.233486 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:06:09.237709 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:06:09.238097 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:06:09.242649 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:06:09.243254 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:06:09.243601 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:06:09.243974 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:06:09.247005 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:06:09.250847 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:06:09.251230 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:06:09.251612 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m16:06:09.254573 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:06:09.254949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:06:09.255474 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:06:09.255856 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:06:09.256317 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m16:06:09.256684 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:06:09.257014 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m16:06:09.257324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:09.257650 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m16:06:09.258023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:09.258421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:06:09.296273 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:06:09.296773 [debug] [Thread-4 (]: SQL status: OK in 0.042 seconds
[0m16:06:09.297172 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:06:09.297526 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:06:09.297835 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:06:09.298167 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:06:09.298507 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from pr_999__local.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.298847 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:06:09.299152 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:06:09.299478 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from pr_999__local.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.299957 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from pr_999__local.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.300344 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from pr_999__local.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:06:09.300668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:09.302321 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m16:06:09.302779 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m16:06:09.303114 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.303418 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:06:09.303725 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m16:06:09.304035 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:09.305277 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m16:06:09.306449 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m16:06:09.306972 [info ] [Thread-1 (]: 50 of 53 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:06:09.308221 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m16:06:09.308574 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m16:06:09.308954 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m16:06:09.309436 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:06:09.309807 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m16:06:09.310122 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m16:06:09.310436 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m16:06:09.310810 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:06:09.311172 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m16:06:09.311666 [info ] [Thread-4 (]: 49 of 53 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.10s]
[0m16:06:09.312359 [info ] [Thread-2 (]: 51 of 53 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m16:06:09.312750 [info ] [Thread-1 (]: 53 of 53 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m16:06:09.313319 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:06:09.314755 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:06:09.315253 [info ] [Thread-3 (]: 52 of 53 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.09s]
[0m16:06:09.315648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m16:06:09.316305 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:06:09.316647 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:06:09.321587 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:06:09.322275 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:06:09.325309 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:06:09.325945 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:06:09.326274 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m16:06:09.326577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:09.404952 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m16:06:09.405409 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:06:09.405777 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:06:09.406782 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:09.408177 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m16:06:09.408617 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m16:06:09.408946 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m16:06:09.410168 [info ] [Thread-1 (]: 53 of 53 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.09s]
[0m16:06:09.410704 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:06:09.411793 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:09.412142 [debug] [MainThread]: On master: BEGIN
[0m16:06:09.412413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:09.453637 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m16:06:09.454075 [debug] [MainThread]: On master: COMMIT
[0m16:06:09.454383 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:09.454661 [debug] [MainThread]: On master: COMMIT
[0m16:06:09.455015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:06:09.455291 [debug] [MainThread]: On master: Close
[0m16:06:09.456379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:09.456666 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m16:06:09.456915 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m16:06:09.457160 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m16:06:09.457402 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94' was properly closed.
[0m16:06:09.457818 [info ] [MainThread]: 
[0m16:06:09.458137 [info ] [MainThread]: Finished running 4 seeds, 4 table models, 4 view models, 41 data tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m16:06:09.464260 [debug] [MainThread]: Command end result
[0m16:06:09.540524 [info ] [MainThread]: 
[0m16:06:09.540994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:09.541355 [info ] [MainThread]: 
[0m16:06:09.541674 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=0 SKIP=0 TOTAL=53
[0m16:06:09.544442 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.030687, "process_in_blocks": "0", "process_kernel_time": 0.661496, "process_mem_max_rss": "181501952", "process_out_blocks": "0", "process_user_time": 9.361378}
[0m16:06:09.544861 [debug] [MainThread]: Command `dbt build` succeeded at 16:06:09.544781 after 6.03 seconds
[0m16:06:09.545208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddeae90>]}
[0m16:06:09.545618 [debug] [MainThread]: Flushing usage events
[0m16:06:43.434120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d658d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7fb040>]}


============================== 16:06:43.438763 | d37a2e83-5f75-4708-bc48-ff6a24569bcf ==============================
[0m16:06:43.438763 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:06:43.439293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --target pr', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:43.698694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109419a80>]}
[0m16:06:43.748430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc8e20>]}
[0m16:06:43.752507 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:06:43.877042 [debug] [MainThread]: checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf, vars: {}, profile: , target: pr, version: 1.8.9
[0m16:06:44.000701 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:06:44.001127 [debug] [MainThread]: previous checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m16:06:44.001421 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:06:44.001749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdb190>]}
[0m16:06:46.326190 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:06:46.326709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0735e0>]}
[0m16:06:46.712927 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:06:46.713401 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:06:46.713737 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:06:46.714051 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:06:46.714349 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:06:46.714646 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:06:46.714937 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:06:46.715230 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:06:46.715514 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:06:46.715799 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:06:46.716083 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:06:46.716365 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:06:46.716648 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:06:46.716931 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:06:46.717214 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:06:46.717494 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:06:46.717774 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:06:46.718048 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:06:46.718322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:06:46.718606 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:06:46.718885 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:06:46.719169 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:06:46.719452 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:06:46.719736 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:06:46.720015 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:06:46.720294 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:06:46.720573 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:06:46.720850 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:06:46.830667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1acc10>]}
[0m16:06:46.977372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b19e530>]}
[0m16:06:46.977868 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:06:46.978212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ccd30>]}
[0m16:06:46.980418 [info ] [MainThread]: 
[0m16:06:46.980896 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:06:46.985938 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:06:47.037833 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:06:47.038218 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:06:47.038516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:47.192023 [debug] [ThreadPool]: SQL status: OK in 0.153 seconds
[0m16:06:47.193635 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:06:47.196044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now create_pr_999__local_analytics_pr)
[0m16:06:47.196683 [debug] [ThreadPool]: Creating schema "database: "pr_999__local"
schema: "analytics_pr"
"
[0m16:06:47.203678 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_pr"
[0m16:06:47.204023 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_analytics_pr"} */

    
        select type from duckdb_databases()
        where database_name='pr_999__local'
        and type='sqlite'
    
  
[0m16:06:47.204315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:47.242170 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:47.243670 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_pr"
[0m16:06:47.243992 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: BEGIN
[0m16:06:47.244351 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:06:47.244629 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_pr"
[0m16:06:47.244907 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_analytics_pr"} */

    
    
        create schema if not exists pr_999__local.analytics_pr
    
[0m16:06:47.245662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:06:47.246448 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: COMMIT
[0m16:06:47.246761 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_analytics_pr"
[0m16:06:47.247041 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: COMMIT
[0m16:06:47.247774 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:06:47.248065 [debug] [ThreadPool]: On create_pr_999__local_analytics_pr: Close
[0m16:06:47.255610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pr_999__local_analytics_pr, now list_pr_999__local_analytics_pr)
[0m16:06:47.261881 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics_pr"
[0m16:06:47.262323 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_analytics'
[0m16:06:47.262614 [debug] [ThreadPool]: On list_pr_999__local_analytics_pr: BEGIN
[0m16:06:47.265088 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:06:47.265390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:47.265685 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m16:06:47.266026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:47.303146 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:47.303483 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics_pr"
[0m16:06:47.303773 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:06:47.304065 [debug] [ThreadPool]: On list_pr_999__local_analytics_pr: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics_pr"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_pr'
    and table_catalog = 'pr_999__local'
  
[0m16:06:47.304358 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:06:47.304742 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m16:06:47.317405 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:06:47.317753 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:06:47.318915 [debug] [ThreadPool]: On list_pr_999__local_analytics_pr: ROLLBACK
[0m16:06:47.320072 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m16:06:47.320880 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics_pr'
[0m16:06:47.321250 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m16:06:47.321540 [debug] [ThreadPool]: On list_pr_999__local_analytics_pr: Close
[0m16:06:47.321833 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m16:06:47.324263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b19c7c0>]}
[0m16:06:47.324758 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:47.325068 [debug] [MainThread]: On master: BEGIN
[0m16:06:47.325349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:47.363295 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m16:06:47.363683 [debug] [MainThread]: On master: COMMIT
[0m16:06:47.363985 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:47.364264 [debug] [MainThread]: On master: COMMIT
[0m16:06:47.364632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:06:47.364942 [debug] [MainThread]: On master: Close
[0m16:06:47.365992 [info ] [MainThread]: Concurrency: 4 threads (target='pr')
[0m16:06:47.366320 [info ] [MainThread]: 
[0m16:06:47.368305 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:06:47.368721 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:06:47.369544 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:06:47.369909 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m16:06:47.369222 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_pr.raw_customers .............................. [RUN]
[0m16:06:47.370464 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_pr.raw_order_items ............................ [RUN]
[0m16:06:47.370990 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_pr.raw_orders ................................. [RUN]
[0m16:06:47.371538 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_pr.raw_products ............................... [RUN]
[0m16:06:47.371991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics_pr, now seed.ci_cd_project.raw_customers)
[0m16:06:47.372405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now seed.ci_cd_project.raw_order_items)
[0m16:06:47.372831 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m16:06:47.373232 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m16:06:47.373558 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:06:47.373869 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:06:47.374175 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:06:47.374601 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:06:47.375031 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:06:47.375381 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:06:47.375705 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:06:47.376021 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:06:47.432161 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:47.433203 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:47.435185 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:47.435522 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:06:47.438743 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:47.439076 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:06:47.439405 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:06:47.439723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:47.440042 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:06:47.440346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:47.440649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:06:47.441052 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:47.477815 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:06:47.478200 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:47.478612 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m16:06:47.478980 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table pr_999__local.analytics_pr.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m16:06:47.479307 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m16:06:47.479643 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:47.479956 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:06:47.480384 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:47.480725 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table pr_999__local.analytics_pr.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m16:06:47.481065 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:47.481396 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table pr_999__local.analytics_pr.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m16:06:47.481701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.482137 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_products"} */

    create table pr_999__local.analytics_pr.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m16:06:47.482558 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.493283 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:47.493715 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:06:47.494685 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:47.495036 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.495374 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY pr_999__local.analytics_pr.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:47.496282 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:47.496634 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY pr_999__local.analytics_pr.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:47.497524 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:47.497957 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY pr_999__local.analytics_pr.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:47.498408 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY pr_999__local.analytics_pr.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:06:47.509539 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:06:47.509951 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m16:06:47.510308 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:06:47.510653 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:06:47.515687 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:06:47.516223 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:06:47.516729 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:06:47.517246 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:06:47.539437 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:06:47.540799 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:06:47.542154 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:06:47.542506 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:06:47.542867 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:06:47.543223 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:06:47.544346 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:06:47.544699 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:06:47.545026 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:06:47.545346 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:06:47.545671 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:06:47.546375 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:06:47.546811 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.547140 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.547495 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:06:47.549271 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:06:47.549612 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:06:47.550259 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:06:47.550878 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m16:06:47.552207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add3cd0>]}
[0m16:06:47.552857 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:06:47.553301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1880d0>]}
[0m16:06:47.553698 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add19f0>]}
[0m16:06:47.554163 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_pr.raw_order_items ........................ [[32mINSERT 14[0m in 0.18s]
[0m16:06:47.554702 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_pr.raw_customers .......................... [[32mINSERT 10[0m in 0.18s]
[0m16:06:47.555184 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_pr.raw_products ........................... [[32mINSERT 10[0m in 0.18s]
[0m16:06:47.555730 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:06:47.556213 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:06:47.556681 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:06:47.566407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd37a2e83-5f75-4708-bc48-ff6a24569bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a634f10>]}
[0m16:06:47.566915 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_pr.raw_orders ............................. [[32mINSERT 10[0m in 0.19s]
[0m16:06:47.567436 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:06:47.568451 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:47.568769 [debug] [MainThread]: On master: BEGIN
[0m16:06:47.569046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:47.607571 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m16:06:47.607958 [debug] [MainThread]: On master: COMMIT
[0m16:06:47.608262 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:47.608544 [debug] [MainThread]: On master: COMMIT
[0m16:06:47.608932 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:06:47.609276 [debug] [MainThread]: On master: Close
[0m16:06:47.610376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:47.610694 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m16:06:47.610965 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m16:06:47.611222 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m16:06:47.611473 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m16:06:47.611816 [info ] [MainThread]: 
[0m16:06:47.612225 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:06:47.613193 [debug] [MainThread]: Command end result
[0m16:06:47.722486 [info ] [MainThread]: 
[0m16:06:47.722968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:47.723302 [info ] [MainThread]: 
[0m16:06:47.723647 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:06:47.726339 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.350303, "process_in_blocks": "0", "process_kernel_time": 0.429436, "process_mem_max_rss": "170835968", "process_out_blocks": "0", "process_user_time": 5.959229}
[0m16:06:47.726737 [debug] [MainThread]: Command `dbt seed` succeeded at 16:06:47.726660 after 4.35 seconds
[0m16:06:47.727081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d658d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f920e0>]}
[0m16:06:47.727418 [debug] [MainThread]: Flushing usage events
[0m16:06:58.868472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68ee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68f280>]}


============================== 16:06:58.873293 | f41fdd20-5a37-473d-87ae-31de901ca3df ==============================
[0m16:06:58.873293 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:06:58.873829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s state:modified+ --state ./state --target pr --vars schema_id: pr_999__local', 'send_anonymous_usage_stats': 'True'}
[0m16:06:59.103711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109109c00>]}
[0m16:06:59.152940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7be8f0>]}
[0m16:06:59.157031 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:06:59.282224 [debug] [MainThread]: checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, vars: {'schema_id': 'pr_999__local'}, profile: , target: pr, version: 1.8.9
[0m16:06:59.405395 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:06:59.405830 [debug] [MainThread]: previous checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, current checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf
[0m16:06:59.406126 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:06:59.406455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa43d60>]}
[0m16:07:01.785678 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:07:01.786183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84ae60>]}
[0m16:07:02.171507 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:07:02.171992 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:07:02.172324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:07:02.172632 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:07:02.172926 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:07:02.173214 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:07:02.173503 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:07:02.173784 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:07:02.174061 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:07:02.174339 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:07:02.174629 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:07:02.174903 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:07:02.175180 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:07:02.175460 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:07:02.175739 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:07:02.176013 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:07:02.176288 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:07:02.176562 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:07:02.176836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:07:02.177112 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:07:02.177388 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:07:02.177665 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:07:02.177941 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:07:02.178216 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:07:02.178493 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:07:02.178769 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:07:02.179046 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:07:02.179322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:07:02.287485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0feb90>]}
[0m16:07:02.578186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf07cd0>]}
[0m16:07:02.578721 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:07:02.587943 [info ] [MainThread]: 
[0m16:07:02.588528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:07:02.593631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:07:02.644874 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:07:02.645305 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:07:02.645608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:02.783885 [debug] [ThreadPool]: SQL status: OK in 0.138 seconds
[0m16:07:02.785858 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:07:02.788863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now list_pr_999__local_pr_999__local__pr_999__local)
[0m16:07:02.795159 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_analytics__pr_999__local'
[0m16:07:02.794729 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_pr_999__local__pr_999__local"
[0m16:07:02.797674 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics__pr_999__local"
[0m16:07:02.797989 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: BEGIN
[0m16:07:02.798357 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: BEGIN
[0m16:07:02.798651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:02.798924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:02.836287 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:07:02.836607 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_pr_999__local__pr_999__local"
[0m16:07:02.836893 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:07:02.837219 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_pr_999__local__pr_999__local"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'pr_999__local__pr_999__local'
    and table_catalog = 'pr_999__local'
  
[0m16:07:02.837533 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics__pr_999__local"
[0m16:07:02.837925 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics__pr_999__local"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics__pr_999__local'
    and table_catalog = 'pr_999__local'
  
[0m16:07:02.851248 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:07:02.851639 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:07:02.852742 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: ROLLBACK
[0m16:07:02.853718 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: ROLLBACK
[0m16:07:02.854497 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics__pr_999__local'
[0m16:07:02.854850 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_pr_999__local__pr_999__local'
[0m16:07:02.855145 [debug] [ThreadPool]: On list_pr_999__local_analytics__pr_999__local: Close
[0m16:07:02.855429 [debug] [ThreadPool]: On list_pr_999__local_pr_999__local__pr_999__local: Close
[0m16:07:02.856948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999d9c0>]}
[0m16:07:02.857385 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:02.857679 [debug] [MainThread]: On master: BEGIN
[0m16:07:02.857951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:02.896289 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m16:07:02.896668 [debug] [MainThread]: On master: COMMIT
[0m16:07:02.896965 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:02.897239 [debug] [MainThread]: On master: COMMIT
[0m16:07:02.897612 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:07:02.897953 [debug] [MainThread]: On master: Close
[0m16:07:02.899036 [info ] [MainThread]: Concurrency: 4 threads (target='pr')
[0m16:07:02.899358 [info ] [MainThread]: 
[0m16:07:02.901577 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m16:07:02.901967 [debug] [Thread-2 (]: Began running node model.ci_cd_project.tmp_new
[0m16:07:02.902442 [info ] [Thread-1 (]: 1 of 23 START sql view model analytics__pr_999__local.stg_orders ............... [RUN]
[0m16:07:02.904055 [info ] [Thread-2 (]: 2 of 23 START sql table model analytics__pr_999__local.tmp_new ................. [RUN]
[0m16:07:02.904592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_pr_999__local__pr_999__local, now model.ci_cd_project.stg_orders)
[0m16:07:02.905069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics__pr_999__local, now model.ci_cd_project.tmp_new)
[0m16:07:02.905465 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:07:02.905814 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:07:02.915348 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:07:02.917877 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:07:02.918593 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:07:02.930586 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:07:02.967239 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:07:02.969610 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:07:02.970325 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:02.970714 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:07:02.971069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:02.971436 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:07:02.971868 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:07:02.972187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:03.010729 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:07:03.011121 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:03.011465 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:07:03.011816 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      pr_999__local.analytics__pr_999__local.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:07:03.012159 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:07:03.012553 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics__pr_999__local.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:07:03.015467 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:07:03.022020 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:03.022406 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "pr_999__local"."analytics__pr_999__local"."tmp_new" rename to tmp_new__dbt_backup
[0m16:07:03.023714 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:07:03.026985 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:03.027772 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics__pr_999__local.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:07:03.028143 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
alter table pr_999__local.analytics__pr_999__local.tmp_new__dbt_tmp rename to tmp_new
[0m16:07:03.028508 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:07:03.029006 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: ROLLBACK
[0m16:07:03.029332 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:07:03.047595 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:07:03.047971 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:03.048311 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:07:03.049936 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:07:03.056062 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:07:03.056452 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists pr_999__local.analytics__pr_999__local.tmp_new__dbt_backup cascade
[0m16:07:03.057081 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:07:03.059288 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: Close
[0m16:07:03.060577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b744ac0>]}
[0m16:07:03.061155 [info ] [Thread-2 (]: 2 of 23 OK created sql table model analytics__pr_999__local.tmp_new ............ [[32mOK[0m in 0.15s]
[0m16:07:03.061746 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:07:03.064294 [debug] [Thread-1 (]: Failed to rollback 'model.ci_cd_project.stg_orders'
[0m16:07:03.064635 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m16:07:03.071408 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "analytics_dev.raw_orders, analytics_pr.raw_orders, or prod.analytics.raw_orders"?
  
  LINE 8:     select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
                            ^
[0m16:07:03.071908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f41fdd20-5a37-473d-87ae-31de901ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf195a0>]}
[0m16:07:03.072461 [error] [Thread-1 (]: 1 of 23 ERROR creating sql view model analytics__pr_999__local.stg_orders ...... [[31mERROR[0m in 0.17s]
[0m16:07:03.072996 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:07:03.073955 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:07:03.074342 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:07:03.074770 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:07:03.075417 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:07:03.075136 [info ] [Thread-4 (]: 3 of 23 SKIP test not_null_stg_orders_customer_id .............................. [[33mSKIP[0m]
[0m16:07:03.075867 [info ] [Thread-3 (]: 4 of 23 SKIP test not_null_stg_orders_order_id ................................. [[33mSKIP[0m]
[0m16:07:03.076270 [info ] [Thread-2 (]: 5 of 23 SKIP test not_null_stg_orders_total_amount ............................. [[33mSKIP[0m]
[0m16:07:03.076656 [info ] [Thread-1 (]: 6 of 23 SKIP test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mSKIP[0m]
[0m16:07:03.077037 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:07:03.077397 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:07:03.077753 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:07:03.078111 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:07:03.078557 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:07:03.078985 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:07:03.079589 [info ] [Thread-4 (]: 7 of 23 SKIP test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mSKIP[0m]
[0m16:07:03.080210 [info ] [Thread-3 (]: 8 of 23 SKIP test unique_stg_orders_order_id ................................... [[33mSKIP[0m]
[0m16:07:03.080863 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:07:03.081264 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:07:03.081919 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_customers
[0m16:07:03.082295 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m16:07:03.082687 [info ] [Thread-2 (]: 9 of 23 SKIP relation analytics__pr_999__local.dim_customers ................... [[33mSKIP[0m]
[0m16:07:03.083127 [info ] [Thread-1 (]: 10 of 23 SKIP relation analytics__pr_999__local.fct_orders ..................... [[33mSKIP[0m]
[0m16:07:03.083523 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:07:03.083877 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:07:03.084629 [debug] [Thread-3 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:07:03.085022 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:07:03.085384 [info ] [Thread-3 (]: 11 of 23 SKIP test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[33mSKIP[0m]
[0m16:07:03.085761 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:07:03.086098 [info ] [Thread-4 (]: 12 of 23 SKIP test not_null_dim_customers_customer_id .......................... [[33mSKIP[0m]
[0m16:07:03.086471 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:07:03.086825 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:07:03.087178 [info ] [Thread-2 (]: 13 of 23 SKIP test not_null_dim_customers_customer_tier ........................ [[33mSKIP[0m]
[0m16:07:03.087556 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:07:03.087900 [info ] [Thread-1 (]: 14 of 23 SKIP test not_null_dim_customers_total_orders ......................... [[33mSKIP[0m]
[0m16:07:03.088279 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:07:03.088661 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:07:03.089025 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:07:03.089375 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:07:03.089764 [info ] [Thread-3 (]: 15 of 23 SKIP test not_null_dim_customers_total_spent .......................... [[33mSKIP[0m]
[0m16:07:03.090146 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:07:03.090525 [info ] [Thread-4 (]: 16 of 23 SKIP test unique_dim_customers_customer_id ............................ [[33mSKIP[0m]
[0m16:07:03.090961 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:07:03.091370 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:07:03.091723 [info ] [Thread-2 (]: 17 of 23 SKIP test not_null_fct_orders_customer_id ............................. [[33mSKIP[0m]
[0m16:07:03.092105 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:07:03.092451 [info ] [Thread-1 (]: 18 of 23 SKIP test not_null_fct_orders_order_id ................................ [[33mSKIP[0m]
[0m16:07:03.092824 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:07:03.093200 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:07:03.093557 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:07:03.093908 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:07:03.094314 [info ] [Thread-3 (]: 19 of 23 SKIP test not_null_fct_orders_order_item_id ........................... [[33mSKIP[0m]
[0m16:07:03.094741 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:07:03.095240 [info ] [Thread-4 (]: 20 of 23 SKIP test not_null_fct_orders_product_id .............................. [[33mSKIP[0m]
[0m16:07:03.095654 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:07:03.096056 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:07:03.096413 [info ] [Thread-2 (]: 21 of 23 SKIP test not_null_fct_orders_quantity ................................ [[33mSKIP[0m]
[0m16:07:03.096850 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:07:03.097211 [info ] [Thread-1 (]: 22 of 23 SKIP test not_null_fct_orders_unit_price .............................. [[33mSKIP[0m]
[0m16:07:03.097596 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:07:03.097994 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:07:03.098420 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:07:03.098768 [info ] [Thread-3 (]: 23 of 23 SKIP test unique_fct_orders_order_item_id ............................. [[33mSKIP[0m]
[0m16:07:03.099270 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:07:03.100155 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:03.100458 [debug] [MainThread]: On master: BEGIN
[0m16:07:03.100728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:03.142312 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m16:07:03.142704 [debug] [MainThread]: On master: COMMIT
[0m16:07:03.143000 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:03.143274 [debug] [MainThread]: On master: COMMIT
[0m16:07:03.143658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:07:03.143977 [debug] [MainThread]: On master: Close
[0m16:07:03.145064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:03.145337 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m16:07:03.145589 [debug] [MainThread]: Connection 'model.ci_cd_project.tmp_new' was properly closed.
[0m16:07:03.145961 [info ] [MainThread]: 
[0m16:07:03.146282 [info ] [MainThread]: Finished running 3 table models, 1 view model, 19 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m16:07:03.147479 [debug] [MainThread]: Command end result
[0m16:07:03.222031 [info ] [MainThread]: 
[0m16:07:03.222459 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:07:03.222756 [info ] [MainThread]: 
[0m16:07:03.223125 [error] [MainThread]:   Runtime Error in model stg_orders (models/staging/stg_orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "analytics_dev.raw_orders, analytics_pr.raw_orders, or prod.analytics.raw_orders"?
  
  LINE 8:     select * from pr_999__local.pr_999__local__pr_999__local.raw_orders
                            ^
[0m16:07:03.223437 [info ] [MainThread]: 
[0m16:07:03.223746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=21 TOTAL=23
[0m16:07:03.227053 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.4179163, "process_in_blocks": "0", "process_kernel_time": 0.392552, "process_mem_max_rss": "167493632", "process_out_blocks": "0", "process_user_time": 5.849875}
[0m16:07:03.227469 [debug] [MainThread]: Command `dbt build` failed at 16:07:03.227390 after 4.42 seconds
[0m16:07:03.227812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc16950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc17100>]}
[0m16:07:03.228147 [debug] [MainThread]: Flushing usage events
[0m16:07:22.336826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d91930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a852c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8530a0>]}


============================== 16:07:22.341771 | 3188a07a-7ffc-4336-a360-31780d6df299 ==============================
[0m16:07:22.341771 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:07:22.342292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --target pr_999__local', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:07:22.345267 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'workshop_duckdb' does not have a target named 'pr_999__local'. The valid target names for this profile are:
   - dev
   - pr
   - prod
[0m16:07:22.347428 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.071017794, "process_in_blocks": "0", "process_kernel_time": 0.133572, "process_mem_max_rss": "98222080", "process_out_blocks": "0", "process_user_time": 1.126168}
[0m16:07:22.347946 [debug] [MainThread]: Command `dbt seed` failed at 16:07:22.347850 after 0.07 seconds
[0m16:07:22.348423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d91930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a853220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a851d80>]}
[0m16:07:22.349037 [debug] [MainThread]: Flushing usage events
[0m16:08:40.223758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad95990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c82acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c82b130>]}


============================== 16:08:40.228763 | b2ddb251-06f6-41ff-834b-cb9067b285c0 ==============================
[0m16:08:40.228763 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:08:40.229337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --target pr', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:40.488207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a309c60>]}
[0m16:08:40.537840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c908e80>]}
[0m16:08:40.542173 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:08:40.666563 [debug] [MainThread]: checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf, vars: {}, profile: , target: pr, version: 1.8.9
[0m16:08:40.791576 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:08:40.792031 [debug] [MainThread]: previous checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf, current checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84
[0m16:08:40.792331 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:08:40.792665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0f760>]}
[0m16:08:43.123665 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:08:43.124181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0a6650>]}
[0m16:08:43.507738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:08:43.508204 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:08:43.508535 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:08:43.508842 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:08:43.509137 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:08:43.509425 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:08:43.509711 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:08:43.509995 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:08:43.510275 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:08:43.510559 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:08:43.510839 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:08:43.511117 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:08:43.511396 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:08:43.511678 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:08:43.511961 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:08:43.512238 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:08:43.512516 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:08:43.512794 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:08:43.513070 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:08:43.513345 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:08:43.513624 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:08:43.513903 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:08:43.514181 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:08:43.514463 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:08:43.514739 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:08:43.515014 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:08:43.515294 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:08:43.515572 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:08:43.624186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19f280>]}
[0m16:08:43.773451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d17a890>]}
[0m16:08:43.773957 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:08:43.774298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d253c40>]}
[0m16:08:43.776483 [info ] [MainThread]: 
[0m16:08:43.776968 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:43.781998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:08:43.833258 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:08:43.833641 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:08:43.833943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:43.991689 [debug] [ThreadPool]: SQL status: OK in 0.158 seconds
[0m16:08:43.993191 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:08:43.995714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now create_pr_999__local_raw)
[0m16:08:43.996348 [debug] [ThreadPool]: Creating schema "database: "pr_999__local"
schema: "raw"
"
[0m16:08:44.003352 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_raw"
[0m16:08:44.003701 [debug] [ThreadPool]: On create_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_raw"} */

    
        select type from duckdb_databases()
        where database_name='pr_999__local'
        and type='sqlite'
    
  
[0m16:08:44.004000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:44.041230 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:08:44.042704 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_raw"
[0m16:08:44.043013 [debug] [ThreadPool]: On create_pr_999__local_raw: BEGIN
[0m16:08:44.043362 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:44.043632 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_raw"
[0m16:08:44.043905 [debug] [ThreadPool]: On create_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "create_pr_999__local_raw"} */

    
    
        create schema if not exists pr_999__local.raw
    
[0m16:08:44.044884 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:08:44.045670 [debug] [ThreadPool]: On create_pr_999__local_raw: COMMIT
[0m16:08:44.045983 [debug] [ThreadPool]: Using duckdb connection "create_pr_999__local_raw"
[0m16:08:44.046268 [debug] [ThreadPool]: On create_pr_999__local_raw: COMMIT
[0m16:08:44.047030 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:08:44.047319 [debug] [ThreadPool]: On create_pr_999__local_raw: Close
[0m16:08:44.055832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_pr_999__local_raw, now list_pr_999__local_analytics)
[0m16:08:44.062128 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:08:44.062561 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_raw'
[0m16:08:44.062843 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m16:08:44.065313 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m16:08:44.065622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:44.065921 [debug] [ThreadPool]: On list_pr_999__local_raw: BEGIN
[0m16:08:44.066260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:44.102924 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:08:44.103232 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:08:44.103523 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:08:44.103856 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m16:08:44.104175 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m16:08:44.104568 [debug] [ThreadPool]: On list_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_raw"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'pr_999__local'
  
[0m16:08:44.117628 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:08:44.117964 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:08:44.119183 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m16:08:44.120117 [debug] [ThreadPool]: On list_pr_999__local_raw: ROLLBACK
[0m16:08:44.120897 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m16:08:44.121254 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_raw'
[0m16:08:44.121534 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m16:08:44.121823 [debug] [ThreadPool]: On list_pr_999__local_raw: Close
[0m16:08:44.124142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ef4f0>]}
[0m16:08:44.124626 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:44.124940 [debug] [MainThread]: On master: BEGIN
[0m16:08:44.125214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:44.163678 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m16:08:44.164020 [debug] [MainThread]: On master: COMMIT
[0m16:08:44.164310 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:44.164583 [debug] [MainThread]: On master: COMMIT
[0m16:08:44.164937 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:44.165239 [debug] [MainThread]: On master: Close
[0m16:08:44.166279 [info ] [MainThread]: Concurrency: 4 threads (target='pr')
[0m16:08:44.166603 [info ] [MainThread]: 
[0m16:08:44.168617 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:08:44.168998 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:08:44.169453 [info ] [Thread-1 (]: 1 of 4 START seed file raw.raw_customers ....................................... [RUN]
[0m16:08:44.169851 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:08:44.170265 [info ] [Thread-2 (]: 2 of 4 START seed file raw.raw_order_items ..................................... [RUN]
[0m16:08:44.170625 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m16:08:44.170997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now seed.ci_cd_project.raw_customers)
[0m16:08:44.171422 [info ] [Thread-3 (]: 3 of 4 START seed file raw.raw_orders .......................................... [RUN]
[0m16:08:44.171883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_raw, now seed.ci_cd_project.raw_order_items)
[0m16:08:44.172371 [info ] [Thread-4 (]: 4 of 4 START seed file raw.raw_products ........................................ [RUN]
[0m16:08:44.172803 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:08:44.173256 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m16:08:44.173614 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:08:44.174038 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m16:08:44.174384 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:08:44.174706 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:08:44.175030 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:08:44.175391 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:08:44.189362 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:08:44.202608 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:08:44.208571 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:08:44.210919 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:08:44.217339 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:08:44.219385 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:08:44.219725 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:08:44.220093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:08:44.223209 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:08:44.223558 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:08:44.223883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:08:44.224290 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:08:44.224612 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:08:44.224984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:08:44.263529 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m16:08:44.263910 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:08:44.264335 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m16:08:44.264740 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table pr_999__local.raw.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m16:08:44.265069 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m16:08:44.265390 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:08:44.265684 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m16:08:44.266102 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:08:44.266451 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table pr_999__local.raw.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m16:08:44.266791 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:08:44.267127 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table pr_999__local.raw.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m16:08:44.267443 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:08:44.267813 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "seed.ci_cd_project.raw_products"} */

    create table pr_999__local.raw.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m16:08:44.274591 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:08:44.274919 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:08:44.279551 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:08:44.280567 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:08:44.280905 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:08:44.281819 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:08:44.282176 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY pr_999__local.raw.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:08:44.282517 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY pr_999__local.raw.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:08:44.283401 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:08:44.283745 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY pr_999__local.raw.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:08:44.284222 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY pr_999__local.raw.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:08:44.295881 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m16:08:44.296260 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:08:44.296612 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m16:08:44.301663 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:08:44.302040 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m16:08:44.302530 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:08:44.303022 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:08:44.303600 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:08:44.320453 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:08:44.320838 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:08:44.321175 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:08:44.322472 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:08:44.323656 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:08:44.324049 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:08:44.324401 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:08:44.324762 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:08:44.326579 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:08:44.326938 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:08:44.328664 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:08:44.329013 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:08:44.329345 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:08:44.330805 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d162d70>]}
[0m16:08:44.331176 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:08:44.331525 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:08:44.331883 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:08:44.332312 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file raw.raw_order_items ................................. [[32mINSERT 14[0m in 0.16s]
[0m16:08:44.332992 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:08:44.333675 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m16:08:44.334168 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:08:44.334474 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:08:44.334890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d160220>]}
[0m16:08:44.335278 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d163550>]}
[0m16:08:44.335977 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:08:44.336410 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file raw.raw_customers ................................... [[32mINSERT 10[0m in 0.16s]
[0m16:08:44.336916 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file raw.raw_products .................................... [[32mINSERT 10[0m in 0.16s]
[0m16:08:44.337553 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:08:44.338072 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:08:44.375684 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ddb251-06f6-41ff-834b-cb9067b285c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6d39d0>]}
[0m16:08:44.376966 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file raw.raw_orders ...................................... [[32mINSERT 10[0m in 0.20s]
[0m16:08:44.377689 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:08:44.381465 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:44.382056 [debug] [MainThread]: On master: BEGIN
[0m16:08:44.382501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:44.423784 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m16:08:44.424180 [debug] [MainThread]: On master: COMMIT
[0m16:08:44.424483 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:44.424761 [debug] [MainThread]: On master: COMMIT
[0m16:08:44.425151 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:08:44.425496 [debug] [MainThread]: On master: Close
[0m16:08:44.426583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:44.426870 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m16:08:44.427130 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m16:08:44.427380 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m16:08:44.427657 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m16:08:44.427993 [info ] [MainThread]: 
[0m16:08:44.428311 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m16:08:44.429235 [debug] [MainThread]: Command end result
[0m16:08:44.538840 [info ] [MainThread]: 
[0m16:08:44.539307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:44.539620 [info ] [MainThread]: 
[0m16:08:44.539932 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:08:44.542897 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.3795238, "process_in_blocks": "0", "process_kernel_time": 0.431374, "process_mem_max_rss": "171966464", "process_out_blocks": "0", "process_user_time": 5.924094}
[0m16:08:44.543324 [debug] [MainThread]: Command `dbt seed` succeeded at 16:08:44.543241 after 4.38 seconds
[0m16:08:44.543673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad95990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06a8c0>]}
[0m16:08:44.544022 [debug] [MainThread]: Flushing usage events
[0m16:08:58.187435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109629930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0eee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ef280>]}


============================== 16:08:58.192338 | ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67 ==============================
[0m16:08:58.192338 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:08:58.192877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s state:modified+ --state ./state --target pr --vars schema_id: pr_999__local', 'send_anonymous_usage_stats': 'True'}
[0m16:08:58.427140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b89c00>]}
[0m16:08:58.477257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21a8f0>]}
[0m16:08:58.481394 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:08:58.608687 [debug] [MainThread]: checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, vars: {'schema_id': 'pr_999__local'}, profile: , target: pr, version: 1.8.9
[0m16:08:58.731342 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:08:58.731770 [debug] [MainThread]: previous checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84, current checksum: 85573b17408f7c2ea530975154832a42cc97d290a342375df247c9e96a8a34cf
[0m16:08:58.732067 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:08:58.732397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a3d60>]}
[0m16:09:01.072206 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:09:01.072716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4788b0>]}
[0m16:09:01.457620 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:09:01.458113 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:09:01.458444 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:09:01.458754 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:09:01.459047 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:09:01.459334 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:09:01.459626 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:09:01.459915 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:09:01.460198 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:09:01.460479 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:09:01.460759 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:09:01.461036 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:09:01.461316 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:09:01.461603 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:09:01.461882 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:09:01.462161 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:09:01.462440 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:09:01.462719 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:09:01.462997 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:09:01.463273 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:09:01.463556 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:09:01.463835 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:09:01.464114 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:09:01.464393 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:09:01.464675 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:09:01.464956 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:09:01.465231 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:09:01.465511 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:09:01.573307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba38d90>]}
[0m16:09:01.859792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9babf0>]}
[0m16:09:01.860335 [info ] [MainThread]: Found 8 models, 4 seeds, 41 data tests, 880 macros
[0m16:09:01.869606 [info ] [MainThread]: 
[0m16:09:01.870184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:09:01.875920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m16:09:01.927390 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m16:09:01.927899 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m16:09:01.928215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:02.080180 [debug] [ThreadPool]: SQL status: OK in 0.152 seconds
[0m16:09:02.081685 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m16:09:02.084778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now list_pr_999__local_raw)
[0m16:09:02.090882 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m16:09:02.091374 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_analytics'
[0m16:09:02.091804 [debug] [ThreadPool]: On list_pr_999__local_raw: BEGIN
[0m16:09:02.094331 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:09:02.094662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:02.094960 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m16:09:02.095410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:02.137141 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:09:02.137539 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m16:09:02.137849 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:09:02.138179 [debug] [ThreadPool]: On list_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_raw"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'pr_999__local'
  
[0m16:09:02.138500 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m16:09:02.138915 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m16:09:02.150706 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:09:02.151045 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:09:02.152328 [debug] [ThreadPool]: On list_pr_999__local_raw: ROLLBACK
[0m16:09:02.153461 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m16:09:02.154254 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_raw'
[0m16:09:02.154580 [debug] [ThreadPool]: On list_pr_999__local_raw: Close
[0m16:09:02.154931 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m16:09:02.155464 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m16:09:02.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fd9c0>]}
[0m16:09:02.158742 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:02.159028 [debug] [MainThread]: On master: BEGIN
[0m16:09:02.159293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:02.198729 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m16:09:02.199082 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.199384 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:02.199662 [debug] [MainThread]: On master: COMMIT
[0m16:09:02.200033 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:02.200369 [debug] [MainThread]: On master: Close
[0m16:09:02.201424 [info ] [MainThread]: Concurrency: 4 threads (target='pr')
[0m16:09:02.201754 [info ] [MainThread]: 
[0m16:09:02.203955 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m16:09:02.205477 [debug] [Thread-2 (]: Began running node model.ci_cd_project.tmp_new
[0m16:09:02.205963 [info ] [Thread-1 (]: 1 of 23 START sql view model analytics.stg_orders .............................. [RUN]
[0m16:09:02.206493 [info ] [Thread-2 (]: 2 of 23 START sql table model analytics.tmp_new ................................ [RUN]
[0m16:09:02.206933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_raw, now model.ci_cd_project.stg_orders)
[0m16:09:02.207363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now model.ci_cd_project.tmp_new)
[0m16:09:02.207710 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:09:02.208039 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.tmp_new
[0m16:09:02.216998 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:09:02.219432 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.tmp_new"
[0m16:09:02.220257 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.tmp_new
[0m16:09:02.220616 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:09:02.272197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:09:02.272773 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.tmp_new"
[0m16:09:02.273476 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.273836 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: BEGIN
[0m16:09:02.274162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.274679 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.275042 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:09:02.275364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.313771 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.314168 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.314514 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.314841 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */

  
    
    

    create  table
      pr_999__local.analytics.tmp_new__dbt_tmp
  
    as (
      select 1 as x
    );
  
  
[0m16:09:02.315181 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.315570 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view pr_999__local.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from pr_999__local.raw.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:09:02.316442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:09:02.323069 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.323433 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:09:02.323788 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "pr_999__local"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m16:09:02.327023 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.327521 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
alter table "pr_999__local"."analytics"."tmp_new" rename to tmp_new__dbt_backup
[0m16:09:02.327978 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.331193 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.331551 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.331885 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */
alter view pr_999__local.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:09:02.335898 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.336333 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
alter table pr_999__local.analytics.tmp_new__dbt_tmp rename to tmp_new
[0m16:09:02.336720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:09:02.343354 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:09:02.358507 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:09:02.358925 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:09:02.359287 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.359638 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.359973 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:09:02.360296 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: COMMIT
[0m16:09:02.361327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.366617 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:09:02.367012 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists pr_999__local.analytics.stg_orders__dbt_backup cascade
[0m16:09:02.367361 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:09:02.370186 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.tmp_new"
[0m16:09:02.370547 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.tmp_new"} */
drop table if exists pr_999__local.analytics.tmp_new__dbt_backup cascade
[0m16:09:02.370873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.373098 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m16:09:02.374040 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.375317 [debug] [Thread-2 (]: On model.ci_cd_project.tmp_new: Close
[0m16:09:02.375874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cfa30>]}
[0m16:09:02.376474 [info ] [Thread-1 (]: 1 of 23 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.17s]
[0m16:09:02.377010 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:09:02.377647 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:09:02.378039 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:09:02.378689 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:09:02.378406 [info ] [Thread-4 (]: 3 of 23 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m16:09:02.379132 [info ] [Thread-3 (]: 4 of 23 START test not_null_stg_orders_order_id ................................ [RUN]
[0m16:09:02.379528 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m16:09:02.380030 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:09:02.380530 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:09:02.380932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m16:09:02.381306 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:09:02.381665 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:09:02.382023 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:09:02.391964 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:09:02.392447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fd9c0>]}
[0m16:09:02.396715 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:09:02.400796 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:09:02.401495 [info ] [Thread-2 (]: 2 of 23 OK created sql table model analytics.tmp_new ........................... [[32mOK[0m in 0.19s]
[0m16:09:02.402284 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.tmp_new
[0m16:09:02.402641 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:09:02.403084 [debug] [Thread-2 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:09:02.408910 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:09:02.415568 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:09:02.421178 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:09:02.415989 [info ] [Thread-2 (]: 6 of 23 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m16:09:02.425218 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:09:02.428003 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:09:02.428817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.tmp_new, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m16:09:02.429394 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:09:02.434338 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:09:02.434767 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:09:02.435236 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m16:09:02.435619 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:09:02.435991 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:09:02.436323 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:02.436675 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:09:02.437007 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:09:02.437343 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m16:09:02.437733 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:02.440593 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:09:02.440962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.441778 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:09:02.442137 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m16:09:02.442463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.476015 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.476482 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:09:02.476843 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m16:09:02.477197 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.477554 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.477893 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m16:09:02.478220 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:09:02.478540 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:09:02.478992 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:09:02.479367 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from pr_999__local.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.479760 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from pr_999__local.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.480189 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from pr_999__local.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from pr_999__local.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.480560 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.483842 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m16:09:02.484354 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:09:02.484695 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.485030 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.485372 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m16:09:02.485694 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:09:02.486932 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:09:02.488145 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m16:09:02.488679 [info ] [Thread-4 (]: 3 of 23 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.11s]
[0m16:09:02.489190 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:09:02.490265 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m16:09:02.490672 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m16:09:02.491170 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:09:02.491504 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:09:02.491912 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m16:09:02.492229 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m16:09:02.492630 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:09:02.493058 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m16:09:02.493518 [info ] [Thread-3 (]: 4 of 23 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.11s]
[0m16:09:02.494014 [info ] [Thread-4 (]: 7 of 23 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m16:09:02.494655 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_orders_total_amount .................................. [[32mPASS[0m in 0.11s]
[0m16:09:02.495249 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:09:02.495760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:09:02.496250 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:09:02.496739 [info ] [Thread-2 (]: 6 of 23 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_ . [[32mPASS[0m in 0.07s]
[0m16:09:02.497144 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:09:02.497526 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:09:02.498081 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:09:02.498429 [info ] [Thread-3 (]: 8 of 23 START test unique_stg_orders_order_id .................................. [RUN]
[0m16:09:02.505123 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:09:02.505603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m16:09:02.506040 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:09:02.512414 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:09:02.512941 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:09:02.515816 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:09:02.516271 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:09:02.519025 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:09:02.519527 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:09:02.519912 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m16:09:02.520257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:02.520612 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:09:02.521003 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:09:02.521312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:02.559211 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.559576 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:09:02.559914 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.560312 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from pr_999__local.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from pr_999__local.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.560690 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:09:02.561218 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:09:02.562680 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.564072 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m16:09:02.564474 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.564861 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m16:09:02.566032 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:09:02.566364 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m16:09:02.566754 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m16:09:02.567272 [info ] [Thread-4 (]: 7 of 23 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.07s]
[0m16:09:02.567658 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:09:02.568141 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:09:02.569403 [info ] [Thread-3 (]: 8 of 23 PASS unique_stg_orders_order_id ........................................ [[32mPASS[0m in 0.06s]
[0m16:09:02.569915 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:09:02.570534 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_customers
[0m16:09:02.570940 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m16:09:02.571400 [info ] [Thread-1 (]: 9 of 23 START sql table model analytics.dim_customers .......................... [RUN]
[0m16:09:02.571871 [info ] [Thread-2 (]: 10 of 23 START sql table model analytics.fct_orders ............................ [RUN]
[0m16:09:02.572329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now model.ci_cd_project.dim_customers)
[0m16:09:02.572711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.ci_cd_project.fct_orders)
[0m16:09:02.573059 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:09:02.573387 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:09:02.578805 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:09:02.582865 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:09:02.583723 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:09:02.587629 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:09:02.588008 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:09:02.591682 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:09:02.592200 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.592569 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:09:02.592911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.593255 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.593640 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:09:02.593946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.632824 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.633214 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.633544 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.633915 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      pr_999__local.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from pr_999__local.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from pr_999__local.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:09:02.634292 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.634826 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      pr_999__local.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from pr_999__local.analytics.stg_orders
),

order_items as (
    select * from pr_999__local.analytics.stg_order_items
),

products as (
    select * from pr_999__local.analytics.stg_products
),

customers as (
    select * from pr_999__local.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:09:02.637626 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.642016 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.642389 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "pr_999__local"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m16:09:02.642743 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:09:02.646026 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.646389 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "pr_999__local"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m16:09:02.646733 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.649975 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.650332 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.dim_customers"} */
alter table pr_999__local.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:09:02.650665 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.653867 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.654218 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.fct_orders"} */
alter table pr_999__local.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:09:02.654564 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:09:02.655819 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:09:02.656172 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.656504 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:09:02.656865 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.657983 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:09:02.658314 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.658631 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.658936 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:09:02.662582 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:09:02.663000 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists pr_999__local.analytics.dim_customers__dbt_backup cascade
[0m16:09:02.663383 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:09:02.666138 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:09:02.666476 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:09:02.666824 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists pr_999__local.analytics.fct_orders__dbt_backup cascade
[0m16:09:02.667930 [debug] [Thread-1 (]: On model.ci_cd_project.dim_customers: Close
[0m16:09:02.668472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c40b220>]}
[0m16:09:02.669315 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.669038 [info ] [Thread-1 (]: 9 of 23 OK created sql table model analytics.dim_customers ..................... [[32mOK[0m in 0.10s]
[0m16:09:02.670466 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m16:09:02.670948 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:09:02.671603 [debug] [Thread-3 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:09:02.671968 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:09:02.672312 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:09:02.672655 [info ] [Thread-3 (]: 11 of 23 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m16:09:02.673076 [info ] [Thread-4 (]: 12 of 23 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m16:09:02.673460 [info ] [Thread-1 (]: 13 of 23 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m16:09:02.673907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m16:09:02.674283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:09:02.674647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m16:09:02.674996 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:09:02.675477 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:09:02.675841 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:09:02.680970 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:09:02.685233 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:09:02.685713 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4cbb7e-bb6b-4f23-87a4-3916fad1ff67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c43f730>]}
[0m16:09:02.690730 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:09:02.691476 [info ] [Thread-2 (]: 10 of 23 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.11s]
[0m16:09:02.692127 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:09:02.692603 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:09:02.693045 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:09:02.693826 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:09:02.693381 [info ] [Thread-2 (]: 14 of 23 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m16:09:02.694285 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:09:02.697085 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:09:02.700097 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:09:02.700511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m16:09:02.703299 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:09:02.703862 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:09:02.749275 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:09:02.749775 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:09:02.750296 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:09:02.750720 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:09:02.751064 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:02.751431 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:09:02.751808 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m16:09:02.752245 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:09:02.752586 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m16:09:02.752922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.755790 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:09:02.756164 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:02.756961 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:09:02.757300 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m16:09:02.757615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.791057 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.791430 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:09:02.791771 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m16:09:02.792138 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.792468 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.792829 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m16:09:02.793142 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:09:02.793462 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:09:02.793885 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:09:02.794277 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from pr_999__local.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m16:09:02.794618 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.794962 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from pr_999__local.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.795326 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from pr_999__local.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.796805 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:09:02.797253 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.797629 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:09:02.797946 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.798377 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m16:09:02.799464 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m16:09:02.800677 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m16:09:02.801760 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m16:09:02.802089 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:09:02.802478 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m16:09:02.802850 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m16:09:02.803222 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m16:09:02.803578 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m16:09:02.804059 [info ] [Thread-4 (]: 12 of 23 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m16:09:02.804453 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m16:09:02.804784 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m16:09:02.805295 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:09:02.805747 [info ] [Thread-1 (]: 13 of 23 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.13s]
[0m16:09:02.806306 [info ] [Thread-2 (]: 14 of 23 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.11s]
[0m16:09:02.806752 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:09:02.807282 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:09:02.807755 [info ] [Thread-3 (]: 11 of 23 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.13s]
[0m16:09:02.808232 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:09:02.808577 [info ] [Thread-4 (]: 15 of 23 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m16:09:02.808966 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:09:02.809443 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:09:02.809842 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:09:02.810281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m16:09:02.810697 [info ] [Thread-1 (]: 16 of 23 START test unique_dim_customers_customer_id ........................... [RUN]
[0m16:09:02.811117 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:09:02.811483 [info ] [Thread-2 (]: 17 of 23 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m16:09:02.811891 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:09:02.812363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m16:09:02.812722 [info ] [Thread-3 (]: 18 of 23 START test not_null_fct_orders_order_id ............................... [RUN]
[0m16:09:02.813106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m16:09:02.817488 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:09:02.817860 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:09:02.818230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m16:09:02.818573 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:09:02.822688 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:09:02.823105 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:09:02.828306 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:09:02.828669 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:09:02.832715 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:09:02.835643 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:09:02.836046 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:09:02.836478 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:09:02.839334 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:09:02.842876 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:09:02.843333 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:09:02.843672 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:09:02.844090 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m16:09:02.844622 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:09:02.847399 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:09:02.847794 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:09:02.848122 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:02.848456 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m16:09:02.848856 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m16:09:02.849287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.849652 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:09:02.849958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.850310 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m16:09:02.850663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:02.888857 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m16:09:02.889271 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:09:02.889621 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from pr_999__local.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.889969 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.890283 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m16:09:02.890577 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.891019 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:09:02.891403 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:09:02.891723 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.892044 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:09:02.892382 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from pr_999__local.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.892750 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:09:02.894055 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m16:09:02.894434 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from pr_999__local.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.895043 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m16:09:02.895401 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.895821 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m16:09:02.896132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.896494 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.897654 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m16:09:02.898223 [info ] [Thread-4 (]: 15 of 23 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.09s]
[0m16:09:02.899454 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m16:09:02.900524 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m16:09:02.900911 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m16:09:02.901403 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:09:02.901791 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m16:09:02.902166 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m16:09:02.902487 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m16:09:02.902870 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:09:02.903241 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m16:09:02.903577 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m16:09:02.904048 [info ] [Thread-2 (]: 17 of 23 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.09s]
[0m16:09:02.904465 [info ] [Thread-4 (]: 19 of 23 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m16:09:02.905081 [info ] [Thread-1 (]: 16 of 23 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m16:09:02.905666 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:09:02.906092 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m16:09:02.906592 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:09:02.907050 [info ] [Thread-3 (]: 18 of 23 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.09s]
[0m16:09:02.907444 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:09:02.907810 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:09:02.908186 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:09:02.908676 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:09:02.909020 [info ] [Thread-2 (]: 20 of 23 START test not_null_fct_orders_product_id ............................. [RUN]
[0m16:09:02.913778 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:09:02.914193 [info ] [Thread-1 (]: 21 of 23 START test not_null_fct_orders_quantity ............................... [RUN]
[0m16:09:02.914619 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:09:02.915040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m16:09:02.915507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m16:09:02.915908 [info ] [Thread-3 (]: 22 of 23 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m16:09:02.916299 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:09:02.916648 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:09:02.916963 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:09:02.917321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m16:09:02.921521 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:09:02.926831 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:09:02.929963 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:09:02.930357 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:09:02.934604 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:09:02.935172 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:09:02.935515 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:09:02.935892 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:09:02.938688 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:09:02.942240 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:09:02.942598 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:09:02.942929 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m16:09:02.945960 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:09:02.946375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:02.946745 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:09:02.947131 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:09:02.947578 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m16:09:02.947948 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:09:02.948275 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m16:09:02.948597 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:02.948930 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m16:09:02.949263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:02.949609 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:09:02.986051 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m16:09:02.986477 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:09:02.986838 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from pr_999__local.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.987188 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m16:09:02.987492 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m16:09:02.987784 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m16:09:02.988173 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:09:02.988502 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:09:02.988798 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.989107 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:09:02.989441 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from pr_999__local.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.989797 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from pr_999__local.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.990219 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from pr_999__local.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m16:09:02.991522 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m16:09:02.992384 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m16:09:02.992717 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m16:09:02.993045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.993376 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:09:02.993710 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:09:02.994243 [info ] [Thread-4 (]: 19 of 23 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.09s]
[0m16:09:02.995514 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m16:09:02.996634 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m16:09:02.997170 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:09:02.998310 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m16:09:02.998729 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m16:09:02.999114 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m16:09:02.999505 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:09:02.999942 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m16:09:03.000281 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m16:09:03.000599 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m16:09:03.000962 [info ] [Thread-4 (]: 23 of 23 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m16:09:03.001352 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m16:09:03.001856 [info ] [Thread-1 (]: 21 of 23 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m16:09:03.002547 [info ] [Thread-3 (]: 22 of 23 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.09s]
[0m16:09:03.002985 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m16:09:03.003552 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:09:03.004020 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:09:03.004368 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:09:03.004833 [info ] [Thread-2 (]: 20 of 23 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m16:09:03.009437 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:09:03.009964 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:09:03.010557 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:09:03.013628 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:09:03.014240 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:09:03.014576 [debug] [Thread-4 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m16:09:03.014891 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:09:03.053443 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:09:03.053828 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:09:03.054183 [debug] [Thread-4 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "pr", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from pr_999__local.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:09:03.055046 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:09:03.056318 [debug] [Thread-4 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m16:09:03.056743 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m16:09:03.057069 [debug] [Thread-4 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m16:09:03.058246 [info ] [Thread-4 (]: 23 of 23 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.06s]
[0m16:09:03.058786 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:09:03.059747 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:03.060040 [debug] [MainThread]: On master: BEGIN
[0m16:09:03.060304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:03.100276 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m16:09:03.100669 [debug] [MainThread]: On master: COMMIT
[0m16:09:03.100970 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:03.101248 [debug] [MainThread]: On master: COMMIT
[0m16:09:03.101619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:09:03.101957 [debug] [MainThread]: On master: Close
[0m16:09:03.103020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:03.103306 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m16:09:03.103566 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m16:09:03.103819 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m16:09:03.104068 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m16:09:03.104425 [info ] [MainThread]: 
[0m16:09:03.104744 [info ] [MainThread]: Finished running 1 view model, 3 table models, 19 data tests in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m16:09:03.107698 [debug] [MainThread]: Command end result
[0m16:09:03.180881 [info ] [MainThread]: 
[0m16:09:03.181319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:03.181648 [info ] [MainThread]: 
[0m16:09:03.181968 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m16:09:03.185637 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0563374, "process_in_blocks": "0", "process_kernel_time": 0.50037, "process_mem_max_rss": "182272000", "process_out_blocks": "0", "process_user_time": 7.545265}
[0m16:09:03.186079 [debug] [MainThread]: Command `dbt build` succeeded at 16:09:03.185993 after 5.06 seconds
[0m16:09:03.186434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109629930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b2170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b1ff0>]}
[0m16:09:03.186779 [debug] [MainThread]: Flushing usage events
[0m18:00:52.419542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf8ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf8b0d0>]}


============================== 18:00:52.424514 | 292363ad-53b8-422d-8a6d-13521dd87b63 ==============================
[0m18:00:52.424514 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:00:52.425038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --target prod', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:52.681077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0dd4e0>]}
[0m18:00:52.730379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a0910>]}
[0m18:00:52.734525 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m18:00:52.859503 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m18:00:52.983204 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:00:52.983616 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 68a0f8730e845b87166efa3131358138b8954f323c10c2daed317ee87324dd84
[0m18:00:52.983910 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:00:52.984232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c36f760>]}
[0m18:00:55.343650 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:55.344158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1941c0>]}
[0m18:00:55.722332 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m18:00:55.722786 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m18:00:55.723116 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m18:00:55.723431 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m18:00:55.723728 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m18:00:55.724021 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m18:00:55.724315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m18:00:55.724602 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m18:00:55.724884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m18:00:55.725167 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m18:00:55.725446 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m18:00:55.725728 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m18:00:55.726010 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m18:00:55.726291 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m18:00:55.726569 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m18:00:55.726848 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m18:00:55.727124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m18:00:55.727402 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m18:00:55.727675 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m18:00:55.727953 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m18:00:55.728232 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m18:00:55.728511 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m18:00:55.728792 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m18:00:55.729073 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m18:00:55.729354 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m18:00:55.729635 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m18:00:55.729918 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m18:00:55.730198 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m18:00:55.840227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d942830>]}
[0m18:00:55.990852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da59fc0>]}
[0m18:00:55.991337 [info ] [MainThread]: Found 7 models, 15 seeds, 41 data tests, 880 macros
[0m18:00:55.991676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '292363ad-53b8-422d-8a6d-13521dd87b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5b580>]}
[0m18:00:55.994310 [info ] [MainThread]: 
[0m18:00:55.994794 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:00:56.000986 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m18:00:56.064932 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m18:00:56.065309 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m18:00:56.065612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:56.118769 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m18:00:56.119144 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:00:56.119794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:56.120082 [debug] [MainThread]: Connection 'list_pr_999__local' was properly closed.
[0m18:00:56.120374 [info ] [MainThread]: 
[0m18:00:56.120697 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m18:00:56.121133 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/preben/Documents/dbt-workshop/./warehouse/pr_999__local.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m18:00:56.123929 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.7658138, "process_in_blocks": "0", "process_kernel_time": 0.308683, "process_mem_max_rss": "141557760", "process_out_blocks": "0", "process_user_time": 4.545157}
[0m18:00:56.124321 [debug] [MainThread]: Command `dbt seed` failed at 18:00:56.124243 after 3.77 seconds
[0m18:00:56.124653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f5960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da59ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da51fc0>]}
[0m18:00:56.124998 [debug] [MainThread]: Flushing usage events
[0m18:01:58.990649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107549990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109009c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109009180>]}


============================== 18:01:58.995659 | d59fe3e7-9b9d-4c86-97c5-c03cb64d94b0 ==============================
[0m18:01:58.995659 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:01:58.996213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --target prod', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:01:59.254847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a89c60>]}
[0m18:01:59.304405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c18d0>]}
[0m18:01:59.308667 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m18:01:59.435138 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m18:01:59.673144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:59.673567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:59.727491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109888130>]}
[0m18:01:59.907883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c2590>]}
[0m18:01:59.908398 [info ] [MainThread]: Found 7 models, 15 seeds, 41 data tests, 880 macros
[0m18:01:59.908741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a3e50>]}
[0m18:01:59.911409 [info ] [MainThread]: 
[0m18:01:59.911901 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:59.917833 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m18:01:59.971393 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m18:01:59.971779 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m18:01:59.972083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:00.118955 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m18:02:00.120980 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m18:02:00.124756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now list_pr_999__local_analytics)
[0m18:02:00.131544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_raw'
[0m18:02:00.131109 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m18:02:00.134161 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m18:02:00.134507 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m18:02:00.134864 [debug] [ThreadPool]: On list_pr_999__local_raw: BEGIN
[0m18:02:00.135158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:00.135451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:00.173396 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m18:02:00.173791 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m18:02:00.174103 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m18:02:00.174440 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m18:02:00.174759 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m18:02:00.175110 [debug] [ThreadPool]: On list_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local_raw"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'pr_999__local'
  
[0m18:02:00.190449 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:02:00.190822 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m18:02:00.192134 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m18:02:00.193199 [debug] [ThreadPool]: On list_pr_999__local_raw: ROLLBACK
[0m18:02:00.193981 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m18:02:00.194349 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_raw'
[0m18:02:00.194625 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m18:02:00.194917 [debug] [ThreadPool]: On list_pr_999__local_raw: Close
[0m18:02:00.197835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e75ae0>]}
[0m18:02:00.198314 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:00.198616 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.198890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:00.238058 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m18:02:00.238448 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.238761 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:00.239050 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.239474 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:00.239806 [debug] [MainThread]: On master: Close
[0m18:02:00.240927 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:02:00.241266 [info ] [MainThread]: 
[0m18:02:00.243986 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m18:02:00.244378 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m18:02:00.244831 [info ] [Thread-1 (]: 1 of 15 START seed file raw.categories ......................................... [RUN]
[0m18:02:00.245209 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m18:02:00.245545 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m18:02:00.245876 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.order_details
[0m18:02:00.246281 [info ] [Thread-2 (]: 2 of 15 START seed file raw.customers .......................................... [RUN]
[0m18:02:00.246742 [debug] [Thread-6 (]: Began running node seed.ci_cd_project.orders
[0m18:02:00.247130 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.products
[0m18:02:00.247498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now seed.ci_cd_project.categories)
[0m18:02:00.247911 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.raw_customers
[0m18:02:00.248338 [info ] [Thread-3 (]: 3 of 15 START seed file raw.employee_territories ............................... [RUN]
[0m18:02:00.248816 [info ] [Thread-4 (]: 4 of 15 START seed file raw.employees .......................................... [RUN]
[0m18:02:00.249281 [info ] [Thread-5 (]: 5 of 15 START seed file raw.order_details ...................................... [RUN]
[0m18:02:00.249690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_raw, now seed.ci_cd_project.customers)
[0m18:02:00.250108 [info ] [Thread-6 (]: 6 of 15 START seed file raw.orders ............................................. [RUN]
[0m18:02:00.250533 [info ] [Thread-7 (]: 7 of 15 START seed file raw.products ........................................... [RUN]
[0m18:02:00.250884 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m18:02:00.251310 [info ] [Thread-8 (]: 8 of 15 START seed file raw.raw_customers ...................................... [RUN]
[0m18:02:00.251807 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m18:02:00.252230 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m18:02:00.252635 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.ci_cd_project.order_details'
[0m18:02:00.252957 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m18:02:00.253348 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.ci_cd_project.orders'
[0m18:02:00.253736 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.ci_cd_project.products'
[0m18:02:00.254064 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m18:02:00.254456 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_customers'
[0m18:02:00.254771 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m18:02:00.255074 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m18:02:00.255377 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.order_details
[0m18:02:00.255684 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m18:02:00.255986 [debug] [Thread-6 (]: Began compiling node seed.ci_cd_project.orders
[0m18:02:00.256285 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.products
[0m18:02:00.269158 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m18:02:00.274670 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m18:02:00.282081 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m18:02:00.286378 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:02:00.286785 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.order_details
[0m18:02:00.290262 [debug] [Thread-6 (]: Began executing node seed.ci_cd_project.orders
[0m18:02:00.290648 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.products
[0m18:02:00.292946 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:02:00.293281 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.raw_customers
[0m18:02:00.297993 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:02:00.301747 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m18:02:00.309778 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:02:00.338195 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m18:02:00.371222 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:02:00.394349 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m18:02:00.410036 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:02:00.434694 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:02:00.444452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:00.447854 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:02:00.448350 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m18:02:00.448704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:00.449055 [debug] [Thread-7 (]: On seed.ci_cd_project.products: BEGIN
[0m18:02:00.449373 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:02:00.449686 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: BEGIN
[0m18:02:00.449997 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m18:02:00.450393 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: BEGIN
[0m18:02:00.450716 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:02:00.451080 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:02:00.451449 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:02:00.451765 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:02:00.452073 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:02:00.486589 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m18:02:00.487004 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:02:00.487420 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.487814 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.categories"} */

    create table pr_999__local.raw.categories (categoryID integer,categoryName text,description text,picture text)
  
[0m18:02:00.488197 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m18:02:00.488515 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.488941 [debug] [Thread-7 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.489350 [debug] [Thread-6 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.489660 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.489961 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:02:00.490272 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m18:02:00.490621 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:02:00.491976 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:02:00.492303 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:02:00.492641 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:02:00.492958 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.493269 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:02:00.493597 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employee_territories"} */

    create table pr_999__local.raw.employee_territories (employeeID integer,territoryID integer)
  
[0m18:02:00.493922 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:02:00.494245 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.customers"} */

    create table pr_999__local.raw.customers (customerID text,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text)
  
[0m18:02:00.494591 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employees"} */

    create table pr_999__local.raw.employees (employeeID integer,lastName text,firstName text,title text,titleOfCourtesy text,birthDate text,hireDate text,address text,city text,region text,postalCode text,country text,homePhone text,extension integer,photo text,notes text,reportsTo integer,photoPath text)
  
[0m18:02:00.494939 [debug] [Thread-7 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.products"} */

    create table pr_999__local.raw.products (productID integer,productName text,supplierID integer,categoryID integer,quantityPerUnit text,unitPrice float8,unitsInStock integer,unitsOnOrder integer,reorderLevel integer,discontinued integer)
  
[0m18:02:00.495281 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.orders"} */

    create table pr_999__local.raw.orders (orderID integer,customerID text,employeeID integer,orderDate text,requiredDate text,shippedDate text,shipVia integer,freight float8,shipName text,shipAddress text,shipCity text,shipRegion text,shipPostalCode text,shipCountry text)
  
[0m18:02:00.506220 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:02:00.506583 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "pr_999__local"."raw"."raw_customers"
[0m18:02:00.507020 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.order_details"} */

    create table pr_999__local.raw.order_details (orderID integer,productID integer,unitPrice float8,quantity integer,discount float8)
  
[0m18:02:00.507461 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.507893 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.508342 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.508752 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY pr_999__local.raw.categories FROM '/Users/preben/Documents/dbt-workshop/seeds/categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.509109 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.509441 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.510551 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:02:00.510914 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.511861 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:02:00.512191 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.513084 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:02:00.514087 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:02:00.515012 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:02:00.515380 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY pr_999__local.raw.employee_territories FROM '/Users/preben/Documents/dbt-workshop/seeds/employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.516288 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:02:00.516645 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY pr_999__local.raw.customers FROM '/Users/preben/Documents/dbt-workshop/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.517570 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:02:00.517919 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY pr_999__local.raw.employees FROM '/Users/preben/Documents/dbt-workshop/seeds/employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.518260 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: 
          COPY pr_999__local.raw.orders FROM '/Users/preben/Documents/dbt-workshop/seeds/orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.518601 [debug] [Thread-7 (]: On seed.ci_cd_project.products: 
          COPY pr_999__local.raw.products FROM '/Users/preben/Documents/dbt-workshop/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.519020 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: 
          COPY pr_999__local.raw.order_details FROM '/Users/preben/Documents/dbt-workshop/seeds/order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.519484 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: 
          COPY pr_999__local.raw.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.521313 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:02:00.526492 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m18:02:00.527112 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m18:02:00.527572 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m18:02:00.528057 [debug] [Thread-8 (]: SQL status: OK in 0.007 seconds
[0m18:02:00.528673 [debug] [Thread-7 (]: SQL status: OK in 0.008 seconds
[0m18:02:00.529246 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m18:02:00.529809 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m18:02:00.546955 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m18:02:00.547514 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m18:02:00.548451 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: 
          COPY pr_999__local.raw.employees FROM '/Users/preben/Documents/dbt-workshop/seeds/employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m18:02:00.548825 [debug] [Thread-5 (]: SQL status: OK in 0.028 seconds
[0m18:02:00.549345 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m18:02:00.549866 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:02:00.550448 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:02:00.551648 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m18:02:00.552956 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m18:02:00.553468 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m18:02:00.554551 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m18:02:00.554946 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m18:02:00.555416 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: ROLLBACK
[0m18:02:00.555767 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:02:00.556878 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m18:02:00.557223 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:02:00.557626 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:02:00.558974 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m18:02:00.559417 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m18:02:00.559741 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.560082 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:02:00.560416 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m18:02:00.560809 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m18:02:00.561200 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:02:00.563005 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m18:02:00.563400 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.563737 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m18:02:00.564287 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m18:02:00.564614 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:02:00.566189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9fc10>]}
[0m18:02:00.566931 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m18:02:00.567326 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m18:02:00.568201 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m18:02:00.568531 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.568986 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.569444 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 0.32s]
[0m18:02:00.569974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9fac0>]}
[0m18:02:00.570693 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: Close
[0m18:02:00.571186 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9fdf0>]}
[0m18:02:00.571850 [debug] [Thread-7 (]: On seed.ci_cd_project.products: Close
[0m18:02:00.572486 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: Close
[0m18:02:00.572998 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m18:02:00.573566 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 0.32s]
[0m18:02:00.574009 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca04f0>]}
[0m18:02:00.574888 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca0c10>]}
[0m18:02:00.574492 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 0.32s]
[0m18:02:00.575587 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca0790>]}
[0m18:02:00.576029 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_order_items
[0m18:02:00.576619 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m18:02:00.577081 [info ] [Thread-8 (]: 8 of 15 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 0.32s]
[0m18:02:00.578118 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m18:02:00.577618 [info ] [Thread-7 (]: 7 of 15 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 0.32s]
[0m18:02:00.578760 [info ] [Thread-5 (]: 5 of 15 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 0.32s]
[0m18:02:00.579881 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_orders
[0m18:02:00.579161 [info ] [Thread-1 (]: 9 of 15 START seed file raw.raw_order_items .................................... [RUN]
[0m18:02:00.580726 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.raw_customers
[0m18:02:00.581359 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_products
[0m18:02:00.582372 [debug] [Thread-4 (]: Failed to rollback 'seed.ci_cd_project.employees'
[0m18:02:00.583030 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.products
[0m18:02:00.583597 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.order_details
[0m18:02:00.584042 [info ] [Thread-2 (]: 10 of 15 START seed file raw.raw_orders ........................................ [RUN]
[0m18:02:00.584508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.raw_order_items)
[0m18:02:00.584906 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.regions
[0m18:02:00.585363 [info ] [Thread-3 (]: 11 of 15 START seed file raw.raw_products ...................................... [RUN]
[0m18:02:00.585731 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m18:02:00.586102 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.shippers
[0m18:02:00.586500 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.suppliers
[0m18:02:00.586921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.raw_orders)
[0m18:02:00.587300 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m18:02:00.587727 [info ] [Thread-8 (]: 12 of 15 START seed file raw.regions ........................................... [RUN]
[0m18:02:00.588149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.raw_products)
[0m18:02:00.588471 [debug] [Thread-6 (]: SQL status: OK in 0.068 seconds
[0m18:02:00.588942 [info ] [Thread-7 (]: 13 of 15 START seed file raw.shippers .......................................... [RUN]
[0m18:02:00.589622 [info ] [Thread-5 (]: 14 of 15 START seed file raw.suppliers ......................................... [RUN]
[0m18:02:00.590006 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m18:02:00.590362 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m18:02:00.590742 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.regions)
[0m18:02:00.591085 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_products
[0m18:02:00.591689 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m18:02:00.592663 [debug] [Thread-4 (]: Runtime Error in seed employees (seeds/employees.csv)
  Conversion Error: CSV Error on Line: 3
  Original Line: 2,Fuller,Andrew,Vice President Sales,Dr.,1952-02-19 00:00:00.000,1992-08-14 00:00:00.000,908 W. Capital Way,Tacoma,WA,98401,USA,(206) 555-9482,3457,0x151C2F00020000000D000E0014002100FFFFFFFF4269746D617020496D616765005061696E742E506963747572650001050000020000000700000050427275736800000000000000000020540000424D20540000000000007600000028000000C0000000DF0000000100040000000000A0530000CE0E0000D80E0000000000,Andrew received his BTS commercial in 1974 and a Ph.D. in international marketing from the University of Dallas in 1981.  He is fluent in French and Italian and reads German.  He joined the company as a sales representative was promoted to sales manager,NULL,http://accweb/emmployees/fuller.bmp
  Error when converting column "reportsTo". Could not convert string "NULL" to 'INTEGER'
  
  Column reportsTo is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/preben/Documents/dbt-workshop/seeds/employees.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 5 Set type: VARCHAR Sniffed type: TIMESTAMP
  Column at position: 6 Set type: VARCHAR Sniffed type: TIMESTAMP
  Column at position: 13 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 16 Set type: INTEGER Sniffed type: VARCHAR
  
  
[0m18:02:00.593102 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.shippers)
[0m18:02:00.593465 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.suppliers)
[0m18:02:00.593807 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_orders
[0m18:02:00.598508 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.regions
[0m18:02:00.602580 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:02:00.602983 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_products
[0m18:02:00.603524 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d81510>]}
[0m18:02:00.603912 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.shippers
[0m18:02:00.604300 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.suppliers
[0m18:02:00.608621 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m18:02:00.608975 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.regions
[0m18:02:00.609385 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m18:02:00.612974 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:02:00.617917 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.shippers
[0m18:02:00.621523 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:02:00.617586 [error] [Thread-4 (]: 4 of 15 ERROR loading seed file raw.employees .................................. [[31mERROR[0m in 0.35s]
[0m18:02:00.621990 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.suppliers
[0m18:02:00.622334 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:02:00.625657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:00.626587 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:02:00.626907 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m18:02:00.630189 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m18:02:00.631122 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:02:00.631713 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m18:02:00.635909 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m18:02:00.672576 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:02:00.673130 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: BEGIN
[0m18:02:00.673505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:00.673859 [debug] [Thread-1 (]: SQL status: OK in 0.048 seconds
[0m18:02:00.674181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:02:00.674519 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: BEGIN
[0m18:02:00.674918 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.territories
[0m18:02:00.675890 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m18:02:00.676269 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:02:00.676776 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:02:00.677146 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.677494 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.677889 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m18:02:00.678216 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.678662 [info ] [Thread-4 (]: 15 of 15 START seed file raw.territories ....................................... [RUN]
[0m18:02:00.679025 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m18:02:00.679430 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "pr_999__local"."raw"."raw_order_items"
[0m18:02:00.679765 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.680406 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: Close
[0m18:02:00.680732 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:02:00.681118 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:02:00.681430 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.681807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.territories)
[0m18:02:00.682332 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m18:02:00.682657 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:02:00.682974 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.683320 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "pr_999__local"."raw"."raw_orders"
[0m18:02:00.683733 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ffba60>]}
[0m18:02:00.684079 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "pr_999__local"."raw"."raw_products"
[0m18:02:00.684476 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:02:00.684813 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.territories
[0m18:02:00.685141 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:02:00.685475 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.regions"} */

    create table pr_999__local.raw.regions (regionID integer,regionDescription text)
  
[0m18:02:00.686537 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:02:00.687086 [info ] [Thread-6 (]: 6 of 15 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 0.43s]
[0m18:02:00.687458 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.687835 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.shippers"} */

    create table pr_999__local.raw.shippers (shipperID integer,companyName text,phone text)
  
[0m18:02:00.688179 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.territories
[0m18:02:00.688479 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.688801 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.suppliers"} */

    create table pr_999__local.raw.suppliers (supplierID integer,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text,homePage text)
  
[0m18:02:00.689226 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: 
          COPY pr_999__local.raw.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.689706 [debug] [Thread-6 (]: Finished running node seed.ci_cd_project.orders
[0m18:02:00.690027 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.691005 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:02:00.694616 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:02:00.695514 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.696190 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m18:02:00.697157 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:02:00.698970 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:02:00.699348 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: 
          COPY pr_999__local.raw.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.699666 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.700011 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: 
          COPY pr_999__local.raw.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.701361 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:02:00.702309 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:02:00.702666 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: 
          COPY pr_999__local.raw.regions FROM '/Users/preben/Documents/dbt-workshop/seeds/regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.703001 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: BEGIN
[0m18:02:00.703589 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m18:02:00.703999 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: 
          COPY pr_999__local.raw.shippers FROM '/Users/preben/Documents/dbt-workshop/seeds/shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.704395 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: 
          COPY pr_999__local.raw.suppliers FROM '/Users/preben/Documents/dbt-workshop/seeds/suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.704819 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:02:00.706666 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m18:02:00.707103 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:02:00.707471 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:02:00.707804 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m18:02:00.708122 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:02:00.708460 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m18:02:00.708803 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.709105 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:02:00.709397 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m18:02:00.709709 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:02:00.710233 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m18:02:00.710719 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m18:02:00.711289 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m18:02:00.711828 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m18:02:00.712327 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m18:02:00.712688 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.territories"} */

    create table pr_999__local.raw.territories (territoryID integer,territoryDescription text,regionID integer)
  
[0m18:02:00.713031 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.714791 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m18:02:00.716005 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: COMMIT
[0m18:02:00.717286 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m18:02:00.717926 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_order_items: Close
[0m18:02:00.719053 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: COMMIT
[0m18:02:00.719376 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m18:02:00.720535 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m18:02:00.720902 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:02:00.721245 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:02:00.721582 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:02:00.722025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9f6a0>]}
[0m18:02:00.722350 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:02:00.723253 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:02:00.723600 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:02:00.723925 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m18:02:00.724247 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: COMMIT
[0m18:02:00.724567 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m18:02:00.725009 [info ] [Thread-1 (]: 9 of 15 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.14s]
[0m18:02:00.725376 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: COMMIT
[0m18:02:00.725707 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: 
          COPY pr_999__local.raw.territories FROM '/Users/preben/Documents/dbt-workshop/seeds/territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:02:00.726033 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m18:02:00.726786 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m18:02:00.727502 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.727818 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.728140 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:02:00.728617 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.729268 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_orders: Close
[0m18:02:00.729608 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m18:02:00.729926 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:02:00.730567 [debug] [Thread-8 (]: On seed.ci_cd_project.regions: Close
[0m18:02:00.731176 [debug] [Thread-7 (]: On seed.ci_cd_project.shippers: Close
[0m18:02:00.731886 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: Close
[0m18:02:00.732598 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: Close
[0m18:02:00.733010 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2eff40>]}
[0m18:02:00.733550 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m18:02:00.734070 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2c0a00>]}
[0m18:02:00.734521 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bd030>]}
[0m18:02:00.734974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff9ff0>]}
[0m18:02:00.735400 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108def010>]}
[0m18:02:00.735867 [info ] [Thread-2 (]: 10 of 15 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.15s]
[0m18:02:00.736395 [info ] [Thread-8 (]: 12 of 15 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.14s]
[0m18:02:00.736867 [info ] [Thread-7 (]: 13 of 15 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.14s]
[0m18:02:00.738149 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: COMMIT
[0m18:02:00.738571 [info ] [Thread-3 (]: 11 of 15 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.15s]
[0m18:02:00.739409 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_orders
[0m18:02:00.738907 [info ] [Thread-5 (]: 14 of 15 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.14s]
[0m18:02:00.739953 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.regions
[0m18:02:00.740406 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.shippers
[0m18:02:00.740740 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:02:00.741185 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_products
[0m18:02:00.741718 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.suppliers
[0m18:02:00.742233 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: COMMIT
[0m18:02:00.742926 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:02:00.743554 [debug] [Thread-4 (]: On seed.ci_cd_project.territories: Close
[0m18:02:00.793809 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59fe3e7-9b9d-4c86-97c5-c03cb64d94b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5f0d0>]}
[0m18:02:00.794361 [info ] [Thread-4 (]: 15 of 15 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.11s]
[0m18:02:00.794898 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.territories
[0m18:02:00.795972 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:00.796306 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.796586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:00.836414 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m18:02:00.836760 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.837047 [debug] [MainThread]: Using duckdb connection "master"
[0m18:02:00.837318 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.837658 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:02:00.837931 [debug] [MainThread]: On master: Close
[0m18:02:00.839002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:00.839326 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m18:02:00.839600 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m18:02:00.839860 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m18:02:00.840112 [debug] [MainThread]: Connection 'seed.ci_cd_project.territories' was properly closed.
[0m18:02:00.840357 [debug] [MainThread]: Connection 'seed.ci_cd_project.suppliers' was properly closed.
[0m18:02:00.840602 [debug] [MainThread]: Connection 'seed.ci_cd_project.orders' was properly closed.
[0m18:02:00.840841 [debug] [MainThread]: Connection 'seed.ci_cd_project.shippers' was properly closed.
[0m18:02:00.841082 [debug] [MainThread]: Connection 'seed.ci_cd_project.regions' was properly closed.
[0m18:02:00.841407 [info ] [MainThread]: 
[0m18:02:00.841715 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:02:00.843934 [debug] [MainThread]: Command end result
[0m18:02:00.917092 [info ] [MainThread]: 
[0m18:02:00.917532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:00.917832 [info ] [MainThread]: 
[0m18:02:00.918289 [error] [MainThread]:   Runtime Error in seed employees (seeds/employees.csv)
  Conversion Error: CSV Error on Line: 3
  Original Line: 2,Fuller,Andrew,Vice President Sales,Dr.,1952-02-19 00:00:00.000,1992-08-14 00:00:00.000,908 W. Capital Way,Tacoma,WA,98401,USA,(206) 555-9482,3457,0x151C2F00020000000D000E0014002100FFFFFFFF4269746D617020496D616765005061696E742E506963747572650001050000020000000700000050427275736800000000000000000020540000424D20540000000000007600000028000000C0000000DF0000000100040000000000A0530000CE0E0000D80E0000000000,Andrew received his BTS commercial in 1974 and a Ph.D. in international marketing from the University of Dallas in 1981.  He is fluent in French and Italian and reads German.  He joined the company as a sales representative was promoted to sales manager,NULL,http://accweb/emmployees/fuller.bmp
  Error when converting column "reportsTo". Could not convert string "NULL" to 'INTEGER'
  
  Column reportsTo is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/preben/Documents/dbt-workshop/seeds/employees.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 5 Set type: VARCHAR Sniffed type: TIMESTAMP
  Column at position: 6 Set type: VARCHAR Sniffed type: TIMESTAMP
  Column at position: 13 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 16 Set type: INTEGER Sniffed type: VARCHAR
  
  
[0m18:02:00.918813 [info ] [MainThread]: 
[0m18:02:00.919166 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m18:02:00.922197 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.9932517, "process_in_blocks": "0", "process_kernel_time": 0.440139, "process_mem_max_rss": "194002944", "process_out_blocks": "0", "process_user_time": 3.52376}
[0m18:02:00.922577 [debug] [MainThread]: Command `dbt seed` failed at 18:02:00.922503 after 1.99 seconds
[0m18:02:00.922920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107549990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092276d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109225270>]}
[0m18:02:00.923256 [debug] [MainThread]: Flushing usage events
[0m18:03:19.738430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108941c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108941180>]}


============================== 18:03:19.743443 | 5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1 ==============================
[0m18:03:19.743443 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:03:19.743976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --target prod', 'send_anonymous_usage_stats': 'True'}
[0m18:03:19.999676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c1c60>]}
[0m18:03:20.049260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf98d0>]}
[0m18:03:20.053462 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m18:03:20.177118 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m18:03:20.406167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:03:20.406871 [debug] [MainThread]: Partial parsing: updated file: ci_cd_project://seeds/employees.csv
[0m18:03:20.656051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921f550>]}
[0m18:03:20.804945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109294a30>]}
[0m18:03:20.805442 [info ] [MainThread]: Found 7 models, 15 seeds, 41 data tests, 880 macros
[0m18:03:20.805783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109294dc0>]}
[0m18:03:20.808273 [info ] [MainThread]: 
[0m18:03:20.808762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:03:20.814699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local'
[0m18:03:20.859265 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local"
[0m18:03:20.859641 [debug] [ThreadPool]: On list_pr_999__local: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'pr_999__local'
    
  
  
[0m18:03:20.859943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:20.993616 [debug] [ThreadPool]: SQL status: OK in 0.134 seconds
[0m18:03:20.995570 [debug] [ThreadPool]: On list_pr_999__local: Close
[0m18:03:20.999058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_pr_999__local, now list_pr_999__local_analytics)
[0m18:03:21.005331 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m18:03:21.005779 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_pr_999__local_raw'
[0m18:03:21.006079 [debug] [ThreadPool]: On list_pr_999__local_analytics: BEGIN
[0m18:03:21.008572 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m18:03:21.008877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:03:21.009171 [debug] [ThreadPool]: On list_pr_999__local_raw: BEGIN
[0m18:03:21.009529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:21.049491 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:03:21.049863 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_analytics"
[0m18:03:21.050170 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m18:03:21.050499 [debug] [ThreadPool]: On list_pr_999__local_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local_analytics"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'pr_999__local'
  
[0m18:03:21.050819 [debug] [ThreadPool]: Using duckdb connection "list_pr_999__local_raw"
[0m18:03:21.051243 [debug] [ThreadPool]: On list_pr_999__local_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_pr_999__local_raw"} */
select
      'pr_999__local' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'pr_999__local'
  
[0m18:03:21.064185 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:21.064512 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:03:21.065992 [debug] [ThreadPool]: On list_pr_999__local_raw: ROLLBACK
[0m18:03:21.067220 [debug] [ThreadPool]: On list_pr_999__local_analytics: ROLLBACK
[0m18:03:21.067927 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_raw'
[0m18:03:21.068286 [debug] [ThreadPool]: Failed to rollback 'list_pr_999__local_analytics'
[0m18:03:21.068574 [debug] [ThreadPool]: On list_pr_999__local_raw: Close
[0m18:03:21.068861 [debug] [ThreadPool]: On list_pr_999__local_analytics: Close
[0m18:03:21.072721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105775ae0>]}
[0m18:03:21.073161 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:21.073440 [debug] [MainThread]: On master: BEGIN
[0m18:03:21.073704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:21.111318 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m18:03:21.111676 [debug] [MainThread]: On master: COMMIT
[0m18:03:21.111977 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:21.112257 [debug] [MainThread]: On master: COMMIT
[0m18:03:21.112624 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:21.112926 [debug] [MainThread]: On master: Close
[0m18:03:21.113952 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m18:03:21.114271 [info ] [MainThread]: 
[0m18:03:21.116835 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m18:03:21.117239 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m18:03:21.117701 [info ] [Thread-1 (]: 1 of 15 START seed file raw.categories ......................................... [RUN]
[0m18:03:21.118100 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m18:03:21.118521 [info ] [Thread-2 (]: 2 of 15 START seed file raw.customers .......................................... [RUN]
[0m18:03:21.118907 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m18:03:21.119270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_pr_999__local_analytics, now seed.ci_cd_project.categories)
[0m18:03:21.119627 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.order_details
[0m18:03:21.120029 [info ] [Thread-3 (]: 3 of 15 START seed file raw.employee_territories ............................... [RUN]
[0m18:03:21.120450 [debug] [Thread-6 (]: Began running node seed.ci_cd_project.orders
[0m18:03:21.120908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_pr_999__local_raw, now seed.ci_cd_project.customers)
[0m18:03:21.121268 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.products
[0m18:03:21.121664 [info ] [Thread-4 (]: 4 of 15 START seed file raw.employees .......................................... [RUN]
[0m18:03:21.122138 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.raw_customers
[0m18:03:21.122487 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m18:03:21.122937 [info ] [Thread-5 (]: 5 of 15 START seed file raw.order_details ...................................... [RUN]
[0m18:03:21.123422 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m18:03:21.123858 [info ] [Thread-6 (]: 6 of 15 START seed file raw.orders ............................................. [RUN]
[0m18:03:21.124215 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m18:03:21.124780 [info ] [Thread-7 (]: 7 of 15 START seed file raw.products ........................................... [RUN]
[0m18:03:21.125480 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m18:03:21.125959 [info ] [Thread-8 (]: 8 of 15 START seed file raw.raw_customers ...................................... [RUN]
[0m18:03:21.126359 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m18:03:21.126806 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.ci_cd_project.order_details'
[0m18:03:21.127133 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m18:03:21.127535 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.ci_cd_project.orders'
[0m18:03:21.127860 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m18:03:21.128254 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.ci_cd_project.products'
[0m18:03:21.128566 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m18:03:21.128954 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_customers'
[0m18:03:21.142913 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.order_details
[0m18:03:21.145958 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m18:03:21.146316 [debug] [Thread-6 (]: Began compiling node seed.ci_cd_project.orders
[0m18:03:21.163107 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:03:21.164112 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.products
[0m18:03:21.164476 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m18:03:21.168648 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:03:21.168992 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m18:03:21.169336 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.order_details
[0m18:03:21.173242 [debug] [Thread-6 (]: Began executing node seed.ci_cd_project.orders
[0m18:03:21.176733 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:03:21.177100 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m18:03:21.177445 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.products
[0m18:03:21.180750 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m18:03:21.181155 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.raw_customers
[0m18:03:21.191948 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:03:21.195805 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m18:03:21.196256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:21.302613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:03:21.315817 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:03:21.317127 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:03:21.342098 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:03:21.345486 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m18:03:21.345872 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:03:21.349321 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:03:21.349868 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: BEGIN
[0m18:03:21.350231 [debug] [Thread-7 (]: On seed.ci_cd_project.products: BEGIN
[0m18:03:21.350560 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: BEGIN
[0m18:03:21.350877 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:03:21.351246 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m18:03:21.351591 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:03:21.351920 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m18:03:21.352235 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:03:21.352575 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:03:21.387715 [debug] [Thread-1 (]: SQL status: OK in 0.191 seconds
[0m18:03:21.388060 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m18:03:21.388451 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:03:21.388762 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m18:03:21.389111 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m18:03:21.389527 [debug] [Thread-6 (]: SQL status: OK in 0.038 seconds
[0m18:03:21.389828 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:03:21.390149 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m18:03:21.390483 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.categories"} */
truncate table "pr_999__local"."raw"."categories"
[0m18:03:21.390783 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m18:03:21.391069 [debug] [Thread-7 (]: SQL status: OK in 0.039 seconds
[0m18:03:21.391382 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:03:21.391695 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:03:21.392003 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:03:21.392315 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.customers"} */
truncate table "pr_999__local"."raw"."customers"
[0m18:03:21.392631 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:03:21.393816 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:03:21.394195 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:03:21.394547 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employee_territories"} */
truncate table "pr_999__local"."raw"."employee_territories"
[0m18:03:21.394933 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employees"} */

    create table pr_999__local.raw.employees (employeeID integer,lastName text,firstName text,title text,titleOfCourtesy text,birthDate text,hireDate text,address text,city text,region text,postalCode text,country text,homePhone text,extension integer,photo text,notes text,reportsTo integer,photoPath text)
  
[0m18:03:21.395309 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.orders"} */
truncate table "pr_999__local"."raw"."orders"
[0m18:03:21.395701 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.396035 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.order_details"} */
truncate table "pr_999__local"."raw"."order_details"
[0m18:03:21.396364 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.396697 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "pr_999__local"."raw"."raw_customers"
[0m18:03:21.397044 [debug] [Thread-7 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.products"} */
truncate table "pr_999__local"."raw"."products"
[0m18:03:21.397764 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:03:21.398128 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.404053 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m18:03:21.409410 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:03:21.410496 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:03:21.410904 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.411309 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m18:03:21.412290 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:03:21.412605 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.413493 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:03:21.414406 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:03:21.414746 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY pr_999__local.raw.categories FROM '/Users/preben/Documents/dbt-workshop/seeds/categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.415082 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY pr_999__local.raw.customers FROM '/Users/preben/Documents/dbt-workshop/seeds/customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.415993 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:03:21.416888 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:03:21.417228 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY pr_999__local.raw.employee_territories FROM '/Users/preben/Documents/dbt-workshop/seeds/employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.418128 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:03:21.418460 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY pr_999__local.raw.employees FROM '/Users/preben/Documents/dbt-workshop/seeds/employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.418784 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: 
          COPY pr_999__local.raw.orders FROM '/Users/preben/Documents/dbt-workshop/seeds/orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.419282 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: 
          COPY pr_999__local.raw.order_details FROM '/Users/preben/Documents/dbt-workshop/seeds/order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.419636 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: 
          COPY pr_999__local.raw.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.420103 [debug] [Thread-7 (]: On seed.ci_cd_project.products: 
          COPY pr_999__local.raw.products FROM '/Users/preben/Documents/dbt-workshop/seeds/products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.427772 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m18:03:21.433530 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m18:03:21.434005 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m18:03:21.434378 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:03:21.434738 [debug] [Thread-7 (]: SQL status: OK in 0.014 seconds
[0m18:03:21.435062 [debug] [Thread-5 (]: SQL status: OK in 0.014 seconds
[0m18:03:21.435382 [debug] [Thread-8 (]: SQL status: OK in 0.015 seconds
[0m18:03:21.435687 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m18:03:21.436172 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m18:03:21.436707 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m18:03:21.437199 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m18:03:21.442907 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m18:03:21.451532 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m18:03:21.452075 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m18:03:21.452580 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.employees"
[0m18:03:21.454039 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m18:03:21.454401 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m18:03:21.455706 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m18:03:21.456731 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m18:03:21.457192 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m18:03:21.458518 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m18:03:21.458930 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m18:03:21.460051 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m18:03:21.464239 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m18:03:21.464596 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m18:03:21.464939 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m18:03:21.465284 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m18:03:21.465629 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m18:03:21.466037 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m18:03:21.466395 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m18:03:21.466757 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m18:03:21.467111 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m18:03:21.467558 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m18:03:21.467948 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m18:03:21.468326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:03:21.468672 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m18:03:21.469020 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:03:21.471495 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m18:03:21.472650 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m18:03:21.473040 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m18:03:21.473392 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.474561 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:03:21.475914 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109691660>]}
[0m18:03:21.476648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109690c70>]}
[0m18:03:21.476998 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m18:03:21.477311 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m18:03:21.477942 [debug] [Thread-7 (]: On seed.ci_cd_project.products: Close
[0m18:03:21.478559 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m18:03:21.479203 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m18:03:21.479717 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 0.35s]
[0m18:03:21.480243 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 0.35s]
[0m18:03:21.480909 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: Close
[0m18:03:21.481521 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: Close
[0m18:03:21.481970 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096920e0>]}
[0m18:03:21.482413 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109691b70>]}
[0m18:03:21.482838 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109690ee0>]}
[0m18:03:21.483321 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m18:03:21.483785 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m18:03:21.484184 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109691de0>]}
[0m18:03:21.484587 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109692500>]}
[0m18:03:21.485021 [info ] [Thread-7 (]: 7 of 15 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 0.35s]
[0m18:03:21.485545 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file raw.employees ...................................... [[32mINSERT 8[0m in 0.36s]
[0m18:03:21.486212 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 0.36s]
[0m18:03:21.486686 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_order_items
[0m18:03:21.487121 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_orders
[0m18:03:21.487635 [info ] [Thread-5 (]: 5 of 15 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 0.36s]
[0m18:03:21.488093 [info ] [Thread-8 (]: 8 of 15 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 0.36s]
[0m18:03:21.488626 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.products
[0m18:03:21.489092 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m18:03:21.489567 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m18:03:21.490360 [info ] [Thread-3 (]: 9 of 15 START seed file raw.raw_order_items .................................... [RUN]
[0m18:03:21.490812 [debug] [Thread-6 (]: SQL status: OK in 0.070 seconds
[0m18:03:21.491287 [info ] [Thread-1 (]: 10 of 15 START seed file raw.raw_orders ........................................ [RUN]
[0m18:03:21.491814 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.order_details
[0m18:03:21.492277 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.raw_customers
[0m18:03:21.492649 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.raw_products
[0m18:03:21.493059 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.regions
[0m18:03:21.493466 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.shippers
[0m18:03:21.493885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.raw_order_items)
[0m18:03:21.494418 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m18:03:21.494774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.raw_orders)
[0m18:03:21.495143 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.suppliers
[0m18:03:21.495508 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.territories
[0m18:03:21.495958 [info ] [Thread-7 (]: 11 of 15 START seed file raw.raw_products ...................................... [RUN]
[0m18:03:21.496503 [info ] [Thread-4 (]: 12 of 15 START seed file raw.regions ........................................... [RUN]
[0m18:03:21.496986 [info ] [Thread-2 (]: 13 of 15 START seed file raw.shippers .......................................... [RUN]
[0m18:03:21.497356 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m18:03:21.497769 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m18:03:21.498228 [info ] [Thread-5 (]: 14 of 15 START seed file raw.suppliers ......................................... [RUN]
[0m18:03:21.498727 [info ] [Thread-8 (]: 15 of 15 START seed file raw.territories ....................................... [RUN]
[0m18:03:21.499961 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m18:03:21.500323 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.raw_products)
[0m18:03:21.500681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.regions)
[0m18:03:21.501032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.shippers)
[0m18:03:21.501472 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m18:03:21.501825 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_orders
[0m18:03:21.502474 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.suppliers)
[0m18:03:21.502844 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.territories)
[0m18:03:21.503205 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m18:03:21.503540 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.raw_products
[0m18:03:21.503855 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.regions
[0m18:03:21.504161 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.shippers
[0m18:03:21.511629 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.suppliers
[0m18:03:21.515512 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:03:21.519444 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:03:21.519786 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.territories
[0m18:03:21.520132 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m18:03:21.520464 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.raw_products
[0m18:03:21.520784 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.regions
[0m18:03:21.521094 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.shippers
[0m18:03:21.521404 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.suppliers
[0m18:03:21.521716 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m18:03:21.522025 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m18:03:21.522331 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.territories
[0m18:03:21.529476 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m18:03:21.538905 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:03:21.542428 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:03:21.545165 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:03:21.545575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:03:21.549011 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:03:21.549337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:03:21.553483 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: Close
[0m18:03:21.553859 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: BEGIN
[0m18:03:21.557317 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:03:21.557675 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m18:03:21.558003 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: BEGIN
[0m18:03:21.558514 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m18:03:21.558984 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m18:03:21.559342 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:03:21.559663 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m18:03:21.560072 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109692170>]}
[0m18:03:21.560418 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: BEGIN
[0m18:03:21.560726 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m18:03:21.561025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:03:21.561329 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m18:03:21.561647 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:03:21.562052 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:03:21.562372 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.562805 [info ] [Thread-6 (]: 6 of 15 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 0.43s]
[0m18:03:21.563162 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m18:03:21.563684 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.564019 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "pr_999__local"."raw"."raw_order_items"
[0m18:03:21.564320 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.564646 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.565010 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "pr_999__local"."raw"."raw_orders"
[0m18:03:21.565354 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:03:21.565825 [debug] [Thread-6 (]: Finished running node seed.ci_cd_project.orders
[0m18:03:21.566220 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:03:21.566535 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.566915 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:03:21.567261 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:03:21.567634 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.567970 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.regions"} */
truncate table "pr_999__local"."raw"."regions"
[0m18:03:21.568288 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.568693 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "pr_999__local"."raw"."raw_products"
[0m18:03:21.569021 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:03:21.569339 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.shippers"} */
truncate table "pr_999__local"."raw"."shippers"
[0m18:03:21.569726 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.suppliers"} */
truncate table "pr_999__local"."raw"."suppliers"
[0m18:03:21.570761 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:03:21.571820 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:03:21.572232 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.572547 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.territories"} */
truncate table "pr_999__local"."raw"."territories"
[0m18:03:21.572861 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.573322 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: 
          COPY pr_999__local.raw.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.573680 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.574002 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: 
          COPY pr_999__local.raw.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.574311 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.575229 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:03:21.576272 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:03:21.576690 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.577675 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:03:21.578711 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:03:21.579060 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: 
          COPY pr_999__local.raw.regions FROM '/Users/preben/Documents/dbt-workshop/seeds/regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.579396 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.579725 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: 
          COPY pr_999__local.raw.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.580683 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:03:21.581019 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.581324 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: 
          COPY pr_999__local.raw.shippers FROM '/Users/preben/Documents/dbt-workshop/seeds/shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.581651 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: 
          COPY pr_999__local.raw.suppliers FROM '/Users/preben/Documents/dbt-workshop/seeds/suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.582233 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m18:03:21.582751 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: 
          COPY pr_999__local.raw.territories FROM '/Users/preben/Documents/dbt-workshop/seeds/territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:03:21.583229 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.583707 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m18:03:21.584727 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m18:03:21.585180 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.586331 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m18:03:21.586720 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m18:03:21.587147 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m18:03:21.588254 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m18:03:21.588758 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m18:03:21.589123 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m18:03:21.589439 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m18:03:21.590493 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: COMMIT
[0m18:03:21.590997 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m18:03:21.591467 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m18:03:21.591801 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m18:03:21.592329 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m18:03:21.592668 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m18:03:21.593012 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m18:03:21.594284 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m18:03:21.594776 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m18:03:21.596111 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m18:03:21.596453 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: COMMIT
[0m18:03:21.596800 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:03:21.597160 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m18:03:21.598223 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m18:03:21.599395 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m18:03:21.599795 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m18:03:21.600559 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: Close
[0m18:03:21.600942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.601276 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m18:03:21.601608 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.601929 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m18:03:21.602262 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m18:03:21.602584 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m18:03:21.603039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971c130>]}
[0m18:03:21.603666 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: Close
[0m18:03:21.604345 [debug] [Thread-4 (]: On seed.ci_cd_project.regions: Close
[0m18:03:21.604722 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m18:03:21.605056 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.605352 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m18:03:21.605885 [info ] [Thread-3 (]: 9 of 15 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.11s]
[0m18:03:21.606393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972a4a0>]}
[0m18:03:21.606846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109690f70>]}
[0m18:03:21.607172 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.607813 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: Close
[0m18:03:21.608441 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m18:03:21.608801 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.609274 [info ] [Thread-1 (]: 10 of 15 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.11s]
[0m18:03:21.609652 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m18:03:21.610668 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: Close
[0m18:03:21.610104 [info ] [Thread-4 (]: 12 of 15 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.11s]
[0m18:03:21.611206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109690a90>]}
[0m18:03:21.611973 [debug] [Thread-5 (]: On seed.ci_cd_project.suppliers: Close
[0m18:03:21.612467 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_orders
[0m18:03:21.613078 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_products: Close
[0m18:03:21.613509 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d1b10>]}
[0m18:03:21.613974 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.regions
[0m18:03:21.614423 [info ] [Thread-2 (]: 13 of 15 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.11s]
[0m18:03:21.614887 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d1000>]}
[0m18:03:21.615447 [info ] [Thread-8 (]: 15 of 15 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.11s]
[0m18:03:21.616172 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.shippers
[0m18:03:21.617050 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.territories
[0m18:03:21.616636 [info ] [Thread-5 (]: 14 of 15 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.11s]
[0m18:03:21.617818 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.suppliers
[0m18:03:21.670162 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2804b9-94c5-42e3-a75b-0b7bdaf4fce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a11540>]}
[0m18:03:21.670754 [info ] [Thread-7 (]: 11 of 15 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.17s]
[0m18:03:21.671314 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.raw_products
[0m18:03:21.672504 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:21.672851 [debug] [MainThread]: On master: BEGIN
[0m18:03:21.673137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:03:21.715822 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m18:03:21.716207 [debug] [MainThread]: On master: COMMIT
[0m18:03:21.716506 [debug] [MainThread]: Using duckdb connection "master"
[0m18:03:21.716789 [debug] [MainThread]: On master: COMMIT
[0m18:03:21.717134 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:03:21.717417 [debug] [MainThread]: On master: Close
[0m18:03:21.718491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:21.718816 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m18:03:21.719084 [debug] [MainThread]: Connection 'seed.ci_cd_project.shippers' was properly closed.
[0m18:03:21.719339 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m18:03:21.719589 [debug] [MainThread]: Connection 'seed.ci_cd_project.regions' was properly closed.
[0m18:03:21.719831 [debug] [MainThread]: Connection 'seed.ci_cd_project.suppliers' was properly closed.
[0m18:03:21.720070 [debug] [MainThread]: Connection 'seed.ci_cd_project.orders' was properly closed.
[0m18:03:21.720311 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m18:03:21.720552 [debug] [MainThread]: Connection 'seed.ci_cd_project.territories' was properly closed.
[0m18:03:21.720876 [info ] [MainThread]: 
[0m18:03:21.721191 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m18:03:21.723341 [debug] [MainThread]: Command end result
[0m18:03:21.798409 [info ] [MainThread]: 
[0m18:03:21.798870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:03:21.799192 [info ] [MainThread]: 
[0m18:03:21.799508 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m18:03:21.802035 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.1244829, "process_in_blocks": "0", "process_kernel_time": 0.413429, "process_mem_max_rss": "223854592", "process_out_blocks": "0", "process_user_time": 3.697792}
[0m18:03:21.802457 [debug] [MainThread]: Command `dbt seed` succeeded at 18:03:21.802376 after 2.12 seconds
[0m18:03:21.802805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986f940>]}
[0m18:03:21.803145 [debug] [MainThread]: Flushing usage events
[0m22:13:08.716519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E347E49BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34B6E8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34B6E8B30>]}


============================== 22:13:08.729210 | 549b65e1-8651-421f-98cb-b9a1b30fa93a ==============================
[0m22:13:08.729210 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:13:08.734759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:13:09.094403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34B693350>]}
[0m22:13:10.673654 [debug] [MainThread]: Set downloads directory='C:\Users\PREBEN~1.GEI\AppData\Local\Temp\dbt-downloads-ou5m70y_'
[0m22:13:10.674712 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:13:11.799520 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:13:11.803906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:13:12.684353 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:13:12.694453 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m22:13:13.948711 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m22:13:13.958750 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m22:13:15.024040 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m22:13:15.028039 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m22:13:15.032041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34AB534A0>]}
[0m22:13:15.037040 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m22:13:16.368740 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m22:13:16.368740 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m22:13:18.220093 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m22:13:18.228670 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:13:20.829736 [info ] [MainThread]: Installed from version 1.1.1
[0m22:13:20.845541 [info ] [MainThread]: Updated version available: 1.3.1
[0m22:13:20.895314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C794F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7951C0>]}
[0m22:13:20.895314 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m22:13:25.458862 [info ] [MainThread]: Installed from version 0.11.0
[0m22:13:25.458862 [info ] [MainThread]: Updated version available: 1.0.2
[0m22:13:25.464908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C794C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C794F50>]}
[0m22:13:25.466918 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m22:13:28.712817 [info ] [MainThread]: Installed from version 0.10.3
[0m22:13:28.714816 [info ] [MainThread]: Updated version available: 0.10.4
[0m22:13:28.715816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E42F0>]}
[0m22:13:28.717817 [info ] [MainThread]: Installing dbt-labs/codegen
[0m22:13:30.280097 [info ] [MainThread]: Installed from version 0.12.1
[0m22:13:30.282097 [info ] [MainThread]: Updated version available: 0.13.1
[0m22:13:30.283097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E4530>]}
[0m22:13:30.284098 [info ] [MainThread]: Installing calogica/dbt_date
[0m22:13:32.002350 [info ] [MainThread]: Installed from version 0.10.1
[0m22:13:32.004389 [info ] [MainThread]: Up to date!
[0m22:13:32.004389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '549b65e1-8651-421f-98cb-b9a1b30fa93a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E45C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C7E47D0>]}
[0m22:13:32.004389 [info ] [MainThread]: 
[0m22:13:32.004389 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m22:13:32.050096 [debug] [MainThread]: Command `dbt deps` succeeded at 22:13:32.049566 after 23.87 seconds
[0m22:13:32.051161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34B35C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E34C0D9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E347847500>]}
[0m22:13:32.052248 [debug] [MainThread]: Flushing usage events
[0m22:13:32.148251 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:14:59.254909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA98CD6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA967333B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA99692780>]}


============================== 22:14:59.268909 | cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b ==============================
[0m22:14:59.268909 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:14:59.270908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --target prod', 'send_anonymous_usage_stats': 'True'}
[0m22:15:00.368707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9A5540B0>]}
[0m22:15:00.521124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9A4F0A10>]}
[0m22:15:00.533440 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m22:15:01.607623 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m22:15:01.975487 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:15:02.005629 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m22:15:02.006630 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:15:02.008628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA997E80E0>]}
[0m22:15:10.932824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:15:10.937821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9BE4ECC0>]}
[0m22:15:12.135742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m22:15:12.137749 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m22:15:12.138743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m22:15:12.140741 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m22:15:12.140741 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m22:15:12.141742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m22:15:12.143742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m22:15:12.144744 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m22:15:12.145743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m22:15:12.146743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m22:15:12.147746 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m22:15:12.148743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m22:15:12.149743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m22:15:12.149743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m22:15:12.150743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m22:15:12.151744 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m22:15:12.152743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m22:15:12.153742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m22:15:12.154743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m22:15:12.155744 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m22:15:12.156742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m22:15:12.156742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m22:15:12.157743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m22:15:12.158742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m22:15:12.159741 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m22:15:12.160742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m22:15:12.161743 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m22:15:12.162746 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m22:15:12.703798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9B7AD460>]}
[0m22:15:13.317345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C26D6A0>]}
[0m22:15:13.318345 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 880 macros
[0m22:15:13.321344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C2E0C80>]}
[0m22:15:13.333345 [info ] [MainThread]: 
[0m22:15:13.335345 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:15:13.357344 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m22:15:13.921342 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m22:15:13.922342 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m22:15:13.922342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:21.847937 [debug] [ThreadPool]: SQL status: OK in 7.925 seconds
[0m22:15:21.852936 [debug] [ThreadPool]: On list_prod: Close
[0m22:15:21.862941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now create_prod_raw)
[0m22:15:21.864938 [debug] [ThreadPool]: Creating schema "database: "prod"
schema: "raw"
"
[0m22:15:21.884937 [debug] [ThreadPool]: Using duckdb connection "create_prod_raw"
[0m22:15:21.885939 [debug] [ThreadPool]: On create_prod_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_raw"} */

    
        select type from duckdb_databases()
        where database_name='prod'
        and type='sqlite'
    
  
[0m22:15:21.886942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:22.455829 [debug] [ThreadPool]: SQL status: OK in 0.568 seconds
[0m22:15:22.459829 [debug] [ThreadPool]: Using duckdb connection "create_prod_raw"
[0m22:15:22.460830 [debug] [ThreadPool]: On create_prod_raw: BEGIN
[0m22:15:22.461829 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:15:22.462830 [debug] [ThreadPool]: Using duckdb connection "create_prod_raw"
[0m22:15:22.463833 [debug] [ThreadPool]: On create_prod_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_raw"} */

    
    
        create schema if not exists prod.raw
    
[0m22:15:22.465832 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:15:22.467830 [debug] [ThreadPool]: On create_prod_raw: COMMIT
[0m22:15:22.468830 [debug] [ThreadPool]: Using duckdb connection "create_prod_raw"
[0m22:15:22.469829 [debug] [ThreadPool]: On create_prod_raw: COMMIT
[0m22:15:22.476829 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m22:15:22.477830 [debug] [ThreadPool]: On create_prod_raw: Close
[0m22:15:22.515828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_raw'
[0m22:15:22.528829 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m22:15:22.532828 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m22:15:22.540832 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m22:15:22.541828 [debug] [ThreadPool]: On list_prod_raw: BEGIN
[0m22:15:22.542829 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m22:15:22.542829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:22.543829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:22.886829 [debug] [ThreadPool]: SQL status: OK in 0.343 seconds
[0m22:15:22.887828 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m22:15:22.887828 [debug] [ThreadPool]: SQL status: OK in 0.344 seconds
[0m22:15:22.888828 [debug] [ThreadPool]: On list_prod_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_raw"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'prod'
  
[0m22:15:22.889829 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m22:15:22.890828 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m22:15:22.952953 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m22:15:22.952953 [debug] [ThreadPool]: On list_prod_raw: ROLLBACK
[0m22:15:22.952953 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m22:15:22.959169 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m22:15:22.963904 [debug] [ThreadPool]: Failed to rollback 'list_prod_raw'
[0m22:15:22.964904 [debug] [ThreadPool]: On list_prod_raw: Close
[0m22:15:22.968439 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m22:15:22.968439 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m22:15:22.989042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9BE9F920>]}
[0m22:15:22.990043 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:22.991042 [debug] [MainThread]: On master: BEGIN
[0m22:15:22.992042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:23.400509 [debug] [MainThread]: SQL status: OK in 0.408 seconds
[0m22:15:23.401646 [debug] [MainThread]: On master: COMMIT
[0m22:15:23.402164 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:23.403162 [debug] [MainThread]: On master: COMMIT
[0m22:15:23.404161 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:23.405162 [debug] [MainThread]: On master: Close
[0m22:15:23.413163 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m22:15:23.414163 [info ] [MainThread]: 
[0m22:15:23.488068 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m22:15:23.489066 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m22:15:23.490066 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m22:15:23.491065 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m22:15:23.493066 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.order_details
[0m22:15:23.494065 [debug] [Thread-6 (]: Began running node seed.ci_cd_project.orders
[0m22:15:23.496066 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.products
[0m22:15:23.492065 [info ] [Thread-1 (]: 1 of 15 START seed file raw.categories ......................................... [RUN]
[0m22:15:23.497065 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.raw_customers
[0m22:15:23.495066 [info ] [Thread-2 (]: 2 of 15 START seed file raw.customers .......................................... [RUN]
[0m22:15:23.498068 [info ] [Thread-3 (]: 3 of 15 START seed file raw.employee_territories ............................... [RUN]
[0m22:15:23.500067 [info ] [Thread-4 (]: 4 of 15 START seed file raw.employees .......................................... [RUN]
[0m22:15:23.501282 [info ] [Thread-5 (]: 5 of 15 START seed file raw.order_details ...................................... [RUN]
[0m22:15:23.504798 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ci_cd_project.categories'
[0m22:15:23.507172 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.customers'
[0m22:15:23.502054 [info ] [Thread-6 (]: 6 of 15 START seed file raw.orders ............................................. [RUN]
[0m22:15:23.508418 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m22:15:23.510010 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m22:15:23.511063 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.ci_cd_project.order_details'
[0m22:15:23.512096 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m22:15:23.512882 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m22:15:23.503667 [info ] [Thread-7 (]: 7 of 15 START seed file raw.products ........................................... [RUN]
[0m22:15:23.519327 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.ci_cd_project.orders'
[0m22:15:23.520324 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m22:15:23.506113 [info ] [Thread-8 (]: 8 of 15 START seed file raw.raw_customers ...................................... [RUN]
[0m22:15:23.521324 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m22:15:23.522323 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.order_details
[0m22:15:23.532352 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.order_details
[0m22:15:23.524354 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m22:15:23.525350 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.ci_cd_project.products'
[0m22:15:23.526350 [debug] [Thread-6 (]: Began compiling node seed.ci_cd_project.orders
[0m22:15:23.527354 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m22:15:23.529354 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_customers'
[0m22:15:23.530352 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m22:15:23.523830 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m22:15:23.587935 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.products
[0m22:15:23.590935 [debug] [Thread-6 (]: Began executing node seed.ci_cd_project.orders
[0m22:15:23.596934 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m22:15:23.710423 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m22:15:23.738422 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m22:15:23.739422 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.products
[0m22:15:23.779677 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m22:15:23.799417 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.raw_customers
[0m22:15:23.830396 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m22:15:23.879336 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m22:15:23.879887 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m22:15:23.885612 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m22:15:23.914348 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m22:15:23.978347 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m22:15:23.979346 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:23.992346 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: BEGIN
[0m22:15:23.998348 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m22:15:23.999347 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:24.000347 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m22:15:24.003350 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:15:24.006347 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m22:15:24.007347 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: BEGIN
[0m22:15:24.008348 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m22:15:24.009347 [debug] [Thread-7 (]: On seed.ci_cd_project.products: BEGIN
[0m22:15:24.010348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:24.011348 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m22:15:24.012349 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m22:15:24.014348 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m22:15:24.015348 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m22:15:24.392348 [debug] [Thread-2 (]: SQL status: OK in 0.413 seconds
[0m22:15:24.393347 [debug] [Thread-4 (]: SQL status: OK in 0.390 seconds
[0m22:15:24.394347 [debug] [Thread-3 (]: SQL status: OK in 0.395 seconds
[0m22:15:24.395346 [debug] [Thread-5 (]: SQL status: OK in 0.387 seconds
[0m22:15:24.396346 [debug] [Thread-1 (]: SQL status: OK in 0.386 seconds
[0m22:15:24.397348 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m22:15:24.398347 [debug] [Thread-7 (]: SQL status: OK in 0.384 seconds
[0m22:15:24.399347 [debug] [Thread-8 (]: SQL status: OK in 0.384 seconds
[0m22:15:24.399347 [debug] [Thread-6 (]: SQL status: OK in 0.387 seconds
[0m22:15:24.400347 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m22:15:24.401348 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m22:15:24.402349 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m22:15:24.403347 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m22:15:24.404346 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.customers"} */

    create table prod.raw.customers (customerID text,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text)
  
[0m22:15:24.405346 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m22:15:24.406346 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m22:15:24.407348 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m22:15:24.408347 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employees"} */

    create table prod.raw.employees (employeeID integer,lastName text,firstName text,title text,titleOfCourtesy text,birthDate text,hireDate text,address text,city text,region text,postalCode text,country text,homePhone text,extension integer,photo text,notes text,reportsTo integer,photoPath text)
  
[0m22:15:24.409346 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employee_territories"} */

    create table prod.raw.employee_territories (employeeID integer,territoryID integer)
  
[0m22:15:24.410346 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.order_details"} */

    create table prod.raw.order_details (orderID integer,productID integer,unitPrice float8,quantity integer,discount float8)
  
[0m22:15:24.411346 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.categories"} */

    create table prod.raw.categories (categoryID integer,categoryName text,description text,picture text)
  
[0m22:15:24.413346 [debug] [Thread-7 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.products"} */

    create table prod.raw.products (productID integer,productName text,supplierID integer,categoryID integer,quantityPerUnit text,unitPrice float8,unitsInStock integer,unitsOnOrder integer,reorderLevel integer,discontinued integer)
  
[0m22:15:24.414348 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table prod.raw.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m22:15:24.416349 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.orders"} */

    create table prod.raw.orders (orderID integer,customerID text,employeeID integer,orderDate text,requiredDate text,shippedDate text,shipVia integer,freight float8,shipName text,shipAddress text,shipCity text,shipRegion text,shipPostalCode text,shipCountry text)
  
[0m22:15:24.417348 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m22:15:24.420348 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:15:24.421347 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.422348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.423349 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m22:15:24.423349 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m22:15:24.455347 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m22:15:24.456347 [debug] [Thread-8 (]: SQL status: OK in 0.033 seconds
[0m22:15:24.459347 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m22:15:24.460346 [debug] [Thread-6 (]: SQL status: OK in 0.035 seconds
[0m22:15:24.463347 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m22:15:24.466349 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m22:15:24.469348 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m22:15:24.471350 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m22:15:24.472348 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY prod.raw.customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.475347 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m22:15:24.476349 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY prod.raw.employee_territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.479348 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m22:15:24.480348 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY prod.raw.employees FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.481348 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY prod.raw.categories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.482348 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: 
          COPY prod.raw.order_details FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.483348 [debug] [Thread-7 (]: On seed.ci_cd_project.products: 
          COPY prod.raw.products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.484350 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: 
          COPY prod.raw.raw_customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.486351 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: 
          COPY prod.raw.orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.506347 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m22:15:24.521348 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m22:15:24.525349 [debug] [Thread-7 (]: SQL status: OK in 0.037 seconds
[0m22:15:24.526902 [debug] [Thread-5 (]: SQL status: OK in 0.039 seconds
[0m22:15:24.527900 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m22:15:24.528900 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m22:15:24.529900 [debug] [Thread-2 (]: SQL status: OK in 0.046 seconds
[0m22:15:24.531900 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m22:15:24.534901 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.employees"
[0m22:15:24.535901 [debug] [Thread-8 (]: SQL status: OK in 0.047 seconds
[0m22:15:24.536900 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m22:15:24.584900 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m22:15:24.585899 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m22:15:24.587903 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m22:15:24.591900 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m22:15:24.593907 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m22:15:24.594900 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m22:15:24.595900 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m22:15:24.599901 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m22:15:24.603899 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m22:15:24.604904 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m22:15:24.605901 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m22:15:24.609899 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m22:15:24.610899 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m22:15:24.613902 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m22:15:24.614900 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m22:15:24.618901 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m22:15:24.619900 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m22:15:24.621901 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m22:15:24.622900 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m22:15:24.623900 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m22:15:24.624901 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m22:15:24.625900 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m22:15:24.627900 [debug] [Thread-7 (]: SQL status: OK in 0.008 seconds
[0m22:15:24.628901 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m22:15:24.629902 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m22:15:24.636904 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m22:15:24.637900 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m22:15:24.638901 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m22:15:24.639901 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m22:15:24.641900 [debug] [Thread-7 (]: On seed.ci_cd_project.products: Close
[0m22:15:24.646902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA96E7D4C0>]}
[0m22:15:24.648902 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m22:15:24.649901 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m22:15:24.650902 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m22:15:24.653902 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: Close
[0m22:15:24.654902 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.656899 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E213AD0>]}
[0m22:15:24.655899 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 1.14s]
[0m22:15:24.658898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E25F410>]}
[0m22:15:24.659911 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m22:15:24.661899 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: Close
[0m22:15:24.663900 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9BEF7D40>]}
[0m22:15:24.664898 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m22:15:24.667900 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m22:15:24.665899 [info ] [Thread-7 (]: 7 of 15 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 1.13s]
[0m22:15:24.670902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C49A5D0>]}
[0m22:15:24.668900 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file raw.employees ...................................... [[32mINSERT 8[0m in 1.15s]
[0m22:15:24.672902 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C4A9BE0>]}
[0m22:15:24.677901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9BF7F020>]}
[0m22:15:24.678901 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_order_items
[0m22:15:24.673900 [info ] [Thread-5 (]: 5 of 15 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 1.15s]
[0m22:15:24.680900 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.products
[0m22:15:24.683900 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m22:15:24.681899 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 1.16s]
[0m22:15:24.684901 [info ] [Thread-8 (]: 8 of 15 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 1.14s]
[0m22:15:24.689900 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.order_details
[0m22:15:24.690900 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.raw_orders
[0m22:15:24.691900 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m22:15:24.685902 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 1.17s]
[0m22:15:24.693900 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m22:15:24.694900 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.raw_customers
[0m22:15:24.687901 [info ] [Thread-3 (]: 9 of 15 START seed file raw.raw_order_items .................................... [RUN]
[0m22:15:24.696900 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.regions
[0m22:15:24.700901 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m22:15:24.702901 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.shippers
[0m22:15:24.697900 [info ] [Thread-7 (]: 10 of 15 START seed file raw.raw_orders ........................................ [RUN]
[0m22:15:24.704904 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.suppliers
[0m22:15:24.706901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.raw_order_items)
[0m22:15:24.698900 [info ] [Thread-4 (]: 11 of 15 START seed file raw.raw_products ...................................... [RUN]
[0m22:15:24.708901 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.territories
[0m22:15:24.707905 [info ] [Thread-5 (]: 12 of 15 START seed file raw.regions ........................................... [RUN]
[0m22:15:24.711900 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.raw_orders)
[0m22:15:24.710901 [info ] [Thread-2 (]: 13 of 15 START seed file raw.shippers .......................................... [RUN]
[0m22:15:24.713901 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m22:15:24.712900 [info ] [Thread-8 (]: 14 of 15 START seed file raw.suppliers ......................................... [RUN]
[0m22:15:24.714900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.raw_products)
[0m22:15:24.717901 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.regions)
[0m22:15:24.719906 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m22:15:24.720905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.shippers)
[0m22:15:24.722903 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m22:15:24.723906 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.suppliers)
[0m22:15:24.716900 [info ] [Thread-1 (]: 15 of 15 START seed file raw.territories ....................................... [RUN]
[0m22:15:24.725902 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m22:15:24.726902 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.regions
[0m22:15:24.727901 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.raw_orders
[0m22:15:24.728900 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.shippers
[0m22:15:24.736909 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.suppliers
[0m22:15:24.739900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.territories)
[0m22:15:24.741902 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m22:15:24.742901 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.regions
[0m22:15:24.751901 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.shippers
[0m22:15:24.758902 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m22:15:24.759901 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.suppliers
[0m22:15:24.766900 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m22:15:24.767372 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.territories
[0m22:15:24.792892 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m22:15:24.804893 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m22:15:24.809894 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m22:15:24.812893 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m22:15:24.813896 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.territories
[0m22:15:24.816893 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m22:15:24.817893 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:15:24.820895 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m22:15:24.822892 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m22:15:24.823892 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: BEGIN
[0m22:15:24.824893 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m22:15:24.833892 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: BEGIN
[0m22:15:24.837892 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m22:15:24.838894 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m22:15:24.839894 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m22:15:24.840892 [debug] [Thread-7 (]: SQL status: OK in 0.020 seconds
[0m22:15:24.841891 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:15:24.842892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:24.844892 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m22:15:24.847893 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m22:15:24.848892 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m22:15:24.849893 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m22:15:24.851892 [debug] [Thread-5 (]: SQL status: OK in 0.012 seconds
[0m22:15:24.852895 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m22:15:24.854894 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m22:15:24.855893 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: BEGIN
[0m22:15:24.856892 [debug] [Thread-8 (]: SQL status: OK in 0.011 seconds
[0m22:15:24.857894 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table prod.raw.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m22:15:24.858895 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table prod.raw.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m22:15:24.859893 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m22:15:24.860894 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m22:15:24.861895 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m22:15:24.862903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:24.863894 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m22:15:24.865892 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.regions"} */

    create table prod.raw.regions (regionID integer,regionDescription text)
  
[0m22:15:24.867894 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */

    create table prod.raw.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m22:15:24.868895 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.869895 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m22:15:24.869895 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.shippers"} */

    create table prod.raw.shippers (shipperID integer,companyName text,phone text)
  
[0m22:15:24.871894 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.suppliers"} */

    create table prod.raw.suppliers (supplierID integer,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text,homePage text)
  
[0m22:15:24.872897 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m22:15:24.876892 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m22:15:24.877892 [debug] [Thread-5 (]: SQL status: OK in 0.005 seconds
[0m22:15:24.880893 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m22:15:24.880893 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m22:15:24.884893 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m22:15:24.885897 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.886894 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: 
          COPY prod.raw.raw_orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.887892 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m22:15:24.890893 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m22:15:24.891892 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: 
          COPY prod.raw.raw_order_items FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.894896 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m22:15:24.895894 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.territories"} */

    create table prod.raw.territories (territoryID integer,territoryDescription text,regionID integer)
  
[0m22:15:24.898891 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m22:15:24.902894 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m22:15:24.903903 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: 
          COPY prod.raw.regions FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.905893 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY prod.raw.raw_products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.906893 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: 
          COPY prod.raw.shippers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.907893 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: 
          COPY prod.raw.suppliers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.908913 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.914894 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m22:15:24.916898 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: 
          COPY prod.raw.territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:15:24.920894 [debug] [Thread-7 (]: SQL status: OK in 0.020 seconds
[0m22:15:24.921894 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m22:15:24.923892 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m22:15:24.924892 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m22:15:24.925892 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m22:15:24.926892 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m22:15:24.934893 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m22:15:24.937891 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m22:15:24.938892 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m22:15:24.939891 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m22:15:24.940893 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m22:15:24.941892 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m22:15:24.942891 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m22:15:24.946892 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m22:15:24.947891 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m22:15:24.948892 [debug] [Thread-5 (]: SQL status: OK in 0.039 seconds
[0m22:15:24.950892 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m22:15:24.951898 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m22:15:24.952895 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m22:15:24.953894 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m22:15:24.955892 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m22:15:24.975894 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: COMMIT
[0m22:15:24.957897 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m22:15:24.959893 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m22:15:24.961892 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_order_items: Close
[0m22:15:24.963894 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_orders: Close
[0m22:15:24.967893 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: COMMIT
[0m22:15:24.976893 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m22:15:24.958894 [debug] [Thread-8 (]: SQL status: OK in 0.048 seconds
[0m22:15:24.982893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C4ADDF0>]}
[0m22:15:24.984894 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E506600>]}
[0m22:15:24.985892 [debug] [Thread-6 (]: SQL status: OK in 0.496 seconds
[0m22:15:24.986892 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m22:15:24.987891 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m22:15:24.988894 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: COMMIT
[0m22:15:24.990891 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m22:15:24.993892 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m22:15:24.997891 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m22:15:24.999892 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: Close
[0m22:15:25.000899 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: COMMIT
[0m22:15:25.002893 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m22:15:25.003892 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m22:15:25.004893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9B75D280>]}
[0m22:15:25.006892 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m22:15:25.008896 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: Close
[0m22:15:25.013893 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m22:15:25.016893 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m22:15:24.994892 [info ] [Thread-3 (]: 9 of 15 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.28s]
[0m22:15:25.017893 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m22:15:25.019895 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E54C080>]}
[0m22:15:25.020895 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m22:15:25.021893 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m22:15:25.022894 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m22:15:25.023892 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m22:15:25.025894 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: Close
[0m22:15:24.996891 [info ] [Thread-7 (]: 10 of 15 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.27s]
[0m22:15:25.028894 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m22:15:25.029895 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m22:15:25.031893 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m22:15:25.009892 [info ] [Thread-2 (]: 13 of 15 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.28s]
[0m22:15:25.033893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E507DA0>]}
[0m22:15:25.035893 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.raw_orders
[0m22:15:25.036893 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E529280>]}
[0m22:15:25.038893 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.shippers
[0m22:15:25.039893 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m22:15:25.041895 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m22:15:25.046898 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: Close
[0m22:15:25.027894 [info ] [Thread-5 (]: 12 of 15 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.30s]
[0m22:15:25.048894 [debug] [Thread-8 (]: On seed.ci_cd_project.suppliers: Close
[0m22:15:25.050893 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9E351340>]}
[0m22:15:25.051893 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.regions
[0m22:15:25.040893 [info ] [Thread-1 (]: 15 of 15 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.29s]
[0m22:15:25.055898 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.territories
[0m22:15:25.043895 [info ] [Thread-4 (]: 11 of 15 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.32s]
[0m22:15:25.058897 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m22:15:25.053893 [info ] [Thread-6 (]: 6 of 15 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 1.53s]
[0m22:15:25.060894 [debug] [Thread-6 (]: Finished running node seed.ci_cd_project.orders
[0m22:15:25.361894 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd0724f9-1e9c-4904-9af2-c61d3c1ffa2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C332FF0>]}
[0m22:15:25.363895 [info ] [Thread-8 (]: 14 of 15 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.64s]
[0m22:15:25.365895 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.suppliers
[0m22:15:25.369894 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:25.370896 [debug] [MainThread]: On master: BEGIN
[0m22:15:25.371895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:26.023894 [debug] [MainThread]: SQL status: OK in 0.652 seconds
[0m22:15:26.024894 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.025894 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:26.026894 [debug] [MainThread]: On master: COMMIT
[0m22:15:26.029894 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:26.030894 [debug] [MainThread]: On master: Close
[0m22:15:26.039893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:26.040896 [debug] [MainThread]: Connection 'create_prod_raw' was properly closed.
[0m22:15:26.041894 [debug] [MainThread]: Connection 'list_prod_raw' was properly closed.
[0m22:15:26.042894 [debug] [MainThread]: Connection 'list_prod_analytics' was properly closed.
[0m22:15:26.043894 [debug] [MainThread]: Connection 'seed.ci_cd_project.territories' was properly closed.
[0m22:15:26.043894 [debug] [MainThread]: Connection 'seed.ci_cd_project.shippers' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.regions' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.orders' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m22:15:26.044957 [debug] [MainThread]: Connection 'seed.ci_cd_project.suppliers' was properly closed.
[0m22:15:26.050109 [info ] [MainThread]: 
[0m22:15:26.060212 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 12.71 seconds (12.71s).
[0m22:15:26.137308 [debug] [MainThread]: Command end result
[0m22:15:26.459022 [info ] [MainThread]: 
[0m22:15:26.472133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:26.481644 [info ] [MainThread]: 
[0m22:15:26.488643 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m22:15:26.493641 [debug] [MainThread]: Command `dbt seed` succeeded at 22:15:26.493641 after 27.63 seconds
[0m22:15:26.494641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9C462A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9B7A9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA9B7AE810>]}
[0m22:15:26.495640 [debug] [MainThread]: Flushing usage events
[0m22:15:26.533697 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:16:59.112918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC9298D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC92989B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC9298B30>]}


============================== 22:16:59.123917 | 9754cb23-f930-4e2f-a77d-69dc8d859c1f ==============================
[0m22:16:59.123917 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:16:59.125917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation drop_pr_dbs', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:16:59.841792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC59858E0>]}
[0m22:17:00.002792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC785ED50>]}
[0m22:17:00.009793 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m22:17:01.182634 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:17:01.488869 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:17:01.491869 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m22:17:01.492871 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:17:01.495871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC85BBF20>]}
[0m22:17:09.482923 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:17:09.542714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECA73E360>]}
[0m22:17:10.652609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m22:17:10.654609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m22:17:10.654609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m22:17:10.655609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m22:17:10.656608 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m22:17:10.656608 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m22:17:10.657608 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m22:17:10.658607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m22:17:10.659607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m22:17:10.660609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m22:17:10.661611 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m22:17:10.662609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m22:17:10.662609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m22:17:10.663609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m22:17:10.664609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m22:17:10.664609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m22:17:10.665609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m22:17:10.666608 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m22:17:10.667609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m22:17:10.667609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m22:17:10.668607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m22:17:10.669607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m22:17:10.670607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m22:17:10.671609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m22:17:10.671609 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m22:17:10.672607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m22:17:10.673607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m22:17:10.673607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m22:17:10.922128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECA671CD0>]}
[0m22:17:11.498128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECAEF33E0>]}
[0m22:17:11.500128 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 880 macros
[0m22:17:11.502128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9754cb23-f930-4e2f-a77d-69dc8d859c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC5DF8DA0>]}
[0m22:17:11.503129 [debug] [MainThread]: Acquiring new duckdb connection 'macro_drop_pr_dbs'
[0m22:17:11.504129 [debug] [MainThread]: Using duckdb connection "macro_drop_pr_dbs"
[0m22:17:11.505129 [debug] [MainThread]: On macro_drop_pr_dbs: BEGIN
[0m22:17:11.506128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:12.029601 [debug] [MainThread]: SQL status: OK in 0.524 seconds
[0m22:17:12.030600 [debug] [MainThread]: On macro_drop_pr_dbs: COMMIT
[0m22:17:12.031600 [debug] [MainThread]: Using duckdb connection "macro_drop_pr_dbs"
[0m22:17:12.032598 [debug] [MainThread]: On macro_drop_pr_dbs: COMMIT
[0m22:17:12.034600 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:17:12.034600 [debug] [MainThread]: On macro_drop_pr_dbs: Close
[0m22:17:12.045600 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "drop_pr_dbs" in any package
[0m22:17:12.054600 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\preben.geier\Documents\dbt-workshop\.venv\Lib\site-packages\dbt\task\run_operation.py", line 62, in run
    self._run_unsafe(package_name, macro_name)
  File "C:\Users\preben.geier\Documents\dbt-workshop\.venv\Lib\site-packages\dbt\task\run_operation.py", line 47, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\preben.geier\Documents\dbt-workshop\.venv\Lib\site-packages\dbt\adapters\base\impl.py", line 1271, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "drop_pr_dbs" in any package

[0m22:17:12.055600 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'drop_pr_dbs' in any package
[0m22:17:12.062587 [debug] [MainThread]: Command `dbt run-operation` failed at 22:17:12.062045 after 13.31 seconds
[0m22:17:12.063665 [debug] [MainThread]: Connection 'macro_drop_pr_dbs' was properly closed.
[0m22:17:12.064748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC8FEA5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECAEF3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022ECAEF2690>]}
[0m22:17:12.065819 [debug] [MainThread]: Flushing usage events
[0m22:17:12.145041 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m22:17:22.815285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F56D4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F56D5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F56D5D90>]}


============================== 22:17:22.826284 | 3b993470-0dea-4f8f-b762-7079cb663053 ==============================
[0m22:17:22.826284 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:17:22.828285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build -s state:modified+ --defer --state ./', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:17:23.586723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b993470-0dea-4f8f-b762-7079cb663053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F73ED820>]}
[0m22:17:23.739724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b993470-0dea-4f8f-b762-7079cb663053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F3985D00>]}
[0m22:17:23.746724 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m22:17:24.839377 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:17:26.139198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:17:26.140198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:17:26.304199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b993470-0dea-4f8f-b762-7079cb663053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F8228F80>]}
[0m22:17:26.791000 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not read WritableManifest at "C:\Users\preben.geier\Documents\dbt-workshop\manifest.json" as JSON: Extra data: line 1 column 4 (char 3)
[0m22:17:26.795000 [debug] [MainThread]: Command `dbt build` failed at 22:17:26.795000 after 4.31 seconds
[0m22:17:26.796003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F710FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F86EF680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F71D9820>]}
[0m22:17:26.799000 [debug] [MainThread]: Flushing usage events
[0m22:17:26.836000 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:29:59.555947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFDF7DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFDF7DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFEB57500>]}


============================== 15:29:59.560947 | 63117ea8-4d71-425e-9a7a-34b7087e4b60 ==============================
[0m15:29:59.560947 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:29:59.561948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'profiles_dir': 'c:\\Users\\preben.geier\\Documents\\dbt-workshop', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:59.731340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFD2CAFF0>]}
[0m15:29:59.771014 [debug] [MainThread]: Set downloads directory='C:\Users\PREBEN~1.GEI\AppData\Local\Temp\dbt-downloads-bb_jzp3c'
[0m15:29:59.772013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:30:00.336928 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:30:00.339926 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:30:00.873080 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:30:00.883082 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m15:30:01.458742 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m15:30:01.463671 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m15:30:01.999153 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m15:30:02.002152 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m15:30:02.002152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFECB85F0>]}
[0m15:30:02.007665 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m15:30:02.633000 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m15:30:02.653016 [info ] [MainThread]: Updating lock file in file path: C:\Users\preben.geier\Documents\dbt-workshop/package-lock.yml
[0m15:30:03.535325 [debug] [MainThread]: Set downloads directory='C:\Users\PREBEN~1.GEI\AppData\Local\Temp\dbt-downloads-1d1m9bj_'
[0m15:30:03.549324 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:30:05.352314 [info ] [MainThread]: Installed from version 1.1.1
[0m15:30:05.353315 [info ] [MainThread]: Updated version available: 1.3.1
[0m15:30:05.353315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFF4911F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFF490D70>]}
[0m15:30:05.354316 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m15:30:09.068928 [info ] [MainThread]: Installed from version 0.11.0
[0m15:30:09.069932 [info ] [MainThread]: Updated version available: 1.0.2
[0m15:30:09.069932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFEDED370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFE953680>]}
[0m15:30:09.070929 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m15:30:10.747953 [info ] [MainThread]: Installed from version 0.10.3
[0m15:30:10.747953 [info ] [MainThread]: Updated version available: 0.10.4
[0m15:30:10.748952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFEC908C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFED56990>]}
[0m15:30:10.749956 [info ] [MainThread]: Installing calogica/dbt_date
[0m15:30:11.903465 [info ] [MainThread]: Installed from version 0.10.1
[0m15:30:11.903465 [info ] [MainThread]: Up to date!
[0m15:30:11.904469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63117ea8-4d71-425e-9a7a-34b7087e4b60', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFED56360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFED57080>]}
[0m15:30:11.905466 [info ] [MainThread]: 
[0m15:30:11.905466 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m15:30:11.915472 [debug] [MainThread]: Command `cli deps` succeeded at 15:30:11.915472 after 12.51 seconds
[0m15:30:11.916466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFDF7DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFDF7DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EFD6B7080>]}
[0m15:30:11.916466 [debug] [MainThread]: Flushing usage events
[0m15:52:45.616342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E4614F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E798800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E798140>]}


============================== 15:52:45.624672 | d2238918-a784-4a34-a0bb-1d431ae36245 ==============================
[0m15:52:45.624672 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:52:45.624672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:52:46.155734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8AD85DF0>]}
[0m15:52:46.239499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E77F980>]}
[0m15:52:46.255360 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m15:52:47.083457 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m15:52:47.255011 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:52:47.255011 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m15:52:47.255011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8DABBE00>]}
[0m15:52:52.144784 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:52:52.145853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8F969A00>]}
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m15:52:52.739315 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m15:52:52.959802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9022B110>]}
[0m15:52:53.362573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC78110>]}
[0m15:52:53.364567 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 858 macros
[0m15:52:53.366373 [info ] [MainThread]: 
[0m15:52:53.366373 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:52:53.380417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:52:53.396586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m15:52:54.068105 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:52:54.068105 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m15:52:54.081125 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:52:54.081125 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m15:52:54.081125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:54.081125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:55.615431 [debug] [ThreadPool]: SQL status: OK in 1.532 seconds
[0m15:52:55.616435 [debug] [ThreadPool]: SQL status: OK in 1.534 seconds
[0m15:52:55.620437 [debug] [ThreadPool]: On list_dev: Close
[0m15:52:55.623436 [debug] [ThreadPool]: On list_dev: Close
[0m15:52:55.634015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_raw)
[0m15:52:55.635027 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "raw"
"
[0m15:52:55.654172 [debug] [ThreadPool]: Using duckdb connection "create_dev_raw"
[0m15:52:55.655172 [debug] [ThreadPool]: On create_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_raw"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m15:52:55.656173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:56.036770 [debug] [ThreadPool]: SQL status: OK in 0.381 seconds
[0m15:52:56.042087 [debug] [ThreadPool]: Using duckdb connection "create_dev_raw"
[0m15:52:56.043087 [debug] [ThreadPool]: On create_dev_raw: BEGIN
[0m15:52:56.044603 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:52:56.045609 [debug] [ThreadPool]: Using duckdb connection "create_dev_raw"
[0m15:52:56.046469 [debug] [ThreadPool]: On create_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_raw"} */

    
    
        create schema if not exists dev.raw
    
[0m15:52:56.058016 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m15:52:56.061014 [debug] [ThreadPool]: On create_dev_raw: COMMIT
[0m15:52:56.062007 [debug] [ThreadPool]: Using duckdb connection "create_dev_raw"
[0m15:52:56.063009 [debug] [ThreadPool]: On create_dev_raw: COMMIT
[0m15:52:56.080553 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:52:56.081550 [debug] [ThreadPool]: On create_dev_raw: Close
[0m15:52:56.150151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_raw'
[0m15:52:56.166447 [debug] [ThreadPool]: Using duckdb connection "list_dev_raw"
[0m15:52:56.167451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m15:52:56.168447 [debug] [ThreadPool]: On list_dev_raw: BEGIN
[0m15:52:56.176200 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:52:56.177525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:56.178037 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m15:52:56.180143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:56.638475 [debug] [ThreadPool]: SQL status: OK in 0.461 seconds
[0m15:52:56.639562 [debug] [ThreadPool]: Using duckdb connection "list_dev_raw"
[0m15:52:56.640631 [debug] [ThreadPool]: SQL status: OK in 0.461 seconds
[0m15:52:56.641702 [debug] [ThreadPool]: On list_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_raw"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'dev'
  
[0m15:52:56.642774 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m15:52:56.643846 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m15:52:56.780916 [debug] [ThreadPool]: SQL status: OK in 0.136 seconds
[0m15:52:56.785219 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m15:52:56.787033 [debug] [ThreadPool]: SQL status: OK in 0.143 seconds
[0m15:52:56.790528 [debug] [ThreadPool]: On list_dev_raw: ROLLBACK
[0m15:52:56.794391 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m15:52:56.795433 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m15:52:56.798657 [debug] [ThreadPool]: Failed to rollback 'list_dev_raw'
[0m15:52:56.803012 [debug] [ThreadPool]: On list_dev_raw: Close
[0m15:52:56.812877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE90275580>]}
[0m15:52:56.814384 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:56.815400 [debug] [MainThread]: On master: BEGIN
[0m15:52:56.816401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:57.145428 [debug] [MainThread]: SQL status: OK in 0.333 seconds
[0m15:52:57.145428 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.145428 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:57.145428 [debug] [MainThread]: On master: COMMIT
[0m15:52:57.145428 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:52:57.145428 [debug] [MainThread]: On master: Close
[0m15:52:57.160947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:57.160947 [info ] [MainThread]: 
[0m15:52:57.207221 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m15:52:57.207221 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m15:52:57.207221 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m15:52:57.207221 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m15:52:57.207221 [info ] [Thread-1 (]: 1 of 64 START seed file raw.categories ......................................... [RUN]
[0m15:52:57.207221 [info ] [Thread-2 (]: 2 of 64 START seed file raw.customers .......................................... [RUN]
[0m15:52:57.207221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ci_cd_project.categories'
[0m15:52:57.207221 [info ] [Thread-3 (]: 3 of 64 START seed file raw.employee_territories ............................... [RUN]
[0m15:52:57.220170 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.customers'
[0m15:52:57.221201 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m15:52:57.207221 [info ] [Thread-4 (]: 4 of 64 START seed file raw.employees .......................................... [RUN]
[0m15:52:57.223193 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m15:52:57.224194 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m15:52:57.224194 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m15:52:57.224194 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m15:52:57.224194 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m15:52:57.224194 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m15:52:57.340799 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m15:52:57.386110 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m15:52:57.403541 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m15:52:57.486506 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m15:52:57.491602 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m15:52:57.491602 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m15:52:57.491602 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m15:52:57.491602 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m15:52:57.491602 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m15:52:57.491602 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:52:57.491602 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:57.491602 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m15:52:57.506623 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m15:52:57.506623 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:52:57.506623 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:52:57.817810 [debug] [Thread-2 (]: SQL status: OK in 0.314 seconds
[0m15:52:57.818815 [debug] [Thread-4 (]: SQL status: OK in 0.310 seconds
[0m15:52:57.819812 [debug] [Thread-1 (]: SQL status: OK in 0.315 seconds
[0m15:52:57.820807 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m15:52:57.821806 [debug] [Thread-3 (]: SQL status: OK in 0.312 seconds
[0m15:52:57.822803 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m15:52:57.823872 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m15:52:57.823872 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.customers"} */

    create table dev.raw.customers (customerID text,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text)
  
[0m15:52:57.823872 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m15:52:57.823872 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.employees"} */

    create table dev.raw.employees (employeeID integer,lastName text,firstName text,title text,titleOfCourtesy text,birthDate text,hireDate text,address text,city text,region text,postalCode text,country text,homePhone text,extension integer,photo text,notes text,reportsTo integer,photoPath text)
  
[0m15:52:57.823872 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.categories"} */

    create table dev.raw.categories (categoryID integer,categoryName text,description text,picture text)
  
[0m15:52:57.823872 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.employee_territories"} */

    create table dev.raw.employee_territories (employeeID integer,territoryID integer)
  
[0m15:52:57.823872 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:52:57.823872 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:52:57.823872 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:52:57.855391 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m15:52:57.872297 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m15:52:57.886342 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m15:52:57.886342 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m15:52:57.886342 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m15:52:57.886342 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY dev.raw.customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:57.901981 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY dev.raw.employees FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:57.901981 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY dev.raw.categories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:57.901981 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY dev.raw.employee_territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:57.936724 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m15:52:57.936724 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m15:52:57.936724 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m15:52:57.949735 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m15:52:57.949735 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m15:52:57.949735 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m15:52:57.949735 [debug] [Thread-4 (]: SQL status: OK in 0.055 seconds
[0m15:52:57.949735 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.employees"
[0m15:52:58.011260 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m15:52:58.019774 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m15:52:58.019774 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m15:52:58.019774 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m15:52:58.019774 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m15:52:58.019774 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m15:52:58.019774 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m15:52:58.019774 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m15:52:58.019774 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m15:52:58.036123 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m15:52:58.036123 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m15:52:58.036123 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m15:52:58.036123 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:52:58.036123 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m15:52:58.036123 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:52:58.036123 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FD2AA20>]}
[0m15:52:58.036123 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:52:58.036123 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:52:58.052296 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m15:52:58.052296 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m15:52:58.052296 [info ] [Thread-2 (]: 2 of 64 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 0.83s]
[0m15:52:58.052296 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m15:52:58.052296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FD28FB0>]}
[0m15:52:58.052296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8F88C740>]}
[0m15:52:58.052296 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m15:52:58.052296 [info ] [Thread-3 (]: 3 of 64 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 0.83s]
[0m15:52:58.052296 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.order_details
[0m15:52:58.065227 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m15:52:58.052296 [info ] [Thread-1 (]: 1 of 64 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 0.85s]
[0m15:52:58.068983 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.orders
[0m15:52:58.070982 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m15:52:58.066968 [info ] [Thread-2 (]: 5 of 64 START seed file raw.order_details ...................................... [RUN]
[0m15:52:58.073733 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.products
[0m15:52:58.074772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.order_details)
[0m15:52:58.071991 [info ] [Thread-3 (]: 6 of 64 START seed file raw.orders ............................................. [RUN]
[0m15:52:58.076771 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.order_details
[0m15:52:58.076771 [info ] [Thread-1 (]: 7 of 64 START seed file raw.products ........................................... [RUN]
[0m15:52:58.078769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.orders)
[0m15:52:58.079641 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.order_details
[0m15:52:58.079641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.products)
[0m15:52:58.079641 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.orders
[0m15:52:58.086710 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.products
[0m15:52:58.090466 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.products
[0m15:52:58.090466 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.orders
[0m15:52:58.205484 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9029F080>]}
[0m15:52:58.223170 [info ] [Thread-4 (]: 4 of 64 OK loaded seed file raw.employees ...................................... [[32mINSERT 8[0m in 0.98s]
[0m15:52:58.246575 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m15:52:58.258251 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_customers
[0m15:52:58.273255 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m15:52:58.274269 [info ] [Thread-4 (]: 8 of 64 START seed file raw.raw_customers ...................................... [RUN]
[0m15:52:58.279262 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m15:52:58.280261 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: BEGIN
[0m15:52:58.306645 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.raw_customers)
[0m15:52:58.330759 [debug] [Thread-1 (]: On seed.ci_cd_project.products: BEGIN
[0m15:52:58.341723 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:58.341723 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m15:52:58.341723 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m15:52:58.341723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:58.341723 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: BEGIN
[0m15:52:58.341723 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_customers
[0m15:52:58.341723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:52:58.363956 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m15:52:58.364949 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m15:52:58.366947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:58.614653 [debug] [Thread-2 (]: SQL status: OK in 0.273 seconds
[0m15:52:58.615656 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m15:52:58.616655 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m15:52:58.617654 [debug] [Thread-3 (]: SQL status: OK in 0.268 seconds
[0m15:52:58.618660 [debug] [Thread-4 (]: SQL status: OK in 0.252 seconds
[0m15:52:58.619653 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m15:52:58.620652 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.order_details"} */

    create table dev.raw.order_details (orderID integer,productID integer,unitPrice float8,quantity integer,discount float8)
  
[0m15:52:58.621663 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m15:52:58.622653 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m15:52:58.623655 [debug] [Thread-1 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.products"} */

    create table dev.raw.products (productID integer,productName text,supplierID integer,categoryID integer,quantityPerUnit text,unitPrice float8,unitsInStock integer,unitsOnOrder integer,reorderLevel integer,discontinued integer)
  
[0m15:52:58.625662 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.orders"} */

    create table dev.raw.orders (orderID integer,customerID text,employeeID integer,orderDate text,requiredDate text,shippedDate text,shipVia integer,freight float8,shipName text,shipAddress text,shipCity text,shipRegion text,shipPostalCode text,shipCountry text)
  
[0m15:52:58.626660 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table dev.raw.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m15:52:58.627656 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:52:58.632140 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m15:52:58.633137 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:52:58.635145 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: 
          COPY dev.raw.order_details FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.636138 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:52:58.637142 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:52:58.640140 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m15:52:58.643141 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m15:52:58.644242 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m15:52:58.644242 [debug] [Thread-1 (]: On seed.ci_cd_project.products: 
          COPY dev.raw.products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.644242 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: 
          COPY dev.raw.orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.644242 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.raw.raw_customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.659876 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m15:52:58.659876 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:52:58.659876 [debug] [Thread-4 (]: SQL status: OK in 0.023 seconds
[0m15:52:58.659876 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m15:52:58.675496 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m15:52:58.675496 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m15:52:58.675496 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: COMMIT
[0m15:52:58.687434 [debug] [Thread-1 (]: On seed.ci_cd_project.products: COMMIT
[0m15:52:58.687434 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m15:52:58.687434 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m15:52:58.691444 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m15:52:58.692187 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m15:52:58.692997 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: COMMIT
[0m15:52:58.692997 [debug] [Thread-1 (]: On seed.ci_cd_project.products: COMMIT
[0m15:52:58.692997 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m15:52:58.692997 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:52:58.692997 [debug] [Thread-2 (]: On seed.ci_cd_project.order_details: Close
[0m15:52:58.692997 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:52:58.692997 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:52:58.706741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC5C9E0>]}
[0m15:52:58.707780 [debug] [Thread-1 (]: On seed.ci_cd_project.products: Close
[0m15:52:58.709756 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_customers: Close
[0m15:52:58.710771 [info ] [Thread-2 (]: 5 of 64 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 0.63s]
[0m15:52:58.711764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE909F7F20>]}
[0m15:52:58.712753 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FD04B30>]}
[0m15:52:58.713784 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.order_details
[0m15:52:58.714758 [info ] [Thread-1 (]: 7 of 64 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 0.63s]
[0m15:52:58.717758 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m15:52:58.716756 [info ] [Thread-4 (]: 8 of 64 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 0.41s]
[0m15:52:58.719159 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.products
[0m15:52:58.723202 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_customers
[0m15:52:58.720174 [info ] [Thread-2 (]: 9 of 64 START seed file raw.raw_order_items .................................... [RUN]
[0m15:52:58.724449 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_orders
[0m15:52:58.726445 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m15:52:58.727699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.raw_order_items)
[0m15:52:58.728702 [info ] [Thread-1 (]: 10 of 64 START seed file raw.raw_orders ........................................ [RUN]
[0m15:52:58.731700 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m15:52:58.730701 [info ] [Thread-4 (]: 11 of 64 START seed file raw.raw_products ...................................... [RUN]
[0m15:52:58.732700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.raw_orders)
[0m15:52:58.733700 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m15:52:58.734693 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.raw_products)
[0m15:52:58.735227 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m15:52:58.743235 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m15:52:58.746237 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_orders
[0m15:52:58.748238 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m15:52:58.757206 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m15:52:58.772379 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m15:52:58.773870 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m15:52:58.773870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:58.773870 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m15:52:58.773870 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m15:52:58.773870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:58.773870 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m15:52:58.773870 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:52:58.788916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:58.794904 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m15:52:58.794904 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:52:58.794904 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table dev.raw.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m15:52:58.794904 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:52:58.794904 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m15:52:58.794904 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m15:52:58.794904 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:52:58.794904 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table dev.raw.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m15:52:58.794904 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */

    create table dev.raw.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m15:52:58.794904 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m15:52:58.794904 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.raw.raw_order_items FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.806507 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:52:58.807530 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:58.810520 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m15:52:58.813521 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m15:52:58.813521 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.raw.raw_products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.814521 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.raw.raw_orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.826523 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m15:52:58.829516 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m15:52:58.842516 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m15:52:58.841516 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m15:52:58.844520 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m15:52:58.845520 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m15:52:58.847525 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m15:52:58.848526 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m15:52:58.850519 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m15:52:58.857525 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m15:52:58.858519 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m15:52:58.859519 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:52:58.860520 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m15:52:58.864518 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m15:52:58.867912 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m15:52:58.869594 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m15:52:58.869594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC6E630>]}
[0m15:52:58.869594 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m15:52:58.869594 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:52:58.869594 [info ] [Thread-2 (]: 9 of 64 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.14s]
[0m15:52:58.869594 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_orders: Close
[0m15:52:58.882621 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m15:52:58.882621 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:52:58.886151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8F98B7A0>]}
[0m15:52:58.886151 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.regions
[0m15:52:58.887685 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m15:52:58.887685 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8F87CE00>]}
[0m15:52:58.887685 [info ] [Thread-1 (]: 10 of 64 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.15s]
[0m15:52:58.887685 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_orders
[0m15:52:58.898381 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.shippers
[0m15:52:58.887685 [info ] [Thread-2 (]: 12 of 64 START seed file raw.regions ........................................... [RUN]
[0m15:52:58.902218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now seed.ci_cd_project.regions)
[0m15:52:58.903220 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.regions
[0m15:52:58.887685 [info ] [Thread-4 (]: 11 of 64 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.15s]
[0m15:52:58.904942 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.regions
[0m15:52:58.901205 [info ] [Thread-1 (]: 13 of 64 START seed file raw.shippers .......................................... [RUN]
[0m15:52:58.906627 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m15:52:58.919229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now seed.ci_cd_project.shippers)
[0m15:52:58.923550 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.suppliers
[0m15:52:58.923550 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.shippers
[0m15:52:58.923550 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.shippers
[0m15:52:58.923550 [info ] [Thread-4 (]: 14 of 64 START seed file raw.suppliers ......................................... [RUN]
[0m15:52:58.939178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now seed.ci_cd_project.suppliers)
[0m15:52:58.940348 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m15:52:58.940348 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.suppliers
[0m15:52:58.940348 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m15:52:58.940348 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: BEGIN
[0m15:52:58.953499 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.suppliers
[0m15:52:58.953499 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: BEGIN
[0m15:52:58.955509 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:58.956904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:58.956904 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:52:58.956904 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:52:58.956904 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m15:52:58.956904 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m15:52:58.956904 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.regions"} */

    create table dev.raw.regions (regionID integer,regionDescription text)
  
[0m15:52:58.973160 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.shippers"} */

    create table dev.raw.shippers (shipperID integer,companyName text,phone text)
  
[0m15:52:58.973724 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:52:58.978798 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m15:52:58.980851 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:52:58.983861 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: 
          COPY dev.raw.regions FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.984959 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m15:52:58.990445 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m15:52:58.990445 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m15:52:58.990445 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: 
          COPY dev.raw.shippers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:58.990445 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:58.990445 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:52:58.990445 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m15:52:58.990445 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.suppliers"} */

    create table dev.raw.suppliers (supplierID integer,companyName text,contactName text,contactTitle text,address text,city text,region text,postalCode text,country text,phone text,fax text,homePage text)
  
[0m15:52:58.990445 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:52:58.990445 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:52:58.990445 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m15:52:59.005970 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m15:52:59.006974 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: 
          COPY dev.raw.suppliers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:59.006974 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m15:52:59.006974 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m15:52:59.006974 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: COMMIT
[0m15:52:59.006974 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m15:52:59.021996 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: COMMIT
[0m15:52:59.023888 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: COMMIT
[0m15:52:59.023888 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m15:52:59.023888 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: COMMIT
[0m15:52:59.023888 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.023888 [debug] [Thread-1 (]: On seed.ci_cd_project.shippers: Close
[0m15:52:59.023888 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:52:59.023888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE9024A0F0>]}
[0m15:52:59.023888 [debug] [Thread-2 (]: On seed.ci_cd_project.regions: Close
[0m15:52:59.039798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC80380>]}
[0m15:52:59.038913 [info ] [Thread-1 (]: 13 of 64 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.10s]
[0m15:52:59.042807 [debug] [Thread-4 (]: SQL status: OK in 0.033 seconds
[0m15:52:59.043815 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.shippers
[0m15:52:59.040810 [info ] [Thread-2 (]: 12 of 64 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.14s]
[0m15:52:59.045808 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m15:52:59.047809 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.territories
[0m15:52:59.048810 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.regions
[0m15:52:59.051813 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_nw_customers
[0m15:52:59.058809 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m15:52:59.059807 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m15:52:59.060806 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m15:52:59.063808 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:52:59.065813 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: Close
[0m15:52:59.066808 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE909D7680>]}
[0m15:52:59.050808 [info ] [Thread-1 (]: 15 of 64 START seed file raw.territories ....................................... [RUN]
[0m15:52:59.073570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.shippers, now seed.ci_cd_project.territories)
[0m15:52:59.073570 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.territories
[0m15:52:59.073570 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.territories
[0m15:52:59.073570 [debug] [Thread-3 (]: SQL status: OK in 0.434 seconds
[0m15:52:59.053808 [info ] [Thread-2 (]: 16 of 64 START sql view model analytics.stg_nw_customers ....................... [RUN]
[0m15:52:59.090424 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m15:52:59.090424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.regions, now model.ci_cd_project.stg_nw_customers)
[0m15:52:59.067584 [info ] [Thread-4 (]: 14 of 64 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.14s]
[0m15:52:59.090424 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_nw_customers
[0m15:52:59.090424 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.suppliers
[0m15:52:59.123128 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_customers
[0m15:52:59.107032 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.128780 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m15:52:59.131781 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: BEGIN
[0m15:52:59.131781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:59.130778 [info ] [Thread-4 (]: 17 of 64 START sql view model analytics.stg_customers .......................... [RUN]
[0m15:52:59.131781 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: COMMIT
[0m15:52:59.140567 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:52:59.131781 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.suppliers, now model.ci_cd_project.stg_customers)
[0m15:52:59.140567 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m15:52:59.140567 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_nw_customers
[0m15:52:59.140567 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m15:52:59.140567 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_customers
[0m15:52:59.140567 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: COMMIT
[0m15:52:59.188921 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.territories"} */

    create table dev.raw.territories (territoryID integer,territoryDescription text,regionID integer)
  
[0m15:52:59.243585 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m15:52:59.249457 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.252232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:59.255856 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m15:52:59.256605 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: 
          COPY dev.raw.territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m15:52:59.257798 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:52:59.258884 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_customers
[0m15:52:59.261524 [debug] [Thread-3 (]: On seed.ci_cd_project.orders: Close
[0m15:52:59.262086 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.272656 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m15:52:59.274266 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:52:59.275330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8F914E30>]}
[0m15:52:59.276398 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: BEGIN
[0m15:52:59.277499 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m15:52:59.279739 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:59.278595 [info ] [Thread-3 (]: 6 of 64 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 1.20s]
[0m15:52:59.282700 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.284504 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.orders
[0m15:52:59.285557 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m15:52:59.286100 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:52:59.287174 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_order_items
[0m15:52:59.288336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:59.292118 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: COMMIT
[0m15:52:59.293127 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.294800 [info ] [Thread-3 (]: 18 of 64 START sql view model analytics.stg_order_items ........................ [RUN]
[0m15:52:59.296813 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m15:52:59.298906 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:52:59.300353 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_nw_customers"} */

  
  create view dev.analytics.stg_nw_customers__dbt_tmp as (
    

with source as (
    select * from dev.raw.customers
),

staged as (
    select
        customerid,
        companyname,
        contactname,
        contacttitle,
        address,
        city,
        region,
        postalcode,
        country,
        phone,
        fax
    from source
)

select * from staged
where true
  );

[0m15:52:59.301273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.orders, now model.ci_cd_project.stg_order_items)
[0m15:52:59.302318 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: COMMIT
[0m15:52:59.303908 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.307149 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m15:52:59.308582 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:52:59.309594 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.raw.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m15:52:59.310871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.322035 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m15:52:59.338950 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.340414 [debug] [Thread-1 (]: On seed.ci_cd_project.territories: Close
[0m15:52:59.340414 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.340414 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_nw_customers"} */
alter view dev.analytics.stg_nw_customers__dbt_tmp rename to stg_nw_customers
[0m15:52:59.340414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FD04B30>]}
[0m15:52:59.354405 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.358295 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.359334 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "dev"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m15:52:59.356429 [info ] [Thread-1 (]: 15 of 64 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.27s]
[0m15:52:59.360855 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_order_items
[0m15:52:59.361400 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m15:52:59.361400 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.territories
[0m15:52:59.373121 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.375126 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_orders
[0m15:52:59.376122 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:52:59.384125 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m15:52:59.385124 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m15:52:59.397049 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.387122 [info ] [Thread-1 (]: 19 of 64 START sql view model analytics.stg_orders ............................. [RUN]
[0m15:52:59.400069 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m15:52:59.402067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.territories, now model.ci_cd_project.stg_orders)
[0m15:52:59.403491 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:52:59.405194 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_orders
[0m15:52:59.406960 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.406960 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:52:59.426472 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m15:52:59.435279 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m15:52:59.436486 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m15:52:59.449021 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m15:52:59.450043 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_nw_customers"} */
drop view if exists dev.analytics.stg_nw_customers__dbt_backup cascade
[0m15:52:59.451571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:52:59.451571 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.456464 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m15:52:59.456987 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:52:59.456987 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_orders
[0m15:52:59.460603 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.460603 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:52:59.460603 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m15:52:59.470692 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m15:52:59.472207 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.raw.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m15:52:59.475190 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: Close
[0m15:52:59.485711 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m15:52:59.488334 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91C18FE0>]}
[0m15:52:59.490255 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m15:52:59.493783 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:52:59.491768 [info ] [Thread-2 (]: 16 of 64 OK created sql view model analytics.stg_nw_customers .................. [[32mOK[0m in 0.40s]
[0m15:52:59.503876 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.507665 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.509278 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_nw_customers
[0m15:52:59.509962 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m15:52:59.511001 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m15:52:59.512069 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "dev"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m15:52:59.513706 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_products
[0m15:52:59.517070 [debug] [Thread-4 (]: On model.ci_cd_project.stg_customers: Close
[0m15:52:59.519069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:59.521824 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:52:59.523251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91C7FC50>]}
[0m15:52:59.536221 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.520820 [info ] [Thread-2 (]: 20 of 64 START sql view model analytics.stg_products ........................... [RUN]
[0m15:52:59.540328 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m15:52:59.541000 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.541000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_nw_customers, now model.ci_cd_project.stg_products)
[0m15:52:59.538915 [info ] [Thread-4 (]: 17 of 64 OK created sql view model analytics.stg_customers ..................... [[32mOK[0m in 0.39s]
[0m15:52:59.541000 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m15:52:59.541000 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.raw.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m15:52:59.541000 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_products
[0m15:52:59.541000 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_customers
[0m15:52:59.556984 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m15:52:59.562534 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m15:52:59.563534 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m15:52:59.572386 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:52:59.573888 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.573888 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m15:52:59.573888 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_products
[0m15:52:59.573888 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "dev"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m15:52:59.573888 [info ] [Thread-4 (]: 21 of 64 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m15:52:59.573888 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.598151 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m15:52:59.599728 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:52:59.600782 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m15:52:59.601836 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.603478 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:52:59.617538 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.619692 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:52:59.643897 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:52:59.645015 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.646119 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m15:52:59.654401 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: BEGIN
[0m15:52:59.655562 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m15:52:59.656507 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:59.657435 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m15:52:59.657435 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.657435 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:52:59.657435 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m15:52:59.657435 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:52:59.657435 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.657435 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:52:59.657435 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.687411 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.raw.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m15:52:59.707306 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:52:59.707306 [debug] [Thread-3 (]: On model.ci_cd_project.stg_order_items: Close
[0m15:52:59.707306 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m15:52:59.707306 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91C60290>]}
[0m15:52:59.707306 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.722936 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:59.707306 [info ] [Thread-3 (]: 18 of 64 OK created sql view model analytics.stg_order_items ................... [[32mOK[0m in 0.41s]
[0m15:52:59.730214 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.735709 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m15:52:59.736799 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:52:59.737878 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_order_items
[0m15:52:59.738537 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view "dev"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m15:52:59.739660 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m15:52:59.740961 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:52:59.741995 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m15:52:59.744554 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:52:59.747424 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:52:59.746287 [info ] [Thread-3 (]: 22 of 64 START test not_null_stg_customers_email ............................... [RUN]
[0m15:52:59.749005 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:52:59.756377 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.758436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m15:52:59.759431 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m15:52:59.763070 [debug] [Thread-1 (]: On model.ci_cd_project.stg_orders: Close
[0m15:52:59.767325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE909F59A0>]}
[0m15:52:59.765971 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m15:52:59.766973 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:52:59.763969 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m15:52:59.815067 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m15:52:59.817085 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:52:59.767325 [info ] [Thread-1 (]: 19 of 64 OK created sql view model analytics.stg_orders ........................ [[32mOK[0m in 0.37s]
[0m15:52:59.820080 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_orders
[0m15:52:59.823080 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m15:52:59.825085 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:52:59.829079 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: COMMIT
[0m15:52:59.830253 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m15:52:59.832262 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.824085 [info ] [Thread-1 (]: 23 of 64 START test not_null_stg_customers_first_name .......................... [RUN]
[0m15:52:59.833262 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m15:52:59.841262 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m15:52:59.842262 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: COMMIT
[0m15:52:59.843262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m15:52:59.851195 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:52:59.854194 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m15:52:59.857199 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:52:59.869196 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m15:52:59.870196 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m15:52:59.870953 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:52:59.881305 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m15:52:59.882576 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m15:52:59.883669 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m15:52:59.886641 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m15:52:59.887819 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m15:52:59.885586 [info ] [Thread-4 (]: 21 of 64 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.29s]
[0m15:52:59.889346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:52:59.900723 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m15:52:59.902305 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m15:52:59.904278 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:52:59.909430 [debug] [Thread-2 (]: On model.ci_cd_project.stg_products: Close
[0m15:52:59.911514 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m15:52:59.913321 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m15:52:59.915800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91D3FFB0>]}
[0m15:52:59.914787 [info ] [Thread-4 (]: 24 of 64 START test not_null_stg_customers_last_name ........................... [RUN]
[0m15:52:59.917799 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m15:52:59.918870 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m15:52:59.918870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m15:52:59.924037 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m15:52:59.925039 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m15:52:59.926037 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m15:52:59.927669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:59.918870 [info ] [Thread-2 (]: 20 of 64 OK created sql view model analytics.stg_products ...................... [[32mOK[0m in 0.37s]
[0m15:52:59.937922 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:52:59.946939 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m15:52:59.948937 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_products
[0m15:52:59.949939 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:52:59.951008 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m15:52:59.956346 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m15:52:59.957360 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m15:52:59.963457 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m15:52:59.964475 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m15:52:59.959751 [info ] [Thread-2 (]: 25 of 64 START test unique_stg_customers_customer_id ........................... [RUN]
[0m15:52:59.966473 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m15:52:59.967550 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m15:52:59.975061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m15:52:59.977064 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m15:52:59.980065 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m15:52:59.979063 [info ] [Thread-3 (]: 22 of 64 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.22s]
[0m15:52:59.999403 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m15:53:00.001405 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m15:53:00.004098 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m15:53:00.010112 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m15:53:00.012118 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m15:53:00.014126 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m15:53:00.017114 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m15:53:00.019114 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m15:53:00.020115 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m15:53:00.026914 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m15:53:00.026914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:00.026914 [info ] [Thread-3 (]: 26 of 64 START test unique_stg_customers_email ................................. [RUN]
[0m15:53:00.026914 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m15:53:00.026914 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m15:53:00.026914 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:00.042037 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m15:53:00.040031 [info ] [Thread-1 (]: 23 of 64 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.20s]
[0m15:53:00.043036 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m15:53:00.045039 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m15:53:00.055236 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m15:53:00.057233 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m15:53:00.058231 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m15:53:00.059233 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:53:00.061230 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m15:53:00.063237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:00.066237 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:00.064239 [info ] [Thread-1 (]: 27 of 64 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m15:53:00.068238 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m15:53:00.069800 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m15:53:00.069800 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m15:53:00.072928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m15:53:00.080942 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m15:53:00.081937 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:00.083938 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m15:53:00.089100 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m15:53:00.106415 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m15:53:00.108086 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m15:53:00.108086 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m15:53:00.108086 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m15:53:00.108086 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m15:53:00.108086 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:53:00.108086 [info ] [Thread-4 (]: 24 of 64 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.19s]
[0m15:53:00.108086 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m15:53:00.124436 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m15:53:00.126437 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m15:53:00.128439 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m15:53:00.129443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:00.131435 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m15:53:00.140199 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m15:53:00.142288 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m15:53:00.145284 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m15:53:00.144286 [info ] [Thread-4 (]: 28 of 64 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m15:53:00.148292 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m15:53:00.147285 [info ] [Thread-2 (]: 25 of 64 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.17s]
[0m15:53:00.150305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m15:53:00.151303 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:00.153317 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m15:53:00.154306 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m15:53:00.155305 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m15:53:00.157484 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m15:53:00.158495 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:53:00.176023 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m15:53:00.177019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:00.178019 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m15:53:00.183520 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m15:53:00.183520 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:53:00.183520 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m15:53:00.179019 [info ] [Thread-2 (]: 29 of 64 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m15:53:00.190856 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m15:53:00.191849 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:00.192857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m15:53:00.194879 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m15:53:00.195869 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m15:53:00.196877 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:53:00.197948 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m15:53:00.207445 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:53:00.220769 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:53:00.206423 [info ] [Thread-3 (]: 26 of 64 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.18s]
[0m15:53:00.226792 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m15:53:00.229318 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m15:53:00.232316 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m15:53:00.234313 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m15:53:00.235551 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m15:53:00.235551 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m15:53:00.239417 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:53:00.242439 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m15:53:00.241430 [info ] [Thread-3 (]: 30 of 64 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m15:53:00.253473 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:53:00.254475 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:00.256917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m15:53:00.258911 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m15:53:00.274037 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m15:53:00.274875 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:53:00.278975 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m15:53:00.279990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:00.282992 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m15:53:00.293516 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m15:53:00.300521 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m15:53:00.301514 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m15:53:00.303520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:00.406546 [info ] [Thread-1 (]: 27 of 64 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.33s]
[0m15:53:00.408546 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m15:53:00.409545 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m15:53:00.410543 [info ] [Thread-1 (]: 31 of 64 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m15:53:00.412554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m15:53:00.413557 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m15:53:00.426393 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m15:53:00.431369 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m15:53:00.440269 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m15:53:00.440269 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m15:53:00.440269 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m15:53:00.440269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:00.682143 [debug] [Thread-2 (]: SQL status: OK in 0.408 seconds
[0m15:53:00.682143 [debug] [Thread-4 (]: SQL status: OK in 0.433 seconds
[0m15:53:00.689653 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:53:00.689653 [debug] [Thread-3 (]: SQL status: OK in 0.387 seconds
[0m15:53:00.689653 [debug] [Thread-1 (]: SQL status: OK in 0.243 seconds
[0m15:53:00.689653 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m15:53:00.689653 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:00.689653 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m15:53:00.689653 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m15:53:00.689653 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:00.689653 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:53:00.689653 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:00.698181 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:00.698181 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m15:53:00.698181 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:00.698181 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:53:00.698181 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m15:53:00.698181 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m15:53:00.698181 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m15:53:00.713830 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m15:53:00.698181 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m15:53:00.718299 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m15:53:00.721310 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m15:53:00.722385 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m15:53:00.722385 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m15:53:00.722385 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m15:53:00.722385 [info ] [Thread-2 (]: 29 of 64 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.53s]
[0m15:53:00.722385 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m15:53:00.722385 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m15:53:00.722385 [info ] [Thread-4 (]: 28 of 64 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.57s]
[0m15:53:00.733945 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:53:00.737119 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m15:53:00.735597 [info ] [Thread-3 (]: 30 of 64 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.48s]
[0m15:53:00.738229 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:53:00.739771 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:53:00.742089 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m15:53:00.742089 [info ] [Thread-2 (]: 32 of 64 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m15:53:00.742089 [info ] [Thread-1 (]: 31 of 64 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.33s]
[0m15:53:00.742089 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:53:00.742089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:53:00.742089 [info ] [Thread-4 (]: 33 of 64 START test not_null_stg_orders_order_id ............................... [RUN]
[0m15:53:00.742089 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m15:53:00.742089 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:53:00.742089 [info ] [Thread-3 (]: 34 of 64 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m15:53:00.756370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:53:00.757015 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:53:00.757015 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:53:00.757015 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m15:53:00.757015 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:53:00.757015 [info ] [Thread-1 (]: 35 of 64 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:53:00.757015 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:53:00.773878 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:53:00.773878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m15:53:00.788906 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:53:00.792256 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:53:00.794289 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:53:00.796360 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:53:00.807188 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:53:00.807188 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:53:00.828580 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:53:00.831649 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:53:00.831649 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:53:00.831649 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:53:00.840596 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:53:00.842602 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:53:00.843600 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:53:00.844595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:00.850623 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:53:00.851625 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:53:00.853609 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:53:00.855595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:00.857319 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m15:53:00.858322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:00.861318 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:53:00.863312 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m15:53:00.864313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:01.089633 [debug] [Thread-2 (]: SQL status: OK in 0.255 seconds
[0m15:53:01.089633 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:53:01.089633 [debug] [Thread-4 (]: SQL status: OK in 0.248 seconds
[0m15:53:01.105079 [debug] [Thread-1 (]: SQL status: OK in 0.241 seconds
[0m15:53:01.105079 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.105079 [debug] [Thread-3 (]: SQL status: OK in 0.248 seconds
[0m15:53:01.105079 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:53:01.105079 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:53:01.105079 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m15:53:01.105079 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.105079 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.105079 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.105079 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:53:01.105079 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:53:01.121644 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:53:01.123652 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m15:53:01.127650 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:53:01.128813 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:53:01.129820 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m15:53:01.130834 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:53:01.133837 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m15:53:01.138836 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m15:53:01.134841 [info ] [Thread-2 (]: 32 of 64 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.39s]
[0m15:53:01.140819 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:53:01.142840 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m15:53:01.143894 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:53:01.143894 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m15:53:01.143894 [debug] [Thread-2 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:53:01.149911 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m15:53:01.143894 [info ] [Thread-4 (]: 33 of 64 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.40s]
[0m15:53:01.149911 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m15:53:01.152096 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m15:53:01.150927 [info ] [Thread-2 (]: 36 of 64 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:53:01.153282 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:53:01.154301 [info ] [Thread-3 (]: 34 of 64 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.40s]
[0m15:53:01.156209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:53:01.157392 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:53:01.158393 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m15:53:01.159400 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:53:01.163996 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m15:53:01.160422 [info ] [Thread-4 (]: 37 of 64 START test unique_stg_orders_order_id ................................. [RUN]
[0m15:53:01.173427 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:53:01.173427 [info ] [Thread-1 (]: 35 of 64 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.40s]
[0m15:53:01.173427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m15:53:01.173427 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:53:01.173427 [info ] [Thread-3 (]: 38 of 64 START test not_null_stg_products_cost ................................. [RUN]
[0m15:53:01.187099 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:53:01.188121 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m15:53:01.190243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m15:53:01.190243 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:53:01.206179 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:53:01.206837 [info ] [Thread-1 (]: 39 of 64 START test not_null_stg_products_price ................................ [RUN]
[0m15:53:01.210119 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m15:53:01.213155 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:53:01.213155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m15:53:01.223833 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m15:53:01.223833 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m15:53:01.223833 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:53:01.247279 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m15:53:01.254713 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:53:01.257114 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:53:01.257114 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:53:01.257114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:01.257114 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m15:53:01.257114 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:53:01.257114 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m15:53:01.275139 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m15:53:01.275139 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:53:01.275139 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m15:53:01.275139 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:01.275139 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m15:53:01.289844 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m15:53:01.290893 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:01.292888 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m15:53:01.293888 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m15:53:01.294905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:01.498871 [debug] [Thread-4 (]: SQL status: OK in 0.222 seconds
[0m15:53:01.498871 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:53:01.498871 [debug] [Thread-2 (]: SQL status: OK in 0.247 seconds
[0m15:53:01.498871 [debug] [Thread-1 (]: SQL status: OK in 0.215 seconds
[0m15:53:01.498871 [debug] [Thread-3 (]: SQL status: OK in 0.219 seconds
[0m15:53:01.498871 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:01.498871 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:53:01.498871 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m15:53:01.498871 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m15:53:01.514507 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.514507 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.514507 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m15:53:01.514507 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:01.514507 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:53:01.514507 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:53:01.514507 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:01.514507 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m15:53:01.514507 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:53:01.530139 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m15:53:01.530139 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m15:53:01.530139 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:53:01.530139 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:53:01.530139 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m15:53:01.530139 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m15:53:01.530139 [info ] [Thread-4 (]: 37 of 64 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.36s]
[0m15:53:01.530139 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m15:53:01.530139 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m15:53:01.545771 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m15:53:01.546951 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m15:53:01.546951 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:53:01.546951 [info ] [Thread-1 (]: 39 of 64 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.33s]
[0m15:53:01.552057 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m15:53:01.554104 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m15:53:01.551046 [info ] [Thread-3 (]: 38 of 64 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.36s]
[0m15:53:01.556333 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:53:01.555481 [info ] [Thread-4 (]: 40 of 64 START test not_null_stg_products_product_id ........................... [RUN]
[0m15:53:01.558345 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m15:53:01.560611 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m15:53:01.559764 [info ] [Thread-1 (]: 41 of 64 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m15:53:01.563335 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m15:53:01.565329 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m15:53:01.565329 [info ] [Thread-2 (]: 36 of 64 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.41s]
[0m15:53:01.566389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m15:53:01.573412 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:53:01.566389 [info ] [Thread-3 (]: 42 of 64 START test unique_stg_products_product_id ............................. [RUN]
[0m15:53:01.573412 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:53:01.573412 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:53:01.573412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m15:53:01.588742 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_customers
[0m15:53:01.595481 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:53:01.596569 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m15:53:01.596569 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m15:53:01.596569 [info ] [Thread-2 (]: 43 of 64 START sql table model analytics.dim_customers ......................... [RUN]
[0m15:53:01.606857 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m15:53:01.618253 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:53:01.618253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.ci_cd_project.dim_customers)
[0m15:53:01.618253 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:53:01.623577 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.dim_customers
[0m15:53:01.740225 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:53:01.740225 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m15:53:01.740225 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:53:01.755847 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m15:53:01.755847 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m15:53:01.755847 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:01.755847 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:53:01.755847 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m15:53:01.755847 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.dim_customers
[0m15:53:01.755847 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m15:53:01.812606 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m15:53:01.813611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:01.991685 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m15:53:01.993706 [debug] [Thread-4 (]: SQL status: OK in 0.235 seconds
[0m15:53:01.995688 [debug] [Thread-1 (]: SQL status: OK in 0.182 seconds
[0m15:53:01.996684 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m15:53:01.997678 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:53:01.998679 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:53:01.999678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:02.000684 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.001679 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:02.002678 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:53:02.003758 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m15:53:02.003758 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:02.003758 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.003758 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m15:53:02.003758 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:02.003758 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:53:02.003758 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:53:02.003758 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.003758 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers as c
left join customer_metrics as cm on c.customer_id = cm.customer_id
    );
  
  
[0m15:53:02.019393 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:53:02.019393 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m15:53:02.019393 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:53:02.019393 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m15:53:02.019393 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m15:53:02.019393 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m15:53:02.035018 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m15:53:02.019393 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m15:53:02.035018 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m15:53:02.035018 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m15:53:02.035018 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m15:53:02.035018 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m15:53:02.035018 [info ] [Thread-4 (]: 40 of 64 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.47s]
[0m15:53:02.035018 [info ] [Thread-1 (]: 41 of 64 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.47s]
[0m15:53:02.052924 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.057033 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m15:53:02.054749 [info ] [Thread-3 (]: 42 of 64 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.48s]
[0m15:53:02.057591 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:53:02.057591 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "dev"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m15:53:02.057591 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m15:53:02.057591 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_products
[0m15:53:02.057591 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m15:53:02.057591 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:02.057591 [info ] [Thread-4 (]: 44 of 64 START sql table model analytics.dim_products .......................... [RUN]
[0m15:53:02.057591 [info ] [Thread-1 (]: 45 of 64 START sql table model analytics.fct_orders ............................ [RUN]
[0m15:53:02.075224 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.076237 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now model.ci_cd_project.dim_products)
[0m15:53:02.077233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now model.ci_cd_project.fct_orders)
[0m15:53:02.078240 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m15:53:02.078240 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_products
[0m15:53:02.079237 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.fct_orders
[0m15:53:02.088587 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m15:53:02.100112 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m15:53:02.101109 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m15:53:02.105114 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m15:53:02.106112 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.107122 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m15:53:02.111107 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_products
[0m15:53:02.112112 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.fct_orders
[0m15:53:02.114159 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m15:53:02.122874 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m15:53:02.126895 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m15:53:02.134893 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m15:53:02.136899 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m15:53:02.139845 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.141865 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.142860 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:53:02.143859 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: BEGIN
[0m15:53:02.144859 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m15:53:02.147862 [debug] [Thread-2 (]: On model.ci_cd_project.dim_customers: Close
[0m15:53:02.148857 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:02.149879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:02.208054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FBB7C50>]}
[0m15:53:02.209641 [info ] [Thread-2 (]: 43 of 64 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.59s]
[0m15:53:02.211241 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_customers
[0m15:53:02.212856 [debug] [Thread-3 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:53:02.213970 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:53:02.215038 [info ] [Thread-3 (]: 46 of 64 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m15:53:02.217365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m15:53:02.216137 [info ] [Thread-2 (]: 47 of 64 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m15:53:02.219676 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:53:02.220748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:53:02.231998 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:53:02.233304 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:53:02.244886 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:53:02.249480 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:53:02.249995 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:53:02.258264 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:53:02.258264 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:53:02.273603 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:53:02.472350 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m15:53:02.482172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.483750 [debug] [Thread-4 (]: SQL status: OK in 0.335 seconds
[0m15:53:02.484278 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.484810 [debug] [Thread-1 (]: SQL status: OK in 0.335 seconds
[0m15:53:02.485890 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products as p
left join product_metrics as pm on p.product_id = pm.product_id
    );
  
  
[0m15:53:02.487119 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:53:02.488233 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.489407 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:53:02.491522 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:53:02.492684 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items as oi
    inner join orders as o on oi.order_id = o.order_id
    inner join products as p on oi.product_id = p.product_id
    inner join customers as c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m15:53:02.493807 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m15:53:02.494874 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:02.496480 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:02.498610 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:02.499720 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m15:53:02.500794 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:02.502024 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m15:53:02.505912 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m15:53:02.508089 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m15:53:02.510226 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m15:53:02.517464 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m15:53:02.521094 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.522198 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m15:53:02.522728 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m15:53:02.523806 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table "dev"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m15:53:02.527134 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m15:53:02.537025 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.527692 [info ] [Thread-2 (]: 47 of 64 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.31s]
[0m15:53:02.539507 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "dev"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m15:53:02.541100 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m15:53:02.542746 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:53:02.542746 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:02.542746 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m15:53:02.542746 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:53:02.542746 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:02.556042 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.557399 [info ] [Thread-3 (]: 46 of 64 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.34s]
[0m15:53:02.564374 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.559286 [info ] [Thread-2 (]: 48 of 64 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m15:53:02.564374 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m15:53:02.564374 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m15:53:02.564374 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m15:53:02.572741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m15:53:02.574756 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:53:02.575766 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:53:02.577472 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:53:02.579701 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:02.578673 [info ] [Thread-3 (]: 49 of 64 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m15:53:02.582761 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m15:53:02.596862 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:53:02.600956 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m15:53:02.602109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m15:53:02.603176 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.604292 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.605473 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:53:02.607060 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m15:53:02.608279 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m15:53:02.622813 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:53:02.624431 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:53:02.630708 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:53:02.636483 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m15:53:02.637503 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:53:02.643491 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m15:53:02.651008 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m15:53:02.652007 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:53:02.653021 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m15:53:02.654010 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m15:53:02.655027 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:53:02.663537 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:53:02.665536 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m15:53:02.667538 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.668540 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:02.670082 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:53:02.673157 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: Close
[0m15:53:02.673157 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:53:02.678617 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: Close
[0m15:53:02.679183 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:53:02.680911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC5BE30>]}
[0m15:53:02.681486 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m15:53:02.682586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2238918-a784-4a34-a0bb-1d431ae36245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8FC88770>]}
[0m15:53:02.683886 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m15:53:02.686342 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m15:53:02.686342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:02.690375 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:53:02.691006 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:02.691006 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m15:53:02.691006 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:53:02.691006 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m15:53:02.691006 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m15:53:02.691006 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:53:02.691006 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m15:53:02.705700 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m15:53:02.705193 [info ] [Thread-2 (]: 48 of 64 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.14s]
[0m15:53:02.705700 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m15:53:02.705700 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m15:53:02.705700 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:53:02.705700 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m15:53:02.705700 [info ] [Thread-2 (]: 50 of 64 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m15:53:02.705700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m15:53:02.715669 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:53:02.724443 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:53:02.724443 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:53:02.736955 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:53:02.743750 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:53:02.744738 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m15:53:02.745733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:02.797479 [info ] [Thread-3 (]: 49 of 64 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.20s]
[0m15:53:02.799489 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m15:53:02.800487 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:53:02.800487 [info ] [Thread-3 (]: 51 of 64 START test unique_dim_customers_customer_id ........................... [RUN]
[0m15:53:02.802491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m15:53:02.802491 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:53:02.811127 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:53:02.815616 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:53:02.828284 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:53:02.828284 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:53:02.828284 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m15:53:02.828284 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:03.019973 [debug] [Thread-2 (]: SQL status: OK in 0.274 seconds
[0m15:53:03.019973 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m15:53:03.019973 [debug] [Thread-3 (]: SQL status: OK in 0.185 seconds
[0m15:53:03.019973 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m15:53:03.019973 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:53:03.019973 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:03.019973 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:53:03.019973 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m15:53:03.019973 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:53:03.019973 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m15:53:03.035630 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m15:53:03.035630 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m15:53:03.035630 [info ] [Thread-2 (]: 50 of 64 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.33s]
[0m15:53:03.035630 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m15:53:03.035630 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m15:53:03.035630 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m15:53:03.052400 [info ] [Thread-3 (]: 51 of 64 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.25s]
[0m15:53:03.054070 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:53:04.245405 [info ] [Thread-1 (]: 45 of 64 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.60s]
[0m15:53:04.245405 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m15:53:04.245405 [info ] [Thread-4 (]: 44 of 64 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.61s]
[0m15:53:04.245405 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_products
[0m15:53:04.245405 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:53:04.245405 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:53:04.245405 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:53:04.245405 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:53:04.245405 [info ] [Thread-2 (]: 52 of 64 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m15:53:04.245405 [info ] [Thread-3 (]: 53 of 64 START test not_null_fct_orders_order_id ............................... [RUN]
[0m15:53:04.259419 [info ] [Thread-4 (]: 54 of 64 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m15:53:04.261060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m15:53:04.260049 [info ] [Thread-1 (]: 55 of 64 START test not_null_fct_orders_product_id ............................. [RUN]
[0m15:53:04.263062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m15:53:04.264059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m15:53:04.265059 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:53:04.266062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m15:53:04.267066 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:53:04.268059 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:53:04.275063 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:53:04.281067 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:53:04.292217 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:53:04.292217 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:53:04.309470 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:53:04.309470 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:53:04.323326 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:53:04.323326 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:53:04.323326 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:53:04.322504 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:53:04.341842 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:53:04.351999 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:53:04.359001 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:53:04.361003 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:53:04.361998 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m15:53:04.364014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:04.366005 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:53:04.368009 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m15:53:04.368998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:04.370002 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:53:04.372006 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:53:04.372996 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m15:53:04.373995 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m15:53:04.374995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:04.376001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:04.714067 [debug] [Thread-1 (]: SQL status: OK in 0.345 seconds
[0m15:53:04.715077 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m15:53:04.716077 [debug] [Thread-4 (]: SQL status: OK in 0.342 seconds
[0m15:53:04.717077 [debug] [Thread-2 (]: SQL status: OK in 0.354 seconds
[0m15:53:04.718081 [debug] [Thread-3 (]: SQL status: OK in 0.342 seconds
[0m15:53:04.719074 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:04.720079 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m15:53:04.720079 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:53:04.721082 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m15:53:04.722170 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:04.722170 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:04.722170 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:04.722170 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:04.722170 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m15:53:04.722170 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:53:04.722170 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:04.722170 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m15:53:04.722170 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m15:53:04.737683 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m15:53:04.744236 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m15:53:04.745249 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m15:53:04.745249 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m15:53:04.745249 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m15:53:04.753769 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m15:53:04.753769 [info ] [Thread-1 (]: 55 of 64 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.49s]
[0m15:53:04.753769 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m15:53:04.753769 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m15:53:04.753769 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m15:53:04.753769 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m15:53:04.753769 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m15:53:04.753769 [info ] [Thread-2 (]: 52 of 64 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.49s]
[0m15:53:04.765759 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:53:04.753769 [info ] [Thread-3 (]: 53 of 64 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.49s]
[0m15:53:04.767772 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m15:53:04.770654 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m15:53:04.773060 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:53:04.768775 [info ] [Thread-1 (]: 56 of 64 START test not_null_fct_orders_quantity ............................... [RUN]
[0m15:53:04.775120 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:53:04.778132 [info ] [Thread-4 (]: 54 of 64 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.51s]
[0m15:53:04.781132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m15:53:04.784130 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m15:53:04.785129 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:53:04.786129 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m15:53:04.798662 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:53:04.779129 [info ] [Thread-2 (]: 57 of 64 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m15:53:04.802663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m15:53:04.782129 [info ] [Thread-3 (]: 58 of 64 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m15:53:04.803662 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:53:04.805663 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m15:53:04.800661 [info ] [Thread-4 (]: 59 of 64 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m15:53:04.817664 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:53:04.821691 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:53:04.822704 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:53:04.824701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m15:53:04.831704 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:53:04.844706 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:53:04.846707 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m15:53:04.863082 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m15:53:04.864597 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:53:04.874627 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:53:04.876620 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:53:04.878622 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m15:53:04.879625 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:53:04.880632 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m15:53:04.891144 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m15:53:04.899676 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:53:04.901681 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:53:04.902675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:04.904681 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m15:53:04.906682 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:04.909691 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:53:04.911703 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m15:53:04.912680 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m15:53:04.913686 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m15:53:04.915685 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:04.916678 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:05.242541 [debug] [Thread-2 (]: SQL status: OK in 0.336 seconds
[0m15:53:05.243749 [debug] [Thread-1 (]: SQL status: OK in 0.341 seconds
[0m15:53:05.244535 [debug] [Thread-3 (]: SQL status: OK in 0.329 seconds
[0m15:53:05.245773 [debug] [Thread-4 (]: SQL status: OK in 0.329 seconds
[0m15:53:05.246819 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m15:53:05.248119 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m15:53:05.249435 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m15:53:05.250631 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m15:53:05.251720 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.252800 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.254199 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:05.255588 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m15:53:05.260648 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:05.262356 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:53:05.264002 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:53:05.265616 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:53:05.270543 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m15:53:05.275132 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m15:53:05.279994 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m15:53:05.283886 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m15:53:05.287064 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m15:53:05.289217 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m15:53:05.292015 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m15:53:05.293031 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m15:53:05.295550 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m15:53:05.296549 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m15:53:05.297549 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m15:53:05.300550 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m15:53:05.299551 [info ] [Thread-1 (]: 56 of 64 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.52s]
[0m15:53:05.302617 [info ] [Thread-2 (]: 57 of 64 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.50s]
[0m15:53:05.305917 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m15:53:05.303778 [info ] [Thread-3 (]: 58 of 64 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.50s]
[0m15:53:05.307771 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m15:53:05.308871 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m15:53:05.310797 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m15:53:05.312344 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m15:53:05.313353 [info ] [Thread-1 (]: 60 of 64 START test not_null_dim_products_performance_category ................. [RUN]
[0m15:53:05.316354 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m15:53:05.315355 [info ] [Thread-4 (]: 59 of 64 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.49s]
[0m15:53:05.319356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_quantity.f754434156, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m15:53:05.317360 [info ] [Thread-2 (]: 61 of 64 START test not_null_dim_products_product_id ........................... [RUN]
[0m15:53:05.324081 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m15:53:05.325079 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m15:53:05.326077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m15:53:05.328075 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m15:53:05.321172 [info ] [Thread-3 (]: 62 of 64 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m15:53:05.345286 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m15:53:05.347287 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m15:53:05.350298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m15:53:05.363893 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:53:05.348849 [info ] [Thread-4 (]: 63 of 64 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m15:53:05.366344 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m15:53:05.367874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m15:53:05.382023 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m15:53:05.384735 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m15:53:05.386361 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m15:53:05.387427 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m15:53:05.395920 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m15:53:05.408771 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m15:53:05.420797 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:53:05.423443 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m15:53:05.433614 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m15:53:05.437153 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m15:53:05.439157 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m15:53:05.440678 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:53:05.441687 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m15:53:05.442687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:05.443684 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m15:53:05.445692 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m15:53:05.454846 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m15:53:05.456744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:05.457766 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m15:53:05.459501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:05.464809 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m15:53:05.466644 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m15:53:05.467595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:53:05.819027 [debug] [Thread-2 (]: SQL status: OK in 0.362 seconds
[0m15:53:05.820032 [debug] [Thread-3 (]: SQL status: OK in 0.361 seconds
[0m15:53:05.821026 [debug] [Thread-1 (]: SQL status: OK in 0.379 seconds
[0m15:53:05.823030 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:53:05.824029 [debug] [Thread-4 (]: SQL status: OK in 0.356 seconds
[0m15:53:05.825026 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m15:53:05.826030 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m15:53:05.827029 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.828026 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m15:53:05.829026 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.830028 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.832027 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:53:05.834027 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:53:05.835027 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:53:05.836027 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:53:05.837026 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:53:05.841026 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m15:53:05.845028 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m15:53:05.849028 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m15:53:05.852031 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m15:53:05.855034 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m15:53:05.858030 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m15:53:05.861037 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m15:53:05.862035 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m15:53:05.865027 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m15:53:05.866034 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m15:53:05.867029 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m15:53:05.869029 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m15:53:05.868030 [info ] [Thread-1 (]: 60 of 64 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.55s]
[0m15:53:05.871028 [info ] [Thread-2 (]: 61 of 64 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.54s]
[0m15:53:05.874171 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m15:53:05.875181 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m15:53:05.872030 [info ] [Thread-3 (]: 62 of 64 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.52s]
[0m15:53:05.877631 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m15:53:05.879645 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m15:53:05.880645 [info ] [Thread-1 (]: 64 of 64 START test unique_dim_products_product_id ............................. [RUN]
[0m15:53:05.882645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m15:53:05.885650 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m15:53:05.897703 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:53:05.884645 [info ] [Thread-4 (]: 63 of 64 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.52s]
[0m15:53:05.899842 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m15:53:05.904857 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m15:53:05.913860 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:53:05.919863 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:53:05.921853 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m15:53:05.922860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:06.222001 [debug] [Thread-1 (]: SQL status: OK in 0.298 seconds
[0m15:53:06.223214 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:53:06.224235 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:53:06.229534 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:53:06.233439 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m15:53:06.235437 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m15:53:06.236434 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m15:53:06.247028 [info ] [Thread-1 (]: 64 of 64 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.36s]
[0m15:53:06.248011 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m15:53:06.251012 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:06.252015 [debug] [MainThread]: On master: BEGIN
[0m15:53:06.253009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:06.494714 [debug] [MainThread]: SQL status: OK in 0.248 seconds
[0m15:53:06.494714 [debug] [MainThread]: On master: COMMIT
[0m15:53:06.494714 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:06.494714 [debug] [MainThread]: On master: COMMIT
[0m15:53:06.505254 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:53:06.505254 [debug] [MainThread]: On master: Close
[0m15:53:06.505254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'create_dev_raw' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'list_dev_raw' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71' was properly closed.
[0m15:53:06.505254 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a' was properly closed.
[0m15:53:06.520898 [info ] [MainThread]: 
[0m15:53:06.522470 [info ] [MainThread]: Finished running 15 seeds, 5 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 13.14 seconds (13.14s).
[0m15:53:06.534550 [debug] [MainThread]: Command end result
[0m15:53:06.704202 [info ] [MainThread]: 
[0m15:53:06.704202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:06.704202 [info ] [MainThread]: 
[0m15:53:06.704202 [info ] [MainThread]: Done. PASS=64 WARN=0 ERROR=0 SKIP=0 TOTAL=64
[0m15:53:06.704202 [debug] [MainThread]: Command `dbt build` succeeded at 15:53:06.704202 after 21.36 seconds
[0m15:53:06.704202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E798920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E798140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E798800>]}
[0m15:53:06.704202 [debug] [MainThread]: Flushing usage events
[0m16:33:45.973798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB28B64E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB3F36300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB410FDD0>]}


============================== 16:33:45.984489 | b9a1444c-e4d1-4979-8edf-e342db93d31a ==============================
[0m16:33:45.984489 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:33:45.985486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target prod', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:46.370900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB4303DD0>]}
[0m16:33:46.432955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB4301BB0>]}
[0m16:33:46.437375 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:33:47.210246 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m16:33:47.442282 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:33:47.443283 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m16:33:47.444281 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:33:47.445282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB35BBE30>]}
[0m16:33:52.042105 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:33:52.044091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5421D00>]}
[0m16:33:52.738868 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m16:33:52.739954 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m16:33:52.740488 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m16:33:52.741033 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m16:33:52.742120 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m16:33:52.742706 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m16:33:52.743766 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m16:33:52.744314 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m16:33:52.744314 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m16:33:52.745330 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m16:33:52.746324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m16:33:52.746324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m16:33:52.747322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m16:33:52.748323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m16:33:52.749324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m16:33:52.750327 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m16:33:52.751323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m16:33:52.751323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m16:33:52.752322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m16:33:52.752322 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m16:33:52.753869 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m16:33:52.754376 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m16:33:52.754376 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m16:33:52.754909 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m16:33:52.755443 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m16:33:52.755980 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m16:33:52.755980 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m16:33:52.756514 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m16:33:52.975004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5C773E0>]}
[0m16:33:53.303223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5C00440>]}
[0m16:33:53.303223 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 858 macros
[0m16:33:53.312277 [info ] [MainThread]: 
[0m16:33:53.313280 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:33:53.323276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m16:33:53.329286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m16:33:53.909892 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m16:33:53.910892 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m16:33:53.911892 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m16:33:53.911892 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m16:33:53.912892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:53.913890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:55.196957 [debug] [ThreadPool]: SQL status: OK in 1.283 seconds
[0m16:33:55.198024 [debug] [ThreadPool]: SQL status: OK in 1.285 seconds
[0m16:33:55.201387 [debug] [ThreadPool]: On list_prod: Close
[0m16:33:55.203384 [debug] [ThreadPool]: On list_prod: Close
[0m16:33:55.213801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m16:33:55.221962 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m16:33:55.222624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_raw'
[0m16:33:55.223653 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m16:33:55.226333 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m16:33:55.227409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:55.227409 [debug] [ThreadPool]: On list_prod_raw: BEGIN
[0m16:33:55.228557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:55.581868 [debug] [ThreadPool]: SQL status: OK in 0.354 seconds
[0m16:33:55.582377 [debug] [ThreadPool]: SQL status: OK in 0.354 seconds
[0m16:33:55.583439 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m16:33:55.583970 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m16:33:55.584503 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m16:33:55.585564 [debug] [ThreadPool]: On list_prod_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_raw"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'prod'
  
[0m16:33:55.692746 [debug] [ThreadPool]: SQL status: OK in 0.106 seconds
[0m16:33:55.693742 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m16:33:55.697815 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m16:33:55.700424 [debug] [ThreadPool]: On list_prod_raw: ROLLBACK
[0m16:33:55.703426 [debug] [ThreadPool]: Failed to rollback 'list_prod_raw'
[0m16:33:55.704423 [debug] [ThreadPool]: On list_prod_raw: Close
[0m16:33:55.710937 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m16:33:55.710937 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m16:33:55.726937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB621D400>]}
[0m16:33:55.727938 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:55.728936 [debug] [MainThread]: On master: BEGIN
[0m16:33:55.729940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:56.134310 [debug] [MainThread]: SQL status: OK in 0.404 seconds
[0m16:33:56.135312 [debug] [MainThread]: On master: COMMIT
[0m16:33:56.136312 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:56.136312 [debug] [MainThread]: On master: COMMIT
[0m16:33:56.137311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:33:56.138318 [debug] [MainThread]: On master: Close
[0m16:33:56.144313 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m16:33:56.145312 [info ] [MainThread]: 
[0m16:33:56.159314 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m16:33:56.160310 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m16:33:56.161310 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m16:33:56.162310 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m16:33:56.161310 [info ] [Thread-1 (]: 1 of 64 START seed file raw.categories ......................................... [RUN]
[0m16:33:56.163310 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.order_details
[0m16:33:56.165311 [debug] [Thread-6 (]: Began running node seed.ci_cd_project.orders
[0m16:33:56.166312 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.products
[0m16:33:56.169314 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:33:56.164311 [info ] [Thread-2 (]: 2 of 64 START seed file raw.customers .......................................... [RUN]
[0m16:33:56.168315 [info ] [Thread-3 (]: 3 of 64 START seed file raw.employee_territories ............................... [RUN]
[0m16:33:56.171316 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ci_cd_project.categories'
[0m16:33:56.170311 [info ] [Thread-4 (]: 4 of 64 START seed file raw.employees .......................................... [RUN]
[0m16:33:56.172312 [info ] [Thread-5 (]: 5 of 64 START seed file raw.order_details ...................................... [RUN]
[0m16:33:56.173312 [info ] [Thread-6 (]: 6 of 64 START seed file raw.orders ............................................. [RUN]
[0m16:33:56.174312 [info ] [Thread-7 (]: 7 of 64 START seed file raw.products ........................................... [RUN]
[0m16:33:56.177312 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.customers'
[0m16:33:56.175315 [info ] [Thread-8 (]: 8 of 64 START seed file raw.raw_customers ...................................... [RUN]
[0m16:33:56.178312 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m16:33:56.179313 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m16:33:56.180312 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m16:33:56.181311 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.ci_cd_project.order_details'
[0m16:33:56.183312 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.ci_cd_project.orders'
[0m16:33:56.184322 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.ci_cd_project.products'
[0m16:33:56.184322 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m16:33:56.186324 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_customers'
[0m16:33:56.186324 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m16:33:56.187323 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m16:33:56.188325 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m16:33:56.189323 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.order_details
[0m16:33:56.190322 [debug] [Thread-6 (]: Began compiling node seed.ci_cd_project.orders
[0m16:33:56.191324 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.products
[0m16:33:56.192324 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m16:33:56.193324 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:33:56.194323 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m16:33:56.244382 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m16:33:56.246384 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.order_details
[0m16:33:56.249085 [debug] [Thread-6 (]: Began executing node seed.ci_cd_project.orders
[0m16:33:56.250081 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.products
[0m16:33:56.261081 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:33:56.307996 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:33:56.310006 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:33:56.343521 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:33:56.353229 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:33:56.359228 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m16:33:56.381630 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m16:33:56.447530 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m16:33:56.453530 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:33:56.479858 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m16:33:56.500144 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:33:56.510650 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:33:56.516911 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:33:56.517908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:56.519910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:33:56.526910 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:33:56.527909 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: BEGIN
[0m16:33:56.527909 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:33:56.528910 [debug] [Thread-7 (]: On seed.ci_cd_project.products: BEGIN
[0m16:33:56.529914 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: BEGIN
[0m16:33:56.531733 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:33:56.531733 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m16:33:56.533706 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m16:33:56.533706 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:33:56.534716 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m16:33:56.804539 [debug] [Thread-4 (]: SQL status: OK in 0.276 seconds
[0m16:33:56.805542 [debug] [Thread-2 (]: SQL status: OK in 0.295 seconds
[0m16:33:56.806543 [debug] [Thread-1 (]: SQL status: OK in 0.289 seconds
[0m16:33:56.806543 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:33:56.807539 [debug] [Thread-3 (]: SQL status: OK in 0.287 seconds
[0m16:33:56.808550 [debug] [Thread-5 (]: SQL status: OK in 0.274 seconds
[0m16:33:56.808550 [debug] [Thread-6 (]: SQL status: OK in 0.277 seconds
[0m16:33:56.810058 [debug] [Thread-8 (]: SQL status: OK in 0.275 seconds
[0m16:33:56.811068 [debug] [Thread-7 (]: SQL status: OK in 0.278 seconds
[0m16:33:56.811068 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:33:56.812074 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:33:56.813074 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employees"} */
truncate table "prod"."raw"."employees"
[0m16:33:56.814069 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:33:56.815068 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:33:56.816068 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:33:56.817067 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:33:56.818066 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:33:56.819066 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.customers"} */
truncate table "prod"."raw"."customers"
[0m16:33:56.820066 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.categories"} */
truncate table "prod"."raw"."categories"
[0m16:33:56.821070 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employee_territories"} */
truncate table "prod"."raw"."employee_territories"
[0m16:33:56.822069 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.order_details"} */
truncate table "prod"."raw"."order_details"
[0m16:33:56.823066 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.orders"} */
truncate table "prod"."raw"."orders"
[0m16:33:56.824068 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "prod"."raw"."raw_customers"
[0m16:33:56.825073 [debug] [Thread-7 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.products"} */
truncate table "prod"."raw"."products"
[0m16:33:56.826067 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:33:56.827069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:33:56.828072 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:33:56.830070 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:33:56.831191 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m16:33:56.831548 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m16:33:56.854217 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:33:56.854217 [debug] [Thread-3 (]: SQL status: OK in 0.028 seconds
[0m16:33:56.855217 [debug] [Thread-7 (]: SQL status: OK in 0.023 seconds
[0m16:33:56.857219 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:33:56.859218 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:33:56.861239 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:33:56.863224 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:33:56.864729 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:33:56.865765 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY prod.raw.employees FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.866768 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:33:56.868767 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:33:56.868767 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY prod.raw.categories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.869766 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY prod.raw.customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.870755 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: 
          COPY prod.raw.order_details FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.870755 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: 
          COPY prod.raw.raw_customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.871753 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: 
          COPY prod.raw.orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.872749 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY prod.raw.employee_territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.872749 [debug] [Thread-7 (]: On seed.ci_cd_project.products: 
          COPY prod.raw.products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:56.908268 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m16:33:56.909257 [debug] [Thread-7 (]: SQL status: OK in 0.034 seconds
[0m16:33:56.924045 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m16:33:56.923042 [debug] [Thread-3 (]: SQL status: OK in 0.048 seconds
[0m16:33:56.922044 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m16:33:56.925043 [debug] [Thread-4 (]: SQL status: OK in 0.053 seconds
[0m16:33:56.926042 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m16:33:56.946586 [debug] [Thread-5 (]: SQL status: OK in 0.072 seconds
[0m16:33:56.967525 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m16:33:56.972524 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m16:33:56.973528 [debug] [Thread-8 (]: SQL status: OK in 0.099 seconds
[0m16:33:56.975530 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.employees"
[0m16:33:56.977529 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m16:33:56.978527 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m16:33:56.979527 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:33:56.982884 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m16:33:56.984879 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:33:56.986879 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m16:33:56.987884 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:33:56.990878 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m16:33:56.992878 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m16:33:56.995890 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m16:33:56.997735 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:33:57.000418 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m16:33:57.001413 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:33:57.004419 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:33:57.005412 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m16:33:57.008415 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m16:33:57.009413 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:33:57.010413 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:33:57.010919 [debug] [Thread-7 (]: SQL status: OK in 0.019 seconds
[0m16:33:57.011930 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m16:33:57.012930 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:33:57.014394 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:33:57.023858 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m16:33:57.014852 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m16:33:57.019855 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:33:57.021858 [debug] [Thread-7 (]: On seed.ci_cd_project.products: Close
[0m16:33:57.022856 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:33:57.018855 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m16:33:57.027864 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m16:33:57.028863 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:33:57.032540 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7062840>]}
[0m16:33:57.033535 [debug] [Thread-5 (]: SQL status: OK in 0.009 seconds
[0m16:33:57.040534 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: Close
[0m16:33:57.035539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB55350A0>]}
[0m16:33:57.036536 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m16:33:57.037536 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m16:33:57.034535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB0A84DD0>]}
[0m16:33:57.040534 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m16:33:57.042052 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB701B710>]}
[0m16:33:57.039535 [info ] [Thread-7 (]: 7 of 64 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 0.85s]
[0m16:33:57.045065 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m16:33:57.046064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB577E780>]}
[0m16:33:57.049170 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:33:57.051170 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.products
[0m16:33:57.052175 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB54C8D40>]}
[0m16:33:57.054172 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7031100>]}
[0m16:33:57.055171 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:33:57.043066 [info ] [Thread-3 (]: 3 of 64 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 0.86s]
[0m16:33:57.059170 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m16:33:57.060170 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:33:57.047064 [info ] [Thread-1 (]: 1 of 64 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 0.86s]
[0m16:33:57.063170 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m16:33:57.050170 [info ] [Thread-5 (]: 5 of 64 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 0.86s]
[0m16:33:57.065174 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_products
[0m16:33:57.053178 [info ] [Thread-2 (]: 2 of 64 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 0.87s]
[0m16:33:57.067171 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.order_details
[0m16:33:57.057170 [info ] [Thread-4 (]: 4 of 64 OK loaded seed file raw.employees ...................................... [[32mINSERT 8[0m in 0.87s]
[0m16:33:57.057170 [info ] [Thread-8 (]: 8 of 64 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 0.87s]
[0m16:33:57.070170 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m16:33:57.058170 [info ] [Thread-7 (]: 9 of 64 START seed file raw.raw_order_items .................................... [RUN]
[0m16:33:57.071171 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.regions
[0m16:33:57.062173 [info ] [Thread-3 (]: 10 of 64 START seed file raw.raw_orders ........................................ [RUN]
[0m16:33:57.072170 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m16:33:57.074172 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:33:57.075170 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.shippers
[0m16:33:57.068170 [info ] [Thread-1 (]: 11 of 64 START seed file raw.raw_products ...................................... [RUN]
[0m16:33:57.076172 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.raw_order_items)
[0m16:33:57.078170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.raw_orders)
[0m16:33:57.077169 [info ] [Thread-5 (]: 12 of 64 START seed file raw.regions ........................................... [RUN]
[0m16:33:57.079169 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.suppliers
[0m16:33:57.080171 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.territories
[0m16:33:57.082170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.raw_products)
[0m16:33:57.083171 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:33:57.081172 [info ] [Thread-2 (]: 13 of 64 START seed file raw.shippers .......................................... [RUN]
[0m16:33:57.084169 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:33:57.085170 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.regions)
[0m16:33:57.088246 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:33:57.086235 [info ] [Thread-4 (]: 14 of 64 START seed file raw.suppliers ......................................... [RUN]
[0m16:33:57.089248 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:33:57.090250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.shippers)
[0m16:33:57.091246 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:33:57.092246 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.regions
[0m16:33:57.093246 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:33:57.094246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.suppliers)
[0m16:33:57.101265 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.shippers
[0m16:33:57.108269 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.regions
[0m16:33:57.087248 [info ] [Thread-8 (]: 15 of 64 START seed file raw.territories ....................................... [RUN]
[0m16:33:57.117783 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.suppliers
[0m16:33:57.122783 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.shippers
[0m16:33:57.135784 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:33:57.142783 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:33:57.151786 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.territories)
[0m16:33:57.157783 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.suppliers
[0m16:33:57.163782 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:33:57.170784 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:33:57.177784 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:33:57.178783 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:33:57.179782 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.territories
[0m16:33:57.190794 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:33:57.192794 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:33:57.195793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:33:57.196793 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: BEGIN
[0m16:33:57.197792 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:33:57.197792 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.territories
[0m16:33:57.200793 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: BEGIN
[0m16:33:57.206311 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:33:57.207309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:57.209310 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:33:57.210310 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:33:57.210820 [debug] [Thread-7 (]: SQL status: OK in 0.014 seconds
[0m16:33:57.218833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:33:57.220834 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m16:33:57.222833 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:33:57.223835 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m16:33:57.224834 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:33:57.227833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:33:57.232833 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:33:57.233836 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "prod"."raw"."raw_orders"
[0m16:33:57.234834 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m16:33:57.235833 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:33:57.236832 [debug] [Thread-5 (]: SQL status: OK in 0.028 seconds
[0m16:33:57.237833 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "prod"."raw"."raw_order_items"
[0m16:33:57.238834 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: BEGIN
[0m16:33:57.239833 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:33:57.240833 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:33:57.241833 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "prod"."raw"."raw_products"
[0m16:33:57.242832 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:33:57.242832 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:33:57.244833 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:33:57.245833 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:33:57.245833 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m16:33:57.246833 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.shippers"} */
truncate table "prod"."raw"."shippers"
[0m16:33:57.249836 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:33:57.250832 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.regions"} */
truncate table "prod"."raw"."regions"
[0m16:33:57.251833 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:33:57.252833 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.suppliers"} */
truncate table "prod"."raw"."suppliers"
[0m16:33:57.255834 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:33:57.255834 [debug] [Thread-8 (]: SQL status: OK in 0.012 seconds
[0m16:33:57.257833 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY prod.raw.raw_orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.258833 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:33:57.260833 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:33:57.261833 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m16:33:57.262835 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: 
          COPY prod.raw.raw_order_items FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.263833 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:33:57.264839 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:33:57.267835 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:33:57.268833 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: 
          COPY prod.raw.raw_products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.271833 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:33:57.274835 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.territories"} */
truncate table "prod"."raw"."territories"
[0m16:33:57.277834 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:33:57.278836 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: 
          COPY prod.raw.shippers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.279835 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: 
          COPY prod.raw.regions FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.281834 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m16:33:57.282834 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: 
          COPY prod.raw.suppliers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.283834 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m16:33:57.285833 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:33:57.287837 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:33:57.289833 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: 
          COPY prod.raw.territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:33:57.290834 [debug] [Thread-7 (]: SQL status: OK in 0.018 seconds
[0m16:33:57.292834 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:33:57.297843 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:33:57.298843 [debug] [Thread-5 (]: SQL status: OK in 0.014 seconds
[0m16:33:57.300849 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m16:33:57.302855 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m16:33:57.305843 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:33:57.313882 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:33:57.315883 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m16:33:57.316883 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m16:33:57.317888 [debug] [Thread-4 (]: SQL status: OK in 0.032 seconds
[0m16:33:57.319882 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:33:57.320882 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:33:57.323880 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:33:57.324883 [debug] [Thread-8 (]: SQL status: OK in 0.035 seconds
[0m16:33:57.328888 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m16:33:57.331882 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: COMMIT
[0m16:33:57.333881 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:33:57.337881 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m16:33:57.339882 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m16:33:57.341882 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:33:57.345880 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:33:57.347881 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:33:57.348882 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m16:33:57.349883 [debug] [Thread-7 (]: SQL status: OK in 0.007 seconds
[0m16:33:57.352881 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m16:33:57.353881 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: COMMIT
[0m16:33:57.354883 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:33:57.355887 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: COMMIT
[0m16:33:57.357880 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:33:57.360882 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m16:33:57.362886 [debug] [Thread-7 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:33:57.363882 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:33:57.364883 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:33:57.365881 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB723B650>]}
[0m16:33:57.366882 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:33:57.367881 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m16:33:57.368881 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB71EA2A0>]}
[0m16:33:57.369885 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m16:33:57.370881 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:33:57.372880 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m16:33:57.374884 [debug] [Thread-5 (]: On seed.ci_cd_project.regions: Close
[0m16:33:57.376882 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:33:57.378881 [debug] [Thread-2 (]: On seed.ci_cd_project.shippers: Close
[0m16:33:57.371881 [info ] [Thread-3 (]: 10 of 64 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.29s]
[0m16:33:57.380881 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_products: Close
[0m16:33:57.381889 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7453F80>]}
[0m16:33:57.382881 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:33:57.383881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB74B4EC0>]}
[0m16:33:57.384881 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:33:57.385881 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m16:33:57.375881 [info ] [Thread-7 (]: 9 of 64 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.29s]
[0m16:33:57.386882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7509340>]}
[0m16:33:57.390883 [debug] [Thread-4 (]: On seed.ci_cd_project.suppliers: Close
[0m16:33:57.392884 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_nw_customers
[0m16:33:57.393880 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: Close
[0m16:33:57.395891 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:33:57.397891 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5793890>]}
[0m16:33:57.387889 [info ] [Thread-5 (]: 12 of 64 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.30s]
[0m16:33:57.401899 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB74DFAA0>]}
[0m16:33:57.402893 [debug] [Thread-7 (]: Began running node model.ci_cd_project.stg_customers
[0m16:33:57.404891 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.regions
[0m16:33:57.414411 [debug] [Thread-5 (]: Began running node model.ci_cd_project.stg_orders
[0m16:33:57.391882 [info ] [Thread-2 (]: 13 of 64 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.29s]
[0m16:33:57.422412 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.shippers
[0m16:33:57.423410 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m16:33:57.396890 [info ] [Thread-1 (]: 11 of 64 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.30s]
[0m16:33:57.445931 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:33:57.446932 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_products
[0m16:33:57.399891 [info ] [Thread-3 (]: 16 of 64 START sql view model analytics.stg_nw_customers ....................... [RUN]
[0m16:33:57.451929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_nw_customers)
[0m16:33:57.452930 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_nw_customers
[0m16:33:57.462938 [debug] [Thread-6 (]: SQL status: OK in 0.588 seconds
[0m16:33:57.472934 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_nw_customers"
[0m16:33:57.474928 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m16:33:57.479929 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_nw_customers
[0m16:33:57.403891 [info ] [Thread-4 (]: 14 of 64 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.30s]
[0m16:33:57.501946 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.suppliers
[0m16:33:57.504941 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m16:33:57.529503 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:33:57.530504 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m16:33:57.540500 [debug] [Thread-6 (]: SQL status: OK in 0.009 seconds
[0m16:33:57.542501 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: Close
[0m16:33:57.407891 [info ] [Thread-8 (]: 15 of 64 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.25s]
[0m16:33:57.559505 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.territories
[0m16:33:57.408891 [info ] [Thread-7 (]: 17 of 64 START sql view model analytics.stg_customers .......................... [RUN]
[0m16:33:57.607511 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_nw_customers"
[0m16:33:57.608521 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_customers)
[0m16:33:57.415411 [info ] [Thread-5 (]: 18 of 64 START sql view model analytics.stg_orders ............................. [RUN]
[0m16:33:57.611024 [debug] [Thread-7 (]: Began compiling node model.ci_cd_project.stg_customers
[0m16:33:57.612044 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.regions, now model.ci_cd_project.stg_orders)
[0m16:33:57.620035 [debug] [Thread-7 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m16:33:57.424409 [info ] [Thread-2 (]: 19 of 64 START sql view model analytics.stg_order_items ........................ [RUN]
[0m16:33:57.622047 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:33:57.624038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.shippers, now model.ci_cd_project.stg_order_items)
[0m16:33:57.450929 [info ] [Thread-1 (]: 20 of 64 START sql view model analytics.stg_products ........................... [RUN]
[0m16:33:57.635037 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:33:57.636036 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:33:57.637036 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m16:33:57.638035 [debug] [Thread-7 (]: Began executing node model.ci_cd_project.stg_customers
[0m16:33:57.639034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m16:33:57.640034 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: BEGIN
[0m16:33:57.650035 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m16:33:57.658035 [debug] [Thread-7 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m16:33:57.660035 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_products
[0m16:33:57.661034 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:33:57.662034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:33:57.670038 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m16:33:57.679035 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:33:57.682043 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m16:33:57.690035 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m16:33:57.691034 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:57.693034 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m16:33:57.694034 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_products
[0m16:33:57.694034 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:57.695033 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:33:57.704042 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m16:33:57.705043 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:33:57.707043 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:57.709042 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m16:33:57.710558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:33:57.713586 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:57.714575 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: BEGIN
[0m16:33:57.715575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:57.708042 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:33:57.829099 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7588110>]}
[0m16:33:57.831100 [info ] [Thread-6 (]: 6 of 64 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 1.65s]
[0m16:33:57.836102 [debug] [Thread-6 (]: Finished running node seed.ci_cd_project.orders
[0m16:33:58.250875 [debug] [Thread-3 (]: SQL status: OK in 0.589 seconds
[0m16:33:58.251926 [debug] [Thread-1 (]: SQL status: OK in 0.536 seconds
[0m16:33:58.252468 [debug] [Thread-7 (]: SQL status: OK in 0.557 seconds
[0m16:33:58.253527 [debug] [Thread-2 (]: SQL status: OK in 0.543 seconds
[0m16:33:58.253527 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:33:58.254540 [debug] [Thread-5 (]: SQL status: OK in 0.547 seconds
[0m16:33:58.255536 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:58.256536 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:58.256536 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:58.257536 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */

  
  create view prod.analytics.stg_nw_customers__dbt_tmp as (
    

with source as (
    select * from prod.raw.customers
),

staged as (
    select
        customerid,
        companyname,
        contactname,
        contacttitle,
        address,
        city,
        region,
        postalcode,
        country,
        phone,
        fax
    from source
)

select * from staged
where true
  );

[0m16:33:58.258537 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:58.260536 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m16:33:58.260536 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m16:33:58.262018 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m16:33:58.266943 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:33:58.270342 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:33:58.271550 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m16:33:58.287898 [debug] [Thread-7 (]: SQL status: OK in 0.020 seconds
[0m16:33:58.288873 [debug] [Thread-5 (]: SQL status: OK in 0.020 seconds
[0m16:33:58.297747 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:33:58.298749 [debug] [Thread-2 (]: SQL status: OK in 0.030 seconds
[0m16:33:58.301747 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:58.309895 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:58.320375 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:58.321452 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */
alter view prod.analytics.stg_nw_customers__dbt_tmp rename to stg_nw_customers
[0m16:33:58.328972 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:58.329784 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view "prod"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m16:33:58.330797 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "prod"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m16:33:58.331305 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "prod"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m16:33:58.333326 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "prod"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m16:33:58.334324 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:33:58.335323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:33:58.336841 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:33:58.337846 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:33:58.338840 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m16:33:58.341681 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m16:33:58.349360 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:58.356884 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:58.365408 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:58.376408 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:58.377408 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:33:58.378408 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m16:33:58.379413 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m16:33:58.380408 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:33:58.381407 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m16:33:58.382414 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m16:33:58.385411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:33:58.393367 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:33:58.394367 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m16:33:58.395367 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m16:33:58.396446 [debug] [Thread-7 (]: SQL status: OK in 0.012 seconds
[0m16:33:58.396953 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:58.397963 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m16:33:58.400979 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:33:58.404998 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:33:58.408070 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:33:58.409346 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:33:58.421594 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:33:58.422664 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:58.423718 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:58.424247 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:58.425324 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */
drop view if exists prod.analytics.stg_nw_customers__dbt_backup cascade
[0m16:33:58.426531 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:33:58.427037 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:33:58.428046 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:33:58.429054 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:33:58.437974 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:33:58.438983 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m16:33:58.439921 [debug] [Thread-7 (]: SQL status: OK in 0.008 seconds
[0m16:33:58.440966 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m16:33:58.442029 [debug] [Thread-5 (]: SQL status: OK in 0.011 seconds
[0m16:33:58.444043 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m16:33:58.451221 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:33:58.473065 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m16:33:58.456744 [debug] [Thread-3 (]: On model.ci_cd_project.stg_nw_customers: Close
[0m16:33:58.475067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB7496510>]}
[0m16:33:58.451728 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:33:58.463062 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:33:58.471064 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:33:58.477063 [info ] [Thread-3 (]: 16 of 64 OK created sql view model analytics.stg_nw_customers .................. [[32mOK[0m in 1.02s]
[0m16:33:58.481062 [debug] [Thread-1 (]: On model.ci_cd_project.stg_products: Close
[0m16:33:58.482062 [debug] [Thread-7 (]: SQL status: OK in 0.008 seconds
[0m16:33:58.484067 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m16:33:58.485061 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m16:33:58.486261 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_nw_customers
[0m16:33:58.487775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB577F1D0>]}
[0m16:33:58.490776 [debug] [Thread-7 (]: On model.ci_cd_project.stg_customers: Close
[0m16:33:58.492776 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:33:58.493776 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:33:58.503785 [debug] [Thread-5 (]: On model.ci_cd_project.stg_orders: Close
[0m16:33:58.509787 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m16:33:58.511299 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB577C620>]}
[0m16:33:58.512313 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5C61C10>]}
[0m16:33:58.499783 [info ] [Thread-1 (]: 20 of 64 OK created sql view model analytics.stg_products ...................... [[32mOK[0m in 0.85s]
[0m16:33:58.519972 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_products
[0m16:33:58.521591 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:33:58.522650 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:33:58.523175 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:33:58.524284 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:33:58.515190 [info ] [Thread-7 (]: 17 of 64 OK created sql view model analytics.stg_customers ..................... [[32mOK[0m in 0.90s]
[0m16:33:58.536142 [debug] [Thread-7 (]: Finished running node model.ci_cd_project.stg_customers
[0m16:33:58.537721 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:33:58.516189 [info ] [Thread-5 (]: 18 of 64 OK created sql view model analytics.stg_orders ........................ [[32mOK[0m in 0.90s]
[0m16:33:58.538731 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:33:58.540731 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:33:58.542730 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:33:58.524813 [info ] [Thread-4 (]: 21 of 64 START test not_null_stg_products_cost ................................. [RUN]
[0m16:33:58.544730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.suppliers, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m16:33:58.545731 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:33:58.570730 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:33:58.525875 [info ] [Thread-8 (]: 22 of 64 START test not_null_stg_products_price ................................ [RUN]
[0m16:33:58.572730 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.territories, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m16:33:58.573731 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:33:58.584739 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:33:58.526404 [info ] [Thread-6 (]: 23 of 64 START test not_null_stg_products_product_id ........................... [RUN]
[0m16:33:58.585729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB5C62240>]}
[0m16:33:58.587730 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.orders, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m16:33:58.527252 [info ] [Thread-3 (]: 24 of 64 START test unique_stg_products_product_id ............................. [RUN]
[0m16:33:58.592736 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:33:58.539731 [info ] [Thread-1 (]: 25 of 64 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:33:58.597740 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:33:58.599740 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:33:58.600741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_nw_customers, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m16:33:58.671634 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:33:58.543730 [info ] [Thread-5 (]: 27 of 64 START test not_null_stg_customers_first_name .......................... [RUN]
[0m16:33:58.705271 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m16:33:58.706271 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:33:58.715784 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:33:58.625506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:33:58.661729 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:33:58.724788 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:33:58.650877 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:33:58.718785 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:33:58.721793 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:33:58.595730 [info ] [Thread-2 (]: 19 of 64 OK created sql view model analytics.stg_order_items ................... [[32mOK[0m in 0.96s]
[0m16:33:58.728793 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:33:58.670624 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:33:58.541730 [info ] [Thread-7 (]: 26 of 64 START test not_null_stg_customers_email ............................... [RUN]
[0m16:33:58.748788 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:33:58.892720 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:33:58.898134 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:33:58.899216 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:33:58.900280 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m16:33:58.906010 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:33:58.907009 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m16:33:58.913531 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:33:58.915530 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m16:33:58.916530 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:33:58.919268 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:33:58.921258 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:33:58.922260 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:33:58.937234 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m16:33:58.925711 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:33:58.927238 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m16:33:58.928242 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:33:58.936234 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:33:58.929233 [info ] [Thread-2 (]: 28 of 64 START test not_null_stg_customers_last_name ........................... [RUN]
[0m16:33:58.938237 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:33:58.923256 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:33:58.939233 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:33:58.942716 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:33:58.943857 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:33:58.948377 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:33:58.950372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m16:33:58.952383 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:33:58.964624 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:33:58.965675 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:33:58.966672 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:33:58.969672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:58.967672 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:33:58.968672 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:33:58.979704 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:33:58.981705 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:33:58.989441 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:33:58.992442 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:33:59.002462 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:33:59.003548 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:33:59.004058 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m16:33:59.005070 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:33:59.010405 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:33:59.011475 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m16:33:59.012025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:33:59.345339 [debug] [Thread-4 (]: SQL status: OK in 0.420 seconds
[0m16:33:59.346339 [debug] [Thread-5 (]: SQL status: OK in 0.407 seconds
[0m16:33:59.347341 [debug] [Thread-1 (]: SQL status: OK in 0.378 seconds
[0m16:33:59.348340 [debug] [Thread-8 (]: SQL status: OK in 0.406 seconds
[0m16:33:59.349339 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:33:59.350340 [debug] [Thread-3 (]: SQL status: OK in 0.382 seconds
[0m16:33:59.351340 [debug] [Thread-6 (]: SQL status: OK in 0.385 seconds
[0m16:33:59.352340 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:33:59.352340 [debug] [Thread-7 (]: SQL status: OK in 0.347 seconds
[0m16:33:59.353850 [debug] [Thread-2 (]: SQL status: OK in 0.342 seconds
[0m16:33:59.354862 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:33:59.355862 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:33:59.356862 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from prod.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.356862 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:33:59.357861 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:33:59.359109 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from prod.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.359622 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:33:59.360631 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:33:59.361632 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.362633 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from prod.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.364262 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:33:59.365154 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.366636 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from prod.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.367650 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from prod.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.369128 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:33:59.371373 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m16:33:59.373367 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:33:59.374368 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m16:33:59.380963 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m16:33:59.381968 [debug] [Thread-7 (]: SQL status: OK in 0.010 seconds
[0m16:33:59.384969 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m16:33:59.386964 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m16:33:59.386964 [debug] [Thread-6 (]: SQL status: OK in 0.016 seconds
[0m16:33:59.388515 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m16:33:59.391151 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:33:59.393713 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m16:33:59.395724 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m16:33:59.399868 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m16:33:59.402854 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m16:33:59.405856 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m16:33:59.408501 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:33:59.410336 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:33:59.413867 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m16:33:59.415932 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m16:33:59.415932 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m16:33:59.417942 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m16:33:59.419357 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m16:33:59.421365 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m16:33:59.423936 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m16:33:59.424944 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:33:59.426451 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m16:33:59.427464 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m16:33:59.430463 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m16:33:59.428466 [info ] [Thread-4 (]: 21 of 64 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.88s]
[0m16:33:59.431466 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m16:33:59.429464 [info ] [Thread-5 (]: 27 of 64 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.73s]
[0m16:33:59.433468 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:33:59.435465 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m16:33:59.434466 [info ] [Thread-1 (]: 25 of 64 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.81s]
[0m16:33:59.436465 [info ] [Thread-8 (]: 22 of 64 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.86s]
[0m16:33:59.444772 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:33:59.438470 [info ] [Thread-7 (]: 26 of 64 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.53s]
[0m16:33:59.440465 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:33:59.440465 [info ] [Thread-2 (]: 28 of 64 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.49s]
[0m16:33:59.443762 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:33:59.439468 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:33:59.455772 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:33:59.441464 [info ] [Thread-6 (]: 23 of 64 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.85s]
[0m16:33:59.445772 [debug] [Thread-8 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:33:59.450772 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:33:59.453771 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:33:59.454772 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:33:59.447772 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:33:59.457771 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:33:59.452772 [info ] [Thread-3 (]: 24 of 64 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.85s]
[0m16:33:59.464776 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:33:59.456775 [info ] [Thread-4 (]: 32 of 64 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:33:59.470772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:33:59.467774 [debug] [Thread-6 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:33:59.468772 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:33:59.473773 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:33:59.471773 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:33:59.466772 [debug] [Thread-7 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:33:59.487771 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:33:59.461775 [info ] [Thread-8 (]: 29 of 64 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:33:59.462773 [info ] [Thread-5 (]: 30 of 64 START test unique_stg_customers_email ................................. [RUN]
[0m16:33:59.491771 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m16:33:59.465772 [info ] [Thread-1 (]: 31 of 64 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m16:33:59.493773 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m16:33:59.469775 [info ] [Thread-2 (]: 33 of 64 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m16:33:59.495774 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:33:59.472773 [info ] [Thread-6 (]: 35 of 64 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:33:59.496780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m16:33:59.497796 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:33:59.474773 [info ] [Thread-3 (]: 36 of 64 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m16:33:59.499793 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:33:59.488772 [info ] [Thread-7 (]: 34 of 64 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m16:33:59.500792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m16:33:59.510802 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:33:59.512326 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m16:33:59.513343 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:33:59.519335 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:33:59.520339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m16:33:59.531336 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:33:59.532336 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:33:59.533334 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:33:59.534336 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:33:59.545333 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:33:59.547335 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:33:59.549338 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:33:59.550352 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:33:59.560333 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:33:59.567335 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:33:59.574336 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:33:59.575339 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:33:59.586333 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:33:59.598345 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:33:59.603413 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:33:59.604411 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:33:59.605409 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:33:59.611921 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:33:59.614939 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:33:59.623933 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:33:59.624938 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:33:59.625936 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:33:59.626939 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:33:59.627942 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:33:59.628942 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:33:59.635933 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:33:59.642931 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:33:59.650930 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:33:59.652933 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:33:59.653931 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:33:59.657929 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:33:59.658931 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:33:59.659935 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:33:59.660934 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m16:33:59.662940 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m16:33:59.664948 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:33:59.665932 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:33:59.666943 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:33:59.668938 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:33:59.669934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:59.671937 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:33:59.672935 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m16:33:59.673940 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m16:33:59.674932 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:33:59.675936 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m16:33:59.676932 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:33:59.677932 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:33:59.678930 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:33:59.679930 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:33:59.887702 [debug] [Thread-4 (]: SQL status: OK in 0.263 seconds
[0m16:33:59.888708 [debug] [Thread-8 (]: SQL status: OK in 0.228 seconds
[0m16:33:59.889701 [debug] [Thread-5 (]: SQL status: OK in 0.221 seconds
[0m16:33:59.889701 [debug] [Thread-2 (]: SQL status: OK in 0.213 seconds
[0m16:33:59.890706 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:33:59.891706 [debug] [Thread-1 (]: SQL status: OK in 0.221 seconds
[0m16:33:59.892704 [debug] [Thread-7 (]: SQL status: OK in 0.214 seconds
[0m16:33:59.892704 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:33:59.893707 [debug] [Thread-6 (]: SQL status: OK in 0.215 seconds
[0m16:33:59.894703 [debug] [Thread-3 (]: SQL status: OK in 0.215 seconds
[0m16:33:59.895706 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:33:59.896213 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:33:59.898235 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.899231 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:33:59.900231 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:33:59.900231 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:33:59.901233 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:33:59.901233 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:33:59.902234 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:33:59.903232 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from prod.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.904233 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.905233 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from prod.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from prod.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.906231 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:33:59.907238 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:33:59.908231 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:33:59.912741 [debug] [Thread-8 (]: SQL status: OK in 0.007 seconds
[0m16:33:59.916750 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:33:59.917751 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:33:59.918753 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m16:33:59.918753 [debug] [Thread-6 (]: SQL status: OK in 0.009 seconds
[0m16:33:59.919751 [debug] [Thread-5 (]: SQL status: OK in 0.012 seconds
[0m16:33:59.919751 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:33:59.922752 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:33:59.925751 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:33:59.925751 [debug] [Thread-7 (]: SQL status: OK in 0.016 seconds
[0m16:33:59.928757 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m16:33:59.932753 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m16:33:59.934750 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:33:59.937748 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m16:33:59.939750 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m16:33:59.940751 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:33:59.942750 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m16:33:59.945754 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:33:59.948751 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m16:33:59.949751 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m16:33:59.951750 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m16:33:59.953757 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m16:33:59.954759 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m16:33:59.956755 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:33:59.955759 [info ] [Thread-4 (]: 32 of 64 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.48s]
[0m16:33:59.957758 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m16:33:59.958756 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m16:33:59.959750 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m16:33:59.960754 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:33:59.961754 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m16:33:59.961754 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m16:33:59.962755 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:33:59.963750 [info ] [Thread-8 (]: 29 of 64 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.47s]
[0m16:33:59.965750 [info ] [Thread-1 (]: 31 of 64 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.47s]
[0m16:33:59.966753 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m16:33:59.966753 [info ] [Thread-2 (]: 33 of 64 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.47s]
[0m16:33:59.967750 [info ] [Thread-6 (]: 35 of 64 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.46s]
[0m16:33:59.970749 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:33:59.968771 [info ] [Thread-5 (]: 30 of 64 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.47s]
[0m16:33:59.971753 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:33:59.969749 [info ] [Thread-3 (]: 36 of 64 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.45s]
[0m16:33:59.972752 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:33:59.973755 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:33:59.974753 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:33:59.976754 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:33:59.977751 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:33:59.974753 [info ] [Thread-4 (]: 37 of 64 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m16:33:59.979751 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:33:59.980750 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:33:59.982751 [debug] [Thread-2 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:33:59.983760 [debug] [Thread-6 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:33:59.981755 [info ] [Thread-7 (]: 34 of 64 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.45s]
[0m16:33:59.984754 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:33:59.986749 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m16:33:59.985752 [info ] [Thread-8 (]: 38 of 64 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m16:33:59.987749 [info ] [Thread-1 (]: 39 of 64 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m16:33:59.987749 [info ] [Thread-2 (]: 40 of 64 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m16:33:59.990762 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:33:59.988751 [info ] [Thread-6 (]: 41 of 64 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m16:33:59.993750 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:33:59.992751 [info ] [Thread-5 (]: 42 of 64 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m16:33:59.994756 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m16:33:59.995754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m16:33:59.997766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m16:34:00.017293 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:33:59.999766 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m16:34:00.009768 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m16:34:00.010770 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:34:00.012283 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:34:00.013301 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:33:59.998766 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m16:34:00.030294 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:34:00.033295 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:34:00.032295 [info ] [Thread-3 (]: 43 of 64 START sql table model analytics.dim_customers ......................... [RUN]
[0m16:34:00.041299 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:34:00.051305 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:34:00.052307 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:34:00.059815 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:34:00.060815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now model.ci_cd_project.dim_customers)
[0m16:34:00.072833 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:34:00.073818 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:34:00.079816 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:34:00.080815 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:34:00.088816 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:34:00.087820 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:34:00.090816 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:34:00.096819 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:34:00.105828 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:34:00.107831 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:34:00.112336 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:34:00.120346 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:34:00.121346 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:34:00.127348 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:34:00.135347 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:34:00.138347 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:34:00.139478 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:34:00.141487 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:34:00.142500 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:34:00.143486 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m16:34:00.145486 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m16:34:00.181222 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:34:00.192226 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:34:00.193223 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m16:34:00.194223 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:34:00.195226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:00.196221 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:34:00.197375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:00.197678 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m16:34:00.199682 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:34:00.200682 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m16:34:00.201680 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m16:34:00.202681 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.203681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:00.204680 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:34:00.205681 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:34:00.206681 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:34:00.207683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:00.508027 [debug] [Thread-2 (]: SQL status: OK in 0.313 seconds
[0m16:34:00.510028 [debug] [Thread-4 (]: SQL status: OK in 0.313 seconds
[0m16:34:00.511033 [debug] [Thread-1 (]: SQL status: OK in 0.307 seconds
[0m16:34:00.512026 [debug] [Thread-5 (]: SQL status: OK in 0.307 seconds
[0m16:34:00.512026 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:34:00.513536 [debug] [Thread-6 (]: SQL status: OK in 0.308 seconds
[0m16:34:00.514550 [debug] [Thread-3 (]: SQL status: OK in 0.307 seconds
[0m16:34:00.515550 [debug] [Thread-8 (]: SQL status: OK in 0.316 seconds
[0m16:34:00.516549 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:34:00.517555 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:34:00.518551 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:34:00.518551 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from prod.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from prod.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:34:00.519548 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:34:00.520548 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.521553 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:34:00.522550 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:00.522550 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:34:00.523550 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:34:00.524549 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from prod.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from prod.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:34:00.525550 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers as c
left join customer_metrics as cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:34:00.526550 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:00.531550 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:34:00.533561 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:34:00.534550 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m16:34:00.537552 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m16:34:00.538550 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m16:34:00.541550 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m16:34:00.544553 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m16:34:00.544553 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m16:34:00.545549 [debug] [Thread-6 (]: SQL status: OK in 0.016 seconds
[0m16:34:00.546551 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m16:34:00.548807 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m16:34:00.551807 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m16:34:00.553814 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m16:34:00.554805 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m16:34:00.564394 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m16:34:00.565415 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.568403 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m16:34:00.569404 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m16:34:00.570403 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m16:34:00.572404 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m16:34:00.573405 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m16:34:00.574403 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "prod"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m16:34:00.575405 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m16:34:00.577408 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m16:34:00.579404 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m16:34:00.578408 [info ] [Thread-1 (]: 39 of 64 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.58s]
[0m16:34:00.579404 [info ] [Thread-4 (]: 37 of 64 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.59s]
[0m16:34:00.582080 [debug] [Thread-2 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m16:34:00.583080 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m16:34:00.584084 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:34:00.581070 [info ] [Thread-8 (]: 38 of 64 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.59s]
[0m16:34:00.587079 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:34:00.586081 [info ] [Thread-5 (]: 42 of 64 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.58s]
[0m16:34:00.589083 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:34:00.590079 [info ] [Thread-2 (]: 40 of 64 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.59s]
[0m16:34:00.600447 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.602441 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:34:00.591080 [info ] [Thread-6 (]: 41 of 64 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.59s]
[0m16:34:00.604496 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:34:00.606509 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:34:00.607508 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:34:00.608510 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:34:00.610508 [debug] [Thread-7 (]: Began running node model.ci_cd_project.dim_products
[0m16:34:00.611508 [debug] [Thread-1 (]: Began running node model.ci_cd_project.fct_orders
[0m16:34:00.614579 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:34:00.613022 [info ] [Thread-7 (]: 44 of 64 START sql table model analytics.dim_products .......................... [RUN]
[0m16:34:00.625611 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:34:00.627610 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.ci_cd_project.dim_products)
[0m16:34:00.628612 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.614408 [info ] [Thread-1 (]: 45 of 64 START sql table model analytics.fct_orders ............................ [RUN]
[0m16:34:00.629608 [debug] [Thread-7 (]: Began compiling node model.ci_cd_project.dim_products
[0m16:34:00.630609 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:34:00.631609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now model.ci_cd_project.fct_orders)
[0m16:34:00.640610 [debug] [Thread-7 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m16:34:00.642610 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:34:00.653611 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:34:00.656609 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m16:34:00.665490 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:34:00.667492 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:34:00.668492 [debug] [Thread-7 (]: Began executing node model.ci_cd_project.dim_products
[0m16:34:00.677491 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:34:00.678489 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m16:34:00.687489 [debug] [Thread-7 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m16:34:00.691492 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:34:00.692501 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:00.695490 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m16:34:00.696491 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:00.697489 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:34:00.698498 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: BEGIN
[0m16:34:00.699498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:00.700502 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:34:00.754900 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB8259070>]}
[0m16:34:00.755898 [info ] [Thread-3 (]: 43 of 64 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.69s]
[0m16:34:00.757897 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:34:00.758897 [debug] [Thread-8 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:34:00.759896 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:34:00.760905 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:34:00.761898 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:34:00.760905 [info ] [Thread-8 (]: 46 of 64 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m16:34:00.768391 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m16:34:00.769392 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:34:00.762897 [info ] [Thread-5 (]: 47 of 64 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m16:34:00.764387 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:34:00.766390 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:34:00.780391 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:34:00.764387 [info ] [Thread-2 (]: 48 of 64 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m16:34:00.783394 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:34:00.786394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m16:34:00.767393 [info ] [Thread-6 (]: 49 of 64 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m16:34:00.787399 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:34:00.789394 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:34:00.784392 [info ] [Thread-4 (]: 50 of 64 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m16:34:00.791392 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m16:34:00.785395 [info ] [Thread-3 (]: 51 of 64 START test unique_dim_customers_customer_id ........................... [RUN]
[0m16:34:00.793389 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:34:00.803400 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:34:00.813293 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:34:01.004916 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m16:34:01.006917 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:34:01.007912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m16:34:01.008912 [debug] [Thread-1 (]: SQL status: OK in 0.309 seconds
[0m16:34:01.008912 [debug] [Thread-7 (]: SQL status: OK in 0.309 seconds
[0m16:34:01.013418 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:34:01.014425 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:34:01.022438 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:34:01.023430 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:34:01.024428 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:34:01.025441 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:01.026694 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:34:01.027700 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:01.038713 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:34:01.046734 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:34:01.053725 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:34:01.054726 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:34:01.054726 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items as oi
    inner join orders as o on oi.order_id = o.order_id
    inner join products as p on oi.product_id = p.product_id
    inner join customers as c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:34:01.061242 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:34:01.061242 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:34:01.062240 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products as p
left join product_metrics as pm on p.product_id = pm.product_id
    );
  
  
[0m16:34:01.064324 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m16:34:01.067799 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:34:01.074792 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:34:01.075791 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:34:01.076790 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:34:01.077792 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:34:01.084425 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:34:01.085425 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:34:01.091420 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:34:01.092422 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:34:01.093426 [debug] [Thread-7 (]: SQL status: OK in 0.016 seconds
[0m16:34:01.094421 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:34:01.095419 [debug] [Thread-8 (]: SQL status: OK in 0.017 seconds
[0m16:34:01.095419 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m16:34:01.097320 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:34:01.098014 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:34:01.106016 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:01.113528 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:34:01.114470 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:01.115467 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:34:01.116465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:01.117473 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:34:01.118466 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m16:34:01.119672 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table "prod"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m16:34:01.119672 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m16:34:01.120681 [debug] [Thread-5 (]: SQL status: OK in 0.023 seconds
[0m16:34:01.121680 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "prod"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m16:34:01.122678 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from prod.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m16:34:01.123683 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m16:34:01.124702 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:34:01.125679 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:34:01.125679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:01.126679 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:34:01.127678 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m16:34:01.128682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:01.129681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:34:01.130915 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:34:01.131993 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m16:34:01.131993 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:01.133018 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m16:34:01.133989 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:34:01.139991 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:01.145990 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:01.146989 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from prod.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m16:34:01.147711 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m16:34:01.148731 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:34:01.149724 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:34:01.151723 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m16:34:01.152722 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m16:34:01.152722 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:34:01.153721 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m16:34:01.154725 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:34:01.155724 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from prod.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m16:34:01.155724 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from prod.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m16:34:01.157723 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:34:01.159719 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m16:34:01.162722 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:34:01.162722 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:34:01.164401 [debug] [Thread-7 (]: SQL status: OK in 0.006 seconds
[0m16:34:01.165409 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:34:01.168412 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m16:34:01.168412 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m16:34:01.169413 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m16:34:01.170414 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:34:01.172414 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m16:34:01.174416 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:34:01.188092 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:01.177414 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:34:01.181009 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m16:34:01.178412 [info ] [Thread-8 (]: 46 of 64 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.41s]
[0m16:34:01.192094 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:34:01.185093 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:34:01.187092 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m16:34:01.175420 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:34:01.189092 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:34:01.190098 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:01.191091 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m16:34:01.184093 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m16:34:01.196091 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m16:34:01.199099 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m16:34:01.194091 [info ] [Thread-5 (]: 47 of 64 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.41s]
[0m16:34:01.200100 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:34:01.203110 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m16:34:01.201099 [info ] [Thread-2 (]: 48 of 64 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.42s]
[0m16:34:01.204100 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m16:34:01.205099 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m16:34:01.206098 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:34:01.207099 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m16:34:01.208099 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m16:34:01.209106 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:34:01.210107 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:34:01.216631 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:34:01.218635 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m16:34:01.217631 [info ] [Thread-4 (]: 50 of 64 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.21s]
[0m16:34:01.220656 [info ] [Thread-6 (]: 49 of 64 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.43s]
[0m16:34:01.227140 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:34:01.228152 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m16:34:01.230185 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:34:01.232187 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:34:01.231188 [info ] [Thread-3 (]: 51 of 64 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.22s]
[0m16:34:01.233189 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m16:34:01.235186 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:34:01.236185 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m16:34:01.239188 [debug] [Thread-7 (]: On model.ci_cd_project.dim_products: Close
[0m16:34:01.240188 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:34:01.242193 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB821AED0>]}
[0m16:34:01.245190 [debug] [Thread-1 (]: On model.ci_cd_project.fct_orders: Close
[0m16:34:01.334721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9a1444c-e4d1-4979-8edf-e342db93d31a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB710A690>]}
[0m16:34:02.741482 [info ] [Thread-7 (]: 44 of 64 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.61s]
[0m16:34:02.749542 [debug] [Thread-7 (]: Finished running node model.ci_cd_project.dim_products
[0m16:34:02.742483 [info ] [Thread-1 (]: 45 of 64 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.70s]
[0m16:34:02.751542 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:34:02.752542 [debug] [Thread-8 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:34:02.753543 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:34:02.754545 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:34:02.755542 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:34:02.757542 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:34:02.758542 [debug] [Thread-6 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:34:02.755542 [info ] [Thread-8 (]: 52 of 64 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m16:34:02.761542 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:34:02.762541 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:34:02.756546 [info ] [Thread-5 (]: 53 of 64 START test not_null_dim_products_performance_category ................. [RUN]
[0m16:34:02.765839 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m16:34:02.768841 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m16:34:02.769837 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:34:02.770838 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:34:02.760543 [info ] [Thread-1 (]: 54 of 64 START test not_null_dim_products_product_id ........................... [RUN]
[0m16:34:02.796843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m16:34:02.798860 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:34:02.800882 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:34:02.807883 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:34:02.821407 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:34:02.762541 [info ] [Thread-2 (]: 55 of 64 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m16:34:02.824412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m16:34:02.826412 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:34:02.828408 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:34:02.840411 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:34:02.763804 [info ] [Thread-4 (]: 56 of 64 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m16:34:02.845406 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:34:02.847415 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:34:02.865060 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:34:02.867066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m16:34:02.870065 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:34:02.764842 [info ] [Thread-6 (]: 57 of 64 START test unique_dim_products_product_id ............................. [RUN]
[0m16:34:02.879062 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:34:02.766838 [info ] [Thread-7 (]: 58 of 64 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m16:34:02.884076 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:34:02.887064 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m16:34:02.889063 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:34:02.890062 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:34:02.891066 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m16:34:02.906758 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:34:02.767838 [info ] [Thread-3 (]: 59 of 64 START test not_null_fct_orders_order_id ............................... [RUN]
[0m16:34:02.908762 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:34:02.909774 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m16:34:02.910758 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:34:02.919290 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:34:02.921285 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:34:02.922280 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:34:02.924280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m16:34:02.938853 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:34:02.940850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:02.941853 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m16:34:02.942852 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:34:02.944850 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m16:34:02.959367 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:34:02.961367 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:34:02.962371 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:34:02.964890 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:34:02.973415 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:34:02.974436 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:34:02.976439 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:34:02.989437 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:34:02.990432 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m16:34:02.999439 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:34:03.001437 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:34:03.002438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:03.006440 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:34:03.014914 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:34:03.015914 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:34:03.017910 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m16:34:03.025913 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:34:03.027912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:34:03.029917 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:34:03.032507 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m16:34:03.033506 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:34:03.036513 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:34:03.037510 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m16:34:03.038507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:34:03.044512 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:34:03.047127 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m16:34:03.049174 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:34:03.503066 [debug] [Thread-5 (]: SQL status: OK in 0.540 seconds
[0m16:34:03.504067 [debug] [Thread-1 (]: SQL status: OK in 0.564 seconds
[0m16:34:03.506070 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:34:03.507067 [debug] [Thread-6 (]: SQL status: OK in 0.474 seconds
[0m16:34:03.513776 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:34:03.508067 [debug] [Thread-2 (]: SQL status: OK in 0.506 seconds
[0m16:34:03.509066 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:34:03.510066 [debug] [Thread-7 (]: SQL status: OK in 0.461 seconds
[0m16:34:03.511066 [debug] [Thread-4 (]: SQL status: OK in 0.483 seconds
[0m16:34:03.512066 [debug] [Thread-3 (]: SQL status: OK in 0.473 seconds
[0m16:34:03.512066 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from prod.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.508067 [debug] [Thread-8 (]: SQL status: OK in 0.533 seconds
[0m16:34:03.514825 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:34:03.515824 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:34:03.516826 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.517829 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:34:03.517829 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:34:03.518825 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:34:03.520828 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:34:03.521827 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from prod.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.522826 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m16:34:03.523824 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.524827 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m16:34:03.525824 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from prod.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.526825 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:34:03.527828 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:03.528831 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from prod.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m16:34:03.532994 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m16:34:03.533993 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:34:03.533993 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m16:34:03.538006 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m16:34:03.541997 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m16:34:03.542994 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:34:03.545994 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m16:34:03.548999 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m16:34:03.549993 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m16:34:03.549993 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:34:03.553994 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m16:34:03.555993 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m16:34:03.557993 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m16:34:03.558997 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m16:34:03.561994 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m16:34:03.563994 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m16:34:03.566995 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m16:34:03.569994 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m16:34:03.570995 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m16:34:03.572995 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m16:34:03.573995 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m16:34:03.575994 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m16:34:03.575994 [info ] [Thread-5 (]: 53 of 64 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.81s]
[0m16:34:03.578994 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m16:34:03.580995 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m16:34:03.582994 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m16:34:03.584994 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m16:34:03.583997 [info ] [Thread-6 (]: 57 of 64 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.70s]
[0m16:34:03.588996 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:34:03.585993 [info ] [Thread-1 (]: 54 of 64 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.79s]
[0m16:34:03.596994 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:34:03.589994 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m16:34:03.591994 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m16:34:03.594994 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:34:03.587996 [info ] [Thread-2 (]: 55 of 64 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.76s]
[0m16:34:03.595994 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:34:03.590993 [debug] [Thread-8 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m16:34:03.599010 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:34:03.593995 [info ] [Thread-7 (]: 58 of 64 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.70s]
[0m16:34:03.604004 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:34:03.601010 [info ] [Thread-4 (]: 56 of 64 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.73s]
[0m16:34:03.605004 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:34:03.609002 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:34:03.612006 [debug] [Thread-7 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:34:03.612006 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:34:03.611003 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:34:03.603007 [info ] [Thread-3 (]: 59 of 64 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.68s]
[0m16:34:03.619524 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:34:03.606003 [info ] [Thread-5 (]: 60 of 64 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m16:34:03.622525 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m16:34:03.623525 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:34:03.636526 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:34:03.607005 [info ] [Thread-1 (]: 61 of 64 START test not_null_fct_orders_product_id ............................. [RUN]
[0m16:34:03.637523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m16:34:03.638525 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:34:03.803062 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:34:03.610003 [info ] [Thread-6 (]: 62 of 64 START test not_null_fct_orders_quantity ............................... [RUN]
[0m16:34:03.614525 [info ] [Thread-7 (]: 64 of 64 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m16:34:03.805062 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m16:34:03.806076 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m16:34:03.808063 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:34:03.615525 [info ] [Thread-2 (]: 63 of 64 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m16:34:03.809065 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:34:03.811061 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:34:03.812070 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:34:03.818606 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:34:03.618524 [info ] [Thread-8 (]: 52 of 64 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.85s]
[0m16:34:03.820605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m16:34:03.830609 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:34:03.840611 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:34:03.846606 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:34:03.848607 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:34:03.850606 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:34:03.852622 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:34:03.865607 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:34:03.866607 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:34:03.867607 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:34:03.868606 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m16:34:03.874606 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:34:03.883879 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:34:03.884889 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:34:03.885891 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:34:03.886890 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m16:34:03.888890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:03.889891 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:34:03.891892 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:34:03.892898 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:34:03.900437 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:34:03.901436 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m16:34:03.902436 [debug] [Thread-7 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m16:34:03.903440 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:34:03.904439 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:34:03.907445 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:34:03.908436 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m16:34:03.909436 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:34:04.182517 [debug] [Thread-1 (]: SQL status: OK in 0.294 seconds
[0m16:34:04.183517 [debug] [Thread-6 (]: SQL status: OK in 0.280 seconds
[0m16:34:04.184517 [debug] [Thread-7 (]: SQL status: OK in 0.280 seconds
[0m16:34:04.185518 [debug] [Thread-5 (]: SQL status: OK in 0.300 seconds
[0m16:34:04.186519 [debug] [Thread-2 (]: SQL status: OK in 0.277 seconds
[0m16:34:04.187519 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:34:04.187519 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:34:04.188517 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:34:04.189518 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:34:04.190517 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:34:04.191520 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:04.192518 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:34:04.193518 [debug] [Thread-7 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:34:04.193518 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:34:04.194517 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from prod.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m16:34:04.197518 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:34:04.198518 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m16:34:04.200531 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m16:34:04.200531 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m16:34:04.204527 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m16:34:04.204527 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:34:04.207529 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m16:34:04.210527 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m16:34:04.214035 [debug] [Thread-7 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m16:34:04.216048 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m16:34:04.220047 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m16:34:04.222046 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m16:34:04.224048 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m16:34:04.225051 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m16:34:04.227062 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m16:34:04.228057 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m16:34:04.230056 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m16:34:04.230056 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m16:34:04.233058 [debug] [Thread-7 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m16:34:04.232056 [info ] [Thread-1 (]: 61 of 64 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.59s]
[0m16:34:04.235055 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m16:34:04.234059 [info ] [Thread-6 (]: 62 of 64 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.43s]
[0m16:34:04.239057 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:34:04.236057 [info ] [Thread-5 (]: 60 of 64 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.61s]
[0m16:34:04.240057 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:34:04.238056 [info ] [Thread-7 (]: 64 of 64 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.43s]
[0m16:34:04.242576 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:34:04.243578 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:34:04.248588 [info ] [Thread-2 (]: 63 of 64 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.43s]
[0m16:34:04.252578 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:34:04.256578 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:04.257578 [debug] [MainThread]: On master: BEGIN
[0m16:34:04.258578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:04.570643 [debug] [MainThread]: SQL status: OK in 0.312 seconds
[0m16:34:04.571644 [debug] [MainThread]: On master: COMMIT
[0m16:34:04.572645 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:04.573645 [debug] [MainThread]: On master: COMMIT
[0m16:34:04.574648 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:34:04.575647 [debug] [MainThread]: On master: Close
[0m16:34:04.583644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:04.584644 [debug] [MainThread]: Connection 'list_prod' was properly closed.
[0m16:34:04.585863 [debug] [MainThread]: Connection 'list_prod' was properly closed.
[0m16:34:04.586371 [debug] [MainThread]: Connection 'list_prod_analytics' was properly closed.
[0m16:34:04.586907 [debug] [MainThread]: Connection 'list_prod_raw' was properly closed.
[0m16:34:04.587449 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m16:34:04.587977 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m16:34:04.588504 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m16:34:04.589556 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a' was properly closed.
[0m16:34:04.590087 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94' was properly closed.
[0m16:34:04.590610 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m16:34:04.591138 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m16:34:04.591672 [debug] [MainThread]: Connection 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed' was properly closed.
[0m16:34:04.592742 [info ] [MainThread]: 
[0m16:34:04.593931 [info ] [MainThread]: Finished running 15 seeds, 5 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m16:34:04.614455 [debug] [MainThread]: Command end result
[0m16:34:04.778114 [info ] [MainThread]: 
[0m16:34:04.781099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:04.784100 [info ] [MainThread]: 
[0m16:34:04.785099 [info ] [MainThread]: Done. PASS=64 WARN=0 ERROR=0 SKIP=0 TOTAL=64
[0m16:34:04.790101 [debug] [MainThread]: Command `dbt build` succeeded at 16:34:04.789101 after 19.01 seconds
[0m16:34:04.791099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB42BB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB29054C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BB3E8B620>]}
[0m16:34:04.791099 [debug] [MainThread]: Flushing usage events
[0m16:40:59.981582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA77342E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7A490740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7A4903E0>]}


============================== 16:40:59.992675 | 03a17d06-8501-4606-8371-dd2fadbaf159 ==============================
[0m16:40:59.992675 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:40:59.994675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target prod', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:00.670695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7B7131D0>]}
[0m16:41:00.795488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7975FBF0>]}
[0m16:41:00.802520 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m16:41:01.873553 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m16:41:02.942156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:02.943158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:03.038124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7B74A930>]}
[0m16:41:03.320542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7C58F5F0>]}
[0m16:41:03.321541 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 858 macros
[0m16:41:03.329542 [info ] [MainThread]: 
[0m16:41:03.330542 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:41:03.346709 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m16:41:03.367717 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m16:41:03.842022 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m16:41:03.843039 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m16:41:03.843039 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m16:41:03.844028 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m16:41:03.845022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:03.845022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:04.118549 [debug] [ThreadPool]: SQL status: OK in 0.273 seconds
[0m16:41:04.119554 [debug] [ThreadPool]: SQL status: OK in 0.275 seconds
[0m16:41:04.121557 [debug] [ThreadPool]: On list_prod: Close
[0m16:41:04.124552 [debug] [ThreadPool]: On list_prod: Close
[0m16:41:04.134587 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_raw'
[0m16:41:04.148069 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m16:41:04.149070 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m16:41:04.150060 [debug] [ThreadPool]: On list_prod_raw: BEGIN
[0m16:41:04.155747 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m16:41:04.156746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:04.157751 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m16:41:04.158746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:04.476950 [debug] [ThreadPool]: SQL status: OK in 0.321 seconds
[0m16:41:04.477951 [debug] [ThreadPool]: Using duckdb connection "list_prod_raw"
[0m16:41:04.478952 [debug] [ThreadPool]: SQL status: OK in 0.321 seconds
[0m16:41:04.480462 [debug] [ThreadPool]: On list_prod_raw: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_raw"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'raw'
    and table_catalog = 'prod'
  
[0m16:41:04.481473 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m16:41:04.482472 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m16:41:04.539041 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m16:41:04.542034 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m16:41:04.542034 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m16:41:04.545554 [debug] [ThreadPool]: On list_prod_raw: ROLLBACK
[0m16:41:04.547555 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m16:41:04.547555 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m16:41:04.549561 [debug] [ThreadPool]: Failed to rollback 'list_prod_raw'
[0m16:41:04.554711 [debug] [ThreadPool]: On list_prod_raw: Close
[0m16:41:04.565704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7B603DD0>]}
[0m16:41:04.566705 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:04.568208 [debug] [MainThread]: On master: BEGIN
[0m16:41:04.568208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:04.845026 [debug] [MainThread]: SQL status: OK in 0.276 seconds
[0m16:41:04.845556 [debug] [MainThread]: On master: COMMIT
[0m16:41:04.846649 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:04.847199 [debug] [MainThread]: On master: COMMIT
[0m16:41:04.848533 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:41:04.849045 [debug] [MainThread]: On master: Close
[0m16:41:04.855676 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m16:41:04.856675 [info ] [MainThread]: 
[0m16:41:04.866262 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.categories
[0m16:41:04.868180 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.customers
[0m16:41:04.869184 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.employee_territories
[0m16:41:04.869184 [info ] [Thread-1 (]: 1 of 64 START seed file raw.categories ......................................... [RUN]
[0m16:41:04.871181 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.employees
[0m16:41:04.872182 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.order_details
[0m16:41:04.872182 [info ] [Thread-2 (]: 2 of 64 START seed file raw.customers .......................................... [RUN]
[0m16:41:04.873691 [debug] [Thread-6 (]: Began running node seed.ci_cd_project.orders
[0m16:41:04.875703 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.products
[0m16:41:04.874702 [info ] [Thread-3 (]: 3 of 64 START seed file raw.employee_territories ............................... [RUN]
[0m16:41:04.876702 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.raw_customers
[0m16:41:04.877702 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ci_cd_project.categories'
[0m16:41:04.878705 [info ] [Thread-4 (]: 4 of 64 START seed file raw.employees .......................................... [RUN]
[0m16:41:04.881837 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.customers'
[0m16:41:04.879703 [info ] [Thread-5 (]: 5 of 64 START seed file raw.order_details ...................................... [RUN]
[0m16:41:04.882835 [info ] [Thread-6 (]: 6 of 64 START seed file raw.orders ............................................. [RUN]
[0m16:41:04.885363 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employee_territories'
[0m16:41:04.884343 [info ] [Thread-7 (]: 7 of 64 START seed file raw.products ........................................... [RUN]
[0m16:41:04.887355 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.categories
[0m16:41:04.886355 [info ] [Thread-8 (]: 8 of 64 START seed file raw.raw_customers ...................................... [RUN]
[0m16:41:04.888352 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.employees'
[0m16:41:04.889302 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.customers
[0m16:41:04.889836 [debug] [Thread-5 (]: Acquiring new duckdb connection 'seed.ci_cd_project.order_details'
[0m16:41:04.890896 [debug] [Thread-6 (]: Acquiring new duckdb connection 'seed.ci_cd_project.orders'
[0m16:41:04.891970 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.employee_territories
[0m16:41:04.893023 [debug] [Thread-7 (]: Acquiring new duckdb connection 'seed.ci_cd_project.products'
[0m16:41:04.893707 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.categories
[0m16:41:04.895372 [debug] [Thread-8 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_customers'
[0m16:41:04.896469 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.employees
[0m16:41:04.897580 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.customers
[0m16:41:04.898535 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.order_details
[0m16:41:04.899576 [debug] [Thread-6 (]: Began compiling node seed.ci_cd_project.orders
[0m16:41:04.900103 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.employee_territories
[0m16:41:04.901245 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.products
[0m16:41:04.936245 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m16:41:04.941893 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.employees
[0m16:41:05.015639 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.order_details
[0m16:41:05.018227 [debug] [Thread-6 (]: Began executing node seed.ci_cd_project.orders
[0m16:41:05.025514 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.products
[0m16:41:05.028514 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.raw_customers
[0m16:41:05.053624 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:41:05.063337 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:41:05.081566 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:41:05.141918 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:41:05.144917 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: BEGIN
[0m16:41:05.233516 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: BEGIN
[0m16:41:05.264805 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:41:05.288178 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:41:05.300188 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: BEGIN
[0m16:41:05.316387 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: BEGIN
[0m16:41:05.323244 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:41:05.338910 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:41:05.339910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:05.340912 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:05.341911 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: BEGIN
[0m16:41:05.342909 [debug] [Thread-7 (]: On seed.ci_cd_project.products: BEGIN
[0m16:41:05.343913 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:05.344910 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:05.345910 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m16:41:05.346909 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: BEGIN
[0m16:41:05.347911 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:41:05.348913 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m16:41:05.349912 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m16:41:05.351489 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m16:41:05.777158 [debug] [Thread-2 (]: SQL status: OK in 0.437 seconds
[0m16:41:05.779158 [debug] [Thread-3 (]: SQL status: OK in 0.435 seconds
[0m16:41:05.780163 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:41:05.781667 [debug] [Thread-4 (]: SQL status: OK in 0.437 seconds
[0m16:41:05.782682 [debug] [Thread-1 (]: SQL status: OK in 0.443 seconds
[0m16:41:05.783680 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:41:05.784841 [debug] [Thread-5 (]: SQL status: OK in 0.436 seconds
[0m16:41:05.785847 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.customers"} */
truncate table "prod"."raw"."customers"
[0m16:41:05.786844 [debug] [Thread-7 (]: SQL status: OK in 0.438 seconds
[0m16:41:05.787843 [debug] [Thread-6 (]: SQL status: OK in 0.437 seconds
[0m16:41:05.788844 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:41:05.789845 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:41:05.790842 [debug] [Thread-8 (]: SQL status: OK in 0.441 seconds
[0m16:41:05.791841 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employee_territories"} */
truncate table "prod"."raw"."employee_territories"
[0m16:41:05.792842 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:41:05.793843 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:41:05.794844 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:41:05.795847 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:05.796844 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.employees"} */
truncate table "prod"."raw"."employees"
[0m16:41:05.797857 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.categories"} */
truncate table "prod"."raw"."categories"
[0m16:41:05.798858 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:41:05.800856 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.order_details"} */
truncate table "prod"."raw"."order_details"
[0m16:41:05.801467 [debug] [Thread-7 (]: On seed.ci_cd_project.products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.products"} */
truncate table "prod"."raw"."products"
[0m16:41:05.802480 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:41:05.803480 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.orders"} */
truncate table "prod"."raw"."orders"
[0m16:41:05.832364 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:41:05.834806 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "prod"."raw"."raw_customers"
[0m16:41:05.835807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:41:05.836809 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:05.840807 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:41:05.841811 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m16:41:05.856492 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:41:05.842808 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m16:41:05.859486 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:41:05.860486 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: 
          COPY prod.raw.order_details FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\order_details.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.851477 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:41:05.852487 [debug] [Thread-8 (]: SQL status: OK in 0.008 seconds
[0m16:41:05.853486 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: 
          COPY prod.raw.employee_territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employee_territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.847809 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:41:05.856492 [debug] [Thread-7 (]: On seed.ci_cd_project.products: 
          COPY prod.raw.products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.861487 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: 
          COPY prod.raw.employees FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\employees.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.844809 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m16:41:05.864487 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:41:05.880177 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: 
          COPY prod.raw.raw_customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.869176 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: 
          COPY prod.raw.categories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\categories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.843811 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: 
          COPY prod.raw.customers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.878176 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:41:05.886911 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: 
          COPY prod.raw.orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:05.893908 [debug] [Thread-3 (]: SQL status: OK in 0.029 seconds
[0m16:41:05.910507 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.employee_territories"
[0m16:41:05.913499 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:41:05.915510 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m16:41:05.916502 [debug] [Thread-5 (]: SQL status: OK in 0.055 seconds
[0m16:41:05.918178 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.categories"
[0m16:41:05.919190 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.customers"
[0m16:41:05.920190 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.order_details"
[0m16:41:05.995933 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m16:41:06.001096 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m16:41:06.003477 [debug] [Thread-7 (]: SQL status: OK in 0.134 seconds
[0m16:41:06.019832 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.products"
[0m16:41:06.005472 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.customers"
[0m16:41:06.004480 [debug] [Thread-4 (]: SQL status: OK in 0.134 seconds
[0m16:41:06.013003 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m16:41:06.016002 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m16:41:06.017821 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.order_details"
[0m16:41:06.007473 [debug] [Thread-8 (]: SQL status: OK in 0.126 seconds
[0m16:41:06.020832 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: COMMIT
[0m16:41:06.023832 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.employees"
[0m16:41:06.024832 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.categories"
[0m16:41:06.026835 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.employee_territories"
[0m16:41:06.027832 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: COMMIT
[0m16:41:06.028836 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m16:41:06.032845 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m16:41:06.034494 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: COMMIT
[0m16:41:06.036509 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: COMMIT
[0m16:41:06.041727 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m16:41:06.043728 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m16:41:06.044239 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.products"
[0m16:41:06.045399 [debug] [Thread-5 (]: SQL status: OK in 0.008 seconds
[0m16:41:06.047506 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.employees"
[0m16:41:06.052380 [debug] [Thread-2 (]: On seed.ci_cd_project.customers: Close
[0m16:41:06.053379 [debug] [Thread-7 (]: On seed.ci_cd_project.products: COMMIT
[0m16:41:06.054382 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:41:06.057377 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:41:06.058378 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:41:06.060380 [debug] [Thread-5 (]: On seed.ci_cd_project.order_details: Close
[0m16:41:06.061380 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: COMMIT
[0m16:41:06.064384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA77884DA0>]}
[0m16:41:06.066403 [debug] [Thread-3 (]: On seed.ci_cd_project.employee_territories: Close
[0m16:41:06.067658 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m16:41:06.069117 [debug] [Thread-1 (]: On seed.ci_cd_project.categories: Close
[0m16:41:06.070117 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7CCAC080>]}
[0m16:41:06.073594 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7B062900>]}
[0m16:41:06.074593 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m16:41:06.075592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7CB949E0>]}
[0m16:41:06.079590 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:41:06.082117 [debug] [Thread-4 (]: On seed.ci_cd_project.employees: Close
[0m16:41:06.083113 [debug] [Thread-7 (]: SQL status: OK in 0.018 seconds
[0m16:41:06.084963 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7C8D1520>]}
[0m16:41:06.086977 [debug] [Thread-7 (]: On seed.ci_cd_project.products: Close
[0m16:41:06.088978 [debug] [Thread-8 (]: SQL status: OK in 0.009 seconds
[0m16:41:06.089979 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7DE04FB0>]}
[0m16:41:06.091978 [debug] [Thread-8 (]: On seed.ci_cd_project.raw_customers: Close
[0m16:41:06.071116 [info ] [Thread-2 (]: 2 of 64 OK loaded seed file raw.customers ...................................... [[32mINSERT 91[0m in 1.18s]
[0m16:41:06.094976 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7DECC0E0>]}
[0m16:41:06.095976 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.customers
[0m16:41:06.097976 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m16:41:06.077602 [info ] [Thread-5 (]: 5 of 64 OK loaded seed file raw.order_details .................................. [[32mINSERT 2155[0m in 1.18s]
[0m16:41:06.109096 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.order_details
[0m16:41:06.110099 [debug] [Thread-5 (]: Began running node seed.ci_cd_project.raw_orders
[0m16:41:06.078593 [info ] [Thread-3 (]: 3 of 64 OK loaded seed file raw.employee_territories ........................... [[32mINSERT 49[0m in 1.19s]
[0m16:41:06.135099 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.employee_territories
[0m16:41:06.136099 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_products
[0m16:41:06.081102 [info ] [Thread-1 (]: 1 of 64 OK loaded seed file raw.categories ..................................... [[32mINSERT 8[0m in 1.20s]
[0m16:41:06.139097 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.categories
[0m16:41:06.140098 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.regions
[0m16:41:06.087977 [info ] [Thread-4 (]: 4 of 64 OK loaded seed file raw.employees ...................................... [[32mINSERT 8[0m in 1.20s]
[0m16:41:06.161098 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.employees
[0m16:41:06.162095 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.shippers
[0m16:41:06.092975 [info ] [Thread-7 (]: 7 of 64 OK loaded seed file raw.products ....................................... [[32mINSERT 77[0m in 1.20s]
[0m16:41:06.167122 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.products
[0m16:41:06.168118 [debug] [Thread-7 (]: Began running node seed.ci_cd_project.suppliers
[0m16:41:06.096978 [info ] [Thread-8 (]: 8 of 64 OK loaded seed file raw.raw_customers .................................. [[32mINSERT 10[0m in 1.20s]
[0m16:41:06.185637 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.raw_customers
[0m16:41:06.186635 [debug] [Thread-8 (]: Began running node seed.ci_cd_project.territories
[0m16:41:06.099979 [info ] [Thread-2 (]: 9 of 64 START seed file raw.raw_order_items .................................... [RUN]
[0m16:41:06.208225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.customers, now seed.ci_cd_project.raw_order_items)
[0m16:41:06.209225 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m16:41:06.210231 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m16:41:06.111094 [info ] [Thread-5 (]: 10 of 64 START seed file raw.raw_orders ........................................ [RUN]
[0m16:41:06.221223 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.order_details, now seed.ci_cd_project.raw_orders)
[0m16:41:06.222225 [debug] [Thread-5 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m16:41:06.223226 [debug] [Thread-5 (]: Began executing node seed.ci_cd_project.raw_orders
[0m16:41:06.137098 [info ] [Thread-3 (]: 11 of 64 START seed file raw.raw_products ...................................... [RUN]
[0m16:41:06.142097 [info ] [Thread-1 (]: 12 of 64 START seed file raw.regions ........................................... [RUN]
[0m16:41:06.243226 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:41:06.247222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employee_territories, now seed.ci_cd_project.raw_products)
[0m16:41:06.248222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.categories, now seed.ci_cd_project.regions)
[0m16:41:06.252228 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m16:41:06.164095 [info ] [Thread-4 (]: 13 of 64 START seed file raw.shippers .......................................... [RUN]
[0m16:41:06.262223 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:41:06.263225 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_products
[0m16:41:06.271235 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_products
[0m16:41:06.265221 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.regions
[0m16:41:06.170119 [info ] [Thread-7 (]: 14 of 64 START seed file raw.suppliers ......................................... [RUN]
[0m16:41:06.282766 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.products, now seed.ci_cd_project.suppliers)
[0m16:41:06.269240 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m16:41:06.266224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:06.279234 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.regions
[0m16:41:06.268236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.employees, now seed.ci_cd_project.shippers)
[0m16:41:06.301771 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.shippers
[0m16:41:06.285767 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:06.187639 [info ] [Thread-8 (]: 15 of 64 START seed file raw.territories ....................................... [RUN]
[0m16:41:06.299761 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m16:41:06.284769 [debug] [Thread-7 (]: Began compiling node seed.ci_cd_project.suppliers
[0m16:41:06.302768 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.shippers
[0m16:41:06.310768 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:41:06.312767 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now seed.ci_cd_project.territories)
[0m16:41:06.313761 [debug] [Thread-5 (]: SQL status: OK in 0.028 seconds
[0m16:41:06.315771 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:41:06.322761 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:41:06.323761 [debug] [Thread-7 (]: Began executing node seed.ci_cd_project.suppliers
[0m16:41:06.330763 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m16:41:06.334766 [debug] [Thread-8 (]: Began compiling node seed.ci_cd_project.territories
[0m16:41:06.336763 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:41:06.337764 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "prod"."raw"."raw_order_items"
[0m16:41:06.338764 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: BEGIN
[0m16:41:06.352765 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:41:06.357764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:06.358762 [debug] [Thread-8 (]: Began executing node seed.ci_cd_project.territories
[0m16:41:06.360763 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "prod"."raw"."raw_orders"
[0m16:41:06.361763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:06.366774 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: BEGIN
[0m16:41:06.368774 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:41:06.374778 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:41:06.382295 [debug] [Thread-3 (]: SQL status: OK in 0.024 seconds
[0m16:41:06.386295 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m16:41:06.387295 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:06.388296 [debug] [Thread-5 (]: SQL status: OK in 0.006 seconds
[0m16:41:06.391296 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:41:06.392294 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: BEGIN
[0m16:41:06.396294 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:41:06.404674 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:41:06.405675 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:41:06.409673 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:41:06.410675 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY prod.raw.raw_order_items FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.411677 [debug] [Thread-4 (]: SQL status: OK in 0.024 seconds
[0m16:41:06.412687 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:06.413676 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "prod"."raw"."raw_products"
[0m16:41:06.414683 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: BEGIN
[0m16:41:06.415675 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.regions"} */
truncate table "prod"."raw"."regions"
[0m16:41:06.416678 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: 
          COPY prod.raw.raw_orders FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.418222 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:41:06.420235 [debug] [Thread-7 (]: SQL status: OK in 0.008 seconds
[0m16:41:06.439232 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:41:06.435233 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:41:06.437233 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.shippers"} */
truncate table "prod"."raw"."shippers"
[0m16:41:06.438232 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:06.432232 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:06.455585 [debug] [Thread-8 (]: SQL status: OK in 0.023 seconds
[0m16:41:06.441233 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m16:41:06.444233 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:41:06.451583 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:41:06.456583 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:41:06.457584 [debug] [Thread-5 (]: SQL status: OK in 0.022 seconds
[0m16:41:06.458584 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m16:41:06.459584 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m16:41:06.460585 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: 
          COPY prod.raw.raw_products FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.462584 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: 
          COPY prod.raw.regions FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\regions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.463584 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.territories"} */
truncate table "prod"."raw"."territories"
[0m16:41:06.464584 [debug] [Thread-5 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m16:41:06.468677 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:41:06.440233 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.suppliers"} */
truncate table "prod"."raw"."suppliers"
[0m16:41:06.501204 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m16:41:06.482208 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m16:41:06.490204 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m16:41:06.491205 [debug] [Thread-6 (]: SQL status: OK in 0.603 seconds
[0m16:41:06.499204 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: 
          COPY prod.raw.shippers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\shippers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.504203 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:41:06.514206 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: 
          COPY prod.raw.territories FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\territories.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.475684 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:41:06.509203 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:41:06.510204 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.regions"
[0m16:41:06.512205 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m16:41:06.513205 [debug] [Thread-6 (]: Writing runtime SQL for node "seed.ci_cd_project.orders"
[0m16:41:06.505202 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m16:41:06.516204 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m16:41:06.517205 [debug] [Thread-5 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m16:41:06.523205 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: COMMIT
[0m16:41:06.529203 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:41:06.530204 [debug] [Thread-8 (]: SQL status: OK in 0.014 seconds
[0m16:41:06.531204 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m16:41:06.532213 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m16:41:06.533208 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m16:41:06.537205 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:41:06.541214 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m16:41:06.542216 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.regions"
[0m16:41:06.543214 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: 
          COPY prod.raw.suppliers FROM 'C:\Users\preben.geier\Documents\dbt-workshop\seeds\suppliers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:41:06.544213 [debug] [Thread-8 (]: Writing runtime SQL for node "seed.ci_cd_project.territories"
[0m16:41:06.546216 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.shippers"
[0m16:41:06.548215 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m16:41:06.549214 [debug] [Thread-6 (]: Using duckdb connection "seed.ci_cd_project.orders"
[0m16:41:06.550214 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: COMMIT
[0m16:41:06.552215 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:06.554216 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m16:41:06.556738 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: COMMIT
[0m16:41:06.559739 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m16:41:06.560739 [debug] [Thread-5 (]: SQL status: OK in 0.013 seconds
[0m16:41:06.562744 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m16:41:06.564739 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:06.567752 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: COMMIT
[0m16:41:06.569753 [debug] [Thread-8 (]: Using duckdb connection "seed.ci_cd_project.territories"
[0m16:41:06.570752 [debug] [Thread-5 (]: On seed.ci_cd_project.raw_orders: Close
[0m16:41:06.571752 [debug] [Thread-7 (]: SQL status: OK in 0.021 seconds
[0m16:41:06.573751 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:41:06.574752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E1D4D40>]}
[0m16:41:06.576752 [debug] [Thread-1 (]: On seed.ci_cd_project.regions: Close
[0m16:41:06.577752 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.shippers"
[0m16:41:06.578752 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: COMMIT
[0m16:41:06.579752 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E163FB0>]}
[0m16:41:06.581260 [debug] [Thread-7 (]: Writing runtime SQL for node "seed.ci_cd_project.suppliers"
[0m16:41:06.582272 [debug] [Thread-6 (]: SQL status: OK in 0.018 seconds
[0m16:41:06.584273 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_products: Close
[0m16:41:06.587272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7DE06A50>]}
[0m16:41:06.589272 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: COMMIT
[0m16:41:06.585271 [info ] [Thread-2 (]: 9 of 64 OK loaded seed file raw.raw_order_items ................................ [[32mINSERT 14[0m in 0.37s]
[0m16:41:06.593273 [debug] [Thread-6 (]: On seed.ci_cd_project.orders: Close
[0m16:41:06.591272 [info ] [Thread-5 (]: 10 of 64 OK loaded seed file raw.raw_orders .................................... [[32mINSERT 10[0m in 0.36s]
[0m16:41:06.594274 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m16:41:06.596271 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7CC75A60>]}
[0m16:41:06.599272 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m16:41:06.602271 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m16:41:06.597271 [info ] [Thread-1 (]: 12 of 64 OK loaded seed file raw.regions ....................................... [[32mINSERT 4[0m in 0.34s]
[0m16:41:06.604271 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7DEC77D0>]}
[0m16:41:06.606272 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:41:06.607272 [debug] [Thread-5 (]: Finished running node seed.ci_cd_project.raw_orders
[0m16:41:06.609272 [debug] [Thread-8 (]: On seed.ci_cd_project.territories: Close
[0m16:41:06.612270 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_nw_customers
[0m16:41:06.611271 [info ] [Thread-3 (]: 11 of 64 OK loaded seed file raw.raw_products .................................. [[32mINSERT 10[0m in 0.35s]
[0m16:41:06.613270 [debug] [Thread-7 (]: Using duckdb connection "seed.ci_cd_project.suppliers"
[0m16:41:06.615269 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.regions
[0m16:41:06.620277 [debug] [Thread-4 (]: On seed.ci_cd_project.shippers: Close
[0m16:41:06.617279 [info ] [Thread-6 (]: 6 of 64 OK loaded seed file raw.orders ......................................... [[32mINSERT 830[0m in 1.71s]
[0m16:41:06.622275 [debug] [Thread-5 (]: Began running node model.ci_cd_project.stg_customers
[0m16:41:06.625274 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A3AFC0>]}
[0m16:41:06.630272 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_products
[0m16:41:06.624272 [info ] [Thread-2 (]: 16 of 64 START sql view model analytics.stg_nw_customers ....................... [RUN]
[0m16:41:06.631272 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: COMMIT
[0m16:41:06.638271 [info ] [Thread-5 (]: 17 of 64 START sql view model analytics.stg_customers .......................... [RUN]
[0m16:41:06.637272 [debug] [Thread-6 (]: Finished running node seed.ci_cd_project.orders
[0m16:41:06.639272 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A08410>]}
[0m16:41:06.642271 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m16:41:06.643271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_nw_customers)
[0m16:41:06.641277 [info ] [Thread-8 (]: 15 of 64 OK loaded seed file raw.territories ................................... [[32mINSERT 53[0m in 0.31s]
[0m16:41:06.650271 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_customers)
[0m16:41:06.653029 [debug] [Thread-6 (]: Began running node model.ci_cd_project.stg_products
[0m16:41:06.654030 [debug] [Thread-7 (]: SQL status: OK in 0.009 seconds
[0m16:41:06.655033 [info ] [Thread-4 (]: 13 of 64 OK loaded seed file raw.shippers ...................................... [[32mINSERT 3[0m in 0.37s]
[0m16:41:06.658028 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_nw_customers
[0m16:41:06.656029 [info ] [Thread-3 (]: 19 of 64 START sql view model analytics.stg_orders ............................. [RUN]
[0m16:41:06.660030 [debug] [Thread-8 (]: Finished running node seed.ci_cd_project.territories
[0m16:41:06.661028 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.stg_customers
[0m16:41:06.633271 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_order_items
[0m16:41:06.664028 [debug] [Thread-7 (]: On seed.ci_cd_project.suppliers: Close
[0m16:41:06.662029 [info ] [Thread-6 (]: 20 of 64 START sql view model analytics.stg_products ........................... [RUN]
[0m16:41:06.704561 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.orders, now model.ci_cd_project.stg_products)
[0m16:41:06.690560 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_nw_customers"
[0m16:41:06.666028 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.shippers
[0m16:41:06.702561 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m16:41:06.705561 [debug] [Thread-6 (]: Began compiling node model.ci_cd_project.stg_products
[0m16:41:06.709566 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_nw_customers
[0m16:41:06.692566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_orders)
[0m16:41:06.722570 [debug] [Thread-6 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m16:41:06.745088 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m16:41:06.703560 [info ] [Thread-1 (]: 18 of 64 START sql view model analytics.stg_order_items ........................ [RUN]
[0m16:41:06.811601 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.stg_customers
[0m16:41:06.819123 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_nw_customers"
[0m16:41:06.827120 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m16:41:06.829137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.regions, now model.ci_cd_project.stg_order_items)
[0m16:41:06.830120 [debug] [Thread-6 (]: Began executing node model.ci_cd_project.stg_products
[0m16:41:06.839727 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m16:41:06.840726 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m16:41:06.851060 [debug] [Thread-6 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m16:41:06.852492 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:06.861490 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m16:41:06.862489 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m16:41:06.864490 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: BEGIN
[0m16:41:06.874070 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m16:41:06.875070 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:06.876073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:06.878068 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m16:41:06.879075 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:06.880067 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_order_items
[0m16:41:06.881578 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:06.882592 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: BEGIN
[0m16:41:06.884529 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:06.895928 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m16:41:06.896927 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:06.898937 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m16:41:06.904808 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:06.923060 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:06.925059 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m16:41:06.926057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:07.131466 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A3A780>]}
[0m16:41:07.133475 [info ] [Thread-7 (]: 14 of 64 OK loaded seed file raw.suppliers ..................................... [[32mINSERT 29[0m in 0.85s]
[0m16:41:07.137466 [debug] [Thread-7 (]: Finished running node seed.ci_cd_project.suppliers
[0m16:41:07.557620 [debug] [Thread-2 (]: SQL status: OK in 0.681 seconds
[0m16:41:07.558620 [debug] [Thread-5 (]: SQL status: OK in 0.677 seconds
[0m16:41:07.560130 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:07.561142 [debug] [Thread-6 (]: SQL status: OK in 0.664 seconds
[0m16:41:07.561142 [debug] [Thread-3 (]: SQL status: OK in 0.657 seconds
[0m16:41:07.562147 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:07.563143 [debug] [Thread-1 (]: SQL status: OK in 0.637 seconds
[0m16:41:07.564141 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */

  
  create view prod.analytics.stg_nw_customers__dbt_tmp as (
    

with source as (
    select * from prod.raw.customers
),

staged as (
    select
        customerid,
        companyname,
        contactname,
        contacttitle,
        address,
        city,
        region,
        postalcode,
        country,
        phone,
        fax
    from source
)

select * from staged
where true
  );

[0m16:41:07.565146 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:07.566145 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:07.567155 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m16:41:07.568161 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:07.570160 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m16:41:07.572156 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:07.573159 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged-- bump
  );

[0m16:41:07.575156 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.raw.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m16:41:07.593343 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:07.594345 [debug] [Thread-5 (]: SQL status: OK in 0.020 seconds
[0m16:41:07.595343 [debug] [Thread-6 (]: SQL status: OK in 0.019 seconds
[0m16:41:07.597344 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */
alter view "prod"."analytics"."stg_nw_customers" rename to stg_nw_customers__dbt_backup
[0m16:41:07.606698 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:07.616186 [debug] [Thread-3 (]: SQL status: OK in 0.020 seconds
[0m16:41:07.616696 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m16:41:07.617712 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:07.619541 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "prod"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m16:41:07.627847 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:07.628903 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m16:41:07.637799 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:07.639806 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view "prod"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m16:41:07.642557 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m16:41:07.643644 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "prod"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m16:41:07.652888 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:07.654180 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "prod"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m16:41:07.664986 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:07.666689 [debug] [Thread-6 (]: SQL status: OK in 0.011 seconds
[0m16:41:07.667700 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */
alter view prod.analytics.stg_nw_customers__dbt_tmp rename to stg_nw_customers
[0m16:41:07.668900 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:41:07.670159 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m16:41:07.678649 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:07.680253 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:41:07.689364 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:07.689887 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m16:41:07.691406 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m16:41:07.701807 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:07.702808 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m16:41:07.704311 [debug] [Thread-5 (]: SQL status: OK in 0.014 seconds
[0m16:41:07.712321 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m16:41:07.714323 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m16:41:07.716200 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m16:41:07.719215 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:41:07.721215 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:07.721215 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:41:07.725408 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:41:07.726421 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:07.727423 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:41:07.728418 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: COMMIT
[0m16:41:07.731846 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:41:07.732907 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:07.734192 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m16:41:07.736507 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:41:07.738086 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:07.739154 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: COMMIT
[0m16:41:07.740285 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:07.741585 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m16:41:07.742399 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:07.742909 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m16:41:07.744966 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m16:41:07.759304 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_nw_customers"
[0m16:41:07.760304 [debug] [Thread-6 (]: SQL status: OK in 0.017 seconds
[0m16:41:07.768462 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m16:41:07.769027 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m16:41:07.770628 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_nw_customers"} */
drop view if exists prod.analytics.stg_nw_customers__dbt_backup cascade
[0m16:41:07.777477 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m16:41:07.779479 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m16:41:07.780477 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:41:07.788565 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m16:41:07.790565 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m16:41:07.797566 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m16:41:07.798566 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:41:07.799565 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m16:41:07.801361 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m16:41:07.802374 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m16:41:07.806374 [debug] [Thread-2 (]: On model.ci_cd_project.stg_nw_customers: Close
[0m16:41:07.806374 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m16:41:07.810374 [debug] [Thread-5 (]: On model.ci_cd_project.stg_customers: Close
[0m16:41:07.812372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E1A7200>]}
[0m16:41:07.815373 [debug] [Thread-6 (]: On model.ci_cd_project.stg_products: Close
[0m16:41:07.816371 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:41:07.817888 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A56660>]}
[0m16:41:07.820957 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:41:07.819900 [info ] [Thread-2 (]: 16 of 64 OK created sql view model analytics.stg_nw_customers .................. [[32mOK[0m in 1.17s]
[0m16:41:07.822005 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A68500>]}
[0m16:41:07.825235 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m16:41:07.830084 [debug] [Thread-1 (]: On model.ci_cd_project.stg_order_items: Close
[0m16:41:07.826816 [info ] [Thread-5 (]: 17 of 64 OK created sql view model analytics.stg_customers ..................... [[32mOK[0m in 1.17s]
[0m16:41:07.831696 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_nw_customers
[0m16:41:07.832989 [info ] [Thread-6 (]: 20 of 64 OK created sql view model analytics.stg_products ...................... [[32mOK[0m in 1.12s]
[0m16:41:07.834737 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80A3ABD0>]}
[0m16:41:07.835792 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.stg_customers
[0m16:41:07.838087 [debug] [Thread-6 (]: Finished running node model.ci_cd_project.stg_products
[0m16:41:07.841276 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:41:07.842727 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:41:07.844895 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:41:07.839659 [info ] [Thread-3 (]: 19 of 64 OK created sql view model analytics.stg_orders ........................ [[32mOK[0m in 1.14s]
[0m16:41:07.846497 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:41:07.847592 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:41:07.843794 [info ] [Thread-8 (]: 21 of 64 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:41:07.849216 [debug] [Thread-6 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:41:07.847037 [info ] [Thread-4 (]: 22 of 64 START test not_null_stg_customers_email ............................... [RUN]
[0m16:41:07.851786 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m16:41:07.849216 [info ] [Thread-7 (]: 23 of 64 START test not_null_stg_customers_first_name .......................... [RUN]
[0m16:41:07.855030 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.territories, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:41:07.852784 [info ] [Thread-2 (]: 24 of 64 START test not_null_stg_customers_last_name ........................... [RUN]
[0m16:41:07.857570 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.shippers, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m16:41:07.854317 [info ] [Thread-5 (]: 25 of 64 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:41:07.859350 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:41:07.860950 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.suppliers, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m16:41:07.856342 [info ] [Thread-6 (]: 26 of 64 START test unique_stg_customers_email ................................. [RUN]
[0m16:41:07.862562 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:41:07.863634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_nw_customers, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m16:41:07.864694 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:41:07.865492 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m16:41:07.867605 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:41:07.869177 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m16:41:07.866293 [info ] [Thread-3 (]: 27 of 64 START test not_null_stg_products_cost ................................. [RUN]
[0m16:41:07.895162 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:41:07.907489 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:41:07.909085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80BCFE30>]}
[0m16:41:07.919958 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:41:07.921559 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:41:07.932689 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:41:07.933688 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:41:07.934691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m16:41:07.944724 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:41:07.946720 [info ] [Thread-1 (]: 18 of 64 OK created sql view model analytics.stg_order_items ................... [[32mOK[0m in 1.08s]
[0m16:41:07.965359 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:41:07.980947 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:41:07.982026 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:41:07.983085 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:41:07.984341 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:41:07.985382 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:41:07.987226 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_order_items
[0m16:41:08.026493 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:41:08.035967 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:41:08.043078 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:41:08.049654 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:41:08.050650 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:41:08.051662 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:41:08.053656 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:41:08.053656 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:41:08.058661 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:41:08.067846 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:41:08.056652 [info ] [Thread-1 (]: 28 of 64 START test not_null_stg_products_price ................................ [RUN]
[0m16:41:08.068933 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:41:08.075977 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:41:08.076972 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:41:08.085866 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:41:08.087865 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:41:08.088865 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m16:41:08.196523 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:41:08.197514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m16:41:08.198516 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m16:41:08.200523 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m16:41:08.201516 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:08.203514 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:41:08.204513 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:41:08.206650 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:41:08.207900 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:08.208918 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:41:08.210918 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:08.221774 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:41:08.222767 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:41:08.223766 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m16:41:08.224765 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m16:41:08.225765 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m16:41:08.226765 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m16:41:08.227767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:08.228769 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:08.229770 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:08.230767 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:08.231769 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:41:08.237147 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:41:08.242142 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:41:08.243142 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m16:41:08.244142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:08.459196 [debug] [Thread-8 (]: SQL status: OK in 0.249 seconds
[0m16:41:08.460197 [debug] [Thread-4 (]: SQL status: OK in 0.259 seconds
[0m16:41:08.461196 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:41:08.462199 [debug] [Thread-6 (]: SQL status: OK in 0.233 seconds
[0m16:41:08.463197 [debug] [Thread-7 (]: SQL status: OK in 0.256 seconds
[0m16:41:08.464201 [debug] [Thread-2 (]: SQL status: OK in 0.236 seconds
[0m16:41:08.465198 [debug] [Thread-5 (]: SQL status: OK in 0.235 seconds
[0m16:41:08.466199 [debug] [Thread-3 (]: SQL status: OK in 0.235 seconds
[0m16:41:08.466199 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m16:41:08.467432 [debug] [Thread-1 (]: SQL status: OK in 0.223 seconds
[0m16:41:08.468431 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.469443 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m16:41:08.469443 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m16:41:08.470458 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m16:41:08.471446 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m16:41:08.472441 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m16:41:08.473440 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from prod.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.474445 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m16:41:08.476439 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:08.477444 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from prod.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.478439 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from prod.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.479443 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:08.480438 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from prod.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.481441 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m16:41:08.482444 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from prod.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m16:41:08.495791 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:41:08.497800 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m16:41:08.497800 [debug] [Thread-6 (]: SQL status: OK in 0.015 seconds
[0m16:41:08.498792 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m16:41:08.499791 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m16:41:08.500762 [debug] [Thread-7 (]: SQL status: OK in 0.017 seconds
[0m16:41:08.501773 [debug] [Thread-5 (]: SQL status: OK in 0.017 seconds
[0m16:41:08.504772 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m16:41:08.507772 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m16:41:08.508769 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:41:08.511768 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m16:41:08.513774 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m16:41:08.516771 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m16:41:08.519790 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m16:41:08.520786 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:41:08.522789 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:41:08.524776 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m16:41:08.526775 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m16:41:08.527773 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m16:41:08.529789 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m16:41:08.530773 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m16:41:08.532776 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m16:41:08.534773 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m16:41:08.536770 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m16:41:08.533770 [info ] [Thread-8 (]: 21 of 64 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.68s]
[0m16:41:08.537770 [debug] [Thread-6 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m16:41:08.538774 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m16:41:08.539771 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m16:41:08.540771 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m16:41:08.541770 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m16:41:08.542771 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m16:41:08.544771 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:41:08.543776 [info ] [Thread-4 (]: 22 of 64 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.69s]
[0m16:41:08.546784 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m16:41:08.545784 [info ] [Thread-6 (]: 26 of 64 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.68s]
[0m16:41:08.547785 [info ] [Thread-3 (]: 27 of 64 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.61s]
[0m16:41:08.551782 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:41:08.548779 [info ] [Thread-2 (]: 24 of 64 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.69s]
[0m16:41:08.553781 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m16:41:08.549784 [info ] [Thread-7 (]: 23 of 64 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.69s]
[0m16:41:08.551782 [info ] [Thread-5 (]: 25 of 64 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.69s]
[0m16:41:08.555781 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m16:41:08.557790 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m16:41:08.558785 [info ] [Thread-8 (]: 29 of 64 START test not_null_stg_products_product_id ........................... [RUN]
[0m16:41:08.561309 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m16:41:08.562310 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:41:08.564308 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m16:41:08.567412 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m16:41:08.568457 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:41:08.565309 [info ] [Thread-1 (]: 28 of 64 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.37s]
[0m16:41:08.570469 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:41:08.571466 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m16:41:08.572465 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:41:08.574467 [debug] [Thread-7 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:41:08.575469 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:41:08.573469 [info ] [Thread-4 (]: 30 of 64 START test unique_stg_products_product_id ............................. [RUN]
[0m16:41:08.578466 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m16:41:08.577466 [info ] [Thread-6 (]: 31 of 64 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m16:41:08.580468 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:41:08.579470 [info ] [Thread-3 (]: 32 of 64 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:41:08.582473 [info ] [Thread-2 (]: 33 of 64 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m16:41:08.582473 [info ] [Thread-7 (]: 34 of 64 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m16:41:08.585984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m16:41:08.583975 [info ] [Thread-5 (]: 35 of 64 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:41:08.586981 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:41:08.587984 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m16:41:08.598983 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:41:08.599987 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:41:08.601985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m16:41:08.602990 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m16:41:08.603988 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:41:08.604986 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m16:41:08.606993 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:41:08.605986 [info ] [Thread-1 (]: 36 of 64 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m16:41:08.607991 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:41:08.608988 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:41:08.609990 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:41:08.619993 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:41:08.620985 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:41:08.629988 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:41:08.633985 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:41:08.634985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m16:41:08.643985 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:41:08.658987 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:41:08.677997 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:41:08.687521 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:41:08.693521 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:41:08.695526 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:41:08.697523 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:41:08.699530 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:41:08.703796 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:41:08.714797 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:41:08.715798 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:41:08.716797 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:41:08.718450 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:41:08.724458 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:41:08.729456 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:41:08.735590 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:41:08.736589 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:41:08.741590 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:41:08.746591 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:41:08.750589 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:41:08.752589 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:41:08.754589 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m16:41:08.757597 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:41:08.765591 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:41:08.766591 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:41:08.768598 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:41:08.769609 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:08.769609 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m16:41:08.771048 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m16:41:08.772058 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:41:08.774060 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:41:08.775064 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:41:08.776057 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m16:41:08.777056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:08.778061 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:41:08.779057 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:08.780057 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m16:41:08.780057 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:41:08.781056 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:41:08.782057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:08.782057 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m16:41:08.783566 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:08.784202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:08.785212 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:08.786213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:09.048506 [debug] [Thread-8 (]: SQL status: OK in 0.279 seconds
[0m16:41:09.049507 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m16:41:09.050835 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.052262 [debug] [Thread-2 (]: SQL status: OK in 0.270 seconds
[0m16:41:09.053256 [debug] [Thread-6 (]: SQL status: OK in 0.274 seconds
[0m16:41:09.054253 [debug] [Thread-4 (]: SQL status: OK in 0.277 seconds
[0m16:41:09.054253 [debug] [Thread-7 (]: SQL status: OK in 0.271 seconds
[0m16:41:09.056253 [debug] [Thread-5 (]: SQL status: OK in 0.270 seconds
[0m16:41:09.057262 [debug] [Thread-3 (]: SQL status: OK in 0.272 seconds
[0m16:41:09.057262 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m16:41:09.058253 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m16:41:09.059254 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m16:41:09.060253 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m16:41:09.061263 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m16:41:09.062268 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m16:41:09.062268 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m16:41:09.063262 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:41:09.064261 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m16:41:09.065262 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from prod.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.066264 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.069805 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m16:41:09.070807 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:09.070807 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from prod.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from prod.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.071806 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:09.072807 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.073807 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.077338 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m16:41:09.079343 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:09.081336 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:41:09.082334 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m16:41:09.084542 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m16:41:09.085554 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:41:09.086553 [debug] [Thread-5 (]: SQL status: OK in 0.008 seconds
[0m16:41:09.089552 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m16:41:09.093553 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m16:41:09.094557 [debug] [Thread-7 (]: SQL status: OK in 0.016 seconds
[0m16:41:09.097552 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m16:41:09.097552 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m16:41:09.102050 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:41:09.098556 [info ] [Thread-8 (]: 29 of 64 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.53s]
[0m16:41:09.105034 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:41:09.106040 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m16:41:09.108037 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m16:41:09.111035 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m16:41:09.113035 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m16:41:09.116033 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m16:41:09.117367 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m16:41:09.119374 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:41:09.121371 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m16:41:09.123371 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m16:41:09.123371 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m16:41:09.124375 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m16:41:09.125371 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m16:41:09.126371 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:41:09.128376 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m16:41:09.128376 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:41:09.130369 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:41:09.129375 [info ] [Thread-2 (]: 33 of 64 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.53s]
[0m16:41:09.132369 [debug] [Thread-7 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m16:41:09.131370 [info ] [Thread-4 (]: 30 of 64 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.55s]
[0m16:41:09.132369 [info ] [Thread-6 (]: 31 of 64 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.54s]
[0m16:41:09.135369 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m16:41:09.133388 [info ] [Thread-8 (]: 37 of 64 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m16:41:09.138372 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m16:41:09.136373 [info ] [Thread-3 (]: 32 of 64 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.54s]
[0m16:41:09.139368 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m16:41:09.137373 [info ] [Thread-5 (]: 35 of 64 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.53s]
[0m16:41:09.141370 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m16:41:09.140390 [info ] [Thread-7 (]: 34 of 64 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.54s]
[0m16:41:09.142372 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m16:41:09.143385 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:41:09.144371 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m16:41:09.145386 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:41:09.146374 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m16:41:09.147386 [debug] [Thread-6 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:41:09.149387 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m16:41:09.151371 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:41:09.150369 [info ] [Thread-1 (]: 36 of 64 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.52s]
[0m16:41:09.153374 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:41:09.152375 [info ] [Thread-2 (]: 38 of 64 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m16:41:09.156369 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:41:09.155369 [info ] [Thread-4 (]: 39 of 64 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m16:41:09.157367 [info ] [Thread-6 (]: 40 of 64 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m16:41:09.198912 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:41:09.199905 [debug] [Thread-7 (]: Began running node model.ci_cd_project.dim_customers
[0m16:41:09.201905 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m16:41:09.203904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m16:41:09.205903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m16:41:09.202906 [info ] [Thread-3 (]: 41 of 64 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m16:41:09.224903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m16:41:09.211903 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:41:09.231903 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:41:09.223902 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:41:09.225902 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:41:09.207909 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m16:41:09.221905 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:41:09.255906 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:41:09.204903 [info ] [Thread-5 (]: 42 of 64 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m16:41:09.267904 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:41:09.282919 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:41:09.287444 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:41:09.289445 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m16:41:09.294441 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:41:09.208904 [info ] [Thread-7 (]: 43 of 64 START sql table model analytics.dim_customers ......................... [RUN]
[0m16:41:09.296443 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:41:09.298442 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:41:09.300449 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.ci_cd_project.dim_customers)
[0m16:41:09.302783 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m16:41:09.306783 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:41:09.307784 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:41:09.316776 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:41:09.317774 [debug] [Thread-7 (]: Began compiling node model.ci_cd_project.dim_customers
[0m16:41:09.322779 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:41:09.324773 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:41:09.325773 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:09.331774 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:41:09.337774 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:41:09.343773 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:41:09.353775 [debug] [Thread-7 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m16:41:09.360775 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:41:09.363778 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:41:09.372788 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:41:09.375791 [debug] [Thread-7 (]: Began executing node model.ci_cd_project.dim_customers
[0m16:41:09.377787 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:41:09.378786 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:41:09.380796 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:41:09.395305 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:41:09.417680 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m16:41:09.418755 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:41:09.444161 [debug] [Thread-7 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m16:41:09.445162 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m16:41:09.446164 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m16:41:09.447161 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m16:41:09.447161 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:09.448164 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m16:41:09.449161 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:09.450164 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:09.451200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:09.705049 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:09.706042 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.707047 [debug] [Thread-8 (]: SQL status: OK in 0.382 seconds
[0m16:41:09.708047 [debug] [Thread-4 (]: SQL status: OK in 0.260 seconds
[0m16:41:09.709036 [debug] [Thread-2 (]: SQL status: OK in 0.260 seconds
[0m16:41:09.710030 [debug] [Thread-6 (]: SQL status: OK in 0.260 seconds
[0m16:41:09.711035 [debug] [Thread-3 (]: SQL status: OK in 0.260 seconds
[0m16:41:09.712033 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m16:41:09.713029 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m16:41:09.714028 [debug] [Thread-5 (]: SQL status: OK in 0.009 seconds
[0m16:41:09.714028 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m16:41:09.716031 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m16:41:09.717030 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m16:41:09.717684 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m16:41:09.718715 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:09.719697 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.720706 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m16:41:09.720706 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.721721 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.722705 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from prod.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from prod.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.723717 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from prod.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from prod.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:41:09.725711 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:09.726712 [debug] [Thread-7 (]: SQL status: OK in 0.009 seconds
[0m16:41:09.729705 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m16:41:09.730703 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:09.732710 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.733706 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:41:09.737235 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m16:41:09.741229 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m16:41:09.742229 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m16:41:09.743228 [debug] [Thread-5 (]: SQL status: OK in 0.011 seconds
[0m16:41:09.744233 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers as c
left join customer_metrics as cm on c.customer_id = cm.customer_id
    );
  
  
[0m16:41:09.744233 [debug] [Thread-6 (]: SQL status: OK in 0.016 seconds
[0m16:41:09.748229 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m16:41:09.751230 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m16:41:09.752231 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m16:41:09.755228 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m16:41:09.758231 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m16:41:09.759240 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m16:41:09.761228 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m16:41:09.764229 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m16:41:09.764229 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m16:41:09.767358 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m16:41:09.768378 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m16:41:09.770398 [debug] [Thread-7 (]: SQL status: OK in 0.015 seconds
[0m16:41:09.770398 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m16:41:09.769392 [info ] [Thread-8 (]: 37 of 64 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.63s]
[0m16:41:09.773389 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m16:41:09.774388 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m16:41:09.772394 [info ] [Thread-4 (]: 39 of 64 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.57s]
[0m16:41:09.775395 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m16:41:09.781393 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.783918 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m16:41:09.782393 [info ] [Thread-2 (]: 38 of 64 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.58s]
[0m16:41:09.785929 [debug] [Thread-6 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m16:41:09.784931 [info ] [Thread-3 (]: 41 of 64 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.56s]
[0m16:41:09.787928 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m16:41:09.790930 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "prod"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m16:41:09.789931 [info ] [Thread-5 (]: 42 of 64 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.50s]
[0m16:41:09.793930 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m16:41:09.796928 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m16:41:09.794935 [info ] [Thread-6 (]: 40 of 64 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.59s]
[0m16:41:09.798928 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m16:41:09.801024 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m16:41:09.803066 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m16:41:09.805065 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_products
[0m16:41:09.811064 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.813066 [debug] [Thread-4 (]: Began running node model.ci_cd_project.fct_orders
[0m16:41:09.812064 [info ] [Thread-1 (]: 44 of 64 START sql table model analytics.dim_products .......................... [RUN]
[0m16:41:09.814065 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m16:41:09.815066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now model.ci_cd_project.dim_products)
[0m16:41:09.814065 [info ] [Thread-4 (]: 45 of 64 START sql table model analytics.fct_orders ............................ [RUN]
[0m16:41:09.816065 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_products
[0m16:41:09.817065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now model.ci_cd_project.fct_orders)
[0m16:41:09.819086 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m16:41:09.825068 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m16:41:09.826064 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.fct_orders
[0m16:41:09.836460 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:41:09.849450 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m16:41:09.850593 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.851596 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m16:41:09.857131 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_products
[0m16:41:09.866124 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m16:41:09.868277 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.fct_orders
[0m16:41:09.869285 [debug] [Thread-7 (]: SQL status: OK in 0.014 seconds
[0m16:41:09.875286 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m16:41:09.880288 [debug] [Thread-7 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m16:41:09.881286 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m16:41:09.883897 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:09.884939 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:09.886935 [debug] [Thread-7 (]: SQL status: OK in 0.005 seconds
[0m16:41:09.886935 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: BEGIN
[0m16:41:09.887935 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m16:41:09.890935 [debug] [Thread-7 (]: On model.ci_cd_project.dim_customers: Close
[0m16:41:09.890935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:09.891942 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:09.950988 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA80AC66C0>]}
[0m16:41:09.953003 [info ] [Thread-7 (]: 43 of 64 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.65s]
[0m16:41:09.955004 [debug] [Thread-7 (]: Finished running node model.ci_cd_project.dim_customers
[0m16:41:09.956002 [debug] [Thread-3 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:41:09.957004 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:41:09.958009 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:41:09.960006 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:41:09.959001 [info ] [Thread-3 (]: 46 of 64 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m16:41:09.961999 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:41:09.964002 [debug] [Thread-7 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:41:09.962998 [info ] [Thread-5 (]: 47 of 64 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m16:41:09.964999 [info ] [Thread-8 (]: 48 of 64 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m16:41:09.968006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m16:41:09.965997 [info ] [Thread-6 (]: 49 of 64 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m16:41:09.970029 [info ] [Thread-2 (]: 50 of 64 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m16:41:09.973019 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:41:09.971026 [info ] [Thread-7 (]: 51 of 64 START test unique_dim_customers_customer_id ........................... [RUN]
[0m16:41:09.974017 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m16:41:09.974017 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:41:09.975018 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m16:41:09.976024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m16:41:09.977017 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:41:09.978017 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m16:41:10.256895 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:41:10.000540 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:41:10.002540 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:41:10.003539 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:41:10.013539 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:41:09.979015 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:41:10.258895 [debug] [Thread-1 (]: SQL status: OK in 0.368 seconds
[0m16:41:10.259896 [debug] [Thread-4 (]: SQL status: OK in 0.368 seconds
[0m16:41:10.270633 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:41:10.291036 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:41:10.294032 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:41:10.304931 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:41:10.305929 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:41:10.306929 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:10.307930 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:10.308930 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:41:10.317354 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products as p
left join product_metrics as pm on p.product_id = pm.product_id
    );
  
  
[0m16:41:10.318739 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:41:10.321738 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:41:10.322737 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:41:10.323740 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:41:10.324741 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:41:10.326742 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items as oi
    inner join orders as o on oi.order_id = o.order_id
    inner join products as p on oi.product_id = p.product_id
    inner join customers as c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m16:41:10.333399 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:41:10.341101 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:41:10.346103 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:41:10.373016 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m16:41:10.362335 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:41:10.363335 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m16:41:10.370016 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:41:10.354338 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:41:10.375033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:10.383528 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:41:10.384543 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:41:10.396542 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m16:41:10.391542 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:41:10.394540 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:41:10.404632 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:10.387540 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:10.397540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:10.398541 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:41:10.403631 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m16:41:10.395540 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m16:41:10.405632 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table "prod"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m16:41:10.408632 [debug] [Thread-7 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m16:41:10.409632 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:41:10.410632 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m16:41:10.411632 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m16:41:10.427340 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m16:41:10.413632 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m16:41:10.414632 [debug] [Thread-5 (]: SQL status: OK in 0.010 seconds
[0m16:41:10.415633 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:10.417328 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m16:41:10.418341 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:41:10.426340 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:10.428356 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from prod.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m16:41:10.412632 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:10.429340 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from prod.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m16:41:10.430345 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:41:10.432338 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:10.452781 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:10.453783 [debug] [Thread-7 (]: SQL status: OK in 0.038 seconds
[0m16:41:10.454782 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "prod"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m16:41:10.457783 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:10.460783 [debug] [Thread-6 (]: SQL status: OK in 0.048 seconds
[0m16:41:10.461783 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:10.463786 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m16:41:10.464783 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m16:41:10.473610 [debug] [Thread-7 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:10.465782 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:41:10.470610 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m16:41:10.471609 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m16:41:10.464783 [debug] [Thread-8 (]: SQL status: OK in 0.033 seconds
[0m16:41:10.475608 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:41:10.476610 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:10.487266 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m16:41:10.490266 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m16:41:10.491266 [debug] [Thread-7 (]: SQL status: OK in 0.010 seconds
[0m16:41:10.492271 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from prod.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m16:41:10.493266 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m16:41:10.494268 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m16:41:10.498267 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:41:10.501590 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:41:10.503590 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m16:41:10.505590 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m16:41:10.509590 [debug] [Thread-7 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m16:41:10.519257 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:10.520260 [debug] [Thread-6 (]: SQL status: OK in 0.010 seconds
[0m16:41:10.521258 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from prod.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m16:41:10.522257 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:10.525258 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m16:41:10.527257 [debug] [Thread-3 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m16:41:10.528257 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m16:41:10.530258 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m16:41:10.526258 [info ] [Thread-2 (]: 50 of 64 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.55s]
[0m16:41:10.535259 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m16:41:10.536485 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m16:41:10.537487 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:41:10.538487 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m16:41:10.540487 [debug] [Thread-7 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m16:41:10.542487 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m16:41:10.543487 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:41:10.545490 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m16:41:10.551613 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m16:41:10.552613 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:41:10.561616 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:41:10.562615 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m16:41:10.571150 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m16:41:10.574148 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m16:41:10.575150 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:10.577152 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m16:41:10.578150 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m16:41:10.579150 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m16:41:10.584687 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:41:10.588682 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: Close
[0m16:41:10.590679 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:41:10.591677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA82AA3530>]}
[0m16:41:10.598676 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m16:41:10.601676 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m16:41:10.539487 [info ] [Thread-3 (]: 46 of 64 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.57s]
[0m16:41:10.606679 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m16:41:10.547487 [info ] [Thread-5 (]: 47 of 64 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.57s]
[0m16:41:10.614677 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:41:10.616676 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m16:41:10.620677 [debug] [Thread-4 (]: On model.ci_cd_project.fct_orders: Close
[0m16:41:10.553614 [info ] [Thread-7 (]: 51 of 64 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.58s]
[0m16:41:10.642678 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m16:41:10.576149 [info ] [Thread-6 (]: 49 of 64 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.60s]
[0m16:41:10.645562 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m16:41:10.582154 [info ] [Thread-8 (]: 48 of 64 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.61s]
[0m16:41:10.600677 [info ] [Thread-1 (]: 44 of 64 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.78s]
[0m16:41:10.647702 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m16:41:10.648766 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_products
[0m16:41:10.650339 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:41:10.652283 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:41:10.653329 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:41:10.655588 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:41:10.656777 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:41:10.658095 [debug] [Thread-8 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:41:10.654446 [info ] [Thread-2 (]: 52 of 64 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m16:41:10.659157 [info ] [Thread-3 (]: 53 of 64 START test not_null_dim_products_performance_category ................. [RUN]
[0m16:41:10.660227 [info ] [Thread-5 (]: 54 of 64 START test not_null_dim_products_product_id ........................... [RUN]
[0m16:41:10.664903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m16:41:10.661895 [info ] [Thread-7 (]: 55 of 64 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m16:41:10.665959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m16:41:10.667016 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m16:41:10.662807 [info ] [Thread-6 (]: 56 of 64 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m16:41:10.669132 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:41:10.663845 [info ] [Thread-8 (]: 57 of 64 START test unique_dim_products_product_id ............................. [RUN]
[0m16:41:10.697829 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m16:41:10.670258 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m16:41:10.672375 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:41:10.673389 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m16:41:10.696325 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:41:10.671320 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:41:10.698842 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:41:10.700844 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:41:10.713415 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:41:10.713415 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:41:10.726465 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:41:10.737529 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:41:10.761067 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:41:10.763067 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:41:10.765070 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:41:10.777758 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:41:10.778767 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:41:10.789570 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:41:10.792583 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a17d06-8501-4606-8371-dd2fadbaf159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA82AFD910>]}
[0m16:41:10.796118 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:41:10.804034 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:41:10.805030 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:41:10.806029 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:41:10.809030 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:41:10.818032 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:41:10.835564 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m16:41:10.837557 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:10.816030 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:41:10.834557 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m16:41:10.821030 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:41:10.794108 [info ] [Thread-4 (]: 45 of 64 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.97s]
[0m16:41:10.838568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:10.841097 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:41:10.843119 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:41:10.849119 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:41:10.852126 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.fct_orders
[0m16:41:10.853651 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m16:41:10.855650 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:41:10.857159 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:10.859170 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:41:10.860173 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m16:41:10.862171 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:41:10.863173 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:41:10.864173 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m16:41:10.865357 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:10.869953 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:41:10.870955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:10.871955 [debug] [Thread-8 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m16:41:10.872955 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m16:41:10.866170 [info ] [Thread-1 (]: 58 of 64 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m16:41:10.875465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m16:41:10.868176 [info ] [Thread-4 (]: 59 of 64 START test not_null_fct_orders_order_id ............................... [RUN]
[0m16:41:10.876479 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:41:10.877480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m16:41:10.889010 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:41:10.891005 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:41:10.904532 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:41:10.907533 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:41:10.916063 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:41:10.919137 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:41:11.223118 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:41:11.226052 [debug] [Thread-2 (]: SQL status: OK in 0.386 seconds
[0m16:41:11.227676 [debug] [Thread-6 (]: SQL status: OK in 0.370 seconds
[0m16:41:11.228780 [debug] [Thread-7 (]: SQL status: OK in 0.363 seconds
[0m16:41:11.229855 [debug] [Thread-5 (]: SQL status: OK in 0.392 seconds
[0m16:41:11.230727 [debug] [Thread-3 (]: SQL status: OK in 0.360 seconds
[0m16:41:11.231910 [debug] [Thread-8 (]: SQL status: OK in 0.359 seconds
[0m16:41:11.232934 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m16:41:11.234312 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m16:41:11.235370 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m16:41:11.236987 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:41:11.238416 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:41:11.239516 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m16:41:11.240044 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m16:41:11.240576 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m16:41:11.241541 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from prod.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m16:41:11.242599 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from prod.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.243680 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from prod.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.244774 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m16:41:11.245831 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m16:41:11.246898 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.247979 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from prod.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.249068 [debug] [Thread-8 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:11.251859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:11.252862 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:11.254399 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m16:41:11.255922 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m16:41:11.256418 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:41:11.256928 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:41:11.259939 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:41:11.263455 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m16:41:11.264475 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m16:41:11.265470 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:41:11.268451 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m16:41:11.269464 [debug] [Thread-8 (]: SQL status: OK in 0.011 seconds
[0m16:41:11.272463 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m16:41:11.274463 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m16:41:11.277460 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m16:41:11.278461 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m16:41:11.280468 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m16:41:11.280468 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m16:41:11.282545 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m16:41:11.285736 [debug] [Thread-8 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m16:41:11.288420 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m16:41:11.290562 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m16:41:11.293253 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m16:41:11.294329 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.294860 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m16:41:11.296455 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.296993 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m16:41:11.298647 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m16:41:11.300537 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m16:41:11.301682 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m16:41:11.302303 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m16:41:11.303926 [info ] [Thread-6 (]: 56 of 64 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.63s]
[0m16:41:11.306612 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:11.306079 [info ] [Thread-7 (]: 55 of 64 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.64s]
[0m16:41:11.309158 [debug] [Thread-8 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m16:41:11.309158 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:41:11.308159 [info ] [Thread-5 (]: 54 of 64 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.64s]
[0m16:41:11.311158 [info ] [Thread-2 (]: 52 of 64 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.65s]
[0m16:41:11.314783 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m16:41:11.319196 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m16:41:11.320756 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m16:41:11.313164 [info ] [Thread-3 (]: 53 of 64 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.65s]
[0m16:41:11.324147 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m16:41:11.327751 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m16:41:11.322352 [info ] [Thread-8 (]: 57 of 64 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.62s]
[0m16:41:11.329110 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m16:41:11.330234 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:41:11.331842 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:41:11.333986 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m16:41:11.336337 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m16:41:11.337438 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:41:11.339441 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m16:41:11.341618 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m16:41:11.342157 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:41:11.343219 [info ] [Thread-6 (]: 60 of 64 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m16:41:11.345507 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m16:41:11.346560 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:41:11.344684 [info ] [Thread-7 (]: 61 of 64 START test not_null_fct_orders_product_id ............................. [RUN]
[0m16:41:11.347664 [info ] [Thread-5 (]: 62 of 64 START test not_null_fct_orders_quantity ............................... [RUN]
[0m16:41:11.348761 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m16:41:11.351379 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m16:41:11.349829 [info ] [Thread-2 (]: 63 of 64 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m16:41:11.353379 [info ] [Thread-1 (]: 58 of 64 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.48s]
[0m16:41:11.355380 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m16:41:11.356869 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m16:41:11.354378 [info ] [Thread-3 (]: 64 of 64 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m16:41:11.358454 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:41:11.359754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m16:41:11.361342 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m16:41:11.362416 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:41:11.364083 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:41:11.365651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m16:41:11.376826 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:41:11.377827 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:41:11.379826 [info ] [Thread-4 (]: 59 of 64 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.50s]
[0m16:41:11.390348 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:41:11.400350 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:41:11.403653 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:41:11.414652 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:41:11.417592 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m16:41:11.429076 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:41:11.430207 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:41:11.438677 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:41:11.440880 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:41:11.442090 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:41:11.443219 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:41:11.451466 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:41:11.456825 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:41:11.462479 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:41:11.463690 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:41:11.465445 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m16:41:11.466694 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:41:11.467836 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m16:41:11.476361 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:41:11.477451 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:41:11.478518 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:41:11.479629 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m16:41:11.481182 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:41:11.481688 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m16:41:11.483313 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m16:41:11.484833 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m16:41:11.485809 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:41:11.486872 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m16:41:11.487944 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:11.489011 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m16:41:11.490602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:11.743676 [debug] [Thread-6 (]: SQL status: OK in 0.275 seconds
[0m16:41:11.744676 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m16:41:11.744676 [debug] [Thread-7 (]: SQL status: OK in 0.258 seconds
[0m16:41:11.745675 [debug] [Thread-3 (]: SQL status: OK in 0.255 seconds
[0m16:41:11.745675 [debug] [Thread-5 (]: SQL status: OK in 0.263 seconds
[0m16:41:11.746676 [debug] [Thread-2 (]: SQL status: OK in 0.259 seconds
[0m16:41:11.747680 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.748678 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m16:41:11.748678 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m16:41:11.750308 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m16:41:11.750830 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m16:41:11.751835 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.752835 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:41:11.752835 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m16:41:11.753835 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.754851 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from prod.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m16:41:11.757839 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m16:41:11.758834 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:41:11.759833 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m16:41:11.759833 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m16:41:11.761843 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m16:41:11.761843 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:11.764849 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m16:41:11.767309 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m16:41:11.769316 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m16:41:11.770334 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m16:41:11.772327 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m16:41:11.774327 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m16:41:11.775341 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m16:41:11.777341 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m16:41:11.778332 [debug] [Thread-3 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m16:41:11.780323 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m16:41:11.778332 [info ] [Thread-6 (]: 60 of 64 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.43s]
[0m16:41:11.781326 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m16:41:11.781326 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m16:41:11.783740 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m16:41:11.782325 [info ] [Thread-3 (]: 64 of 64 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.42s]
[0m16:41:11.784593 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m16:41:11.785604 [info ] [Thread-7 (]: 61 of 64 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.43s]
[0m16:41:11.787628 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m16:41:11.786602 [info ] [Thread-5 (]: 62 of 64 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.43s]
[0m16:41:11.789602 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m16:41:11.790602 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m16:41:11.794605 [info ] [Thread-2 (]: 63 of 64 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.44s]
[0m16:41:11.795607 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m16:41:11.799605 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:11.799605 [debug] [MainThread]: On master: BEGIN
[0m16:41:11.800605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:11.990453 [debug] [MainThread]: SQL status: OK in 0.190 seconds
[0m16:41:11.991453 [debug] [MainThread]: On master: COMMIT
[0m16:41:11.991453 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:11.992451 [debug] [MainThread]: On master: COMMIT
[0m16:41:11.993452 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:11.993452 [debug] [MainThread]: On master: Close
[0m16:41:11.999470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:12.000255 [debug] [MainThread]: Connection 'list_prod' was properly closed.
[0m16:41:12.000645 [debug] [MainThread]: Connection 'list_prod' was properly closed.
[0m16:41:12.001650 [debug] [MainThread]: Connection 'list_prod_raw' was properly closed.
[0m16:41:12.001650 [debug] [MainThread]: Connection 'list_prod_analytics' was properly closed.
[0m16:41:12.002651 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b' was properly closed.
[0m16:41:12.002651 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m16:41:12.003653 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m16:41:12.003653 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m16:41:12.003653 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m16:41:12.004652 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94' was properly closed.
[0m16:41:12.004652 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m16:41:12.005652 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m16:41:12.006652 [info ] [MainThread]: 
[0m16:41:12.007650 [info ] [MainThread]: Finished running 15 seeds, 5 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m16:41:12.021650 [debug] [MainThread]: Command end result
[0m16:41:12.206645 [info ] [MainThread]: 
[0m16:41:12.207619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:12.208614 [info ] [MainThread]: 
[0m16:41:12.209615 [info ] [MainThread]: Done. PASS=64 WARN=0 ERROR=0 SKIP=0 TOTAL=64
[0m16:41:12.212635 [debug] [MainThread]: Command `dbt build` succeeded at 16:41:12.212635 after 12.54 seconds
[0m16:41:12.213613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA79A37440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA77D680B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7CA7D1F0>]}
[0m16:41:13.762974 [debug] [MainThread]: Flushing usage events
[0m09:36:06.804792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F1090470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F10BB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F10BA780>]}


============================== 09:36:06.813676 | 7d823066-968c-4013-bad7-6f27cd1c45e8 ==============================
[0m09:36:06.813676 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:36:06.815675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:modified+ --state ./state --target pr --vars schema_id: pr_99', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:07.316898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F20516A0>]}
[0m09:36:07.396388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F21118E0>]}
[0m09:36:07.400385 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m09:36:08.075264 [debug] [MainThread]: checksum: cd9b35727ad82087b7cf24daaccec6f1e0f7f1b6ba394ce7eaf46ff9c359f6f8, vars: {'schema_id': 'pr_99'}, profile: , target: pr, version: 1.8.9
[0m09:36:08.234700 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:36:08.235704 [debug] [MainThread]: previous checksum: cd9b35727ad82087b7cf24daaccec6f1e0f7f1b6ba394ce7eaf46ff9c359f6f8, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m09:36:08.236631 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:36:08.237616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F10E8110>]}
[0m09:36:12.905300 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:36:12.906304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F2FDBB90>]}
[0m09:36:13.475836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m09:36:13.476833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m09:36:13.476833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m09:36:13.476833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m09:36:13.477833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m09:36:13.477833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m09:36:13.478833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m09:36:13.478833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m09:36:13.478833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m09:36:13.479833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m09:36:13.479833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m09:36:13.479833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m09:36:13.480833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m09:36:13.480833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m09:36:13.481833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m09:36:13.481833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m09:36:13.481833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m09:36:13.482833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m09:36:13.482833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m09:36:13.482833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m09:36:13.483833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m09:36:13.483833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m09:36:13.483833 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m09:36:13.484836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m09:36:13.484836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m09:36:13.484836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m09:36:13.485836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m09:36:13.485836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m09:36:13.621285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F373E000>]}
[0m09:36:13.864588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d823066-968c-4013-bad7-6f27cd1c45e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F2F2FEC0>]}
[0m09:36:13.865591 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 858 macros
[0m09:36:13.866587 [error] [MainThread]: Encountered an error:
Runtime Error
  Got a state selector method, but no comparison manifest
[0m09:36:13.869597 [debug] [MainThread]: Command `dbt build` failed at 09:36:13.868611 after 7.38 seconds
[0m09:36:13.870588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F10E9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F366A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130F2FBF6B0>]}
[0m09:36:13.870588 [debug] [MainThread]: Flushing usage events
[0m09:36:13.937177 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:37:36.710736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191242D97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019124038F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191229DF8F0>]}


============================== 09:37:36.716250 | fb51abfd-42fa-46c8-be37-1095306dc253 ==============================
[0m09:37:36.716250 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:37:36.717250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:37:36.980548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb51abfd-42fa-46c8-be37-1095306dc253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191243FCFB0>]}
[0m09:37:38.233948 [debug] [MainThread]: Command `dbt clean` succeeded at 09:37:38.233948 after 1.68 seconds
[0m09:37:38.233948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191240BA930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191243ECF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191229DF8F0>]}
[0m09:37:38.234948 [debug] [MainThread]: Flushing usage events
[0m09:37:38.304254 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:37:43.518436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025693C28F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694D96A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694D94260>]}


============================== 09:37:43.527055 | 75fded30-3758-4fb2-8bfe-b02577c9fcc9 ==============================
[0m09:37:43.527055 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:37:43.528211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:37:43.801132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694C716A0>]}
[0m09:37:43.868667 [debug] [MainThread]: Set downloads directory='C:\Users\PREBEN~1.GEI\AppData\Local\Temp\dbt-downloads-f1dxujcr'
[0m09:37:43.869669 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:37:44.627917 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:37:44.629917 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:37:45.410716 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:37:45.421729 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m09:37:46.347469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m09:37:46.353466 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m09:37:47.071252 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m09:37:47.073248 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m09:37:47.074248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256934DFB30>]}
[0m09:37:47.078249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m09:37:47.787458 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m09:37:47.792463 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:37:49.894273 [info ] [MainThread]: Installed from version 1.1.1
[0m09:37:49.895279 [info ] [MainThread]: Updated version available: 1.3.1
[0m09:37:49.896270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256956B1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256956B1280>]}
[0m09:37:49.897269 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m09:37:53.549465 [info ] [MainThread]: Installed from version 0.11.0
[0m09:37:53.550462 [info ] [MainThread]: Updated version available: 1.0.2
[0m09:37:53.550462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694F89730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694F8AA80>]}
[0m09:37:53.551462 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m09:37:56.687584 [info ] [MainThread]: Installed from version 0.10.3
[0m09:37:56.688594 [info ] [MainThread]: Updated version available: 0.10.4
[0m09:37:56.690212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002569412D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694F63200>]}
[0m09:37:56.690212 [info ] [MainThread]: Installing calogica/dbt_date
[0m09:37:57.903151 [info ] [MainThread]: Installed from version 0.10.1
[0m09:37:57.904154 [info ] [MainThread]: Up to date!
[0m09:37:57.904154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75fded30-3758-4fb2-8bfe-b02577c9fcc9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025695698710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256956986E0>]}
[0m09:37:57.905152 [info ] [MainThread]: 
[0m09:37:57.905152 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m09:37:57.914155 [debug] [MainThread]: Command `dbt deps` succeeded at 09:37:57.914155 after 14.61 seconds
[0m09:37:57.915163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002569394EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694190B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025694192E10>]}
[0m09:37:57.916152 [debug] [MainThread]: Flushing usage events
[0m09:37:57.925170 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:38:02.815287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107A163AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021079F37D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107A161070>]}


============================== 09:38:02.824289 | b08a13fd-c678-435b-a318-181712ba659f ==============================
[0m09:38:02.824289 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:38:02.825288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt parse --target pr --vars schema_id: pr_99', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:38:03.249731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08a13fd-c678-435b-a318-181712ba659f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107AE0DEB0>]}
[0m09:38:03.331959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08a13fd-c678-435b-a318-181712ba659f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107A194E00>]}
[0m09:38:03.337956 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m09:38:04.098776 [debug] [MainThread]: checksum: cd9b35727ad82087b7cf24daaccec6f1e0f7f1b6ba394ce7eaf46ff9c359f6f8, vars: {'schema_id': 'pr_99'}, profile: , target: pr, version: 1.8.9
[0m09:38:04.103775 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:38:04.104774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b08a13fd-c678-435b-a318-181712ba659f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107A354C20>]}
[0m09:38:08.743710 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:38:08.744710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b08a13fd-c678-435b-a318-181712ba659f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107BD7D970>]}
[0m09:38:09.353504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models\marts\dag\dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m09:38:09.354504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models\marts\dag\dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m09:38:09.355504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models\marts\dag\dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m09:38:09.356509 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models\marts\dag\dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m09:38:09.356509 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models\marts\dag\dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m09:38:09.357505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models\marts\dag\dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m09:38:09.357505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models\marts\dag\dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m09:38:09.358502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models\marts\dag\dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m09:38:09.359502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m09:38:09.359502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models\marts\dag\dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m09:38:09.359502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models\marts\dag\dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m09:38:09.360502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models\marts\dag\dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m09:38:09.360502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models\marts\dag\dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m09:38:09.361502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models\marts\dag\dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m09:38:09.361502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models\marts\documentation\documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m09:38:09.362505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m09:38:09.362505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m09:38:09.363501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models\marts\documentation\documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m09:38:09.364504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models\marts\governance\governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m09:38:09.364504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models\marts\governance\governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m09:38:09.365503 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models\marts\governance\governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m09:38:09.365503 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models\marts\performance\performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m09:38:09.366510 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models\marts\structure\structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m09:38:09.366510 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models\marts\structure\structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m09:38:09.366510 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models\marts\structure\structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m09:38:09.367504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models\marts\structure\structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m09:38:09.367504 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models\marts\tests\testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m09:38:09.368505 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models\marts\tests\testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m09:38:09.569632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b08a13fd-c678-435b-a318-181712ba659f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107BCE4C50>]}
[0m09:38:09.579599 [info ] [MainThread]: Performance info: C:\Users\preben.geier\Documents\dbt-workshop\target\perf_info.json
[0m09:38:09.928345 [debug] [MainThread]: Command `dbt parse` succeeded at 09:38:09.928345 after 7.30 seconds
[0m09:38:09.931903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021079F37D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107BE4FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002107BE4FE30>]}
[0m09:38:09.932955 [debug] [MainThread]: Flushing usage events
[0m09:38:09.994050 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:39:28.470178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278DC6E57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E0B95160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E0B61130>]}


============================== 09:39:28.480180 | a89dd3e7-0318-4f93-8030-13c87df02047 ==============================
[0m09:39:28.480180 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:39:28.481179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s state:modified+ --state .\\state --target pr --vars schema_id: pr_99', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:39:29.000538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a89dd3e7-0318-4f93-8030-13c87df02047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278DF4042C0>]}
[0m09:39:29.118225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a89dd3e7-0318-4f93-8030-13c87df02047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E0B95520>]}
[0m09:39:29.124245 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m09:39:29.975231 [debug] [MainThread]: checksum: cd9b35727ad82087b7cf24daaccec6f1e0f7f1b6ba394ce7eaf46ff9c359f6f8, vars: {'schema_id': 'pr_99'}, profile: , target: pr, version: 1.8.9
[0m09:39:30.698216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:39:30.699216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:39:30.757741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89dd3e7-0318-4f93-8030-13c87df02047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E18CE510>]}
[0m09:39:31.231146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89dd3e7-0318-4f93-8030-13c87df02047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E2625C10>]}
[0m09:39:31.232146 [info ] [MainThread]: Found 8 models, 15 seeds, 41 data tests, 858 macros
[0m09:39:31.233145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89dd3e7-0318-4f93-8030-13c87df02047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E20D5D90>]}
[0m09:39:31.237143 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m09:39:31.238142 [warn ] [MainThread]: No nodes selected!
[0m09:39:31.243183 [debug] [MainThread]: Command `dbt ls` succeeded at 09:39:31.243183 after 3.01 seconds
[0m09:39:31.244148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278DF190E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278DF190CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278DDAF5670>]}
[0m09:39:31.244148 [debug] [MainThread]: Flushing usage events
[0m09:39:31.280226 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:41:29.216083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024881A3F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024881724560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248853B8620>]}


============================== 09:41:29.227088 | 3780bbfd-c44c-41f0-b76a-6b4148d703c1 ==============================
[0m09:41:29.227088 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:41:29.229087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse --target pr --vars schema_id: pr_99', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:41:29.861493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3780bbfd-c44c-41f0-b76a-6b4148d703c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024881D85E50>]}
[0m09:41:29.995103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3780bbfd-c44c-41f0-b76a-6b4148d703c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248859C9640>]}
[0m09:41:30.002621 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m09:41:30.956122 [debug] [MainThread]: checksum: cd9b35727ad82087b7cf24daaccec6f1e0f7f1b6ba394ce7eaf46ff9c359f6f8, vars: {'schema_id': 'pr_99'}, profile: , target: pr, version: 1.8.9
[0m09:41:31.779477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:31.779477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:31.849087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3780bbfd-c44c-41f0-b76a-6b4148d703c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248858FF4D0>]}
[0m09:41:31.857086 [info ] [MainThread]: Performance info: C:\Users\preben.geier\Documents\dbt-workshop\target\perf_info.json
[0m09:41:32.108848 [debug] [MainThread]: Command `dbt parse` succeeded at 09:41:32.108848 after 3.13 seconds
[0m09:41:32.108848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248853B8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024885362CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248833682C0>]}
[0m09:41:32.109815 [debug] [MainThread]: Flushing usage events
[0m09:41:32.138820 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:20:05.985674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019495917230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019499DEFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019499D36480>]}


============================== 10:20:05.999677 | 734167b2-b291-4ca1-b127-f6088e53e027 ==============================
[0m10:20:05.999677 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:20:06.001675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\preben.geier\\Documents\\dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s state:modified+ --defer --state ./', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:06.589884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '734167b2-b291-4ca1-b127-f6088e53e027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019496885FD0>]}
[0m10:20:06.675124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '734167b2-b291-4ca1-b127-f6088e53e027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019499E3ED80>]}
[0m10:20:06.681123 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m10:20:07.560990 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:20:08.433684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:08.434684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:08.512664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '734167b2-b291-4ca1-b127-f6088e53e027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949B487410>]}
[0m10:20:08.770215 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not read WritableManifest at "C:\Users\preben.geier\Documents\dbt-workshop\manifest.json" as JSON: Extra data: line 1 column 4 (char 3)
[0m10:20:08.773220 [debug] [MainThread]: Command `dbt build` failed at 10:20:08.773220 after 3.08 seconds
[0m10:20:08.773220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019495917230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949B0321E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949B032960>]}
[0m10:20:08.774217 [debug] [MainThread]: Flushing usage events
[0m10:20:08.840058 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
