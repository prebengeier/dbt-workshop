[0m12:34:27.468874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097506d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109750b50>]}


============================== 12:34:27.473072 | 909fd906-26cb-4cb5-ba6d-84a2736afee9 ==============================
[0m12:34:27.473072 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:34:27.473615 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt debug --target prod', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m12:34:27.485081 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m12:34:27.485606 [info ] [MainThread]: python version: 3.10.0
[0m12:34:27.485907 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:34:27.486190 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:34:27.490396 [info ] [MainThread]: Using profiles dir at /Users/preben/Documents/dbt-workshop
[0m12:34:27.490714 [info ] [MainThread]: Using profiles.yml file at /Users/preben/Documents/dbt-workshop/profiles.yml
[0m12:34:27.491097 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:34:27.606310 [info ] [MainThread]: Configuration:
[0m12:34:27.606742 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:34:27.607039 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:34:27.607316 [info ] [MainThread]: Required dependencies:
[0m12:34:27.607654 [debug] [MainThread]: Executing "git --help"
[0m12:34:27.621092 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:34:27.621884 [debug] [MainThread]: STDERR: "b''"
[0m12:34:27.622218 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:34:27.622538 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:34:27.622840 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:34:27.623115 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m12:34:27.924392 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.52839553, "process_in_blocks": "0", "process_kernel_time": 0.184818, "process_mem_max_rss": "109428736", "process_out_blocks": "0", "process_user_time": 1.417024}
[0m12:34:27.925826 [debug] [MainThread]: Command `dbt debug` failed at 12:34:27.925629 after 0.53 seconds
[0m12:34:27.926736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108268a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109825f90>]}
[0m12:34:27.927570 [debug] [MainThread]: Flushing usage events
[0m12:34:28.460961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:30.073688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b4d90>]}


============================== 12:34:30.077105 | 2b3bf297-289e-4306-985a-b10071a387b1 ==============================
[0m12:34:30.077105 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:34:30.077653 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --target prod', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m12:34:30.080675 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:34:30.082740 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07458783, "process_in_blocks": "0", "process_kernel_time": 0.112308, "process_mem_max_rss": "106119168", "process_out_blocks": "0", "process_user_time": 1.236159}
[0m12:34:30.083159 [debug] [MainThread]: Command `dbt build` failed at 12:34:30.083073 after 0.08 seconds
[0m12:34:30.083498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b6c20>]}
[0m12:34:30.084017 [debug] [MainThread]: Flushing usage events
[0m12:34:30.553164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:28.886361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a00730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a00bb0>]}


============================== 12:37:28.890395 | 2f4b3169-56e4-41c6-b106-fe07a8100820 ==============================
[0m12:37:28.890395 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:37:28.890948 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'invocation_command': 'dbt debug --target prod', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False'}
[0m12:37:28.902986 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m12:37:28.903365 [info ] [MainThread]: python version: 3.10.0
[0m12:37:28.903657 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:37:28.903933 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:37:28.908321 [info ] [MainThread]: Using profiles dir at /Users/preben/Documents/dbt-workshop
[0m12:37:28.908677 [info ] [MainThread]: Using profiles.yml file at /Users/preben/Documents/dbt-workshop/profiles.yml
[0m12:37:28.908957 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:37:29.023504 [info ] [MainThread]: Configuration:
[0m12:37:29.023951 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:37:29.024253 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:37:29.024534 [info ] [MainThread]: Required dependencies:
[0m12:37:29.024894 [debug] [MainThread]: Executing "git --help"
[0m12:37:29.035841 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:37:29.036592 [debug] [MainThread]: STDERR: "b''"
[0m12:37:29.036923 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:37:29.037239 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:37:29.037529 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:37:29.037799 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'snowflake'


[0m12:37:29.040927 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22939354, "process_in_blocks": "0", "process_kernel_time": 0.154574, "process_mem_max_rss": "109740032", "process_out_blocks": "0", "process_user_time": 1.365646}
[0m12:37:29.041403 [debug] [MainThread]: Command `dbt debug` failed at 12:37:29.041304 after 0.23 seconds
[0m12:37:29.041827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a03c70>]}
[0m12:37:29.042225 [debug] [MainThread]: Flushing usage events
[0m12:37:29.617344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:31.233213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc9a0>]}


============================== 12:37:31.237070 | 3bc4e05b-aa58-443d-89a1-1448f405fa20 ==============================
[0m12:37:31.237070 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:37:31.237614 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt build --target prod', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m12:37:31.240657 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:37:31.242816 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07452554, "process_in_blocks": "0", "process_kernel_time": 0.113117, "process_mem_max_rss": "106086400", "process_out_blocks": "0", "process_user_time": 1.237027}
[0m12:37:31.243310 [debug] [MainThread]: Command `dbt build` failed at 12:37:31.243216 after 0.08 seconds
[0m12:37:31.243660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7c02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcff370>]}
[0m12:37:31.244010 [debug] [MainThread]: Flushing usage events
[0m12:37:31.781946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:44.593413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c198280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d8be0>]}


============================== 12:42:44.597288 | dcc0268c-4043-41e8-a101-1901e08bf8cd ==============================
[0m12:42:44.597288 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:42:44.597825 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'empty': 'None', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m12:42:44.600863 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'snowflake'
[0m12:42:44.603698 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.08370979, "process_in_blocks": "0", "process_kernel_time": 0.162065, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.24134}
[0m12:42:44.604179 [debug] [MainThread]: Command `dbt seed` failed at 12:42:44.604088 after 0.08 seconds
[0m12:42:44.604532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c198280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6db6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6dada0>]}
[0m12:42:44.604890 [debug] [MainThread]: Flushing usage events
[0m12:42:45.223927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:47.972054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71cbe0>]}


============================== 12:43:47.976120 | 431dbbce-aedd-4933-84e9-3bc836ab81ba ==============================
[0m12:43:47.976120 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:43:47.976657 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'invocation_command': 'dbt seed', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m12:43:47.978256 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /Users/preben/Documents/dbt-workshop/profiles.yml
  
[0m12:43:47.980959 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.077663705, "process_in_blocks": "0", "process_kernel_time": 0.16098, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.247626}
[0m12:43:47.981385 [debug] [MainThread]: Command `dbt seed` failed at 12:43:47.981299 after 0.08 seconds
[0m12:43:47.981734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1dc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71f6a0>]}
[0m12:43:47.982059 [debug] [MainThread]: Flushing usage events
[0m12:43:48.487790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:59.108589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50be0>]}


============================== 12:44:59.112671 | cb756505-14b1-47d8-9ec7-942dfc1e0ae2 ==============================
[0m12:44:59.112671 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m12:44:59.113243 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'introspect': 'True'}
[0m12:44:59.117994 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.duckdb'
[0m12:44:59.118682 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "workshop_duckdb", target "dev" invalid: Runtime Error
    Could not find adapter type duckdb!
[0m12:44:59.121056 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.082555875, "process_in_blocks": "0", "process_kernel_time": 0.161813, "process_mem_max_rss": "106151936", "process_out_blocks": "0", "process_user_time": 1.24929}
[0m12:44:59.121505 [debug] [MainThread]: Command `dbt seed` failed at 12:44:59.121418 after 0.08 seconds
[0m12:44:59.121828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb532b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb50d90>]}
[0m12:44:59.122176 [debug] [MainThread]: Flushing usage events
[0m12:44:59.709894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:53.719238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935b010>]}


============================== 12:46:53.724124 | d3348f53-45c2-430a-8a2f-f6288ba90a79 ==============================
[0m12:46:53.724124 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:46:53.724657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:53.852210 [error] [MainThread]: Encountered an error:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:46:53.855077 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.19681813, "process_in_blocks": "0", "process_kernel_time": 0.149653, "process_mem_max_rss": "105857024", "process_out_blocks": "0", "process_user_time": 1.241223}
[0m12:46:53.855535 [debug] [MainThread]: Command `dbt seed` failed at 12:46:53.855446 after 0.20 seconds
[0m12:46:53.855874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b9150>]}
[0m12:46:53.856214 [debug] [MainThread]: Flushing usage events
[0m12:47:33.987512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11eec0>]}


============================== 12:47:33.992211 | b040c08e-9b40-4670-b6e5-643259214ee1 ==============================
[0m12:47:33.992211 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:47:33.992767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir . --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:34.002725 [info ] [MainThread]: dbt version: 1.8.9
[0m12:47:34.003131 [info ] [MainThread]: python version: 3.10.0
[0m12:47:34.003494 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:47:34.004035 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:47:34.125072 [info ] [MainThread]: Using profiles dir at .
[0m12:47:34.125514 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m12:47:34.125814 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:47:34.130035 [info ] [MainThread]: adapter type: duckdb
[0m12:47:34.130381 [info ] [MainThread]: adapter version: 1.8.4
[0m12:47:34.141379 [info ] [MainThread]: Configuration:
[0m12:47:34.141746 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:47:34.142075 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m12:47:34.142357 [info ] [MainThread]: Required dependencies:
[0m12:47:34.142682 [debug] [MainThread]: Executing "git --help"
[0m12:47:34.161237 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:47:34.162116 [debug] [MainThread]: STDERR: "b''"
[0m12:47:34.162473 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:47:34.162807 [info ] [MainThread]: Connection:
[0m12:47:34.163176 [info ] [MainThread]:   database: dev
[0m12:47:34.163534 [info ] [MainThread]:   schema: analytics_dev
[0m12:47:34.163878 [info ] [MainThread]:   path: ./warehouse/dev.duckdb
[0m12:47:34.164216 [info ] [MainThread]:   config_options: None
[0m12:47:34.164487 [info ] [MainThread]:   extensions: ['httpfs']
[0m12:47:34.164801 [info ] [MainThread]:   settings: {}
[0m12:47:34.165073 [info ] [MainThread]:   external_root: ./external
[0m12:47:34.165323 [info ] [MainThread]:   use_credential_provider: None
[0m12:47:34.165642 [info ] [MainThread]:   attach: None
[0m12:47:34.165915 [info ] [MainThread]:   filesystems: None
[0m12:47:34.166264 [info ] [MainThread]:   remote: None
[0m12:47:34.166606 [info ] [MainThread]:   plugins: None
[0m12:47:34.167021 [info ] [MainThread]:   disable_transactions: False
[0m12:47:34.167890 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:47:34.270978 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:47:34.323513 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:47:34.323867 [debug] [MainThread]: On debug: select 1 as id
[0m12:47:34.324154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:34.756081 [debug] [MainThread]: SQL status: OK in 0.432 seconds
[0m12:47:34.757257 [debug] [MainThread]: On debug: Close
[0m12:47:34.758926 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:47:34.759284 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:47:34.759562 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml


[0m12:47:34.762613 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.8347332, "process_in_blocks": "0", "process_kernel_time": 0.30395, "process_mem_max_rss": "130203648", "process_out_blocks": "0", "process_user_time": 1.515268}
[0m12:47:34.763061 [debug] [MainThread]: Command `dbt debug` failed at 12:47:34.762961 after 0.84 seconds
[0m12:47:34.763399 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:47:34.763744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e25f0>]}
[0m12:47:34.764143 [debug] [MainThread]: Flushing usage events
[0m12:47:36.795738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a985c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9851e0>]}


============================== 12:47:36.800754 | d08d042a-cc69-431f-9fc7-6b73967facf7 ==============================
[0m12:47:36.800754 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:47:36.801312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir . --target dev', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:47:36.905181 [error] [MainThread]: Encountered an error:
Runtime Error
  "<1.12" is not a valid semantic version.

Error encountered in /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:47:36.907619 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.17241058, "process_in_blocks": "0", "process_kernel_time": 0.110477, "process_mem_max_rss": "105791488", "process_out_blocks": "0", "process_user_time": 1.2275}
[0m12:47:36.908123 [debug] [MainThread]: Command `dbt seed` failed at 12:47:36.908032 after 0.17 seconds
[0m12:47:36.908520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa8dc0>]}
[0m12:47:36.908895 [debug] [MainThread]: Flushing usage events
[0m12:48:35.611606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc458d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d2f80>]}


============================== 12:48:35.616472 | 300329d7-7dd1-435d-b744-c4e0cd09caa8 ==============================
[0m12:48:35.616472 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:35.617029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir . --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:35.628179 [info ] [MainThread]: dbt version: 1.8.9
[0m12:48:35.628581 [info ] [MainThread]: python version: 3.10.0
[0m12:48:35.628895 [info ] [MainThread]: python path: /Users/preben/.pyenv/versions/3.10.0/bin/python3.10
[0m12:48:35.629187 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m12:48:35.748074 [info ] [MainThread]: Using profiles dir at .
[0m12:48:35.748494 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m12:48:35.748790 [info ] [MainThread]: Using dbt_project.yml file at /Users/preben/Documents/dbt-workshop/dbt_project.yml
[0m12:48:35.752519 [info ] [MainThread]: adapter type: duckdb
[0m12:48:35.752859 [info ] [MainThread]: adapter version: 1.8.4
[0m12:48:35.848188 [info ] [MainThread]: Configuration:
[0m12:48:35.848600 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:35.848894 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:35.849170 [info ] [MainThread]: Required dependencies:
[0m12:48:35.849503 [debug] [MainThread]: Executing "git --help"
[0m12:48:35.866563 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:35.867427 [debug] [MainThread]: STDERR: "b''"
[0m12:48:35.867751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:35.868061 [info ] [MainThread]: Connection:
[0m12:48:35.868392 [info ] [MainThread]:   database: dev
[0m12:48:35.868657 [info ] [MainThread]:   schema: analytics_dev
[0m12:48:35.868909 [info ] [MainThread]:   path: ./warehouse/dev.duckdb
[0m12:48:35.869162 [info ] [MainThread]:   config_options: None
[0m12:48:35.869690 [info ] [MainThread]:   extensions: ['httpfs']
[0m12:48:35.870033 [info ] [MainThread]:   settings: {}
[0m12:48:35.870318 [info ] [MainThread]:   external_root: ./external
[0m12:48:35.870585 [info ] [MainThread]:   use_credential_provider: None
[0m12:48:35.870845 [info ] [MainThread]:   attach: None
[0m12:48:35.871097 [info ] [MainThread]:   filesystems: None
[0m12:48:35.871351 [info ] [MainThread]:   remote: None
[0m12:48:35.871607 [info ] [MainThread]:   plugins: None
[0m12:48:35.871858 [info ] [MainThread]:   disable_transactions: False
[0m12:48:35.872499 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:48:35.962705 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:48:36.003557 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:48:36.003918 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:36.004202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:36.147371 [debug] [MainThread]: SQL status: OK in 0.143 seconds
[0m12:48:36.148300 [debug] [MainThread]: On debug: Close
[0m12:48:36.149683 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:36.150060 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:36.152822 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.60297644, "process_in_blocks": "0", "process_kernel_time": 0.29976, "process_mem_max_rss": "134529024", "process_out_blocks": "0", "process_user_time": 1.598457}
[0m12:48:36.153229 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:36.153142 after 0.60 seconds
[0m12:48:36.153528 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:36.153845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc458d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d1ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2fa0b0>]}
[0m12:48:36.154219 [debug] [MainThread]: Flushing usage events
[0m12:48:38.271593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7f010>]}


============================== 12:48:38.275871 | 2cf08aa5-0020-47db-9c1a-b8cba7294b42 ==============================
[0m12:48:38.275871 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:38.276398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir . --target dev', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:38.508023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cf08aa5-0020-47db-9c1a-b8cba7294b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9cfa0>]}
[0m12:48:38.560816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cf08aa5-0020-47db-9c1a-b8cba7294b42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107697be0>]}
[0m12:48:38.564794 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:48:38.690011 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 4 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:48:38.692391 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.47765446, "process_in_blocks": "0", "process_kernel_time": 0.13669, "process_mem_max_rss": "110215168", "process_out_blocks": "0", "process_user_time": 1.42462}
[0m12:48:38.692813 [debug] [MainThread]: Command `dbt seed` failed at 12:48:38.692728 after 0.48 seconds
[0m12:48:38.693194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917e320>]}
[0m12:48:38.693553 [debug] [MainThread]: Flushing usage events
[0m12:48:45.058153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d2ec0>]}


============================== 12:48:45.062913 | 92f3ec45-bf4c-4c9b-b265-794a5009bd3b ==============================
[0m12:48:45.062913 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:48:45.063452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:48:45.179970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d3940>]}
[0m12:48:45.193866 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-_ee8jy6j'
[0m12:48:45.194366 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:48:45.300365 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:48:45.300979 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:48:45.347137 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:48:45.354459 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m12:48:45.404493 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m12:48:45.408205 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:48:45.454263 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:48:45.455182 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m12:48:45.455558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efd90>]}
[0m12:48:45.458649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:48:45.503895 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:48:45.509705 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:48:45.644405 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:48:45.670058 [info ] [MainThread]: Updating lock file in file path: /Users/preben/Documents/dbt-workshop/package-lock.yml
[0m12:48:45.673442 [debug] [MainThread]: Set downloads directory='/var/folders/1m/czql7ksd08b7hgtjsgdj6zjw0000gn/T/dbt-downloads-uhq_1o3c'
[0m12:48:45.687147 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:48:46.017289 [info ] [MainThread]: Installed from version 1.1.1
[0m12:48:46.017704 [info ] [MainThread]: Updated version available: 1.3.1
[0m12:48:46.018060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080063b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef5e0>]}
[0m12:48:46.018411 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m12:48:46.496555 [info ] [MainThread]: Installed from version 0.11.0
[0m12:48:46.496997 [info ] [MainThread]: Updated version available: 1.0.2
[0m12:48:46.497427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080063b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef2e0>]}
[0m12:48:46.497803 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:48:47.159539 [info ] [MainThread]: Installed from version 0.10.3
[0m12:48:47.160745 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:48:47.161143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095eea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ec220>]}
[0m12:48:47.161513 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:48:47.409557 [info ] [MainThread]: Installed from version 0.12.1
[0m12:48:47.410025 [info ] [MainThread]: Updated version available: 0.13.1
[0m12:48:47.410409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095efac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ed900>]}
[0m12:48:47.410770 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:48:47.733698 [info ] [MainThread]: Installed from version 0.10.1
[0m12:48:47.734116 [info ] [MainThread]: Up to date!
[0m12:48:47.734465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '92f3ec45-bf4c-4c9b-b265-794a5009bd3b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ef5b0>]}
[0m12:48:47.734811 [info ] [MainThread]: 
[0m12:48:47.735121 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/dbt_project_evaluator', 'calogica/dbt_expectations', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m12:48:47.738566 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7394335, "process_in_blocks": "0", "process_kernel_time": 0.281932, "process_mem_max_rss": "105693184", "process_out_blocks": "0", "process_user_time": 1.478357}
[0m12:48:47.739029 [debug] [MainThread]: Command `dbt deps` succeeded at 12:48:47.738924 after 2.74 seconds
[0m12:48:47.739424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107945870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109527fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ed900>]}
[0m12:48:47.740017 [debug] [MainThread]: Flushing usage events
[0m12:50:09.172486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31d8a0>]}


============================== 12:50:09.177396 | 9cd4ef3f-a762-4616-9094-5029107bf9bf ==============================
[0m12:50:09.177396 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:50:09.177929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:09.435875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f12da0>]}
[0m12:50:09.486419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b38e0>]}
[0m12:50:09.492999 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:50:09.619475 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:50:09.620367 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:50:09.620746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b427ee0>]}
[0m12:50:12.010129 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:50:12.010646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb12ef0>]}
[0m12:50:12.380042 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:50:12.380502 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:50:12.380821 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:50:12.381116 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:50:12.381399 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:50:12.381680 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:50:12.381961 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:50:12.382239 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:50:12.382514 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:50:12.382789 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:50:12.383060 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:50:12.383333 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:50:12.383619 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:50:12.383894 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:50:12.384167 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:50:12.384439 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:50:12.384712 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:50:12.384984 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:50:12.385256 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:50:12.385529 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:50:12.385803 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:50:12.386077 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:50:12.386349 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:50:12.386624 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:50:12.386898 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:50:12.387169 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:50:12.387440 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:50:12.387711 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:50:12.551748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ada80>]}
[0m12:50:12.705921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b882b30>]}
[0m12:50:12.706427 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:50:12.706766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31630>]}
[0m12:50:12.708935 [info ] [MainThread]: 
[0m12:50:12.709407 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:50:12.714798 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:50:12.767198 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:50:12.767587 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m12:50:12.767877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:12.934735 [debug] [ThreadPool]: SQL status: OK in 0.167 seconds
[0m12:50:12.936673 [debug] [ThreadPool]: On list_dev: Close
[0m12:50:12.938425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_analytics_dev)
[0m12:50:12.939049 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "analytics_dev"
"
[0m12:50:12.946001 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.946334 [debug] [ThreadPool]: On create_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics_dev"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:50:12.946613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:12.987363 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m12:50:12.988943 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.989244 [debug] [ThreadPool]: On create_dev_analytics_dev: BEGIN
[0m12:50:12.989690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:12.990073 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.990339 [debug] [ThreadPool]: On create_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics_dev"} */

    
    
        create schema if not exists dev.analytics_dev
    
[0m12:50:12.991598 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:12.992338 [debug] [ThreadPool]: On create_dev_analytics_dev: COMMIT
[0m12:50:12.992632 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics_dev"
[0m12:50:12.992897 [debug] [ThreadPool]: On create_dev_analytics_dev: COMMIT
[0m12:50:12.993693 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:12.993969 [debug] [ThreadPool]: On create_dev_analytics_dev: Close
[0m12:50:12.997177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_analytics_dev, now list_dev_analytics)
[0m12:50:13.002888 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:50:13.003313 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:50:13.003589 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:50:13.006812 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:50:13.007107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:13.007387 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:50:13.007717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:13.046046 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:13.046380 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:50:13.046664 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:13.046955 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m12:50:13.047247 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:50:13.047637 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m12:50:13.061914 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:50:13.062249 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:50:13.063335 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m12:50:13.064334 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m12:50:13.065123 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m12:50:13.065478 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m12:50:13.065751 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:50:13.066029 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m12:50:13.067315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108155a20>]}
[0m12:50:13.067724 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.067989 [debug] [MainThread]: On master: BEGIN
[0m12:50:13.068240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:13.110773 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m12:50:13.111121 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.111403 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.111668 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.112025 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:13.112314 [debug] [MainThread]: On master: Close
[0m12:50:13.113268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:13.113579 [info ] [MainThread]: 
[0m12:50:13.115696 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:50:13.116069 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:50:13.116675 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_dev.raw_customers ............................. [RUN]
[0m12:50:13.117083 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:50:13.117474 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:50:13.117873 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_dev.raw_order_items ........................... [RUN]
[0m12:50:13.118363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m12:50:13.118874 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_dev.raw_orders ................................ [RUN]
[0m12:50:13.119757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m12:50:13.119444 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_dev.raw_products .............................. [RUN]
[0m12:50:13.120178 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:50:13.120591 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:50:13.120964 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:50:13.121377 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:50:13.121718 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:50:13.122038 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:50:13.122573 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:50:13.123223 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:50:13.137216 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:50:13.144168 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:50:13.166325 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.168336 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.170341 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.173761 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:50:13.174110 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:50:13.174481 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:50:13.177660 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.178002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:13.178320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:50:13.178736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:13.179073 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:50:13.179530 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:13.218220 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m12:50:13.218592 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.218933 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:50:13.219269 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:50:13.219569 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m12:50:13.219884 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table dev.analytics_dev.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:50:13.220217 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.220531 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.220847 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.221300 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */

    create table dev.analytics_dev.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:50:13.221671 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table dev.analytics_dev.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:50:13.222027 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table dev.analytics_dev.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:50:13.222950 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.223272 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.223572 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:50:13.223857 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.234630 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.235586 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.236494 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.237369 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.237708 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238036 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238357 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.238671 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:13.254405 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m12:50:13.254855 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.255210 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.255536 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m12:50:13.260756 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:50:13.261343 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:50:13.261839 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:50:13.262390 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:50:13.282823 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:13.284682 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:13.285884 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:13.286229 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:13.287346 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:13.287712 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:13.288226 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:13.288615 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:13.288966 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:13.289287 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:13.289600 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:13.290012 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:13.291228 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.291588 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:13.293350 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:50:13.293678 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:50:13.293981 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:50:13.294590 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:50:13.295890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9b8370>]}
[0m12:50:13.296502 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:50:13.297101 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:50:13.297551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba1c310>]}
[0m12:50:13.298028 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_dev.raw_customers ......................... [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.298487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba1e830>]}
[0m12:50:13.299480 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:50:13.299007 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_dev.raw_orders ............................ [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.300032 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_dev.raw_products .......................... [[32mINSERT 10[0m in 0.18s]
[0m12:50:13.300664 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:50:13.301122 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:50:13.308239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd4ef3f-a762-4616-9094-5029107bf9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba102e0>]}
[0m12:50:13.308717 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_dev.raw_order_items ....................... [[32mINSERT 14[0m in 0.19s]
[0m12:50:13.309218 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:50:13.310150 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.310530 [debug] [MainThread]: On master: BEGIN
[0m12:50:13.310810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:13.360351 [debug] [MainThread]: SQL status: OK in 0.049 seconds
[0m12:50:13.360762 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.361066 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:13.361342 [debug] [MainThread]: On master: COMMIT
[0m12:50:13.361712 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:13.361988 [debug] [MainThread]: On master: Close
[0m12:50:13.363116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:13.363402 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:50:13.363648 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:50:13.363893 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:50:13.364130 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:50:13.364452 [info ] [MainThread]: 
[0m12:50:13.364759 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:50:13.365799 [debug] [MainThread]: Command end result
[0m12:50:13.479131 [info ] [MainThread]: 
[0m12:50:13.479605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:13.479914 [info ] [MainThread]: 
[0m12:50:13.480224 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:50:13.483189 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.370567, "process_in_blocks": "0", "process_kernel_time": 0.436314, "process_mem_max_rss": "168230912", "process_out_blocks": "0", "process_user_time": 5.908098}
[0m12:50:13.483570 [debug] [MainThread]: Command `dbt seed` succeeded at 12:50:13.483494 after 4.37 seconds
[0m12:50:13.483896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b675a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b677400>]}
[0m12:50:13.484221 [debug] [MainThread]: Flushing usage events
[0m12:50:34.178921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb56c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb570a0>]}


============================== 12:50:34.184032 | bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e ==============================
[0m12:50:34.184032 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:50:34.184562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed --target prod', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:34.419079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b797070>]}
[0m12:50:34.468658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2735b0>]}
[0m12:50:34.472923 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:50:34.597937 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:50:34.722380 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:50:34.722811 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m12:50:34.723100 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:50:34.723415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3fd60>]}
[0m12:50:37.038332 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:50:37.038837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e3880>]}
[0m12:50:37.462316 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:50:37.462816 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:50:37.463151 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:50:37.463459 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:50:37.463752 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:50:37.464039 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:50:37.464324 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:50:37.464607 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:50:37.464883 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:50:37.465156 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:50:37.465424 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:50:37.465693 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:50:37.465966 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:50:37.466245 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:50:37.466517 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:50:37.466793 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:50:37.467071 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:50:37.467344 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:50:37.467614 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:50:37.467885 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:50:37.468163 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:50:37.468439 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:50:37.468717 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:50:37.468993 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:50:37.469267 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:50:37.469538 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:50:37.469807 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:50:37.470076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:50:37.578328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533520>]}
[0m12:50:37.727327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19a350>]}
[0m12:50:37.727849 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:50:37.728188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ca980>]}
[0m12:50:37.730351 [info ] [MainThread]: 
[0m12:50:37.730830 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:50:37.736147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:50:37.781247 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:50:37.781619 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:50:37.781909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:37.929322 [debug] [ThreadPool]: SQL status: OK in 0.147 seconds
[0m12:50:37.931423 [debug] [ThreadPool]: On list_prod: Close
[0m12:50:37.933450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now create_prod_analytics)
[0m12:50:37.933938 [debug] [ThreadPool]: Creating schema "database: "prod"
schema: "analytics"
"
[0m12:50:37.940989 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.941319 [debug] [ThreadPool]: On create_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_analytics"} */

    
        select type from duckdb_databases()
        where database_name='prod'
        and type='sqlite'
    
  
[0m12:50:37.941601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:37.980201 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:37.981786 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.982108 [debug] [ThreadPool]: On create_prod_analytics: BEGIN
[0m12:50:37.982483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:50:37.982751 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.983016 [debug] [ThreadPool]: On create_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "create_prod_analytics"} */

    
    
        create schema if not exists prod.analytics
    
[0m12:50:37.984300 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:37.985073 [debug] [ThreadPool]: On create_prod_analytics: COMMIT
[0m12:50:37.985372 [debug] [ThreadPool]: Using duckdb connection "create_prod_analytics"
[0m12:50:37.985638 [debug] [ThreadPool]: On create_prod_analytics: COMMIT
[0m12:50:37.986459 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:50:37.986732 [debug] [ThreadPool]: On create_prod_analytics: Close
[0m12:50:37.990402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_prod_analytics, now list_prod_analytics)
[0m12:50:37.997331 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:50:37.997673 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:50:37.997949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:38.037136 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m12:50:38.037511 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:50:38.037805 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:50:38.048313 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:50:38.049376 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:50:38.050130 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:50:38.050403 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:50:38.051545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bb6a0>]}
[0m12:50:38.052000 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.052294 [debug] [MainThread]: On master: BEGIN
[0m12:50:38.052560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:38.091287 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m12:50:38.091622 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.091902 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.092165 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.092539 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:38.092890 [debug] [MainThread]: On master: Close
[0m12:50:38.093855 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:50:38.094183 [info ] [MainThread]: 
[0m12:50:38.096318 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:50:38.096696 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:50:38.097162 [info ] [Thread-1 (]: 1 of 4 START seed file analytics.raw_customers ................................. [RUN]
[0m12:50:38.097560 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:50:38.097968 [info ] [Thread-2 (]: 2 of 4 START seed file analytics.raw_order_items ............................... [RUN]
[0m12:50:38.098375 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:50:38.099008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now seed.ci_cd_project.raw_customers)
[0m12:50:38.099455 [info ] [Thread-3 (]: 3 of 4 START seed file analytics.raw_orders .................................... [RUN]
[0m12:50:38.100012 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_order_items'
[0m12:50:38.100842 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:50:38.100422 [info ] [Thread-4 (]: 4 of 4 START seed file analytics.raw_products .................................. [RUN]
[0m12:50:38.101364 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:50:38.101675 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:50:38.102000 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:50:38.102392 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:50:38.102696 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:50:38.103069 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:50:38.115654 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:50:38.120672 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:50:38.130760 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:50:38.139534 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.140737 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.148133 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:50:38.148554 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:50:38.150527 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.153825 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.154148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:38.154474 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:50:38.154823 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:50:38.155132 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:50:38.155592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:38.155956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:50:38.194987 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m12:50:38.195374 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:50:38.195717 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.196023 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:50:38.196317 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:50:38.196642 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.196970 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table prod.analytics.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:50:38.197290 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.197594 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.197916 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table prod.analytics.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:50:38.198389 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_products"} */

    create table prod.analytics.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:50:38.198772 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table prod.analytics.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:50:38.199739 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.205872 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:50:38.206234 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:50:38.211301 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.211660 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.212605 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.213509 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.213847 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY prod.analytics.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.214716 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.215050 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY prod.analytics.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.215375 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY prod.analytics.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.215879 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY prod.analytics.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:50:38.228869 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229243 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229576 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m12:50:38.229887 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m12:50:38.234907 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:50:38.235421 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:50:38.235926 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:50:38.236403 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:50:38.257562 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:38.259241 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:38.262720 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:38.263099 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:50:38.263465 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:50:38.264622 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:38.264947 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:50:38.265271 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:50:38.265584 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:50:38.265907 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:50:38.266214 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:50:38.266698 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:50:38.267229 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.267568 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:50:38.269274 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:50:38.269589 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:50:38.269882 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:50:38.270481 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:50:38.271734 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:50:38.272494 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:50:38.273026 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ac610>]}
[0m12:50:38.273452 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5aeaa0>]}
[0m12:50:38.273881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d187be0>]}
[0m12:50:38.274402 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics.raw_orders ................................ [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.274799 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics.raw_products .............................. [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.275837 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:50:38.275296 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics.raw_customers ............................. [[32mINSERT 10[0m in 0.17s]
[0m12:50:38.276390 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:50:38.276956 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:50:38.282816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb605e94-28cc-441a-a3c8-dd6c6b7c8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d187df0>]}
[0m12:50:38.283313 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics.raw_order_items ........................... [[32mINSERT 14[0m in 0.18s]
[0m12:50:38.283874 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:50:38.284988 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.285454 [debug] [MainThread]: On master: BEGIN
[0m12:50:38.286009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:38.332350 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m12:50:38.332740 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.333028 [debug] [MainThread]: Using duckdb connection "master"
[0m12:50:38.333298 [debug] [MainThread]: On master: COMMIT
[0m12:50:38.333635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:50:38.333907 [debug] [MainThread]: On master: Close
[0m12:50:38.334904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:38.335222 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:50:38.335485 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:50:38.335733 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:50:38.335977 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:50:38.336286 [info ] [MainThread]: 
[0m12:50:38.336588 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:50:38.337541 [debug] [MainThread]: Command end result
[0m12:50:38.445225 [info ] [MainThread]: 
[0m12:50:38.445693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:38.445999 [info ] [MainThread]: 
[0m12:50:38.446306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:50:38.449341 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.328413, "process_in_blocks": "0", "process_kernel_time": 0.392192, "process_mem_max_rss": "167362560", "process_out_blocks": "0", "process_user_time": 5.89138}
[0m12:50:38.449758 [debug] [MainThread]: Command `dbt seed` succeeded at 12:50:38.449675 after 4.33 seconds
[0m12:50:38.450101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3584c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e8430>]}
[0m12:50:38.450444 [debug] [MainThread]: Flushing usage events
[0m12:52:10.118753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093feb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fefe0>]}


============================== 12:52:10.123471 | ebd1395c-8329-4d75-bac8-e763623e1bc1 ==============================
[0m12:52:10.123471 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:52:10.123991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --target test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:10.382152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108018430>]}
[0m12:52:10.432880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087eb040>]}
[0m12:52:10.436963 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:52:10.561302 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:52:10.685779 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:52:10.686200 [debug] [MainThread]: previous checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m12:52:10.686486 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:52:10.686805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b2c20>]}
[0m12:52:13.007689 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:52:13.008194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109970e80>]}
[0m12:52:13.394479 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:52:13.394940 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:52:13.395260 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:52:13.395554 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:52:13.395836 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:52:13.396117 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:52:13.396393 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:52:13.396669 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:52:13.396942 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:52:13.397211 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:52:13.397480 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:52:13.397744 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:52:13.398014 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:52:13.398283 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:52:13.398552 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:52:13.398817 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:52:13.399084 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:52:13.399353 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:52:13.399616 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:52:13.399881 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:52:13.400147 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:52:13.400413 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:52:13.400683 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:52:13.400949 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:52:13.401215 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:52:13.401478 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:52:13.401746 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:52:13.402011 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:52:13.532182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e854b0>]}
[0m12:52:13.681604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfda50>]}
[0m12:52:13.682095 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:52:13.682437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebd1395c-8329-4d75-bac8-e763623e1bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfd450>]}
[0m12:52:13.684608 [info ] [MainThread]: 
[0m12:52:13.685074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:52:13.690057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:52:13.740407 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:52:13.740790 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:52:13.741083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:13.878345 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:52:13.878757 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:52:13.879462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:13.879786 [debug] [MainThread]: Connection 'list_test' was properly closed.
[0m12:52:13.880083 [info ] [MainThread]: 
[0m12:52:13.880395 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m12:52:13.880822 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "./warehouse/prod.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:52:13.883578 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.8271637, "process_in_blocks": "0", "process_kernel_time": 0.367492, "process_mem_max_rss": "152666112", "process_out_blocks": "0", "process_user_time": 4.713808}
[0m12:52:13.883972 [debug] [MainThread]: Command `dbt seed` failed at 12:52:13.883890 after 3.83 seconds
[0m12:52:13.884301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793d870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfef20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd2bc0>]}
[0m12:52:13.884636 [debug] [MainThread]: Flushing usage events
[0m12:53:25.219049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a15900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ab070>]}


============================== 12:53:25.223873 | c637d95c-b330-4217-a0e2-4aa001b74539 ==============================
[0m12:53:25.223873 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:25.224393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --target test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:25.478566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109566ef0>]}
[0m12:53:25.528489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5a170>]}
[0m12:53:25.532552 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:25.657776 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:25.875029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:25.875443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:25.929076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d442b0>]}
[0m12:53:26.109111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7b520>]}
[0m12:53:26.109611 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:26.109949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d243d0>]}
[0m12:53:26.112104 [info ] [MainThread]: 
[0m12:53:26.112573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:26.117754 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:26.170609 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:26.170985 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:26.171293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:26.318895 [debug] [ThreadPool]: SQL status: OK in 0.148 seconds
[0m12:53:26.320824 [debug] [ThreadPool]: On list_test: Close
[0m12:53:26.322578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now create_test_analytics_test)
[0m12:53:26.323031 [debug] [ThreadPool]: Creating schema "database: "test"
schema: "analytics_test"
"
[0m12:53:26.329931 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.330259 [debug] [ThreadPool]: On create_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics_test"} */

    
        select type from duckdb_databases()
        where database_name='test'
        and type='sqlite'
    
  
[0m12:53:26.330621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:26.364998 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m12:53:26.366404 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.366717 [debug] [ThreadPool]: On create_test_analytics_test: BEGIN
[0m12:53:26.367063 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:26.367324 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.367586 [debug] [ThreadPool]: On create_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics_test"} */

    
    
        create schema if not exists test.analytics_test
    
[0m12:53:26.368579 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:26.369350 [debug] [ThreadPool]: On create_test_analytics_test: COMMIT
[0m12:53:26.369646 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics_test"
[0m12:53:26.369911 [debug] [ThreadPool]: On create_test_analytics_test: COMMIT
[0m12:53:26.370652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:26.370920 [debug] [ThreadPool]: On create_test_analytics_test: Close
[0m12:53:26.373711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_analytics_test, now list_test_analytics_test)
[0m12:53:26.379990 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:26.380414 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics'
[0m12:53:26.380681 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:26.383130 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:26.383420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:26.383702 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:26.384033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:26.419977 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m12:53:26.420312 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:26.420589 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m12:53:26.420870 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:26.421160 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:26.421536 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:26.434207 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:53:26.434634 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:53:26.435681 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:26.436774 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:26.437620 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:26.438004 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:26.438305 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:26.438626 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:26.440063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d243d0>]}
[0m12:53:26.440498 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.440774 [debug] [MainThread]: On master: BEGIN
[0m12:53:26.441029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:26.480904 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:53:26.481234 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.481518 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.481778 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.482132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:26.482444 [debug] [MainThread]: On master: Close
[0m12:53:26.483411 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:26.483732 [info ] [MainThread]: 
[0m12:53:26.485522 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m12:53:26.486039 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m12:53:26.486510 [info ] [Thread-1 (]: 1 of 4 START seed file analytics_test.raw_customers ............................ [RUN]
[0m12:53:26.486922 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m12:53:26.487325 [info ] [Thread-2 (]: 2 of 4 START seed file analytics_test.raw_order_items .......................... [RUN]
[0m12:53:26.487701 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m12:53:26.488060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now seed.ci_cd_project.raw_customers)
[0m12:53:26.488492 [info ] [Thread-3 (]: 3 of 4 START seed file analytics_test.raw_orders ............................... [RUN]
[0m12:53:26.488939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics, now seed.ci_cd_project.raw_order_items)
[0m12:53:26.489440 [info ] [Thread-4 (]: 4 of 4 START seed file analytics_test.raw_products ............................. [RUN]
[0m12:53:26.489830 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m12:53:26.490260 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m12:53:26.490605 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m12:53:26.491022 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m12:53:26.491384 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m12:53:26.491724 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m12:53:26.492036 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m12:53:26.492334 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m12:53:26.507027 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m12:53:26.516296 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m12:53:26.529111 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.531724 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.533732 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.536946 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m12:53:26.540132 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.540549 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m12:53:26.540881 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m12:53:26.541193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:26.541501 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m12:53:26.541796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:26.542084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:26.542463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:26.578193 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:53:26.578586 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:53:26.578895 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.579187 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m12:53:26.579473 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:53:26.579787 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.580113 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_customers"} */

    create table test.analytics_test.raw_customers (customer_id integer,first_name text,last_name text,email text,phone text,address text,city text,state text,zip_code integer,country text,created_at date,updated_at date)
  
[0m12:53:26.580440 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.580740 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.581054 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_products"} */

    create table test.analytics_test.raw_products (product_id integer,product_name text,category text,subcategory text,brand text,price float8,cost integer,description text,is_active boolean,created_at date,updated_at date)
  
[0m12:53:26.581501 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_order_items"} */

    create table test.analytics_test.raw_order_items (order_item_id integer,order_id integer,product_id integer,quantity integer,unit_price float8,total_price float8,discount_amount integer,created_at date)
  
[0m12:53:26.581863 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "seed.ci_cd_project.raw_orders"} */

    create table test.analytics_test.raw_orders (order_id integer,customer_id integer,order_date date,status text,total_amount float8,shipping_address text,billing_address text,payment_method text,created_at date,updated_at date)
  
[0m12:53:26.582274 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.582768 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.589425 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:53:26.594017 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.594349 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m12:53:26.595271 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.596180 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.596515 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY test.analytics_test.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.597388 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.597721 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY test.analytics_test.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.598045 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY test.analytics_test.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.598445 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY test.analytics_test.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m12:53:26.612045 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.612453 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.612799 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.613133 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m12:53:26.618257 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m12:53:26.618789 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m12:53:26.619280 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m12:53:26.619748 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m12:53:26.641941 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:53:26.642364 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m12:53:26.644210 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:53:26.646089 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:53:26.650882 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:53:26.651241 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m12:53:26.651622 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m12:53:26.651977 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m12:53:26.652316 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m12:53:26.652734 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m12:53:26.653072 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m12:53:26.653418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:26.653808 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m12:53:26.656014 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m12:53:26.656399 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.656762 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.657508 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m12:53:26.658846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6cfd0>]}
[0m12:53:26.659221 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:26.659856 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m12:53:26.660280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094633a0>]}
[0m12:53:26.660742 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file analytics_test.raw_customers ........................ [[32mINSERT 10[0m in 0.17s]
[0m12:53:26.661448 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m12:53:26.661901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a69270>]}
[0m12:53:26.662335 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file analytics_test.raw_orders ........................... [[32mINSERT 10[0m in 0.17s]
[0m12:53:26.662857 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m12:53:26.663315 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file analytics_test.raw_order_items ...................... [[32mINSERT 14[0m in 0.17s]
[0m12:53:26.663810 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m12:53:26.664373 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m12:53:26.672637 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c637d95c-b330-4217-a0e2-4aa001b74539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21bc70>]}
[0m12:53:26.673149 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file analytics_test.raw_products ......................... [[32mINSERT 10[0m in 0.18s]
[0m12:53:26.673681 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m12:53:26.674728 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.675033 [debug] [MainThread]: On master: BEGIN
[0m12:53:26.675296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:26.715236 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:53:26.715597 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.715890 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:26.716156 [debug] [MainThread]: On master: COMMIT
[0m12:53:26.716509 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:26.716788 [debug] [MainThread]: On master: Close
[0m12:53:26.717772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:26.718084 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_customers' was properly closed.
[0m12:53:26.718345 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_order_items' was properly closed.
[0m12:53:26.718588 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_orders' was properly closed.
[0m12:53:26.718825 [debug] [MainThread]: Connection 'seed.ci_cd_project.raw_products' was properly closed.
[0m12:53:26.719134 [info ] [MainThread]: 
[0m12:53:26.719444 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:53:26.720381 [debug] [MainThread]: Command end result
[0m12:53:26.792061 [info ] [MainThread]: 
[0m12:53:26.792511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:26.792810 [info ] [MainThread]: 
[0m12:53:26.793116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:53:26.795746 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.6374655, "process_in_blocks": "0", "process_kernel_time": 0.425814, "process_mem_max_rss": "161349632", "process_out_blocks": "0", "process_user_time": 3.237472}
[0m12:53:26.796115 [debug] [MainThread]: Command `dbt seed` succeeded at 12:53:26.796039 after 1.64 seconds
[0m12:53:26.796437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a15900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108888850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a260a60>]}
[0m12:53:26.796758 [debug] [MainThread]: Flushing usage events
[0m12:53:44.872209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091598d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abeebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abef040>]}


============================== 12:53:44.878123 | 27e2ac68-77c4-4630-8573-59bf46225dd3 ==============================
[0m12:53:44.878123 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:44.878688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target test', 'send_anonymous_usage_stats': 'True'}
[0m12:53:45.114221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abddae0>]}
[0m12:53:45.164506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2a080>]}
[0m12:53:45.168998 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:45.291935 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:45.500860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:45.501260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:45.554697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b488280>]}
[0m12:53:45.731335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1af220>]}
[0m12:53:45.731843 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:45.732179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ad450>]}
[0m12:53:45.734365 [info ] [MainThread]: 
[0m12:53:45.734861 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:45.740209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:45.792656 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:45.793051 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:45.793352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:45.947050 [debug] [ThreadPool]: SQL status: OK in 0.154 seconds
[0m12:53:45.948566 [debug] [ThreadPool]: On list_test: Close
[0m12:53:45.950557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now create_test_analytics)
[0m12:53:45.951158 [debug] [ThreadPool]: Creating schema "database: "test"
schema: "analytics"
"
[0m12:53:45.958045 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.958386 [debug] [ThreadPool]: On create_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics"} */

    
        select type from duckdb_databases()
        where database_name='test'
        and type='sqlite'
    
  
[0m12:53:45.958746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:45.996424 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m12:53:45.997893 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.998224 [debug] [ThreadPool]: On create_test_analytics: BEGIN
[0m12:53:45.998595 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:53:45.998869 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:45.999134 [debug] [ThreadPool]: On create_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "create_test_analytics"} */

    
    
        create schema if not exists test.analytics
    
[0m12:53:46.000056 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:46.000834 [debug] [ThreadPool]: On create_test_analytics: COMMIT
[0m12:53:46.001134 [debug] [ThreadPool]: Using duckdb connection "create_test_analytics"
[0m12:53:46.001406 [debug] [ThreadPool]: On create_test_analytics: COMMIT
[0m12:53:46.002204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:53:46.002481 [debug] [ThreadPool]: On create_test_analytics: Close
[0m12:53:46.008520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_analytics, now list_test_analytics)
[0m12:53:46.014833 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:46.015272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics_test'
[0m12:53:46.015546 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:46.018060 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:46.018363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:46.018651 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:46.018987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:46.054519 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:46.054810 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:46.055077 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:46.055345 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:46.055623 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:46.056019 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:46.068417 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:53:46.068744 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:53:46.069779 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:46.070813 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:46.071591 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:46.071950 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:46.072216 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:46.072495 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:46.074327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b436cb0>]}
[0m12:53:46.074751 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.075026 [debug] [MainThread]: On master: BEGIN
[0m12:53:46.075280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:46.112036 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:53:46.112435 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.112735 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.113009 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.113400 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:46.113731 [debug] [MainThread]: On master: Close
[0m12:53:46.114768 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:46.115149 [info ] [MainThread]: 
[0m12:53:46.117128 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:53:46.117526 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:53:46.118004 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:53:46.118412 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:53:46.118834 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:53:46.119263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics, now model.ci_cd_project.stg_customers)
[0m12:53:46.119630 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:53:46.120042 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:53:46.120525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now model.ci_cd_project.stg_order_items)
[0m12:53:46.120953 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:53:46.121413 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:53:46.121970 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:53:46.122343 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:53:46.131768 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:53:46.132241 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:53:46.132595 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:53:46.137125 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:53:46.137633 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:53:46.141575 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:53:46.145308 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:53:46.146218 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:53:46.146614 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:53:46.146973 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:53:46.166238 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:53:46.195692 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:53:46.197113 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:53:46.198961 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:53:46.202428 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:53:46.203551 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.203978 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.204359 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.204703 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.205010 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:53:46.205336 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:53:46.205644 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:53:46.205947 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:53:46.206253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:46.206575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:46.206928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:46.207240 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:46.244421 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.244766 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.245092 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.245460 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:53:46.245787 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view test.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:46.246118 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:53:46.246421 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.246724 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.247191 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.247590 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view test.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:53:46.247927 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.248272 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view test.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:46.248635 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view test.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:53:46.255684 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.256196 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:53:46.256577 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view test.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:53:46.256955 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.257309 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.260571 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.263897 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.264258 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:46.267454 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.267809 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view test.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:53:46.268145 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view test.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:53:46.281058 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view test.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:53:46.282529 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:46.283119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.283455 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.283748 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.284074 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.285107 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:46.285449 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:46.286438 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:46.287423 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:46.287760 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.288141 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.288525 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.288843 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:46.289167 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:46.289490 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:46.289772 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.295138 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:46.295500 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.295816 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:53:46.296126 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists test.analytics.stg_orders__dbt_backup cascade
[0m12:53:46.296432 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m12:53:46.299156 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:46.301847 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:46.305193 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:46.305576 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists test.analytics.stg_customers__dbt_backup cascade
[0m12:53:46.305922 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:53:46.306234 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists test.analytics.stg_products__dbt_backup cascade
[0m12:53:46.306570 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists test.analytics.stg_order_items__dbt_backup cascade
[0m12:53:46.308874 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:53:46.309285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.309676 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.310614 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.311663 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:53:46.312410 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b798fd0>]}
[0m12:53:46.313487 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:53:46.314504 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:53:46.315459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb6020>]}
[0m12:53:46.315081 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.19s]
[0m12:53:46.316007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b798a90>]}
[0m12:53:46.316592 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.20s]
[0m12:53:46.317096 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:53:46.317620 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.18s]
[0m12:53:46.318260 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:53:46.318966 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:53:46.319359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a5480>]}
[0m12:53:46.320124 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.20s]
[0m12:53:46.320793 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:53:46.321161 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m12:53:46.321764 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:53:46.322192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now model.ci_cd_project.dim_customers)
[0m12:53:46.322548 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_products
[0m12:53:46.322883 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m12:53:46.323193 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:53:46.323646 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:53:46.324088 [info ] [Thread-2 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:53:46.328470 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:53:46.328888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.dim_products)
[0m12:53:46.329254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.fct_orders)
[0m12:53:46.329695 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:53:46.330082 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:53:46.333700 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:53:46.337719 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:53:46.338238 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:53:46.350740 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_products
[0m12:53:46.363271 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:53:46.368088 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:53:46.368420 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:53:46.371958 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:53:46.372725 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.373082 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:53:46.373460 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.373834 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:46.374185 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:53:46.374557 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.374941 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:46.375268 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:53:46.375624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:46.412096 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.412460 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.412786 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:53:46.413101 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:53:46.413461 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      test.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from test.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from test.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:53:46.413835 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.414146 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.414672 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      test.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from test.analytics.stg_orders
),

order_items as (
    select * from test.analytics.stg_order_items
),

products as (
    select * from test.analytics.stg_products
),

customers as (
    select * from test.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:53:46.415119 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      test.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from test.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from test.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:53:46.422818 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:53:46.423234 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m12:53:46.426854 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.427206 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m12:53:46.464631 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.465019 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table test.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:53:46.468291 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.468659 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table test.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:53:46.469126 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table test.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:53:46.469512 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.473924 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:46.474285 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.474620 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.474944 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m12:53:46.475244 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:46.476462 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:46.477546 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:46.477964 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.478333 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.478659 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.478964 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:46.479272 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:46.481989 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:46.482447 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists test.analytics.dim_products__dbt_backup cascade
[0m12:53:46.482871 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:53:46.483229 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.485946 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:46.486264 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:53:46.489629 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:46.489972 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists test.analytics.dim_customers__dbt_backup cascade
[0m12:53:46.491102 [debug] [Thread-4 (]: On model.ci_cd_project.dim_products: Close
[0m12:53:46.491444 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists test.analytics.fct_orders__dbt_backup cascade
[0m12:53:46.492003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb51c00>]}
[0m12:53:46.492361 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:46.493961 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m12:53:46.494285 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:46.492966 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.16s]
[0m12:53:46.494773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb51e70>]}
[0m12:53:46.495849 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m12:53:46.496333 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_products
[0m12:53:46.496840 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.17s]
[0m12:53:46.497476 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:53:46.509841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e2ac68-77c4-4630-8573-59bf46225dd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a8610>]}
[0m12:53:46.510430 [info ] [Thread-2 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.18s]
[0m12:53:46.510944 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:53:46.511886 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.512200 [debug] [MainThread]: On master: BEGIN
[0m12:53:46.512467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:46.555613 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m12:53:46.556000 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.556293 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:46.556561 [debug] [MainThread]: On master: COMMIT
[0m12:53:46.556951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:46.557299 [debug] [MainThread]: On master: Close
[0m12:53:46.558350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:46.558660 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:53:46.558920 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:53:46.559165 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:53:46.559403 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:53:46.559769 [info ] [MainThread]: 
[0m12:53:46.560077 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m12:53:46.561314 [debug] [MainThread]: Command end result
[0m12:53:46.633171 [info ] [MainThread]: 
[0m12:53:46.633607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:46.633920 [info ] [MainThread]: 
[0m12:53:46.634233 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:46.636911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8228965, "process_in_blocks": "0", "process_kernel_time": 0.436627, "process_mem_max_rss": "170131456", "process_out_blocks": "0", "process_user_time": 3.60153}
[0m12:53:46.637287 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:46.637214 after 1.82 seconds
[0m12:53:46.637615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091598d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa95e70>]}
[0m12:53:46.637938 [debug] [MainThread]: Flushing usage events
[0m12:53:56.297424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae198d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d9cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d9870>]}


============================== 12:53:56.302191 | a8d95aaf-2dd5-423d-82ea-4a256d7d951e ==============================
[0m12:53:56.302191 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:53:56.302715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target test', 'send_anonymous_usage_stats': 'True'}
[0m12:53:56.511162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c899ae0>]}
[0m12:53:56.562250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6ea080>]}
[0m12:53:56.568439 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:53:56.691187 [debug] [MainThread]: checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e, vars: {}, profile: , target: test, version: 1.8.9
[0m12:53:56.893771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:56.894161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:56.947598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d148280>]}
[0m12:53:57.126588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce83220>]}
[0m12:53:57.127085 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:53:57.127415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce81450>]}
[0m12:53:57.129556 [info ] [MainThread]: 
[0m12:53:57.130030 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:53:57.135389 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test'
[0m12:53:57.181295 [debug] [ThreadPool]: Using duckdb connection "list_test"
[0m12:53:57.181678 [debug] [ThreadPool]: On list_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'test'
    
  
  
[0m12:53:57.181993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.232202 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m12:53:57.233387 [debug] [ThreadPool]: On list_test: Close
[0m12:53:57.235706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test, now list_test_analytics_test)
[0m12:53:57.241649 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:57.242080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_analytics'
[0m12:53:57.242447 [debug] [ThreadPool]: On list_test_analytics_test: BEGIN
[0m12:53:57.245300 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:57.245594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:57.245928 [debug] [ThreadPool]: On list_test_analytics: BEGIN
[0m12:53:57.246264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:57.281852 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:57.282172 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics_test"
[0m12:53:57.282462 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m12:53:57.282776 [debug] [ThreadPool]: On list_test_analytics_test: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics_test"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_test'
    and table_catalog = 'test'
  
[0m12:53:57.283082 [debug] [ThreadPool]: Using duckdb connection "list_test_analytics"
[0m12:53:57.283466 [debug] [ThreadPool]: On list_test_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "connection_name": "list_test_analytics"} */
select
      'test' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'test'
  
[0m12:53:57.292443 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:53:57.292807 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m12:53:57.293961 [debug] [ThreadPool]: On list_test_analytics_test: ROLLBACK
[0m12:53:57.295048 [debug] [ThreadPool]: On list_test_analytics: ROLLBACK
[0m12:53:57.298303 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics'
[0m12:53:57.298630 [debug] [ThreadPool]: On list_test_analytics: Close
[0m12:53:57.298951 [debug] [ThreadPool]: Failed to rollback 'list_test_analytics_test'
[0m12:53:57.299372 [debug] [ThreadPool]: On list_test_analytics_test: Close
[0m12:53:57.302316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f6cb0>]}
[0m12:53:57.302798 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.303099 [debug] [MainThread]: On master: BEGIN
[0m12:53:57.303367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:57.340233 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:53:57.340537 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.340812 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.341069 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.341404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:57.341669 [debug] [MainThread]: On master: Close
[0m12:53:57.342648 [info ] [MainThread]: Concurrency: 4 threads (target='test')
[0m12:53:57.343001 [info ] [MainThread]: 
[0m12:53:57.344737 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:53:57.345254 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:53:57.345704 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:53:57.346158 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:53:57.346543 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:53:57.346900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_analytics_test, now model.ci_cd_project.stg_customers)
[0m12:53:57.347250 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:53:57.347598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_analytics, now model.ci_cd_project.stg_order_items)
[0m12:53:57.348030 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:53:57.348423 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:53:57.348875 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:53:57.349259 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:53:57.349676 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:53:57.358803 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:53:57.359265 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:53:57.362941 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:53:57.363314 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:53:57.363735 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:53:57.367988 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:53:57.371338 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:53:57.371711 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:53:57.372026 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:53:57.384301 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:53:57.411855 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:53:57.412153 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:53:57.413315 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:53:57.413890 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:53:57.417560 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:53:57.418114 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.418506 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.418871 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:53:57.419235 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.419594 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.419910 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:53:57.420230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:57.420557 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:53:57.420868 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:53:57.421170 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:57.421543 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:53:57.421856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:57.460073 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.460431 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.460756 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:53:57.461122 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.461454 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view test.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:53:57.461805 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:53:57.462102 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.462407 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.462753 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.463193 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view test.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:57.463614 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view test.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:53:57.463984 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.464317 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view test.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from test.analytics_test.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:53:57.470910 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.471390 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:53:57.471719 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "test"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m12:53:57.472044 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:53:57.475931 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.476245 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m12:53:57.479587 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.479947 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "test"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m12:53:57.480277 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.483567 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.483920 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view "test"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m12:53:57.487192 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.487544 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "test"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m12:53:57.487847 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.488203 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view test.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:53:57.488678 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.492359 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.492685 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.495945 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.496292 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
alter view test.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:53:57.496592 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.499679 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.500015 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
alter view test.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:53:57.506713 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m12:53:57.515714 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:57.516065 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
alter view test.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:53:57.517272 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:57.517630 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.517957 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.518319 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.518651 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:53:57.518939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.520000 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:57.520314 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:53:57.521412 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:57.521744 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.522102 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.522433 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.522741 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.523033 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:53:57.528789 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:53:57.529124 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:53:57.531977 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:53:57.532446 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists test.analytics.stg_order_items__dbt_backup cascade
[0m12:53:57.532888 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.533382 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists test.analytics.stg_orders__dbt_backup cascade
[0m12:53:57.533807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:53:57.537050 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:53:57.537382 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.540260 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:53:57.540624 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists test.analytics.stg_products__dbt_backup cascade
[0m12:53:57.540950 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.543168 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:53:57.543530 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists test.analytics.stg_customers__dbt_backup cascade
[0m12:53:57.544678 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:53:57.545644 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.546467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d149f60>]}
[0m12:53:57.546830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.547232 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3dba30>]}
[0m12:53:57.548287 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:53:57.549861 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:53:57.548850 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.20s]
[0m12:53:57.550446 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.20s]
[0m12:53:57.550915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6808e0>]}
[0m12:53:57.551431 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:53:57.551882 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:53:57.552370 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.19s]
[0m12:53:57.553063 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:53:57.553549 [debug] [Thread-2 (]: Began running node model.ci_cd_project.dim_products
[0m12:53:57.554001 [info ] [Thread-2 (]: 5 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:53:57.554525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now model.ci_cd_project.dim_products)
[0m12:53:57.554856 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:53:57.559468 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:53:57.560060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49d630>]}
[0m12:53:57.560667 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.21s]
[0m12:53:57.561321 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:53:57.561765 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.dim_products
[0m12:53:57.580962 [debug] [Thread-4 (]: Began running node model.ci_cd_project.dim_customers
[0m12:53:57.583300 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:53:57.583671 [debug] [Thread-3 (]: Began running node model.ci_cd_project.fct_orders
[0m12:53:57.584090 [info ] [Thread-4 (]: 6 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:53:57.584677 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:53:57.585130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now model.ci_cd_project.dim_customers)
[0m12:53:57.585509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now model.ci_cd_project.fct_orders)
[0m12:53:57.585859 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:53:57.586201 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:53:57.589819 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:53:57.594169 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:53:57.594562 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.595054 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:53:57.595434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:53:57.595891 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:53:57.596264 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:53:57.663623 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:53:57.667458 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:53:57.668101 [debug] [Thread-2 (]: SQL status: OK in 0.073 seconds
[0m12:53:57.668474 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.668868 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      test.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from test.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from test.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:53:57.669604 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.670011 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.670361 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:53:57.670726 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:53:57.671085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:53:57.671428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:53:57.671988 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.672314 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.672679 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      test.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from test.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from test.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:53:57.673044 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.673344 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.676795 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.677173 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.677510 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.677841 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table "test"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m12:53:57.678248 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      test.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from test.analytics.stg_orders
),

order_items as (
    select * from test.analytics.stg_order_items
),

products as (
    select * from test.analytics.stg_products
),

customers as (
    select * from test.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:53:57.681500 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.682096 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "test"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m12:53:57.682480 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.686454 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.686825 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
alter table test.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:53:57.687160 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m12:53:57.690508 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.690876 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
alter table test.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:53:57.691203 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m12:53:57.691528 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.694719 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.698992 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:57.699347 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m12:53:57.699663 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "test"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m12:53:57.699992 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.701138 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:57.701543 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:53:57.701875 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.702174 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.702546 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:53:57.705746 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.706071 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:53:57.706442 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
alter table test.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:53:57.706766 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:53:57.710386 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:53:57.713210 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:53:57.713556 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists test.analytics.dim_products__dbt_backup cascade
[0m12:53:57.713863 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:53:57.714193 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists test.analytics.dim_customers__dbt_backup cascade
[0m12:53:57.715398 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:57.715816 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.716127 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:53:57.716428 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:53:57.716741 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.717835 [debug] [Thread-2 (]: On model.ci_cd_project.dim_products: Close
[0m12:53:57.718149 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.719183 [debug] [Thread-4 (]: On model.ci_cd_project.dim_customers: Close
[0m12:53:57.719630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a96f0>]}
[0m12:53:57.722430 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:53:57.722850 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d777f40>]}
[0m12:53:57.723679 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "test", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists test.analytics.fct_orders__dbt_backup cascade
[0m12:53:57.723391 [info ] [Thread-2 (]: 5 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.17s]
[0m12:53:57.724279 [info ] [Thread-4 (]: 6 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.14s]
[0m12:53:57.724849 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.dim_products
[0m12:53:57.725302 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:53:57.725618 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:53:57.726820 [debug] [Thread-3 (]: On model.ci_cd_project.fct_orders: Close
[0m12:53:57.739321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d95aaf-2dd5-423d-82ea-4a256d7d951e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d777ac0>]}
[0m12:53:57.739971 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.15s]
[0m12:53:57.740591 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:53:57.741802 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.742103 [debug] [MainThread]: On master: BEGIN
[0m12:53:57.742379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:57.783855 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m12:53:57.784222 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.784519 [debug] [MainThread]: Using duckdb connection "master"
[0m12:53:57.784789 [debug] [MainThread]: On master: COMMIT
[0m12:53:57.785129 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:53:57.785398 [debug] [MainThread]: On master: Close
[0m12:53:57.786403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:57.786665 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:53:57.786902 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:53:57.787133 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:53:57.787361 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:53:57.787715 [info ] [MainThread]: 
[0m12:53:57.788016 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:53:57.789237 [debug] [MainThread]: Command end result
[0m12:53:57.861512 [info ] [MainThread]: 
[0m12:53:57.861938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:57.862237 [info ] [MainThread]: 
[0m12:53:57.862539 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:57.865171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6282461, "process_in_blocks": "0", "process_kernel_time": 0.289514, "process_mem_max_rss": "168837120", "process_out_blocks": "0", "process_user_time": 3.408644}
[0m12:53:57.865578 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:57.865496 after 1.63 seconds
[0m12:53:57.865907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae198d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ea1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce5cd60>]}
[0m12:53:57.866237 [debug] [MainThread]: Flushing usage events
[0m12:54:04.537472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae798d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c939cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c939870>]}


============================== 12:54:04.542279 | 7625b782-269d-426c-bf2c-96b6199ac7f5 ==============================
[0m12:54:04.542279 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:54:04.542801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --target prod', 'send_anonymous_usage_stats': 'True'}
[0m12:54:04.749150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3bbbb0>]}
[0m12:54:04.798819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b024040>]}
[0m12:54:04.803436 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:54:04.923185 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:54:05.045754 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:54:05.046198 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: a97dccaa182eba697c16e244145b1efb63f860d87508320d62b13f95150d894e
[0m12:54:05.046497 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:54:05.046820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcef190>]}
[0m12:54:07.373762 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:54:07.374271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cda7df0>]}
[0m12:54:07.762179 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:54:07.762656 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:54:07.762977 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:54:07.763274 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:54:07.763557 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:54:07.763834 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:54:07.764109 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:54:07.764381 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:54:07.764649 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:54:07.764920 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:54:07.765186 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:54:07.765456 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:54:07.765723 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:54:07.765993 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:54:07.766258 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:54:07.766528 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:54:07.766796 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:54:07.767062 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:54:07.767328 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:54:07.767594 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:54:07.767865 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:54:07.768131 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:54:07.768399 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:54:07.768668 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:54:07.768934 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:54:07.769199 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:54:07.769469 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:54:07.769738 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:54:07.878073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3683a0>]}
[0m12:54:08.023008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0af160>]}
[0m12:54:08.023502 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:54:08.023835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0adae0>]}
[0m12:54:08.026025 [info ] [MainThread]: 
[0m12:54:08.026491 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:54:08.031793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:54:08.076361 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:54:08.076741 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:54:08.077038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:08.129062 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m12:54:08.130220 [debug] [ThreadPool]: On list_prod: Close
[0m12:54:08.132465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now list_prod_analytics)
[0m12:54:08.138231 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:54:08.138563 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:54:08.138836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:08.174075 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m12:54:08.174426 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:54:08.174735 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:54:08.182241 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m12:54:08.183400 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:54:08.184708 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:54:08.185008 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:54:08.186672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac4d960>]}
[0m12:54:08.187080 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.187353 [debug] [MainThread]: On master: BEGIN
[0m12:54:08.187610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:08.221729 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m12:54:08.222075 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.222363 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.222627 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.222964 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:08.223231 [debug] [MainThread]: On master: Close
[0m12:54:08.224176 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:54:08.224500 [info ] [MainThread]: 
[0m12:54:08.226562 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:54:08.226963 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:54:08.228016 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:54:08.228753 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:54:08.228468 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:54:08.229260 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:54:08.229730 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:54:08.230197 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:54:08.230639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now model.ci_cd_project.stg_customers)
[0m12:54:08.231065 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_order_items'
[0m12:54:08.231467 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:54:08.231856 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:54:08.232179 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:54:08.232485 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:54:08.232782 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:54:08.233077 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:54:08.242056 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:54:08.245706 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:54:08.249041 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:54:08.253408 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:54:08.254166 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:54:08.254510 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:54:08.261138 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:54:08.267814 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:54:08.295607 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:54:08.296154 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:54:08.299888 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:54:08.335235 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:54:08.336184 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.336621 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.336993 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.337333 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.337640 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:54:08.337957 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:54:08.338266 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:54:08.338570 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:54:08.338867 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:08.339161 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:08.339450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:08.339741 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:08.377528 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.377894 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.378235 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.378549 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.378874 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:54:08.379168 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.379502 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:54:08.379830 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.380129 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.380454 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:54:08.380939 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:54:08.381316 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:54:08.381655 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.388276 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.388649 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.388997 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:54:08.389341 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.389668 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:54:08.392870 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.396775 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.399976 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.400294 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m12:54:08.400629 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:54:08.400962 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:54:08.401286 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:54:08.414984 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:54:08.415387 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.415884 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.416192 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.417251 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:54:08.417567 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.417883 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:54:08.418880 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:54:08.419221 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.420200 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:54:08.420618 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.420957 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:54:08.421308 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.421647 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.421952 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:54:08.422327 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:54:08.427448 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:54:08.427830 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.428273 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m12:54:08.431060 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:54:08.431378 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.431709 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.432097 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m12:54:08.435469 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:54:08.435811 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.438477 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:54:08.438888 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m12:54:08.441112 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:54:08.441435 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.441772 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m12:54:08.443549 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:54:08.444288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c6a0>]}
[0m12:54:08.444624 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.445177 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29fdf0>]}
[0m12:54:08.445695 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.21s]
[0m12:54:08.446899 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:54:08.447418 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.21s]
[0m12:54:08.447771 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.448255 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:54:08.448688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c490>]}
[0m12:54:08.449153 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:54:08.450215 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:54:08.450840 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.22s]
[0m12:54:08.451528 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:54:08.451998 [debug] [Thread-6 (]: Began running node model.ci_cd_project.dim_customers
[0m12:54:08.452479 [info ] [Thread-6 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:54:08.452990 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_customers'
[0m12:54:08.453316 [debug] [Thread-6 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:54:08.457344 [debug] [Thread-6 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:54:08.457879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c7f0>]}
[0m12:54:08.458448 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.23s]
[0m12:54:08.458972 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:54:08.459489 [debug] [Thread-8 (]: Began running node model.ci_cd_project.dim_products
[0m12:54:08.459818 [debug] [Thread-6 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:54:08.460171 [debug] [Thread-5 (]: Began running node model.ci_cd_project.fct_orders
[0m12:54:08.460579 [info ] [Thread-8 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:54:08.472577 [info ] [Thread-5 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:54:08.480762 [debug] [Thread-6 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:54:08.481208 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_products'
[0m12:54:08.481623 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.ci_cd_project.fct_orders'
[0m12:54:08.482051 [debug] [Thread-8 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:54:08.482404 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:54:08.487086 [debug] [Thread-8 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:54:08.487537 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.491529 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:54:08.491988 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:54:08.492539 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:54:08.492881 [debug] [Thread-8 (]: Began executing node model.ci_cd_project.dim_products
[0m12:54:08.496637 [debug] [Thread-8 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:54:08.496997 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:54:08.500699 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:54:08.532764 [debug] [Thread-6 (]: SQL status: OK in 0.040 seconds
[0m12:54:08.533122 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.533501 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.533925 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:54:08.534295 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:54:08.534661 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.535151 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:54:08.535455 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:54:08.535850 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:54:08.536269 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.536576 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.536948 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:54:08.537332 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.537875 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.538286 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:54:08.538658 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.543390 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.543792 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:54:08.544155 [debug] [Thread-8 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.544486 [debug] [Thread-5 (]: SQL status: OK in 0.005 seconds
[0m12:54:08.547754 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.550901 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.551216 [debug] [Thread-6 (]: SQL status: OK in 0.006 seconds
[0m12:54:08.551541 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:54:08.551862 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:54:08.556054 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:54:08.556581 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.556914 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:54:08.557287 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.558422 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:54:08.558764 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.559095 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.559389 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:54:08.560468 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:54:08.560788 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:54:08.563509 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:54:08.563835 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.564215 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m12:54:08.564550 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m12:54:08.564834 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:54:08.568305 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:54:08.568690 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:54:08.568997 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m12:54:08.569314 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.570377 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: Close
[0m12:54:08.573106 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:54:08.573568 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3565c0>]}
[0m12:54:08.573921 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m12:54:08.574238 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m12:54:08.575760 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: Close
[0m12:54:08.574788 [info ] [Thread-6 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.12s]
[0m12:54:08.576335 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d927e20>]}
[0m12:54:08.576826 [debug] [Thread-6 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:54:08.577145 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:54:08.577620 [info ] [Thread-8 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.10s]
[0m12:54:08.578813 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: Close
[0m12:54:08.579270 [debug] [Thread-8 (]: Finished running node model.ci_cd_project.dim_products
[0m12:54:08.590119 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7625b782-269d-426c-bf2c-96b6199ac7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d927b50>]}
[0m12:54:08.590724 [info ] [Thread-5 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.11s]
[0m12:54:08.591363 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:54:08.592404 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.592720 [debug] [MainThread]: On master: BEGIN
[0m12:54:08.592991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:08.630694 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m12:54:08.631027 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.631307 [debug] [MainThread]: Using duckdb connection "master"
[0m12:54:08.631575 [debug] [MainThread]: On master: COMMIT
[0m12:54:08.631906 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:54:08.632172 [debug] [MainThread]: On master: Close
[0m12:54:08.633147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:08.633453 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:54:08.633715 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_order_items' was properly closed.
[0m12:54:08.633953 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m12:54:08.634186 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_products' was properly closed.
[0m12:54:08.634419 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:54:08.634654 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:54:08.634880 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:54:08.635241 [info ] [MainThread]: 
[0m12:54:08.635548 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m12:54:08.636753 [debug] [MainThread]: Command end result
[0m12:54:08.708757 [info ] [MainThread]: 
[0m12:54:08.709179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:08.709488 [info ] [MainThread]: 
[0m12:54:08.709791 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:54:08.712729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.231933, "process_in_blocks": "0", "process_kernel_time": 0.299059, "process_mem_max_rss": "177061888", "process_out_blocks": "0", "process_user_time": 6.014648}
[0m12:54:08.713134 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:08.713054 after 4.23 seconds
[0m12:54:08.713469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae798d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d581960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96a200>]}
[0m12:54:08.713801 [debug] [MainThread]: Flushing usage events
[0m12:56:47.839798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108881cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108881840>]}


============================== 12:56:47.844651 | 89aa3906-18fa-4494-88a8-b31c049acaff ==============================
[0m12:56:47.844651 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:47.845201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --target prod', 'send_anonymous_usage_stats': 'True'}
[0m12:56:48.101310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106300f70>]}
[0m12:56:48.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c26560>]}
[0m12:56:48.155434 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:56:48.278512 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:56:48.489741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:48.490151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:48.543503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ec130>]}
[0m12:56:48.730261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3b4f0>]}
[0m12:56:48.730763 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:56:48.731096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89aa3906-18fa-4494-88a8-b31c049acaff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a23ac0>]}
[0m12:56:48.734395 [info ] [MainThread]: 
[0m12:56:48.734880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:56:48.740517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m12:56:48.792396 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:56:48.792762 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:56:48.793045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:48.849400 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:56:48.849773 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:56:48.850444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:48.850740 [debug] [MainThread]: Connection 'list_prod_analytics' was properly closed.
[0m12:56:48.851022 [info ] [MainThread]: 
[0m12:56:48.851328 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m12:56:48.851766 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/preben/Documents/dbt-workshop/./warehouse/prod.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:56:48.854488 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0757446, "process_in_blocks": "0", "process_kernel_time": 0.266153, "process_mem_max_rss": "130449408", "process_out_blocks": "0", "process_user_time": 1.887856}
[0m12:56:48.854885 [debug] [MainThread]: Command `dbt test` failed at 12:56:48.854804 after 1.08 seconds
[0m12:56:48.855208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911ded0>]}
[0m12:56:48.855539 [debug] [MainThread]: Flushing usage events
[0m12:56:58.656492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091818d0>]}


============================== 12:56:58.661235 | ae489945-7d81-468c-8c94-21ff79457b3d ==============================
[0m12:56:58.661235 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:58.661762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:58.866673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d76ce0>]}
[0m12:56:58.916361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092178b0>]}
[0m12:56:58.920659 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:56:59.041605 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:56:59.163917 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:56:59.164343 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m12:56:59.164628 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:56:59.164948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536c20>]}
[0m12:57:01.467220 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:57:01.467708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109797f10>]}
[0m12:57:01.848641 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:57:01.849114 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:57:01.849437 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:57:01.849740 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:57:01.850024 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:57:01.850303 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:57:01.850578 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:57:01.850854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:57:01.851123 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:57:01.851390 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:57:01.851659 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:57:01.851922 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:57:01.852189 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:57:01.852455 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:57:01.852728 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:57:01.852992 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:57:01.853261 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:57:01.853524 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:57:01.853791 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:57:01.854058 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:57:01.854323 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:57:01.854594 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:57:01.854859 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:57:01.855128 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:57:01.855392 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:57:01.855655 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:57:01.855923 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:57:01.856184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:57:01.963253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0de10>]}
[0m12:57:02.117249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109525480>]}
[0m12:57:02.117761 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:02.118093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae489945-7d81-468c-8c94-21ff79457b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b340>]}
[0m12:57:02.121411 [info ] [MainThread]: 
[0m12:57:02.121893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:02.127609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:57:02.137967 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m12:57:02.172859 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:02.173237 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:02.173545 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:57:02.173839 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:57:02.174121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:02.174394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:02.180480 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:57:02.180843 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:57:02.183480 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m12:57:02.183805 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:57:02.184337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:02.184609 [debug] [MainThread]: Connection 'list_dev_analytics_dev' was properly closed.
[0m12:57:02.184854 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m12:57:02.185116 [info ] [MainThread]: 
[0m12:57:02.185410 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:57:02.185823 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/preben/Documents/dbt-workshop/./warehouse/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 21255) by user preben. See also https://duckdb.org/docs/stable/connect/concurrency
[0m12:57:02.188516 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.5890808, "process_in_blocks": "0", "process_kernel_time": 0.19364, "process_mem_max_rss": "140443648", "process_out_blocks": "0", "process_user_time": 4.514934}
[0m12:57:02.188890 [debug] [MainThread]: Command `dbt test` failed at 12:57:02.188814 after 3.59 seconds
[0m12:57:02.189213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099296c0>]}
[0m12:57:02.189552 [debug] [MainThread]: Flushing usage events
[0m12:57:31.080619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e89900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a949cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a949840>]}


============================== 12:57:31.085359 | d683f181-7e49-4d6d-9b6b-0ca68b0154c0 ==============================
[0m12:57:31.085359 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:57:31.085878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:57:31.315914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953ca90>]}
[0m12:57:31.365820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d35300>]}
[0m12:57:31.370092 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:57:31.492874 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m12:57:31.706170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:31.706574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:31.760186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b4130>]}
[0m12:57:31.946015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af034f0>]}
[0m12:57:31.946520 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:31.946853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf8e20>]}
[0m12:57:31.950172 [info ] [MainThread]: 
[0m12:57:31.950661 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:31.956496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics_dev'
[0m12:57:31.959669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_analytics'
[0m12:57:32.014932 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:32.015319 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:32.015632 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m12:57:32.015937 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m12:57:32.016224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:32.016502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:32.172465 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m12:57:32.172885 [debug] [ThreadPool]: SQL status: OK in 0.156 seconds
[0m12:57:32.173205 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m12:57:32.173518 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m12:57:32.173847 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m12:57:32.174179 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m12:57:32.195915 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m12:57:32.196618 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m12:57:32.197727 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m12:57:32.198803 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m12:57:32.199574 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m12:57:32.199928 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m12:57:32.200203 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m12:57:32.200480 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m12:57:32.203333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd683f181-7e49-4d6d-9b6b-0ca68b0154c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad25ab0>]}
[0m12:57:32.203764 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:32.204046 [debug] [MainThread]: On master: BEGIN
[0m12:57:32.204305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:32.239316 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m12:57:32.239684 [debug] [MainThread]: On master: COMMIT
[0m12:57:32.239985 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:32.240263 [debug] [MainThread]: On master: COMMIT
[0m12:57:32.240609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:32.240887 [debug] [MainThread]: On master: Close
[0m12:57:32.241924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:32.242234 [info ] [MainThread]: 
[0m12:57:32.244773 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.245187 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.245852 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.246190 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.245571 [info ] [Thread-1 (]: 1 of 41 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m12:57:32.246616 [info ] [Thread-2 (]: 2 of 41 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m12:57:32.247032 [info ] [Thread-3 (]: 3 of 41 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:57:32.247496 [info ] [Thread-4 (]: 4 of 41 START test not_null_dim_customers_customer_tier ........................ [RUN]
[0m12:57:32.247907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m12:57:32.248270 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m12:57:32.248686 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:57:32.249080 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:57:32.249413 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.249741 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.250052 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.250352 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.274401 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.277565 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.285692 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.289754 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.290727 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.291115 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.304112 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.304475 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.316299 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.321981 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.324789 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.328096 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.328966 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.329323 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:57:32.329706 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.330062 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:32.330493 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m12:57:32.330905 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.331275 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.331692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.332040 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m12:57:32.332362 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m12:57:32.332713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.333027 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:32.367518 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:32.367871 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.368190 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:57:32.368505 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.368846 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.369196 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:57:32.369559 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.369916 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:57:32.370235 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:57:32.370581 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.371079 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.371463 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.384704 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.385188 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.385596 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.386012 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:57:32.386346 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.386690 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387051 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387391 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.387813 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m12:57:32.388212 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:57:32.388594 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m12:57:32.388981 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m12:57:32.396056 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:57:32.396440 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m12:57:32.397147 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:57:32.397871 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m12:57:32.398779 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:57:32.399112 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:57:32.399489 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m12:57:32.399847 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m12:57:32.400612 [debug] [Thread-4 (]: Runtime Error in test not_null_dim_customers_customer_tier (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.401557 [error] [Thread-4 (]: 4 of 41 ERROR not_null_dim_customers_customer_tier ............................. [[31mERROR[0m in 0.15s]
[0m12:57:32.402272 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:57:32.402698 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.403065 [info ] [Thread-4 (]: 5 of 41 START test not_null_dim_customers_total_orders ......................... [RUN]
[0m12:57:32.404458 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.404840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m12:57:32.405598 [debug] [Thread-1 (]: Runtime Error in test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 20:     from dev.analytics.dim_customers
                    ^
[0m12:57:32.406010 [error] [Thread-3 (]: 3 of 41 ERROR not_null_dim_customers_customer_id ............................... [[31mERROR[0m in 0.16s]
[0m12:57:32.406408 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.407167 [debug] [Thread-2 (]: Runtime Error in test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 20:     from dev.analytics.dim_products
                    ^
[0m12:57:32.407575 [error] [Thread-1 (]: 1 of 41 ERROR accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[31mERROR[0m in 0.16s]
[0m12:57:32.408213 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:57:32.413045 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.413528 [error] [Thread-2 (]: 2 of 41 ERROR accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[31mERROR[0m in 0.17s]
[0m12:57:32.414244 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:57:32.414634 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.415257 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:57:32.415650 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.416100 [info ] [Thread-3 (]: 6 of 41 START test not_null_dim_customers_total_spent .......................... [RUN]
[0m12:57:32.416544 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.416858 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.417238 [info ] [Thread-1 (]: 7 of 41 START test not_null_dim_products_performance_category .................. [RUN]
[0m12:57:32.417658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m12:57:32.418039 [info ] [Thread-2 (]: 8 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m12:57:32.421055 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.421462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m12:57:32.421823 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.422221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m12:57:32.422656 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.426955 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.427311 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.427696 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.432715 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.436862 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.437276 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m12:57:32.437696 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.438077 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.440951 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.441401 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.441763 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.444924 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.448342 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.448822 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.481394 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m12:57:32.481805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.482298 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.482658 [debug] [Thread-4 (]: SQL status: OK in 0.045 seconds
[0m12:57:32.483114 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.483448 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m12:57:32.483787 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.484104 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:57:32.484424 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:57:32.484741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.485072 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:57:32.485411 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.485741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.486128 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.486465 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.487052 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:57:32.487387 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:57:32.487731 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.488075 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:57:32.488489 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.493927 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.494315 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.494740 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495177 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495587 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.495998 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:57:32.496330 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.496649 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.496967 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.497437 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m12:57:32.497943 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m12:57:32.498373 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m12:57:32.499399 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:57:32.499859 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:57:32.501014 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:57:32.501361 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m12:57:32.502051 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:57:32.502609 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m12:57:32.503566 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:57:32.503894 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m12:57:32.504566 [debug] [Thread-2 (]: Runtime Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.505842 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_customers_total_spent (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.505112 [error] [Thread-2 (]: 8 of 41 ERROR not_null_dim_products_product_id ................................. [[31mERROR[0m in 0.08s]
[0m12:57:32.506380 [error] [Thread-3 (]: 6 of 41 ERROR not_null_dim_customers_total_spent ............................... [[31mERROR[0m in 0.09s]
[0m12:57:32.507122 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:57:32.507898 [debug] [Thread-4 (]: Runtime Error in test not_null_dim_customers_total_orders (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:32.508392 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:57:32.508810 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.509239 [error] [Thread-4 (]: 5 of 41 ERROR not_null_dim_customers_total_orders .............................. [[31mERROR[0m in 0.10s]
[0m12:57:32.509783 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.510496 [debug] [Thread-1 (]: Runtime Error in test not_null_dim_products_performance_category (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.510839 [info ] [Thread-2 (]: 9 of 41 START test not_null_dim_products_profit_margin ......................... [RUN]
[0m12:57:32.511407 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:57:32.511754 [info ] [Thread-3 (]: 10 of 41 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:57:32.512225 [error] [Thread-1 (]: 7 of 41 ERROR not_null_dim_products_performance_category ....................... [[31mERROR[0m in 0.09s]
[0m12:57:32.512713 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m12:57:32.513099 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.513506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:57:32.513993 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:57:32.514309 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.514639 [info ] [Thread-4 (]: 11 of 41 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:57:32.515045 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.515445 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.519970 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.520390 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:57:32.524586 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.524990 [info ] [Thread-1 (]: 12 of 41 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:57:32.525444 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.525897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m12:57:32.530198 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.530637 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.531007 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.531303 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.536408 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.539265 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.541995 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.542592 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.545488 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.546025 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.546387 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:57:32.546711 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.547065 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.547386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.547764 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.585217 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.585587 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m12:57:32.586041 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:57:32.586510 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.586866 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.587489 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.587827 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:57:32.588135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.623508 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m12:57:32.623865 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:57:32.624181 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.624483 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.624764 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.625074 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.625402 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:57:32.625705 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:57:32.626004 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:57:32.626390 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.626860 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.627208 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.634159 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.634657 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635086 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635489 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.635808 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636120 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636423 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.636720 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.637105 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:57:32.637484 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m12:57:32.637849 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:57:32.638207 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:57:32.639604 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m12:57:32.639975 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m12:57:32.640811 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m12:57:32.641353 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:57:32.642039 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m12:57:32.642839 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m12:57:32.643155 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:57:32.643649 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:57:32.644740 [debug] [Thread-2 (]: Runtime Error in test not_null_dim_products_profit_margin (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.645430 [debug] [Thread-3 (]: Runtime Error in test not_null_dim_products_total_revenue (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:32.646021 [error] [Thread-2 (]: 9 of 41 ERROR not_null_dim_products_profit_margin .............................. [[31mERROR[0m in 0.13s]
[0m12:57:32.646498 [error] [Thread-3 (]: 10 of 41 ERROR not_null_dim_products_total_revenue ............................. [[31mERROR[0m in 0.13s]
[0m12:57:32.647032 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:57:32.647524 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:57:32.647961 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.648494 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.649198 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_orders_customer_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.649902 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_orders_order_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.650242 [info ] [Thread-2 (]: 13 of 41 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m12:57:32.650600 [info ] [Thread-3 (]: 14 of 41 START test not_null_fct_orders_product_id ............................. [RUN]
[0m12:57:32.651056 [error] [Thread-4 (]: 11 of 41 ERROR not_null_fct_orders_customer_id ................................. [[31mERROR[0m in 0.13s]
[0m12:57:32.651503 [error] [Thread-1 (]: 12 of 41 ERROR not_null_fct_orders_order_id .................................... [[31mERROR[0m in 0.13s]
[0m12:57:32.651903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m12:57:32.652263 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m12:57:32.652869 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:57:32.653336 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:57:32.653657 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.653963 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.654322 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.654728 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.659174 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.663464 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.663864 [info ] [Thread-4 (]: 15 of 41 START test not_null_fct_orders_quantity ............................... [RUN]
[0m12:57:32.664282 [info ] [Thread-1 (]: 16 of 41 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m12:57:32.664843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m12:57:32.665293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m12:57:32.665661 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.665973 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.666261 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.666565 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.670685 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.674573 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.677334 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.681504 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.682409 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.682809 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.683136 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m12:57:32.683504 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.683821 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m12:57:32.684145 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.684464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.687313 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.687652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.691134 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.691837 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.692203 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m12:57:32.692521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.692931 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.693271 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m12:57:32.693843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.728889 [debug] [Thread-3 (]: SQL status: OK in 0.044 seconds
[0m12:57:32.729274 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:57:32.729606 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:57:32.729920 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.730208 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.730521 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:57:32.730855 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.731182 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:57:32.731485 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:57:32.731805 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.732263 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.732646 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.739860 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.740247 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.740675 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741113 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741514 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.741923 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m12:57:32.742249 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.742562 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.742869 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.743350 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m12:57:32.743846 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m12:57:32.744282 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m12:57:32.745403 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m12:57:32.745887 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m12:57:32.746618 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m12:57:32.747113 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m12:57:32.748054 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m12:57:32.748718 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m12:57:32.749078 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m12:57:32.749438 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m12:57:32.750161 [debug] [Thread-3 (]: Runtime Error in test not_null_fct_orders_product_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.750916 [error] [Thread-3 (]: 14 of 41 ERROR not_null_fct_orders_product_id .................................. [[31mERROR[0m in 0.10s]
[0m12:57:32.751485 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:57:32.752135 [debug] [Thread-2 (]: Runtime Error in test not_null_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.752538 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.753170 [error] [Thread-2 (]: 13 of 41 ERROR not_null_fct_orders_order_item_id ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.753703 [info ] [Thread-3 (]: 17 of 41 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m12:57:32.754467 [debug] [Thread-4 (]: Runtime Error in test not_null_fct_orders_quantity (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.754945 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:57:32.755563 [debug] [Thread-1 (]: Runtime Error in test not_null_fct_orders_unit_price (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:32.755932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m12:57:32.756332 [error] [Thread-4 (]: 15 of 41 ERROR not_null_fct_orders_quantity .................................... [[31mERROR[0m in 0.09s]
[0m12:57:32.756753 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.757146 [error] [Thread-1 (]: 16 of 41 ERROR not_null_fct_orders_unit_price .................................. [[31mERROR[0m in 0.09s]
[0m12:57:32.757509 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.758210 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:57:32.758565 [info ] [Thread-2 (]: 18 of 41 START test not_null_stg_customers_email ............................... [RUN]
[0m12:57:32.759049 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:57:32.763581 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.764016 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.764443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m12:57:32.764828 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.765617 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.765315 [info ] [Thread-4 (]: 19 of 41 START test not_null_stg_customers_first_name .......................... [RUN]
[0m12:57:32.766050 [info ] [Thread-1 (]: 20 of 41 START test not_null_stg_customers_last_name ........................... [RUN]
[0m12:57:32.770233 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.770660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_quantity.f754434156, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m12:57:32.771049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m12:57:32.771389 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.771777 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.772100 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.774954 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.780419 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.780771 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.784865 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.787862 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.788420 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.791248 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.791682 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.792106 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.795730 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.796109 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m12:57:32.796506 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.796878 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.797275 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.797622 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m12:57:32.797958 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m12:57:32.798318 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.798715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.799037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.799360 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m12:57:32.799724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.833728 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.834132 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:57:32.834473 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.834783 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:57:32.835073 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.835384 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.835718 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:57:32.836023 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:57:32.836325 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:57:32.836702 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.837159 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.837511 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.844766 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.845245 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.845656 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.846048 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.846362 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.846677 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.846984 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.847283 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.847673 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m12:57:32.848052 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m12:57:32.848425 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m12:57:32.848794 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m12:57:32.850289 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m12:57:32.851060 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m12:57:32.851405 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m12:57:32.852055 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m12:57:32.852710 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m12:57:32.853013 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m12:57:32.853535 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m12:57:32.853873 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m12:57:32.855138 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_customers_first_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.856404 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_last_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.855706 [error] [Thread-4 (]: 19 of 41 ERROR not_null_stg_customers_first_name ............................... [[31mERROR[0m in 0.09s]
[0m12:57:32.856934 [error] [Thread-1 (]: 20 of 41 ERROR not_null_stg_customers_last_name ................................ [[31mERROR[0m in 0.09s]
[0m12:57:32.857692 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.858281 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:57:32.858937 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:32.859396 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:57:32.859779 [error] [Thread-3 (]: 17 of 41 ERROR not_null_stg_customers_customer_id .............................. [[31mERROR[0m in 0.10s]
[0m12:57:32.860179 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.860637 [error] [Thread-2 (]: 18 of 41 ERROR not_null_stg_customers_email .................................... [[31mERROR[0m in 0.10s]
[0m12:57:32.861089 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.861620 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:57:32.861963 [info ] [Thread-4 (]: 21 of 41 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m12:57:32.862580 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:57:32.862934 [info ] [Thread-1 (]: 22 of 41 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m12:57:32.863341 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.863718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m12:57:32.864095 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.864497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m12:57:32.864836 [info ] [Thread-3 (]: 23 of 41 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m12:57:32.865180 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.865504 [info ] [Thread-2 (]: 24 of 41 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m12:57:32.865834 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.866168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m12:57:32.870704 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.871118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m12:57:32.875271 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.875653 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.876085 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.880422 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.885615 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.886145 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.888960 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.889429 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.889813 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.892553 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.892898 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.895661 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.896148 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.899372 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.899836 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m12:57:32.900248 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.900618 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:32.900963 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.901290 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m12:57:32.901690 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m12:57:32.902048 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.902383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:32.902696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:32.903026 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m12:57:32.903412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.937541 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m12:57:32.937912 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.938243 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:57:32.938550 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m12:57:32.938836 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:57:32.939143 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:57:32.939470 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.939800 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:57:32.940099 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:57:32.940419 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.940861 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.941252 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.948556 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.948963 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.949397 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.949809 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.950200 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:57:32.950599 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m12:57:32.950930 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951238 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951541 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:32.951985 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m12:57:32.952481 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m12:57:32.952928 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m12:57:32.954066 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m12:57:32.954420 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m12:57:32.955529 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m12:57:32.956280 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m12:57:32.956926 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m12:57:32.957247 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m12:57:32.957976 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_order_items_product_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.958292 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m12:57:32.958595 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m12:57:32.959026 [error] [Thread-3 (]: 23 of 41 ERROR not_null_stg_order_items_product_id ............................. [[31mERROR[0m in 0.09s]
[0m12:57:32.960132 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:57:32.960580 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.960949 [info ] [Thread-3 (]: 25 of 41 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m12:57:32.961409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m12:57:32.962087 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_order_items_order_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.962683 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.963141 [error] [Thread-4 (]: 21 of 41 ERROR not_null_stg_order_items_order_id ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.967946 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.968638 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.969252 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:57:32.969921 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_order_items_quantity (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:32.970444 [error] [Thread-1 (]: 22 of 41 ERROR not_null_stg_order_items_order_item_id .......................... [[31mERROR[0m in 0.11s]
[0m12:57:32.970915 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.971379 [error] [Thread-2 (]: 24 of 41 ERROR not_null_stg_order_items_quantity ............................... [[31mERROR[0m in 0.10s]
[0m12:57:32.971886 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:57:32.972252 [info ] [Thread-4 (]: 26 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m12:57:32.972774 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:57:32.973149 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.973515 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:32.973877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:57:32.974259 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:32.974638 [info ] [Thread-1 (]: 27 of 41 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m12:57:32.977580 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.978080 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.978437 [info ] [Thread-2 (]: 28 of 41 START test not_null_stg_products_cost ................................. [RUN]
[0m12:57:32.978867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m12:57:32.983192 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:32.983606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m12:57:32.983982 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.984388 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:32.989385 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:32.993483 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:32.993964 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:32.994513 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:32.994944 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:57:32.997803 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:32.998228 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:32.998545 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:32.998919 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:33.001820 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.005311 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.005850 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:33.006223 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:57:33.036543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.037142 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.037513 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:57:33.037876 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.038267 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.038620 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.039017 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.039333 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:57:33.039665 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m12:57:33.040097 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m12:57:33.040444 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.040790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.041105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.041696 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.042010 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:57:33.042325 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.042657 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.043031 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:57:33.043482 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.046859 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.047261 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.047686 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048093 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048487 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.048886 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:57:33.049211 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.049581 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.049919 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.050445 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:57:33.050887 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m12:57:33.051313 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m12:57:33.052210 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m12:57:33.052795 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:57:33.053903 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m12:57:33.054218 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m12:57:33.054915 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m12:57:33.055435 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:57:33.056206 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m12:57:33.056534 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m12:57:33.057473 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.058067 [error] [Thread-4 (]: 26 of 41 ERROR not_null_stg_orders_order_id .................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.058714 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:57:33.059376 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_products_cost (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.059810 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.060399 [error] [Thread-2 (]: 28 of 41 ERROR not_null_stg_products_cost ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.061156 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_orders_customer_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.061508 [info ] [Thread-4 (]: 29 of 41 START test not_null_stg_products_price ................................ [RUN]
[0m12:57:33.062021 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:57:33.062648 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_orders_total_amount (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.063044 [error] [Thread-3 (]: 25 of 41 ERROR not_null_stg_orders_customer_id ................................. [[31mERROR[0m in 0.10s]
[0m12:57:33.063545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m12:57:33.063923 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.064518 [error] [Thread-1 (]: 27 of 41 ERROR not_null_stg_orders_total_amount ................................ [[31mERROR[0m in 0.09s]
[0m12:57:33.065103 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:57:33.065427 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.065763 [info ] [Thread-2 (]: 30 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m12:57:33.066248 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:57:33.066610 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.071137 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.071559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m12:57:33.071968 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.072382 [info ] [Thread-3 (]: 31 of 41 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m12:57:33.072827 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.073183 [info ] [Thread-1 (]: 32 of 41 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m12:57:33.073569 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m12:57:33.077875 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.078323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m12:57:33.078667 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.078993 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.079408 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.082342 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.097614 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.098026 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.098483 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.101479 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.102016 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.102424 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.102745 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m12:57:33.105568 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.105947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.106314 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.106758 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.110490 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.110848 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:57:33.111227 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.111608 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.111936 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m12:57:33.112343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.112736 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.113081 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m12:57:33.113380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.145515 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:57:33.145866 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m12:57:33.146176 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:57:33.146485 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m12:57:33.146818 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:57:33.147114 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m12:57:33.147441 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.147774 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:57:33.148099 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.148431 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:57:33.148879 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.149399 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.156603 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.157005 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.157473 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.157919 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.158346 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.158761 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m12:57:33.159089 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.159399 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.159706 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.160194 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m12:57:33.160689 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:57:33.161125 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m12:57:33.162242 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m12:57:33.162607 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m12:57:33.163735 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m12:57:33.164410 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m12:57:33.164751 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:57:33.165162 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m12:57:33.165812 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m12:57:33.166775 [debug] [Thread-4 (]: Runtime Error in test not_null_stg_products_price (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.167251 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m12:57:33.168018 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.168451 [error] [Thread-4 (]: 29 of 41 ERROR not_null_stg_products_price ..................................... [[31mERROR[0m in 0.10s]
[0m12:57:33.169050 [error] [Thread-2 (]: 30 of 41 ERROR not_null_stg_products_product_id ................................ [[31mERROR[0m in 0.10s]
[0m12:57:33.169778 [debug] [Thread-3 (]: Runtime Error in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.170275 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:57:33.170898 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:57:33.171304 [error] [Thread-3 (]: 31 of 41 ERROR relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[31mERROR[0m in 0.10s]
[0m12:57:33.171743 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.172570 [debug] [Thread-1 (]: Runtime Error in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.172927 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.173437 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:57:33.173781 [info ] [Thread-4 (]: 33 of 41 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m12:57:33.174216 [error] [Thread-1 (]: 32 of 41 ERROR relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[31mERROR[0m in 0.10s]
[0m12:57:33.174588 [info ] [Thread-2 (]: 34 of 41 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:57:33.174997 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.175408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:57:33.176070 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:57:33.176520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:57:33.176875 [info ] [Thread-3 (]: 35 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m12:57:33.177218 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.177569 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.177930 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.178305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m12:57:33.184118 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.184523 [info ] [Thread-1 (]: 36 of 41 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m12:57:33.190933 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.191332 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.191779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m12:57:33.196055 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.196474 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.196925 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.201945 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.202293 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.245081 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.248114 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.248513 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.251522 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.251901 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.252415 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.255159 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.255510 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.255862 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m12:57:33.256271 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.256600 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:57:33.256959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.257307 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:57:33.257653 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.257962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.258344 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.258666 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m12:57:33.259040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.296707 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.297098 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:57:33.297435 [debug] [Thread-4 (]: SQL status: OK in 0.040 seconds
[0m12:57:33.297750 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.298089 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.298413 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:57:33.298726 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:57:33.299025 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:57:33.299371 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:57:33.299824 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.300194 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.300540 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.306863 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.307271 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.307721 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.308155 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.308578 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:57:33.308992 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:57:33.309317 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.309629 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.309976 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.310439 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:57:33.310924 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m12:57:33.311377 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m12:57:33.312397 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m12:57:33.312820 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:57:33.313894 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m12:57:33.314308 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m12:57:33.315211 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m12:57:33.315874 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m12:57:33.316194 [debug] [Thread-3 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:57:33.316603 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m12:57:33.317243 [debug] [Thread-2 (]: Runtime Error in test unique_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.dim_customers
                ^
[0m12:57:33.318005 [error] [Thread-2 (]: 34 of 41 ERROR unique_dim_customers_customer_id ................................ [[31mERROR[0m in 0.14s]
[0m12:57:33.318629 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:57:33.319029 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.319385 [info ] [Thread-2 (]: 37 of 41 START test unique_stg_customers_customer_id ........................... [RUN]
[0m12:57:33.320133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m12:57:33.320810 [debug] [Thread-3 (]: Runtime Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.dim_products
                ^
[0m12:57:33.321159 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.321808 [debug] [Thread-4 (]: Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 16:     from dev.analytics.stg_orders
                    ^
[0m12:57:33.322227 [error] [Thread-3 (]: 35 of 41 ERROR unique_dim_products_product_id .................................. [[31mERROR[0m in 0.14s]
[0m12:57:33.327867 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.328352 [error] [Thread-4 (]: 33 of 41 ERROR relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[31mERROR[0m in 0.15s]
[0m12:57:33.328863 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:57:33.329636 [debug] [Thread-1 (]: Runtime Error in test unique_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.fct_orders
                ^
[0m12:57:33.330180 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:57:33.330570 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.330993 [error] [Thread-1 (]: 36 of 41 ERROR unique_fct_orders_order_item_id ................................. [[31mERROR[0m in 0.14s]
[0m12:57:33.331409 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.331814 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.332134 [info ] [Thread-3 (]: 38 of 41 START test unique_stg_customers_email ................................. [RUN]
[0m12:57:33.332603 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:57:33.332923 [info ] [Thread-4 (]: 39 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m12:57:33.335871 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.336278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m12:57:33.336692 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.337110 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m12:57:33.337535 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.337875 [info ] [Thread-1 (]: 40 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:57:33.338234 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.342289 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.342702 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.343046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:57:33.347314 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.347764 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m12:57:33.348096 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.348511 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:57:33.348841 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.353821 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.356715 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.357067 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.359937 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.360543 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.361151 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.361491 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m12:57:33.364318 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.364682 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.396143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.396582 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m12:57:33.396919 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m12:57:33.397397 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:57:33.397735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:57:33.398030 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:57:33.398386 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.398766 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.399163 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:57:33.399479 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:57:33.399912 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:57:33.400249 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.400580 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:57:33.400876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:33.401316 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.401817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:57:33.402129 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:57:33.402458 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.406398 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.406888 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.407323 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.407732 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.408056 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.408393 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.408736 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.409054 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.409449 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m12:57:33.409836 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m12:57:33.410205 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:57:33.410574 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m12:57:33.412036 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m12:57:33.412707 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m12:57:33.413430 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m12:57:33.413802 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m12:57:33.414467 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m12:57:33.414760 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:57:33.415060 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m12:57:33.415428 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m12:57:33.416966 [debug] [Thread-3 (]: Runtime Error in test unique_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.417436 [error] [Thread-3 (]: 38 of 41 ERROR unique_stg_customers_email ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.417972 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:57:33.418639 [debug] [Thread-1 (]: Runtime Error in test unique_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.stg_orders
                ^
[0m12:57:33.419161 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.419754 [error] [Thread-1 (]: 40 of 41 ERROR unique_stg_orders_order_id ...................................... [[31mERROR[0m in 0.08s]
[0m12:57:33.420455 [debug] [Thread-2 (]: Runtime Error in test unique_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.420867 [info ] [Thread-3 (]: 41 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m12:57:33.421388 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:57:33.421848 [error] [Thread-2 (]: 37 of 41 ERROR unique_stg_customers_customer_id ................................ [[31mERROR[0m in 0.10s]
[0m12:57:33.422536 [debug] [Thread-4 (]: Runtime Error in test unique_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 18: from dev.analytics.stg_order_items
                ^
[0m12:57:33.422912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m12:57:33.423672 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:57:33.424076 [error] [Thread-4 (]: 39 of 41 ERROR unique_stg_order_items_order_item_id ............................ [[31mERROR[0m in 0.09s]
[0m12:57:33.424438 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.425009 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:57:33.430483 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.431238 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.434042 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.434629 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.434946 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:57:33.435237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:57:33.472660 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:33.473034 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:57:33.473370 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.479347 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:57:33.479739 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:33.480144 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:57:33.481003 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m12:57:33.481320 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m12:57:33.482947 [debug] [Thread-3 (]: Runtime Error in test unique_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.stg_products
                ^
[0m12:57:33.483406 [error] [Thread-3 (]: 41 of 41 ERROR unique_stg_products_product_id .................................. [[31mERROR[0m in 0.06s]
[0m12:57:33.483919 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:57:33.484895 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:33.485201 [debug] [MainThread]: On master: BEGIN
[0m12:57:33.485458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:33.523235 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m12:57:33.523592 [debug] [MainThread]: On master: COMMIT
[0m12:57:33.523926 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:33.524242 [debug] [MainThread]: On master: COMMIT
[0m12:57:33.524609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:33.524887 [debug] [MainThread]: On master: Close
[0m12:57:33.525821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:33.526082 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:57:33.526326 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m12:57:33.526640 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:57:33.526907 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108' was properly closed.
[0m12:57:33.527250 [info ] [MainThread]: 
[0m12:57:33.527557 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m12:57:33.532611 [debug] [MainThread]: Command end result
[0m12:57:33.606484 [info ] [MainThread]: 
[0m12:57:33.606927 [info ] [MainThread]: [31mCompleted with 41 errors and 0 warnings:[0m
[0m12:57:33.607212 [info ] [MainThread]: 
[0m12:57:33.607564 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_customer_tier (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.607847 [info ] [MainThread]: 
[0m12:57:33.608173 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.608439 [info ] [MainThread]: 
[0m12:57:33.608764 [error] [MainThread]:   Runtime Error in test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 20:     from dev.analytics.dim_customers
                    ^
[0m12:57:33.609028 [info ] [MainThread]: 
[0m12:57:33.609399 [error] [MainThread]:   Runtime Error in test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 20:     from dev.analytics.dim_products
                    ^
[0m12:57:33.609720 [info ] [MainThread]: 
[0m12:57:33.610054 [error] [MainThread]:   Runtime Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.610321 [info ] [MainThread]: 
[0m12:57:33.610638 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_total_spent (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.610898 [info ] [MainThread]: 
[0m12:57:33.611211 [error] [MainThread]:   Runtime Error in test not_null_dim_customers_total_orders (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.dim_customers
                ^
[0m12:57:33.611468 [info ] [MainThread]: 
[0m12:57:33.611832 [error] [MainThread]:   Runtime Error in test not_null_dim_products_performance_category (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.612210 [info ] [MainThread]: 
[0m12:57:33.612568 [error] [MainThread]:   Runtime Error in test not_null_dim_products_profit_margin (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.612841 [info ] [MainThread]: 
[0m12:57:33.613170 [error] [MainThread]:   Runtime Error in test not_null_dim_products_total_revenue (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.dim_products
                ^
[0m12:57:33.613676 [info ] [MainThread]: 
[0m12:57:33.614053 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_customer_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.614322 [info ] [MainThread]: 
[0m12:57:33.614638 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_order_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.614896 [info ] [MainThread]: 
[0m12:57:33.615205 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_product_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.615461 [info ] [MainThread]: 
[0m12:57:33.615770 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.616022 [info ] [MainThread]: 
[0m12:57:33.616325 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_quantity (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.616578 [info ] [MainThread]: 
[0m12:57:33.616910 [error] [MainThread]:   Runtime Error in test not_null_fct_orders_unit_price (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.fct_orders
                ^
[0m12:57:33.617188 [info ] [MainThread]: 
[0m12:57:33.617503 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_first_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.617764 [info ] [MainThread]: 
[0m12:57:33.618073 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_last_name (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.618325 [info ] [MainThread]: 
[0m12:57:33.618631 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.618887 [info ] [MainThread]: 
[0m12:57:33.619193 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 17: from dev.analytics.stg_customers
                ^
[0m12:57:33.619450 [info ] [MainThread]: 
[0m12:57:33.619760 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_product_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.620024 [info ] [MainThread]: 
[0m12:57:33.620340 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_order_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.620596 [info ] [MainThread]: 
[0m12:57:33.620901 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.621155 [info ] [MainThread]: 
[0m12:57:33.621460 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items_quantity (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 17: from dev.analytics.stg_order_items
                ^
[0m12:57:33.621715 [info ] [MainThread]: 
[0m12:57:33.622078 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.622366 [info ] [MainThread]: 
[0m12:57:33.622706 [error] [MainThread]:   Runtime Error in test not_null_stg_products_cost (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.622984 [info ] [MainThread]: 
[0m12:57:33.623315 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_customer_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.623584 [info ] [MainThread]: 
[0m12:57:33.623899 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_total_amount (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 17: from dev.analytics.stg_orders
                ^
[0m12:57:33.624156 [info ] [MainThread]: 
[0m12:57:33.624464 [error] [MainThread]:   Runtime Error in test not_null_stg_products_price (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.624721 [info ] [MainThread]: 
[0m12:57:33.625030 [error] [MainThread]:   Runtime Error in test not_null_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 17: from dev.analytics.stg_products
                ^
[0m12:57:33.625287 [info ] [MainThread]: 
[0m12:57:33.625606 [error] [MainThread]:   Runtime Error in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.625869 [info ] [MainThread]: 
[0m12:57:33.626184 [error] [MainThread]:   Runtime Error in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 16:     from dev.analytics.stg_order_items
                    ^
[0m12:57:33.626516 [info ] [MainThread]: 
[0m12:57:33.627022 [error] [MainThread]:   Runtime Error in test unique_dim_customers_customer_id (models/marts/dim_customers.yml)
  Catalog Error: Table with name dim_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.dim_customers
                ^
[0m12:57:33.627315 [info ] [MainThread]: 
[0m12:57:33.627670 [error] [MainThread]:   Runtime Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Catalog Error: Table with name dim_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.dim_products
                ^
[0m12:57:33.627934 [info ] [MainThread]: 
[0m12:57:33.628260 [error] [MainThread]:   Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 16:     from dev.analytics.stg_orders
                    ^
[0m12:57:33.628520 [info ] [MainThread]: 
[0m12:57:33.628827 [error] [MainThread]:   Runtime Error in test unique_fct_orders_order_item_id (models/marts/fct_orders.yml)
  Catalog Error: Table with name fct_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.fct_orders
                ^
[0m12:57:33.629078 [info ] [MainThread]: 
[0m12:57:33.629383 [error] [MainThread]:   Runtime Error in test unique_stg_customers_email (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.629632 [info ] [MainThread]: 
[0m12:57:33.629935 [error] [MainThread]:   Runtime Error in test unique_stg_orders_order_id (models/staging/stg_orders.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "analytics_dev.raw_orders"?
  
  LINE 18: from dev.analytics.stg_orders
                ^
[0m12:57:33.630187 [info ] [MainThread]: 
[0m12:57:33.630494 [error] [MainThread]:   Runtime Error in test unique_stg_customers_customer_id (models/staging/stg_customers.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "analytics_dev.raw_customers"?
  
  LINE 18: from dev.analytics.stg_customers
                ^
[0m12:57:33.630746 [info ] [MainThread]: 
[0m12:57:33.631056 [error] [MainThread]:   Runtime Error in test unique_stg_order_items_order_item_id (models/staging/stg_order_items.yml)
  Catalog Error: Table with name stg_order_items does not exist!
  Did you mean "analytics_dev.raw_order_items"?
  
  LINE 18: from dev.analytics.stg_order_items
                ^
[0m12:57:33.631310 [info ] [MainThread]: 
[0m12:57:33.631616 [error] [MainThread]:   Runtime Error in test unique_stg_products_product_id (models/staging/stg_products.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "analytics_dev.raw_products"?
  
  LINE 18: from dev.analytics.stg_products
                ^
[0m12:57:33.631920 [info ] [MainThread]: 
[0m12:57:33.632257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=41 SKIP=0 TOTAL=41
[0m12:57:33.634877 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.6135461, "process_in_blocks": "0", "process_kernel_time": 0.549885, "process_mem_max_rss": "156319744", "process_out_blocks": "0", "process_user_time": 5.569214}
[0m12:57:33.635252 [debug] [MainThread]: Command `dbt test` failed at 12:57:33.635177 after 2.61 seconds
[0m12:57:33.635587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e89900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfcf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce9db0>]}
[0m12:57:33.635916 [debug] [MainThread]: Flushing usage events
[0m12:57:55.720221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c618d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871d870>]}


============================== 12:57:55.725077 | fc8306d4-ce4e-461f-ac1c-05b04e8ccd77 ==============================
[0m12:57:55.725077 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:57:55.725631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target prod', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:55.950620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d3bb0>]}
[0m12:57:56.000362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e08040>]}
[0m12:57:56.004577 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:57:56.127298 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:57:56.250101 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:57:56.250522 [debug] [MainThread]: previous checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, current checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995
[0m12:57:56.250811 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:57:56.251133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad3190>]}
[0m12:57:58.569887 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:57:58.570392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8bdf0>]}
[0m12:57:58.954588 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m12:57:58.955076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m12:57:58.955403 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m12:57:58.955704 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m12:57:58.955992 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m12:57:58.956276 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m12:57:58.956557 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m12:57:58.956838 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m12:57:58.957109 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m12:57:58.957382 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m12:57:58.957656 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m12:57:58.957925 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m12:57:58.958200 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m12:57:58.958473 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m12:57:58.958742 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m12:57:58.959012 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m12:57:58.959283 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m12:57:58.959550 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m12:57:58.959816 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m12:57:58.960082 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m12:57:58.960356 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m12:57:58.960630 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m12:57:58.960905 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m12:57:58.961180 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m12:57:58.961450 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m12:57:58.961720 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m12:57:58.961988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m12:57:58.962255 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m12:57:59.070219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0b8b0>]}
[0m12:57:59.215867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66320>]}
[0m12:57:59.216353 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:57:59.216684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f30760>]}
[0m12:57:59.218835 [info ] [MainThread]: 
[0m12:57:59.219306 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:59.224634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod'
[0m12:57:59.268719 [debug] [ThreadPool]: Using duckdb connection "list_prod"
[0m12:57:59.269078 [debug] [ThreadPool]: On list_prod: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'prod'
    
  
  
[0m12:57:59.269367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:59.420677 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m12:57:59.422249 [debug] [ThreadPool]: On list_prod: Close
[0m12:57:59.425559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_prod, now list_prod_analytics)
[0m12:57:59.431470 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:57:59.431789 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:57:59.432056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:59.467501 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m12:57:59.467833 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:57:59.468130 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:57:59.479448 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:57:59.480697 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:57:59.481438 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:57:59.481713 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:57:59.484284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a31960>]}
[0m12:57:59.484755 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.485051 [debug] [MainThread]: On master: BEGIN
[0m12:57:59.485320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:59.519898 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m12:57:59.520224 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.520505 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.520767 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.521099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:59.521365 [debug] [MainThread]: On master: Close
[0m12:57:59.522328 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:57:59.522651 [info ] [MainThread]: 
[0m12:57:59.525308 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m12:57:59.525702 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m12:57:59.526162 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics.stg_customers ............................ [RUN]
[0m12:57:59.526541 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m12:57:59.526886 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m12:57:59.527294 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics.stg_order_items .......................... [RUN]
[0m12:57:59.527746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now model.ci_cd_project.stg_customers)
[0m12:57:59.528259 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics.stg_orders ............................... [RUN]
[0m12:57:59.528752 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics.stg_products ............................. [RUN]
[0m12:57:59.529212 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_order_items'
[0m12:57:59.529550 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m12:57:59.529969 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_orders'
[0m12:57:59.530392 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.ci_cd_project.stg_products'
[0m12:57:59.530728 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m12:57:59.539715 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m12:57:59.540065 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m12:57:59.540396 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m12:57:59.543735 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m12:57:59.547303 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m12:57:59.551678 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m12:57:59.552145 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m12:57:59.565198 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m12:57:59.584412 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m12:57:59.587068 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m12:57:59.587638 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m12:57:59.591241 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m12:57:59.591706 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m12:57:59.625721 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.628877 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m12:57:59.629289 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m12:57:59.629697 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.630121 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.630488 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:59.630825 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m12:57:59.631171 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m12:57:59.631533 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.631920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:59.632245 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:59.632560 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m12:57:59.632930 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:57:59.667747 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.668118 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.668461 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:57:59.668824 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view prod.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:57:59.669157 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.669447 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:57:59.669762 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.670437 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.670763 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.671093 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view prod.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m12:57:59.671405 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.671737 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view prod.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m12:57:59.672090 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view prod.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from prod.analytics.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m12:57:59.678898 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.679300 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.679878 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view "prod"."analytics"."stg_orders" rename to stg_orders__dbt_backup
[0m12:57:59.683299 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.683635 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.683970 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.684616 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view "prod"."analytics"."stg_products" rename to stg_products__dbt_backup
[0m12:57:59.684980 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.688272 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.692218 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.695570 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.695935 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view "prod"."analytics"."stg_order_items" rename to stg_order_items__dbt_backup
[0m12:57:59.696245 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.696566 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view "prod"."analytics"."stg_customers" rename to stg_customers__dbt_backup
[0m12:57:59.696887 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
alter view prod.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m12:57:59.700162 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.700558 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.700911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.701261 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
alter view prod.analytics.stg_products__dbt_tmp rename to stg_products
[0m12:57:59.704425 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.704766 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.708446 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.708877 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view prod.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m12:57:59.715182 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m12:57:59.721831 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
alter view prod.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m12:57:59.724902 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:57:59.726121 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:57:59.726496 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.726900 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.727224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.727539 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.728603 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:57:59.728928 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m12:57:59.729957 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:57:59.730283 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m12:57:59.730602 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.730996 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.731420 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m12:57:59.731812 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m12:57:59.732221 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.732567 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.737746 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m12:57:59.738128 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.740898 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m12:57:59.741235 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m12:57:59.741551 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists prod.analytics.stg_orders__dbt_backup cascade
[0m12:57:59.744821 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m12:57:59.745188 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists prod.analytics.stg_order_items__dbt_backup cascade
[0m12:57:59.747899 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m12:57:59.748311 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists prod.analytics.stg_products__dbt_backup cascade
[0m12:57:59.748733 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists prod.analytics.stg_customers__dbt_backup cascade
[0m12:57:59.749066 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.749505 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.751664 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m12:57:59.752016 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.752325 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.753363 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m12:57:59.755034 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m12:57:59.755793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082e90>]}
[0m12:57:59.756821 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m12:57:59.757255 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d236d0>]}
[0m12:57:59.757647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109059d20>]}
[0m12:57:59.758188 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics.stg_orders .......................... [[32mOK[0m in 0.22s]
[0m12:57:59.758794 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics.stg_order_items ..................... [[32mOK[0m in 0.23s]
[0m12:57:59.759340 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics.stg_customers ....................... [[32mOK[0m in 0.23s]
[0m12:57:59.759863 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m12:57:59.760331 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m12:57:59.760782 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m12:57:59.761395 [debug] [Thread-6 (]: Began running node model.ci_cd_project.dim_customers
[0m12:57:59.761826 [info ] [Thread-6 (]: 5 of 7 START sql table model analytics.dim_customers ........................... [RUN]
[0m12:57:59.762277 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_customers'
[0m12:57:59.762596 [debug] [Thread-6 (]: Began compiling node model.ci_cd_project.dim_customers
[0m12:57:59.766569 [debug] [Thread-6 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m12:57:59.767019 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109082fe0>]}
[0m12:57:59.767725 [info ] [Thread-4 (]: 4 of 7 OK created sql view model analytics.stg_products ........................ [[32mOK[0m in 0.24s]
[0m12:57:59.768311 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m12:57:59.768723 [debug] [Thread-6 (]: Began executing node model.ci_cd_project.dim_customers
[0m12:57:59.788246 [debug] [Thread-8 (]: Began running node model.ci_cd_project.dim_products
[0m12:57:59.788801 [debug] [Thread-6 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m12:57:59.789162 [debug] [Thread-5 (]: Began running node model.ci_cd_project.fct_orders
[0m12:57:59.789589 [info ] [Thread-8 (]: 6 of 7 START sql table model analytics.dim_products ............................ [RUN]
[0m12:57:59.790142 [info ] [Thread-5 (]: 7 of 7 START sql table model analytics.fct_orders .............................. [RUN]
[0m12:57:59.790661 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.ci_cd_project.dim_products'
[0m12:57:59.791081 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.ci_cd_project.fct_orders'
[0m12:57:59.791409 [debug] [Thread-8 (]: Began compiling node model.ci_cd_project.dim_products
[0m12:57:59.791747 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.792054 [debug] [Thread-5 (]: Began compiling node model.ci_cd_project.fct_orders
[0m12:57:59.796741 [debug] [Thread-8 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m12:57:59.797129 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m12:57:59.801108 [debug] [Thread-5 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m12:57:59.801566 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:57:59.802053 [debug] [Thread-8 (]: Began executing node model.ci_cd_project.dim_products
[0m12:57:59.805759 [debug] [Thread-8 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m12:57:59.806169 [debug] [Thread-5 (]: Began executing node model.ci_cd_project.fct_orders
[0m12:57:59.809788 [debug] [Thread-5 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m12:57:59.840316 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.840725 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: BEGIN
[0m12:57:59.841108 [debug] [Thread-6 (]: SQL status: OK in 0.040 seconds
[0m12:57:59.841440 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:57:59.841818 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.842243 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.842629 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      prod.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from prod.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from prod.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m12:57:59.842995 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m12:57:59.843314 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m12:57:59.843795 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.844110 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:57:59.844503 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      prod.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from prod.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from prod.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m12:57:59.845114 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.845444 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.845813 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      prod.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from prod.analytics.stg_orders
),

order_items as (
    select * from prod.analytics.stg_order_items
),

products as (
    select * from prod.analytics.stg_products
),

customers as (
    select * from prod.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m12:57:59.853515 [debug] [Thread-8 (]: SQL status: OK in 0.009 seconds
[0m12:57:59.853902 [debug] [Thread-6 (]: SQL status: OK in 0.010 seconds
[0m12:57:59.858312 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.858676 [debug] [Thread-5 (]: SQL status: OK in 0.012 seconds
[0m12:57:59.861898 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.862261 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table "prod"."analytics"."dim_products" rename to dim_products__dbt_backup
[0m12:57:59.865387 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.865736 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table "prod"."analytics"."dim_customers" rename to dim_customers__dbt_backup
[0m12:57:59.866165 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table "prod"."analytics"."fct_orders" rename to fct_orders__dbt_backup
[0m12:57:59.866567 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.866933 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:57:59.870070 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.873898 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.874209 [debug] [Thread-5 (]: SQL status: OK in 0.007 seconds
[0m12:57:59.874531 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
alter table prod.analytics.dim_products__dbt_tmp rename to dim_products
[0m12:57:59.874854 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
alter table prod.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m12:57:59.877974 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.878496 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
alter table prod.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m12:57:59.878837 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.879185 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.883585 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:57:59.884775 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:57:59.885099 [debug] [Thread-5 (]: SQL status: OK in 0.006 seconds
[0m12:57:59.885424 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.885735 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.886821 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:57:59.887146 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: COMMIT
[0m12:57:59.887449 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m12:57:59.887755 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.888221 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m12:57:59.888803 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:57:59.891677 [debug] [Thread-8 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m12:57:59.892002 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.892311 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists prod.analytics.dim_products__dbt_backup cascade
[0m12:57:59.892606 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.895394 [debug] [Thread-6 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m12:57:59.899178 [debug] [Thread-5 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m12:57:59.899575 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists prod.analytics.dim_customers__dbt_backup cascade
[0m12:57:59.899956 [debug] [Thread-8 (]: SQL status: OK in 0.004 seconds
[0m12:57:59.900315 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists prod.analytics.fct_orders__dbt_backup cascade
[0m12:57:59.901591 [debug] [Thread-8 (]: On model.ci_cd_project.dim_products: Close
[0m12:57:59.902149 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109829120>]}
[0m12:57:59.902515 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:57:59.904071 [debug] [Thread-6 (]: On model.ci_cd_project.dim_customers: Close
[0m12:57:59.903075 [info ] [Thread-8 (]: 6 of 7 OK created sql table model analytics.dim_products ....................... [[32mOK[0m in 0.11s]
[0m12:57:59.904488 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m12:57:59.904918 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1d80>]}
[0m12:57:59.905383 [debug] [Thread-8 (]: Finished running node model.ci_cd_project.dim_products
[0m12:57:59.906443 [debug] [Thread-5 (]: On model.ci_cd_project.fct_orders: Close
[0m12:57:59.906959 [info ] [Thread-6 (]: 5 of 7 OK created sql table model analytics.dim_customers ...................... [[32mOK[0m in 0.14s]
[0m12:57:59.907588 [debug] [Thread-6 (]: Finished running node model.ci_cd_project.dim_customers
[0m12:57:59.919531 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8306d4-ce4e-461f-ac1c-05b04e8ccd77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f64220>]}
[0m12:57:59.920114 [info ] [Thread-5 (]: 7 of 7 OK created sql table model analytics.fct_orders ......................... [[32mOK[0m in 0.13s]
[0m12:57:59.920641 [debug] [Thread-5 (]: Finished running node model.ci_cd_project.fct_orders
[0m12:57:59.921687 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.922002 [debug] [MainThread]: On master: BEGIN
[0m12:57:59.922272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:59.962753 [debug] [MainThread]: SQL status: OK in 0.040 seconds
[0m12:57:59.963096 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.963383 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:59.963648 [debug] [MainThread]: On master: COMMIT
[0m12:57:59.964015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:57:59.964327 [debug] [MainThread]: On master: Close
[0m12:57:59.965333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:59.965642 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_customers' was properly closed.
[0m12:57:59.965897 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_order_items' was properly closed.
[0m12:57:59.966140 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_orders' was properly closed.
[0m12:57:59.966376 [debug] [MainThread]: Connection 'model.ci_cd_project.stg_products' was properly closed.
[0m12:57:59.966611 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_customers' was properly closed.
[0m12:57:59.966844 [debug] [MainThread]: Connection 'model.ci_cd_project.dim_products' was properly closed.
[0m12:57:59.967076 [debug] [MainThread]: Connection 'model.ci_cd_project.fct_orders' was properly closed.
[0m12:57:59.967431 [info ] [MainThread]: 
[0m12:57:59.967735 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:57:59.968952 [debug] [MainThread]: Command end result
[0m12:58:00.040306 [info ] [MainThread]: 
[0m12:58:00.040753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:00.041060 [info ] [MainThread]: 
[0m12:58:00.041361 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:58:00.044079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.38141, "process_in_blocks": "0", "process_kernel_time": 0.381365, "process_mem_max_rss": "182894592", "process_out_blocks": "0", "process_user_time": 6.027266}
[0m12:58:00.044485 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:00.044403 after 4.38 seconds
[0m12:58:00.044825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c618d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e08040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9d000>]}
[0m12:58:00.045157 [debug] [MainThread]: Flushing usage events
[0m12:58:07.291183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093958a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae55d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae558a0>]}


============================== 12:58:07.295871 | aa14daee-4fce-4c31-9c4f-5f9629d0831e ==============================
[0m12:58:07.295871 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:07.296390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --target prod', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:07.500955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d5c60>]}
[0m12:58:07.551016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeeb8e0>]}
[0m12:58:07.555137 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m12:58:07.676456 [debug] [MainThread]: checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4, vars: {}, profile: , target: prod, version: 1.8.9
[0m12:58:07.879666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:07.880073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:07.933919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6c0130>]}
[0m12:58:08.117880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40ffd0>]}
[0m12:58:08.118376 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m12:58:08.118709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae0ee0>]}
[0m12:58:08.122006 [info ] [MainThread]: 
[0m12:58:08.122492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:58:08.128350 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_prod_analytics'
[0m12:58:08.171642 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:58:08.171995 [debug] [ThreadPool]: On list_prod_analytics: BEGIN
[0m12:58:08.172274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:08.221656 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m12:58:08.222008 [debug] [ThreadPool]: Using duckdb connection "list_prod_analytics"
[0m12:58:08.222304 [debug] [ThreadPool]: On list_prod_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "connection_name": "list_prod_analytics"} */
select
      'prod' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'prod'
  
[0m12:58:08.230180 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m12:58:08.231546 [debug] [ThreadPool]: On list_prod_analytics: ROLLBACK
[0m12:58:08.232528 [debug] [ThreadPool]: Failed to rollback 'list_prod_analytics'
[0m12:58:08.232841 [debug] [ThreadPool]: On list_prod_analytics: Close
[0m12:58:08.235341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa14daee-4fce-4c31-9c4f-5f9629d0831e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9da20>]}
[0m12:58:08.235810 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:08.236099 [debug] [MainThread]: On master: BEGIN
[0m12:58:08.236360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:08.273883 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m12:58:08.274194 [debug] [MainThread]: On master: COMMIT
[0m12:58:08.274466 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:08.274726 [debug] [MainThread]: On master: COMMIT
[0m12:58:08.275092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:08.275433 [debug] [MainThread]: On master: Close
[0m12:58:08.276446 [info ] [MainThread]: Concurrency: 8 threads (target='prod')
[0m12:58:08.276766 [info ] [MainThread]: 
[0m12:58:08.279480 [debug] [Thread-1 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.279918 [debug] [Thread-2 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.280604 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.280315 [info ] [Thread-1 (]: 1 of 41 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m12:58:08.281049 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.281666 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.281401 [info ] [Thread-2 (]: 2 of 41 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m12:58:08.282162 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.282481 [info ] [Thread-3 (]: 3 of 41 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:58:08.282880 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.283273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_prod_analytics, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m12:58:08.283638 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.283965 [info ] [Thread-4 (]: 4 of 41 START test not_null_dim_customers_customer_tier ........................ [RUN]
[0m12:58:08.284333 [info ] [Thread-5 (]: 5 of 41 START test not_null_dim_customers_total_orders ......................... [RUN]
[0m12:58:08.284808 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:58:08.285149 [info ] [Thread-6 (]: 6 of 41 START test not_null_dim_customers_total_spent .......................... [RUN]
[0m12:58:08.285579 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:58:08.285912 [info ] [Thread-7 (]: 7 of 41 START test not_null_dim_products_performance_category .................. [RUN]
[0m12:58:08.286258 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.286585 [info ] [Thread-8 (]: 8 of 41 START test not_null_dim_products_product_id ............................ [RUN]
[0m12:58:08.287004 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:58:08.287397 [debug] [Thread-5 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:58:08.287735 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.288159 [debug] [Thread-6 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:58:08.288525 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.288989 [debug] [Thread-7 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:58:08.301974 [debug] [Thread-8 (]: Acquiring new duckdb connection 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:58:08.307869 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.308264 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.308595 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.315486 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.315829 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.323905 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.324260 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.324593 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.328684 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.332753 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.333224 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.338070 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.342262 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.342665 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.346631 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.347046 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.365005 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.365443 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.365755 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.368575 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.369032 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.371870 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.372293 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.375112 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.375441 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.378679 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.379179 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.381929 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.382425 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.385146 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.387927 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.388271 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.388690 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m12:58:08.389070 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.389479 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m12:58:08.389945 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.390363 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.390703 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:58:08.391062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.391412 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m12:58:08.391751 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.392103 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.392441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:58:08.392754 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m12:58:08.393061 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m12:58:08.393359 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:58:08.393754 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:58:08.394069 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m12:58:08.394376 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:58:08.394714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:58:08.395020 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:58:08.395378 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:58:08.395682 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:58:08.433562 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.434042 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m12:58:08.434397 [debug] [Thread-3 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.434756 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.435220 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from prod.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m12:58:08.435666 [debug] [Thread-5 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.436074 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.436487 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:58:08.436850 [debug] [Thread-8 (]: SQL status: OK in 0.041 seconds
[0m12:58:08.437147 [debug] [Thread-6 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.437446 [debug] [Thread-7 (]: SQL status: OK in 0.042 seconds
[0m12:58:08.437757 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m12:58:08.438229 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m12:58:08.438590 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m12:58:08.438955 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.439376 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m12:58:08.439934 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m12:58:08.440309 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.440616 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m12:58:08.441013 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from prod.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m12:58:08.441430 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from prod.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.441794 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from prod.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442252 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442615 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from prod.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.442947 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.443324 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from prod.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.447346 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m12:58:08.448322 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.449519 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:58:08.449851 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.450176 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.450517 [debug] [Thread-5 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.450845 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.451304 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m12:58:08.452439 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m12:58:08.452806 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.453151 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m12:58:08.454236 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:58:08.455335 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m12:58:08.456408 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m12:58:08.457469 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m12:58:08.457797 [debug] [Thread-1 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m12:58:08.458181 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m12:58:08.458543 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:58:08.459648 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m12:58:08.460045 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m12:58:08.460427 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m12:58:08.460790 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m12:58:08.461137 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m12:58:08.461483 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m12:58:08.461984 [info ] [Thread-1 (]: 1 of 41 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.18s]
[0m12:58:08.462562 [info ] [Thread-3 (]: 3 of 41 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m12:58:08.462963 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m12:58:08.463277 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:58:08.463594 [debug] [Thread-2 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m12:58:08.463900 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m12:58:08.464199 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m12:58:08.464701 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m12:58:08.465139 [info ] [Thread-4 (]: 4 of 41 PASS not_null_dim_customers_customer_tier .............................. [[32mPASS[0m in 0.18s]
[0m12:58:08.465619 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:58:08.465932 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m12:58:08.466427 [info ] [Thread-8 (]: 8 of 41 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.16s]
[0m12:58:08.466888 [info ] [Thread-2 (]: 2 of 41 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.18s]
[0m12:58:08.467415 [info ] [Thread-6 (]: 6 of 41 PASS not_null_dim_customers_total_spent ................................ [[32mPASS[0m in 0.18s]
[0m12:58:08.467955 [info ] [Thread-5 (]: 5 of 41 PASS not_null_dim_customers_total_orders ............................... [[32mPASS[0m in 0.18s]
[0m12:58:08.468391 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.468913 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m12:58:08.469281 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.469832 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m12:58:08.470302 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m12:58:08.470799 [info ] [Thread-7 (]: 7 of 41 PASS not_null_dim_products_performance_category ........................ [[32mPASS[0m in 0.18s]
[0m12:58:08.471284 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m12:58:08.471737 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m12:58:08.472081 [info ] [Thread-1 (]: 9 of 41 START test not_null_dim_products_profit_margin ......................... [RUN]
[0m12:58:08.472477 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.473170 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.472852 [info ] [Thread-3 (]: 10 of 41 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:58:08.473649 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.474122 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m12:58:08.474533 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.474930 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.475668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m12:58:08.476098 [info ] [Thread-4 (]: 11 of 41 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:58:08.476966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:58:08.476491 [info ] [Thread-8 (]: 12 of 41 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:58:08.477818 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.477381 [info ] [Thread-2 (]: 13 of 41 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m12:58:08.478315 [info ] [Thread-6 (]: 14 of 41 START test not_null_fct_orders_product_id ............................. [RUN]
[0m12:58:08.478713 [info ] [Thread-5 (]: 15 of 41 START test not_null_fct_orders_quantity ............................... [RUN]
[0m12:58:08.479090 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.479454 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:58:08.479787 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.480125 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m12:58:08.480465 [info ] [Thread-7 (]: 16 of 41 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m12:58:08.480845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m12:58:08.481209 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m12:58:08.481598 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m12:58:08.487398 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.487784 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.491859 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.492227 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.492600 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m12:58:08.492941 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.493257 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.493597 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.497884 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.502002 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.502382 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.502713 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.507583 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.511758 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.512137 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.516061 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.520196 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.555958 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.559163 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.559551 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.559890 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.560339 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.560680 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.561293 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.561688 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.564495 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.564926 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.567624 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.570900 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.571288 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.574021 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.576699 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.579375 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.579785 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m12:58:08.580311 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.580647 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:58:08.581127 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.581493 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.581933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.582273 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.582636 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:58:08.582996 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.583325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.583663 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.583961 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:58:08.584276 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m12:58:08.584658 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m12:58:08.585034 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.585356 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m12:58:08.585692 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m12:58:08.585990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.586293 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.586588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.586915 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.587208 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.621586 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.621946 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m12:58:08.622348 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:58:08.622707 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.623080 [debug] [Thread-6 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.623369 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.623729 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.624044 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m12:58:08.624349 [debug] [Thread-7 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.624693 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from prod.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.625008 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.625313 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:58:08.625618 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m12:58:08.625918 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m12:58:08.626221 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m12:58:08.626551 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from prod.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.626882 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m12:58:08.627299 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m12:58:08.627666 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.627988 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.628320 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.628664 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629008 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629448 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from prod.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.629810 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.630116 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.631460 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:58:08.631889 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.632269 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.632711 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.633144 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.633492 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.633841 [debug] [Thread-5 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.634970 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m12:58:08.635346 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m12:58:08.636525 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:58:08.637584 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m12:58:08.638668 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:58:08.639780 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m12:58:08.640862 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m12:58:08.641296 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m12:58:08.642347 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m12:58:08.642656 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:58:08.643027 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m12:58:08.643387 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m12:58:08.643764 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m12:58:08.644123 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m12:58:08.644471 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m12:58:08.644780 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m12:58:08.645126 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m12:58:08.645463 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:58:08.645931 [info ] [Thread-3 (]: 10 of 41 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.17s]
[0m12:58:08.646291 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m12:58:08.646596 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:58:08.646893 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m12:58:08.647186 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m12:58:08.647515 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m12:58:08.647952 [info ] [Thread-1 (]: 9 of 41 PASS not_null_dim_products_profit_margin ............................... [[32mPASS[0m in 0.17s]
[0m12:58:08.648456 [info ] [Thread-4 (]: 11 of 41 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.17s]
[0m12:58:08.648951 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m12:58:08.649402 [info ] [Thread-6 (]: 14 of 41 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.649893 [info ] [Thread-8 (]: 12 of 41 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.650397 [info ] [Thread-7 (]: 16 of 41 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.16s]
[0m12:58:08.650912 [info ] [Thread-2 (]: 13 of 41 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.17s]
[0m12:58:08.651472 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m12:58:08.651918 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m12:58:08.652300 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.652757 [info ] [Thread-5 (]: 15 of 41 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.17s]
[0m12:58:08.653313 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m12:58:08.653756 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m12:58:08.654292 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m12:58:08.654758 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m12:58:08.655130 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.655557 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.655966 [info ] [Thread-3 (]: 17 of 41 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m12:58:08.656444 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m12:58:08.656794 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.657185 [debug] [Thread-8 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.657607 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.657987 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.658338 [info ] [Thread-1 (]: 18 of 41 START test not_null_stg_customers_email ............................... [RUN]
[0m12:58:08.658706 [info ] [Thread-4 (]: 19 of 41 START test not_null_stg_customers_first_name .......................... [RUN]
[0m12:58:08.659106 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m12:58:08.659507 [debug] [Thread-5 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.659873 [info ] [Thread-6 (]: 20 of 41 START test not_null_stg_customers_last_name ........................... [RUN]
[0m12:58:08.660276 [info ] [Thread-8 (]: 21 of 41 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m12:58:08.660698 [info ] [Thread-7 (]: 22 of 41 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m12:58:08.661098 [info ] [Thread-2 (]: 23 of 41 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m12:58:08.661548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m12:58:08.661969 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m12:58:08.662304 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.662641 [info ] [Thread-5 (]: 24 of 41 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m12:58:08.663047 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m12:58:08.663421 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m12:58:08.663773 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m12:58:08.664116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m12:58:08.664466 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.664778 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.670281 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.670689 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_quantity.f754434156, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m12:58:08.671033 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.671349 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.671657 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.671958 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.675930 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.680022 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.680461 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.684540 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.689545 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.689911 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.693919 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.697949 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.702062 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.702706 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.703018 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.706827 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.707241 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.707623 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.710518 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.710942 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.713625 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.713974 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.714331 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.717113 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.720364 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.720862 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.723545 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.724036 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.726735 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.729493 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.729873 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.730346 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m12:58:08.730751 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.731130 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m12:58:08.731499 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.731896 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.732350 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m12:58:08.732714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.733045 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.733379 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.733681 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m12:58:08.733983 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.734282 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m12:58:08.734581 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m12:58:08.734872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.735249 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m12:58:08.735579 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m12:58:08.735888 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.736226 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.736536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.736867 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.737164 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.771538 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:58:08.771985 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:58:08.772348 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.772641 [debug] [Thread-6 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.772993 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.773329 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.773792 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.774119 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m12:58:08.774422 [debug] [Thread-7 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.774706 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.774998 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:08.775293 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m12:58:08.775589 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m12:58:08.775988 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m12:58:08.776325 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from prod.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.776658 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m12:58:08.777010 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.777322 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m12:58:08.777619 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m12:58:08.777940 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from prod.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.778282 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from prod.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.778619 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.779002 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from prod.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.780362 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m12:58:08.780716 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.781042 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.781363 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from prod.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.782275 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m12:58:08.782659 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783031 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783324 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.783609 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.783926 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.785052 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m12:58:08.785456 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m12:58:08.785801 [debug] [Thread-5 (]: SQL status: OK in 0.000 seconds
[0m12:58:08.786877 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m12:58:08.787985 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m12:58:08.789063 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m12:58:08.790131 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m12:58:08.791220 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m12:58:08.791582 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m12:58:08.792083 [info ] [Thread-3 (]: 17 of 41 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m12:58:08.793270 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m12:58:08.793661 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m12:58:08.794013 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m12:58:08.794363 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m12:58:08.794712 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m12:58:08.795063 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m12:58:08.795365 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m12:58:08.795814 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:58:08.796165 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m12:58:08.796469 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m12:58:08.796763 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m12:58:08.797057 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m12:58:08.797353 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m12:58:08.797644 [debug] [Thread-8 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m12:58:08.798047 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.798501 [info ] [Thread-4 (]: 19 of 41 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.14s]
[0m12:58:08.798954 [debug] [Thread-5 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m12:58:08.799483 [info ] [Thread-6 (]: 20 of 41 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.800183 [info ] [Thread-1 (]: 18 of 41 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.14s]
[0m12:58:08.800754 [info ] [Thread-2 (]: 23 of 41 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.14s]
[0m12:58:08.801264 [info ] [Thread-7 (]: 22 of 41 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.14s]
[0m12:58:08.801754 [info ] [Thread-8 (]: 21 of 41 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 0.14s]
[0m12:58:08.802121 [info ] [Thread-3 (]: 25 of 41 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m12:58:08.802599 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m12:58:08.803086 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m12:58:08.803548 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m12:58:08.804087 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m12:58:08.804538 [info ] [Thread-5 (]: 24 of 41 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.13s]
[0m12:58:08.805010 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m12:58:08.805446 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m12:58:08.805791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m12:58:08.806157 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.806549 [debug] [Thread-6 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.806906 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.807278 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.807749 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m12:58:08.808099 [debug] [Thread-7 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.808470 [debug] [Thread-8 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.808796 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.809141 [info ] [Thread-4 (]: 26 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m12:58:08.809550 [info ] [Thread-6 (]: 27 of 41 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m12:58:08.809903 [info ] [Thread-1 (]: 28 of 41 START test not_null_stg_products_cost ................................. [RUN]
[0m12:58:08.810245 [info ] [Thread-2 (]: 29 of 41 START test not_null_stg_products_price ................................ [RUN]
[0m12:58:08.810747 [debug] [Thread-5 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.811118 [info ] [Thread-7 (]: 30 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m12:58:08.811515 [info ] [Thread-8 (]: 31 of 41 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m12:58:08.817032 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.817426 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:58:08.817775 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m12:58:08.818114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m12:58:08.818444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m12:58:08.818793 [info ] [Thread-5 (]: 32 of 41 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m12:58:08.819151 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m12:58:08.819481 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m12:58:08.819878 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.820221 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.820565 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.820889 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.821205 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.821563 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m12:58:08.821897 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.822203 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.826316 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.830541 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.834529 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.839405 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.842175 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.842530 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.846568 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.854331 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.855115 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.861242 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.861778 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.862092 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.862438 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.865288 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.865698 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.866079 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.868885 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.871743 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.872088 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.875326 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.875667 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.876046 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:58:08.878856 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.879332 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.882138 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.884998 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.885363 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.885700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:08.886033 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.886447 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m12:58:08.886781 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.887325 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.887638 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:58:08.888111 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.888455 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.888759 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m12:58:08.889065 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:08.889378 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m12:58:08.889684 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:58:08.889978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:08.890289 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m12:58:08.890600 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m12:58:08.890893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:08.891208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:08.891501 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:08.891821 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:08.892109 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:08.924986 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m12:58:08.925333 [debug] [Thread-6 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.925688 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:58:08.925988 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.926368 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m12:58:08.926706 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m12:58:08.927053 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.927362 [debug] [Thread-7 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.927737 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from prod.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.928055 [debug] [Thread-5 (]: SQL status: OK in 0.036 seconds
[0m12:58:08.928369 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:58:08.928686 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m12:58:08.928972 [debug] [Thread-8 (]: SQL status: OK in 0.037 seconds
[0m12:58:08.929291 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from prod.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.929613 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m12:58:08.929904 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:58:08.930249 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m12:58:08.930641 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from prod.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.930979 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from prod.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.931303 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m12:58:08.931577 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.931985 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from prod.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.932357 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from prod.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.932663 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.933005 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from prod.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from prod.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.933571 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from prod.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from prod.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:08.933986 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.934297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.935507 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:58:08.936835 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m12:58:08.937292 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:08.937695 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.938849 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:58:08.939230 [debug] [Thread-5 (]: SQL status: OK in 0.002 seconds
[0m12:58:08.940328 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m12:58:08.940677 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m12:58:08.941064 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m12:58:08.941404 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m12:58:08.942571 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m12:58:08.943674 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:58:08.944035 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m12:58:08.944457 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m12:58:08.945566 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m12:58:08.946635 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m12:58:08.946946 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:58:08.947256 [debug] [Thread-6 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m12:58:08.947613 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m12:58:08.947962 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m12:58:08.948266 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:58:08.948558 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m12:58:08.948908 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m12:58:08.949259 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m12:58:08.949758 [info ] [Thread-3 (]: 25 of 41 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.950132 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m12:58:08.950576 [info ] [Thread-6 (]: 27 of 41 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.13s]
[0m12:58:08.950935 [debug] [Thread-7 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:58:08.951391 [info ] [Thread-4 (]: 26 of 41 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.951770 [debug] [Thread-5 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m12:58:08.952194 [info ] [Thread-1 (]: 28 of 41 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.952544 [debug] [Thread-8 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m12:58:08.952994 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:58:08.953437 [info ] [Thread-2 (]: 29 of 41 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.13s]
[0m12:58:08.953895 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m12:58:08.954355 [info ] [Thread-7 (]: 30 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.14s]
[0m12:58:08.954863 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:58:08.955367 [info ] [Thread-5 (]: 32 of 41 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.13s]
[0m12:58:08.955825 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m12:58:08.956437 [debug] [Thread-3 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:08.956900 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m12:58:08.957303 [debug] [Thread-6 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:08.957742 [info ] [Thread-8 (]: 31 of 41 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.14s]
[0m12:58:08.958256 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m12:58:08.958618 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:08.959097 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m12:58:08.959448 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:08.959815 [info ] [Thread-3 (]: 33 of 41 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m12:58:08.960205 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:08.960648 [info ] [Thread-6 (]: 34 of 41 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:58:08.961194 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m12:58:08.961546 [debug] [Thread-7 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:08.961899 [info ] [Thread-4 (]: 35 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m12:58:08.962323 [debug] [Thread-5 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:08.962719 [info ] [Thread-1 (]: 36 of 41 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m12:58:08.963113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:58:08.963454 [info ] [Thread-2 (]: 37 of 41 START test unique_stg_customers_customer_id ........................... [RUN]
[0m12:58:08.963816 [debug] [Thread-6 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:58:08.964175 [debug] [Thread-8 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:08.964522 [info ] [Thread-7 (]: 38 of 41 START test unique_stg_customers_email ................................. [RUN]
[0m12:58:08.964901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m12:58:08.965241 [info ] [Thread-5 (]: 39 of 41 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m12:58:08.965600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m12:58:08.965923 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:08.966252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m12:58:08.966567 [debug] [Thread-6 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:08.966989 [info ] [Thread-8 (]: 40 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:58:08.967402 [debug] [Thread-7 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m12:58:08.967740 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:08.968091 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m12:58:08.968414 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:08.975254 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:08.975608 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:08.981837 [debug] [Thread-6 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:08.982248 [debug] [Thread-8 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:58:08.982599 [debug] [Thread-7 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:08.986529 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:08.986888 [debug] [Thread-5 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:08.990772 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:08.995805 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:08.996267 [debug] [Thread-8 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.033479 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:09.037065 [debug] [Thread-7 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.041160 [debug] [Thread-5 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.041560 [debug] [Thread-6 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:09.045816 [debug] [Thread-8 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.046232 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:09.049021 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.049351 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:09.049660 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:09.053402 [debug] [Thread-6 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.056329 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.056847 [debug] [Thread-7 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:09.059650 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.062509 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.062860 [debug] [Thread-5 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:09.063226 [debug] [Thread-8 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.063663 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.067076 [debug] [Thread-7 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.067572 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.068013 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.070745 [debug] [Thread-5 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.073503 [debug] [Thread-8 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.073862 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.074221 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m12:58:09.074569 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.074942 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:58:09.075259 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:58:09.075698 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.076105 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m12:58:09.076444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:09.076810 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.077123 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m12:58:09.077428 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m12:58:09.077765 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.078065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:58:09.078374 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m12:58:09.078668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:09.079040 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m12:58:09.079349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:58:09.079693 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:58:09.080020 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m12:58:09.080343 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:58:09.080656 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m12:58:09.116051 [debug] [Thread-6 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.116422 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m12:58:09.116796 [debug] [Thread-6 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:58:09.117108 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.117459 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.117880 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.118185 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:58:09.118518 [debug] [Thread-8 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.118804 [debug] [Thread-5 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.119079 [debug] [Thread-7 (]: SQL status: OK in 0.039 seconds
[0m12:58:09.119386 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.119718 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m12:58:09.120018 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m12:58:09.120310 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m12:58:09.120650 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from prod.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from prod.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:58:09.120985 [debug] [Thread-8 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:58:09.121279 [debug] [Thread-5 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m12:58:09.121569 [debug] [Thread-7 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m12:58:09.121928 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.122366 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.122731 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123214 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123593 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.123996 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from prod.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.124327 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:58:09.124718 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:58:09.125233 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.125685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.126243 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.126587 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.128099 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m12:58:09.129288 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:58:09.129646 [debug] [Thread-7 (]: SQL status: OK in 0.004 seconds
[0m12:58:09.129942 [debug] [Thread-5 (]: SQL status: OK in 0.004 seconds
[0m12:58:09.131045 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:58:09.132167 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m12:58:09.133234 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m12:58:09.134306 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:58:09.134702 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m12:58:09.135060 [debug] [Thread-6 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m12:58:09.136120 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m12:58:09.137164 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m12:58:09.137514 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m12:58:09.137877 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m12:58:09.138230 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m12:58:09.138572 [debug] [Thread-8 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m12:58:09.138881 [debug] [Thread-3 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m12:58:09.139182 [debug] [Thread-6 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:58:09.139520 [debug] [Thread-7 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m12:58:09.139860 [debug] [Thread-5 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m12:58:09.140155 [debug] [Thread-4 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:58:09.140449 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m12:58:09.140742 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m12:58:09.141030 [debug] [Thread-8 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:58:09.141533 [info ] [Thread-3 (]: 33 of 41 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.18s]
[0m12:58:09.141940 [debug] [Thread-7 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m12:58:09.142362 [info ] [Thread-6 (]: 34 of 41 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.142703 [debug] [Thread-5 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m12:58:09.143179 [info ] [Thread-4 (]: 35 of 41 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.18s]
[0m12:58:09.143669 [info ] [Thread-1 (]: 36 of 41 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.144161 [info ] [Thread-2 (]: 37 of 41 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.18s]
[0m12:58:09.144623 [info ] [Thread-8 (]: 40 of 41 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.16s]
[0m12:58:09.145093 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:58:09.145578 [debug] [Thread-6 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:58:09.146004 [info ] [Thread-7 (]: 38 of 41 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.18s]
[0m12:58:09.146668 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m12:58:09.147148 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m12:58:09.147597 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m12:58:09.148314 [info ] [Thread-5 (]: 39 of 41 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.18s]
[0m12:58:09.148858 [debug] [Thread-8 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m12:58:09.149223 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.149810 [debug] [Thread-7 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m12:58:09.150442 [debug] [Thread-5 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m12:58:09.150839 [info ] [Thread-3 (]: 41 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m12:58:09.151353 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m12:58:09.151687 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.156030 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.156596 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.160557 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.161100 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.161693 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:58:09.162007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:58:09.200134 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m12:58:09.200488 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m12:58:09.200819 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "prod", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from prod.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:58:09.201837 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:58:09.203110 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:58:09.203516 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m12:58:09.203821 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m12:58:09.204944 [info ] [Thread-3 (]: 41 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.05s]
[0m12:58:09.205476 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m12:58:09.206593 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:09.206905 [debug] [MainThread]: On master: BEGIN
[0m12:58:09.207164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:09.245818 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m12:58:09.246175 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.246459 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:09.246718 [debug] [MainThread]: On master: COMMIT
[0m12:58:09.247081 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:09.247409 [debug] [MainThread]: On master: Close
[0m12:58:09.248401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:09.248668 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m12:58:09.248913 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m12:58:09.249153 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:58:09.249384 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:58:09.249613 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108' was properly closed.
[0m12:58:09.249842 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:58:09.250072 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e' was properly closed.
[0m12:58:09.250297 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:58:09.250619 [info ] [MainThread]: 
[0m12:58:09.250910 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m12:58:09.255537 [debug] [MainThread]: Command end result
[0m12:58:09.328897 [info ] [MainThread]: 
[0m12:58:09.329300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:09.329624 [info ] [MainThread]: 
[0m12:58:09.329918 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 TOTAL=41
[0m12:58:09.332401 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.0983748, "process_in_blocks": "0", "process_kernel_time": 0.334696, "process_mem_max_rss": "161513472", "process_out_blocks": "0", "process_user_time": 4.324152}
[0m12:58:09.332776 [debug] [MainThread]: Command `dbt test` succeeded at 12:58:09.332702 after 2.10 seconds
[0m12:58:09.333096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093958a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeeb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1f5d50>]}
[0m12:58:09.333423 [debug] [MainThread]: Flushing usage events
[0m13:20:36.614816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb2d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb31f0>]}


============================== 13:20:36.619561 | b0672e7a-a637-4ba9-bbc4-adc7af9f33bc ==============================
[0m13:20:36.619561 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:20:36.620090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/preben/Documents/dbt-workshop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/preben/Documents/dbt-workshop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:36.877570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad08100>]}
[0m13:20:36.927551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac88a00>]}
[0m13:20:36.934196 [info ] [MainThread]: Registered adapter: duckdb=1.8.4
[0m13:20:37.058303 [debug] [MainThread]: checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, vars: {}, profile: , target: dev, version: 1.8.9
[0m13:20:37.181421 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:20:37.181838 [debug] [MainThread]: previous checksum: 7c9f24cadb9ed71bfad0146ef54df7f5d259c85b535c1ae4260269edc44b8995, current checksum: 615e2d2cb3f98118511aae44913b8ec8777c6094d89fb36e10217eda1f944ce4
[0m13:20:37.182151 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:20:37.182469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f97190>]}
[0m13:20:39.497800 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:20:39.498293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1480d0>]}
[0m13:20:39.887226 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7' (models/marts/documentation/documentation.yml) depends on a node named 'fct_documentation_coverage' which is disabled
[0m13:20:39.887726 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_models' which is disabled
[0m13:20:39.888052 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_source_tables' which is disabled
[0m13:20:39.888354 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235' (models/marts/documentation/documentation.yml) depends on a node named 'fct_undocumented_sources' which is disabled
[0m13:20:39.888645 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028' (models/marts/dag/dag.yml) depends on a node named 'fct_direct_join_to_source' which is disabled
[0m13:20:39.888927 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31' (models/marts/dag/dag.yml) depends on a node named 'fct_duplicate_sources' which is disabled
[0m13:20:39.889209 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f' (models/marts/dag/dag.yml) depends on a node named 'fct_marts_or_intermediate_dependent_on_source' which is disabled
[0m13:20:39.889487 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95' (models/marts/dag/dag.yml) depends on a node named 'fct_model_fanout' which is disabled
[0m13:20:39.889760 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817' (models/marts/dag/dag.yml) depends on a node named 'fct_multiple_sources_joined' which is disabled
[0m13:20:39.890039 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d' (models/marts/dag/dag.yml) depends on a node named 'fct_rejoining_of_upstream_concepts' which is disabled
[0m13:20:39.890313 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1' (models/marts/dag/dag.yml) depends on a node named 'fct_root_models' which is disabled
[0m13:20:39.890583 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722' (models/marts/dag/dag.yml) depends on a node named 'fct_source_fanout' which is disabled
[0m13:20:39.890854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_marts_or_intermediate' which is disabled
[0m13:20:39.891132 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' (models/marts/dag/dag.yml) depends on a node named 'fct_staging_dependent_on_staging' which is disabled
[0m13:20:39.891402 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' (models/marts/dag/dag.yml) depends on a node named 'fct_unused_sources' which is disabled
[0m13:20:39.891678 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422' (models/marts/dag/dag.yml) depends on a node named 'fct_exposure_parents_materializations' which is disabled
[0m13:20:39.891951 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113' (models/marts/dag/dag.yml) depends on a node named 'fct_hard_coded_references' which is disabled
[0m13:20:39.892220 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' (models/marts/dag/dag.yml) depends on a node named 'fct_too_many_joins' which is disabled
[0m13:20:39.892488 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.valid_test_coverage.df03f31e09' (models/marts/tests/testing.yml) depends on a node named 'fct_test_coverage' which is disabled
[0m13:20:39.892759 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0' (models/marts/tests/testing.yml) depends on a node named 'fct_missing_primary_key_tests' which is disabled
[0m13:20:39.893034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0' (models/marts/governance/governance.yml) depends on a node named 'fct_public_models_without_contract' which is disabled
[0m13:20:39.893307 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938' (models/marts/governance/governance.yml) depends on a node named 'fct_undocumented_public_models' which is disabled
[0m13:20:39.893583 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e' (models/marts/governance/governance.yml) depends on a node named 'fct_exposures_dependent_on_private_models' which is disabled
[0m13:20:39.893854 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33' (models/marts/performance/performance.yml) depends on a node named 'fct_chained_views_dependencies' which is disabled
[0m13:20:39.894124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db' (models/marts/structure/structure.yml) depends on a node named 'fct_model_directories' which is disabled
[0m13:20:39.894396 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2' (models/marts/structure/structure.yml) depends on a node named 'fct_model_naming_conventions' which is disabled
[0m13:20:39.894667 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c' (models/marts/structure/structure.yml) depends on a node named 'fct_source_directories' which is disabled
[0m13:20:39.894935 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433' (models/marts/structure/structure.yml) depends on a node named 'fct_test_directories' which is disabled
[0m13:20:40.002626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b66fd60>]}
[0m13:20:40.163323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbf8e0>]}
[0m13:20:40.163802 [info ] [MainThread]: Found 7 models, 4 seeds, 41 data tests, 880 macros
[0m13:20:40.168065 [info ] [MainThread]: 
[0m13:20:40.168546 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:40.174298 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:20:40.174796 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:20:40.232873 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:20:40.233253 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:20:40.233577 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:20:40.233905 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = 'dev'
    
  
  
[0m13:20:40.234208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.234484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.384645 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m13:20:40.385047 [debug] [ThreadPool]: SQL status: OK in 0.151 seconds
[0m13:20:40.386975 [debug] [ThreadPool]: On list_dev: Close
[0m13:20:40.387975 [debug] [ThreadPool]: On list_dev: Close
[0m13:20:40.390031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_analytics)
[0m13:20:40.390625 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "analytics"
"
[0m13:20:40.397559 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.397897 [debug] [ThreadPool]: On create_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m13:20:40.398182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.433394 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:20:40.434775 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.435081 [debug] [ThreadPool]: On create_dev_analytics: BEGIN
[0m13:20:40.435436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:40.435707 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.435973 [debug] [ThreadPool]: On create_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "create_dev_analytics"} */

    
    
        create schema if not exists dev.analytics
    
[0m13:20:40.437236 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:40.438008 [debug] [ThreadPool]: On create_dev_analytics: COMMIT
[0m13:20:40.438312 [debug] [ThreadPool]: Using duckdb connection "create_dev_analytics"
[0m13:20:40.438584 [debug] [ThreadPool]: On create_dev_analytics: COMMIT
[0m13:20:40.439363 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:40.439643 [debug] [ThreadPool]: On create_dev_analytics: Close
[0m13:20:40.445705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m13:20:40.451413 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:20:40.451830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_analytics, now list_dev_analytics_dev)
[0m13:20:40.452136 [debug] [ThreadPool]: On list_dev_analytics: BEGIN
[0m13:20:40.455213 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:20:40.455519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.455801 [debug] [ThreadPool]: On list_dev_analytics_dev: BEGIN
[0m13:20:40.456125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:40.489907 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:20:40.490264 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics"
[0m13:20:40.490566 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:20:40.490885 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'dev'
  
[0m13:20:40.491188 [debug] [ThreadPool]: Using duckdb connection "list_dev_analytics_dev"
[0m13:20:40.491569 [debug] [ThreadPool]: On list_dev_analytics_dev: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "connection_name": "list_dev_analytics_dev"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_dev'
    and table_catalog = 'dev'
  
[0m13:20:40.504339 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:20:40.504672 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:20:40.505729 [debug] [ThreadPool]: On list_dev_analytics: ROLLBACK
[0m13:20:40.506839 [debug] [ThreadPool]: On list_dev_analytics_dev: ROLLBACK
[0m13:20:40.507624 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics'
[0m13:20:40.507981 [debug] [ThreadPool]: Failed to rollback 'list_dev_analytics_dev'
[0m13:20:40.508253 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m13:20:40.508532 [debug] [ThreadPool]: On list_dev_analytics_dev: Close
[0m13:20:40.510417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a6110>]}
[0m13:20:40.510852 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:40.511127 [debug] [MainThread]: On master: BEGIN
[0m13:20:40.511380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:40.550413 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m13:20:40.550746 [debug] [MainThread]: On master: COMMIT
[0m13:20:40.551032 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:40.551300 [debug] [MainThread]: On master: COMMIT
[0m13:20:40.551632 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:40.551902 [debug] [MainThread]: On master: Close
[0m13:20:40.552877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:40.553222 [info ] [MainThread]: 
[0m13:20:40.555503 [debug] [Thread-1 (]: Began running node seed.ci_cd_project.raw_customers
[0m13:20:40.555892 [debug] [Thread-2 (]: Began running node seed.ci_cd_project.raw_order_items
[0m13:20:40.556366 [info ] [Thread-1 (]: 1 of 52 START seed file analytics_dev.raw_customers ............................ [RUN]
[0m13:20:40.556785 [debug] [Thread-3 (]: Began running node seed.ci_cd_project.raw_orders
[0m13:20:40.557195 [info ] [Thread-2 (]: 2 of 52 START seed file analytics_dev.raw_order_items .......................... [RUN]
[0m13:20:40.557580 [debug] [Thread-4 (]: Began running node seed.ci_cd_project.raw_products
[0m13:20:40.557948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now seed.ci_cd_project.raw_customers)
[0m13:20:40.558385 [info ] [Thread-3 (]: 3 of 52 START seed file analytics_dev.raw_orders ............................... [RUN]
[0m13:20:40.558878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dev_analytics_dev, now seed.ci_cd_project.raw_order_items)
[0m13:20:40.559326 [info ] [Thread-4 (]: 4 of 52 START seed file analytics_dev.raw_products ............................. [RUN]
[0m13:20:40.559840 [debug] [Thread-1 (]: Began compiling node seed.ci_cd_project.raw_customers
[0m13:20:40.560295 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_orders'
[0m13:20:40.560629 [debug] [Thread-2 (]: Began compiling node seed.ci_cd_project.raw_order_items
[0m13:20:40.561034 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.ci_cd_project.raw_products'
[0m13:20:40.561373 [debug] [Thread-1 (]: Began executing node seed.ci_cd_project.raw_customers
[0m13:20:40.561693 [debug] [Thread-3 (]: Began compiling node seed.ci_cd_project.raw_orders
[0m13:20:40.562330 [debug] [Thread-2 (]: Began executing node seed.ci_cd_project.raw_order_items
[0m13:20:40.562674 [debug] [Thread-4 (]: Began compiling node seed.ci_cd_project.raw_products
[0m13:20:40.569335 [debug] [Thread-3 (]: Began executing node seed.ci_cd_project.raw_orders
[0m13:20:40.582670 [debug] [Thread-4 (]: Began executing node seed.ci_cd_project.raw_products
[0m13:20:40.632107 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.640724 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.642331 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: BEGIN
[0m13:20:40.646747 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.647090 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: BEGIN
[0m13:20:40.651882 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.652249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.652582 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: BEGIN
[0m13:20:40.652921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:40.653279 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: BEGIN
[0m13:20:40.653676 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:40.654053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:20:40.690030 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:40.690419 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:40.690776 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.691102 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:40.691399 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m13:20:40.691719 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.692043 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_order_items"} */
truncate table "dev"."analytics_dev"."raw_order_items"
[0m13:20:40.692363 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.692669 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.692978 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_customers"} */
truncate table "dev"."analytics_dev"."raw_customers"
[0m13:20:40.693385 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_products"} */
truncate table "dev"."analytics_dev"."raw_products"
[0m13:20:40.693740 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "seed.ci_cd_project.raw_orders"} */
truncate table "dev"."analytics_dev"."raw_orders"
[0m13:20:40.695133 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.695467 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.695783 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.696079 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.706872 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.707878 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.708830 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.709745 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.710091 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: 
          COPY dev.analytics_dev.raw_products FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.710427 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: 
          COPY dev.analytics_dev.raw_orders FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.710760 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: 
          COPY dev.analytics_dev.raw_customers FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.711085 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: 
          COPY dev.analytics_dev.raw_order_items FROM '/Users/preben/Documents/dbt-workshop/seeds/raw_order_items.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:40.722261 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:20:40.722620 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:20:40.722945 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:20:40.723269 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m13:20:40.728368 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_customers"
[0m13:20:40.728893 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_order_items"
[0m13:20:40.729380 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_orders"
[0m13:20:40.729847 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.ci_cd_project.raw_products"
[0m13:20:40.745475 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:20:40.747678 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:20:40.748087 [debug] [Thread-2 (]: Using duckdb connection "seed.ci_cd_project.raw_order_items"
[0m13:20:40.749255 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:20:40.749600 [debug] [Thread-1 (]: Using duckdb connection "seed.ci_cd_project.raw_customers"
[0m13:20:40.750621 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:20:40.750964 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: COMMIT
[0m13:20:40.751288 [debug] [Thread-3 (]: Using duckdb connection "seed.ci_cd_project.raw_orders"
[0m13:20:40.751605 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: COMMIT
[0m13:20:40.751923 [debug] [Thread-4 (]: Using duckdb connection "seed.ci_cd_project.raw_products"
[0m13:20:40.752325 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: COMMIT
[0m13:20:40.752754 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: COMMIT
[0m13:20:40.754250 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.756174 [debug] [Thread-2 (]: On seed.ci_cd_project.raw_order_items: Close
[0m13:20:40.756581 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:40.756920 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:20:40.758009 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:20:40.758646 [debug] [Thread-1 (]: On seed.ci_cd_project.raw_customers: Close
[0m13:20:40.759205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b421f00>]}
[0m13:20:40.759843 [debug] [Thread-3 (]: On seed.ci_cd_project.raw_orders: Close
[0m13:20:40.760447 [debug] [Thread-4 (]: On seed.ci_cd_project.raw_products: Close
[0m13:20:40.760900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b61e260>]}
[0m13:20:40.761385 [info ] [Thread-2 (]: 2 of 52 OK loaded seed file analytics_dev.raw_order_items ...................... [[32mINSERT 14[0m in 0.20s]
[0m13:20:40.761839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b422800>]}
[0m13:20:40.762798 [debug] [Thread-2 (]: Finished running node seed.ci_cd_project.raw_order_items
[0m13:20:40.762353 [info ] [Thread-1 (]: 1 of 52 OK loaded seed file analytics_dev.raw_customers ........................ [[32mINSERT 10[0m in 0.20s]
[0m13:20:40.763355 [info ] [Thread-3 (]: 3 of 52 OK loaded seed file analytics_dev.raw_orders ........................... [[32mINSERT 10[0m in 0.20s]
[0m13:20:40.763922 [debug] [Thread-2 (]: Began running node model.ci_cd_project.stg_order_items
[0m13:20:40.764396 [debug] [Thread-1 (]: Finished running node seed.ci_cd_project.raw_customers
[0m13:20:40.764863 [debug] [Thread-3 (]: Finished running node seed.ci_cd_project.raw_orders
[0m13:20:40.765321 [info ] [Thread-2 (]: 5 of 52 START sql view model analytics.stg_order_items ......................... [RUN]
[0m13:20:40.765975 [debug] [Thread-1 (]: Began running node model.ci_cd_project.stg_customers
[0m13:20:40.766346 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_order_items, now model.ci_cd_project.stg_order_items)
[0m13:20:40.766718 [debug] [Thread-3 (]: Began running node model.ci_cd_project.stg_orders
[0m13:20:40.767519 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.stg_order_items
[0m13:20:40.767202 [info ] [Thread-1 (]: 6 of 52 START sql view model analytics.stg_customers ........................... [RUN]
[0m13:20:40.777282 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.stg_order_items"
[0m13:20:40.777738 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b422d40>]}
[0m13:20:40.778104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_customers, now model.ci_cd_project.stg_customers)
[0m13:20:40.768148 [info ] [Thread-3 (]: 7 of 52 START sql view model analytics.stg_orders .............................. [RUN]
[0m13:20:40.779075 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.stg_customers
[0m13:20:40.778760 [info ] [Thread-4 (]: 4 of 52 OK loaded seed file analytics_dev.raw_products ......................... [[32mINSERT 10[0m in 0.22s]
[0m13:20:40.779586 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_orders, now model.ci_cd_project.stg_orders)
[0m13:20:40.784015 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.stg_customers"
[0m13:20:40.784397 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.stg_order_items
[0m13:20:40.784874 [debug] [Thread-4 (]: Finished running node seed.ci_cd_project.raw_products
[0m13:20:40.785195 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.stg_orders
[0m13:20:40.807619 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.stg_orders"
[0m13:20:40.814500 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.stg_customers
[0m13:20:40.815955 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.stg_order_items"
[0m13:20:40.820426 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.stg_customers"
[0m13:20:40.820823 [debug] [Thread-4 (]: Began running node model.ci_cd_project.stg_products
[0m13:20:40.821358 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.stg_orders
[0m13:20:40.825140 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.stg_orders"
[0m13:20:40.821785 [info ] [Thread-4 (]: 8 of 52 START sql view model analytics.stg_products ............................ [RUN]
[0m13:20:40.825743 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.826158 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.826518 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.ci_cd_project.raw_products, now model.ci_cd_project.stg_products)
[0m13:20:40.826875 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: BEGIN
[0m13:20:40.827244 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: BEGIN
[0m13:20:40.827595 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.827911 [debug] [Thread-4 (]: Began compiling node model.ci_cd_project.stg_products
[0m13:20:40.828222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:40.828579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.829002 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: BEGIN
[0m13:20:40.832243 [debug] [Thread-4 (]: Writing injected SQL for node "model.ci_cd_project.stg_products"
[0m13:20:40.832688 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:40.833188 [debug] [Thread-4 (]: Began executing node model.ci_cd_project.stg_products
[0m13:20:40.836646 [debug] [Thread-4 (]: Writing runtime sql for node "model.ci_cd_project.stg_products"
[0m13:20:40.837402 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.837759 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: BEGIN
[0m13:20:40.838071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:40.870584 [debug] [Thread-2 (]: SQL status: OK in 0.042 seconds
[0m13:20:40.870980 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m13:20:40.871331 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.871652 [debug] [Thread-4 (]: SQL status: OK in 0.034 seconds
[0m13:20:40.871995 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:40.872332 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.872681 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */

  
  create view dev.analytics.stg_order_items__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_order_items
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        total_price,
        discount_amount,
        created_at
    from source
)

select * from staged
  );

[0m13:20:40.873019 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.873322 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.873652 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */

  
  create view dev.analytics.stg_customers__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_customers
),

staged as (
    select
        customer_id,
        first_name,
        last_name,
        email,
        phone,
        address,
        city,
        state,
        zip_code,
        country,
        created_at,
        updated_at
    from source
)

select * from staged
where true
  );

[0m13:20:40.874321 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */

  
  create view dev.analytics.stg_products__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_products
),

staged as (
    select
        product_id,
        product_name,
        category,
        subcategory,
        brand,
        price,
        cost,
        description,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:20:40.874683 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */

  
  create view dev.analytics.stg_orders__dbt_tmp as (
    

with source as (
    select * from dev.analytics_dev.raw_orders
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        total_amount,
        shipping_address,
        billing_address,
        payment_method,
        created_at,
        updated_at
    from source
)

select * from staged
  );

[0m13:20:40.875023 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.882452 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.882812 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:20:40.883178 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
alter view dev.analytics.stg_order_items__dbt_tmp rename to stg_order_items
[0m13:20:40.883498 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:20:40.883821 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:20:40.887107 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.890697 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.893889 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.894223 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:20:40.894555 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
alter view dev.analytics.stg_customers__dbt_tmp rename to stg_customers
[0m13:20:40.894906 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
alter view dev.analytics.stg_orders__dbt_tmp rename to stg_orders
[0m13:20:40.895241 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
alter view dev.analytics.stg_products__dbt_tmp rename to stg_products
[0m13:20:40.896274 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:20:40.896853 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.897182 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.897491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.897795 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: COMMIT
[0m13:20:40.898094 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.899105 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:20:40.900085 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:20:40.901124 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:20:40.901489 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.901838 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.902185 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.902527 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: COMMIT
[0m13:20:40.902870 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: COMMIT
[0m13:20:40.903172 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.903474 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: COMMIT
[0m13:20:40.909566 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.stg_order_items"
[0m13:20:40.909896 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:20:40.910268 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:20:40.910594 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_order_items"} */
drop view if exists dev.analytics.stg_order_items__dbt_backup cascade
[0m13:20:40.910903 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.913584 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.stg_customers"
[0m13:20:40.916252 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.stg_orders"
[0m13:20:40.918962 [debug] [Thread-4 (]: Using duckdb connection "model.ci_cd_project.stg_products"
[0m13:20:40.919313 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_customers"} */
drop view if exists dev.analytics.stg_customers__dbt_backup cascade
[0m13:20:40.919656 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_orders"} */
drop view if exists dev.analytics.stg_orders__dbt_backup cascade
[0m13:20:40.919968 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.920283 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.stg_products"} */
drop view if exists dev.analytics.stg_products__dbt_backup cascade
[0m13:20:40.921525 [debug] [Thread-2 (]: On model.ci_cd_project.stg_order_items: Close
[0m13:20:40.921858 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:40.922197 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:40.922693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7dd80>]}
[0m13:20:40.923793 [debug] [Thread-1 (]: On model.ci_cd_project.stg_customers: Close
[0m13:20:40.924837 [debug] [Thread-3 (]: On model.ci_cd_project.stg_orders: Close
[0m13:20:40.925145 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:40.925671 [info ] [Thread-2 (]: 5 of 52 OK created sql view model analytics.stg_order_items .................... [[32mOK[0m in 0.16s]
[0m13:20:40.926169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6410f0>]}
[0m13:20:40.927239 [debug] [Thread-4 (]: On model.ci_cd_project.stg_products: Close
[0m13:20:40.927609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02a0b0>]}
[0m13:20:40.928092 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.stg_order_items
[0m13:20:40.928610 [info ] [Thread-1 (]: 6 of 52 OK created sql view model analytics.stg_customers ...................... [[32mOK[0m in 0.15s]
[0m13:20:40.929201 [info ] [Thread-3 (]: 7 of 52 OK created sql view model analytics.stg_orders ......................... [[32mOK[0m in 0.15s]
[0m13:20:40.929940 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.stg_customers
[0m13:20:40.930310 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.930829 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.stg_orders
[0m13:20:40.931198 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.931675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b43c8b0>]}
[0m13:20:40.932039 [info ] [Thread-2 (]: 9 of 52 START test not_null_stg_order_items_order_id ........................... [RUN]
[0m13:20:40.932657 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.933280 [info ] [Thread-1 (]: 10 of 52 START test not_null_stg_order_items_order_item_id ..................... [RUN]
[0m13:20:40.934024 [info ] [Thread-4 (]: 8 of 52 OK created sql view model analytics.stg_products ....................... [[32mOK[0m in 0.11s]
[0m13:20:40.934419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_order_items, now test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96)
[0m13:20:40.934784 [info ] [Thread-3 (]: 11 of 52 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m13:20:40.935188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_customers, now test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35)
[0m13:20:40.935671 [debug] [Thread-4 (]: Finished running node model.ci_cd_project.stg_products
[0m13:20:40.935987 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.936349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_orders, now test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6)
[0m13:20:40.936820 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.937222 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.947054 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:40.947424 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.951428 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.951822 [info ] [Thread-4 (]: 12 of 52 START test not_null_stg_order_items_quantity .......................... [RUN]
[0m13:20:40.956028 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.956564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.stg_products, now test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7)
[0m13:20:40.957005 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:40.957329 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:40.957667 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.980129 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.991356 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:40.992015 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:40.992452 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:40.995476 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.995900 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:40.998697 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:40.999128 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:40.999604 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:40.999970 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:41.000302 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: BEGIN
[0m13:20:41.000644 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: BEGIN
[0m13:20:41.000986 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:41.001295 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: BEGIN
[0m13:20:41.001608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.001928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.002242 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: BEGIN
[0m13:20:41.002587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.003004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.039833 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:41.040225 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"
[0m13:20:41.040577 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.stg_order_items
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.040925 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m13:20:41.041296 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.041691 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.042020 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"
[0m13:20:41.042342 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:20:41.042665 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"
[0m13:20:41.043031 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_order_items
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.043435 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_order_items
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.043809 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.044138 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.stg_order_items
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.047412 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: ROLLBACK
[0m13:20:41.047832 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.048164 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.048519 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35'
[0m13:20:41.048840 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.050013 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: ROLLBACK
[0m13:20:41.051125 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: ROLLBACK
[0m13:20:41.051460 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35: Close
[0m13:20:41.051891 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96'
[0m13:20:41.052957 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: ROLLBACK
[0m13:20:41.053334 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7'
[0m13:20:41.053711 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96: Close
[0m13:20:41.054198 [info ] [Thread-1 (]: 10 of 52 PASS not_null_stg_order_items_order_item_id ........................... [[32mPASS[0m in 0.12s]
[0m13:20:41.054683 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6'
[0m13:20:41.055043 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7: Close
[0m13:20:41.055593 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35
[0m13:20:41.056039 [info ] [Thread-2 (]: 9 of 52 PASS not_null_stg_order_items_order_id ................................. [[32mPASS[0m in 0.12s]
[0m13:20:41.056403 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6: Close
[0m13:20:41.056819 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.057260 [info ] [Thread-4 (]: 12 of 52 PASS not_null_stg_order_items_quantity ................................ [[32mPASS[0m in 0.10s]
[0m13:20:41.057808 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96
[0m13:20:41.058227 [info ] [Thread-1 (]: 13 of 52 START test unique_stg_order_items_order_item_id ....................... [RUN]
[0m13:20:41.058740 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7
[0m13:20:41.059121 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.059575 [info ] [Thread-3 (]: 11 of 52 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 0.12s]
[0m13:20:41.060063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_item_id.26a7e2bc35, now test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108)
[0m13:20:41.060474 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.061015 [info ] [Thread-2 (]: 14 of 52 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m13:20:41.061569 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:20:41.061894 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.062225 [info ] [Thread-4 (]: 15 of 52 START test not_null_stg_customers_email ............................... [RUN]
[0m13:20:41.062608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_order_id.2063801f96, now test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:20:41.062986 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.069692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_quantity.ae199f05a7, now test.ci_cd_project.not_null_stg_customers_email.d7cf761533)
[0m13:20:41.071106 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.071463 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.071830 [info ] [Thread-3 (]: 16 of 52 START test not_null_stg_customers_first_name .......................... [RUN]
[0m13:20:41.072211 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.076372 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.076771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_order_items_product_id.5154a8a6f6, now test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033)
[0m13:20:41.080838 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.081311 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.081662 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.085665 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.089688 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.090144 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.090539 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.093328 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.096122 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.096500 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.096966 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.099744 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.100158 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: BEGIN
[0m13:20:41.100524 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.100958 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.101281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.101616 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:20:41.101967 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: BEGIN
[0m13:20:41.102318 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.102714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.103061 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.103503 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: BEGIN
[0m13:20:41.103881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.138661 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.139022 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.139339 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"
[0m13:20:41.139677 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.140030 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.140336 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:20:41.140678 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_order_items
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.141016 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"
[0m13:20:41.141320 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"
[0m13:20:41.141645 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.142145 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from dev.analytics.stg_customers
where email is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.142556 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_name
from dev.analytics.stg_customers
where first_name is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.143535 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.143907 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.145172 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:20:41.145546 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.145895 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.147112 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: ROLLBACK
[0m13:20:41.147495 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:20:41.148624 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m13:20:41.149735 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: ROLLBACK
[0m13:20:41.150129 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033'
[0m13:20:41.150446 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:20:41.150839 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_email.d7cf761533'
[0m13:20:41.151229 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108'
[0m13:20:41.151534 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033: Close
[0m13:20:41.152054 [info ] [Thread-2 (]: 14 of 52 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.152408 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_customers_email.d7cf761533: Close
[0m13:20:41.152725 [debug] [Thread-1 (]: On test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108: Close
[0m13:20:41.153223 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:20:41.153667 [info ] [Thread-3 (]: 16 of 52 PASS not_null_stg_customers_first_name ................................ [[32mPASS[0m in 0.08s]
[0m13:20:41.154186 [info ] [Thread-4 (]: 15 of 52 PASS not_null_stg_customers_email ..................................... [[32mPASS[0m in 0.08s]
[0m13:20:41.154650 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.155169 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033
[0m13:20:41.155624 [info ] [Thread-1 (]: 13 of 52 PASS unique_stg_order_items_order_item_id ............................. [[32mPASS[0m in 0.10s]
[0m13:20:41.156096 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_customers_email.d7cf761533
[0m13:20:41.156436 [info ] [Thread-2 (]: 17 of 52 START test not_null_stg_customers_last_name ........................... [RUN]
[0m13:20:41.156820 [debug] [Thread-3 (]: Began running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.157330 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108
[0m13:20:41.157699 [debug] [Thread-4 (]: Began running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.158084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186)
[0m13:20:41.158493 [info ] [Thread-3 (]: 18 of 52 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:20:41.159122 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.159520 [info ] [Thread-4 (]: 19 of 52 START test unique_stg_customers_email ................................. [RUN]
[0m13:20:41.159893 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.160257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_first_name.57f99cf033, now test.ci_cd_project.unique_stg_customers_customer_id.c7614daada)
[0m13:20:41.160607 [info ] [Thread-1 (]: 20 of 52 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m13:20:41.160973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_email.d7cf761533, now test.ci_cd_project.unique_stg_customers_email.1ebcb2333e)
[0m13:20:41.166621 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.166998 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.167373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_order_items_order_item_id.90e333a108, now test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:20:41.167708 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.171956 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.172328 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.176388 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.180602 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.180969 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.181466 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.185262 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.188127 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.188496 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.188809 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.191624 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.194453 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.194865 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.195371 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.195702 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: BEGIN
[0m13:20:41.196113 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:20:41.196454 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.196804 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.197200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.197512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.197832 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:20:41.198146 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m13:20:41.198555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.198875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.233401 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.233746 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.234109 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"
[0m13:20:41.234457 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.234784 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.235088 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"
[0m13:20:41.235424 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.235758 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:20:41.236061 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"
[0m13:20:41.236413 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_name
from dev.analytics.stg_customers
where last_name is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.236887 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.stg_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.237243 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from dev.analytics.stg_customers
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.237680 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.238132 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.239535 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:20:41.240884 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: ROLLBACK
[0m13:20:41.241266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.241582 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.241954 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_customer_id.c7614daada'
[0m13:20:41.242335 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186'
[0m13:20:41.243515 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:20:41.244657 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m13:20:41.244995 [debug] [Thread-3 (]: On test.ci_cd_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:20:41.245325 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186: Close
[0m13:20:41.245720 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5'
[0m13:20:41.246096 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.unique_stg_customers_email.1ebcb2333e'
[0m13:20:41.246593 [info ] [Thread-3 (]: 18 of 52 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.247142 [info ] [Thread-2 (]: 17 of 52 PASS not_null_stg_customers_last_name ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.247496 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:20:41.247829 [debug] [Thread-4 (]: On test.ci_cd_project.unique_stg_customers_email.1ebcb2333e: Close
[0m13:20:41.248301 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.unique_stg_customers_customer_id.c7614daada
[0m13:20:41.248753 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186
[0m13:20:41.249294 [info ] [Thread-1 (]: 20 of 52 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m13:20:41.249743 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.250148 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.250699 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:20:41.251164 [info ] [Thread-4 (]: 19 of 52 PASS unique_stg_customers_email ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.251537 [info ] [Thread-3 (]: 21 of 52 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:20:41.251898 [info ] [Thread-2 (]: 22 of 52 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m13:20:41.252327 [debug] [Thread-1 (]: Began running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.252819 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.unique_stg_customers_email.1ebcb2333e
[0m13:20:41.253230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_customer_id.c7614daada, now test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:20:41.253849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_customers_last_name.fa1ab1e186, now test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b)
[0m13:20:41.254232 [info ] [Thread-1 (]: 23 of 52 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:20:41.254640 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.254989 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.255345 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.255704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m13:20:41.256061 [info ] [Thread-4 (]: 24 of 52 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:20:41.261718 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.265768 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.266142 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.266508 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_customers_email.1ebcb2333e, now test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:20:41.271904 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.272309 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.277329 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.277703 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.322296 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.322749 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.323099 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.326037 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.326414 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.329116 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.329582 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.332342 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.332809 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m13:20:41.333342 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.333739 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.334121 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.334572 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: BEGIN
[0m13:20:41.334974 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.335316 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:20:41.335655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.335997 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:20:41.336312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.336652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.370267 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.370608 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.370918 [debug] [Thread-3 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.371257 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:20:41.371606 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m13:20:41.371937 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"
[0m13:20:41.372260 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:41.372615 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from dev.analytics.stg_order_items
    where order_id is not null
),

parent as (
    select order_id as to_field
    from dev.analytics.stg_orders
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.372969 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:20:41.373298 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from dev.analytics.stg_orders
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.373641 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.374137 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from dev.analytics.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from dev.analytics.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.375073 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.375445 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.376778 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m13:20:41.377183 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.377498 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.378614 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:20:41.379030 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b'
[0m13:20:41.380180 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:20:41.381276 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: ROLLBACK
[0m13:20:41.381663 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:20:41.381971 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m13:20:41.382365 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:20:41.382756 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54'
[0m13:20:41.383055 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:20:41.383835 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:20:41.383563 [info ] [Thread-2 (]: 22 of 52 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.13s]
[0m13:20:41.384249 [debug] [Thread-1 (]: On test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: Close
[0m13:20:41.384735 [info ] [Thread-3 (]: 21 of 52 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m13:20:41.385194 [info ] [Thread-4 (]: 24 of 52 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.12s]
[0m13:20:41.385693 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b
[0m13:20:41.386179 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:41.386654 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:20:41.387028 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.387509 [info ] [Thread-1 (]: 23 of 52 PASS relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.13s]
[0m13:20:41.387969 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.388368 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.388718 [info ] [Thread-2 (]: 25 of 52 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:20:41.389214 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:20:41.389588 [info ] [Thread-3 (]: 26 of 52 START test not_null_stg_products_cost ................................. [RUN]
[0m13:20:41.390020 [info ] [Thread-4 (]: 27 of 52 START test not_null_stg_products_price ................................ [RUN]
[0m13:20:41.390518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_total_amount.f31d98d41b, now test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:20:41.390926 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.391327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_orders_order_id.81cfe2fe64, now test.ci_cd_project.not_null_stg_products_cost.addf44ba80)
[0m13:20:41.391687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ci_cd_project.not_null_stg_products_price.2d147627d4)
[0m13:20:41.392013 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.392363 [info ] [Thread-1 (]: 28 of 52 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:20:41.392704 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.393008 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.398425 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.398825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:20:41.402800 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.407070 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.407516 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.411665 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.412066 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.415977 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.416581 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.416909 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.417210 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.419923 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.422743 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.423147 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.425906 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.426389 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:20:41.426875 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.427220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.427573 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.427915 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: BEGIN
[0m13:20:41.428360 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.428696 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: BEGIN
[0m13:20:41.429015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.429354 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:20:41.429663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.430002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.464303 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.464636 [debug] [Thread-4 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.464978 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:41.465318 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.465620 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.465939 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_price.2d147627d4"
[0m13:20:41.466278 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.466616 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"
[0m13:20:41.466922 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:20:41.467245 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from dev.analytics.stg_products
where price is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.467698 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_cost.addf44ba80"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cost
from dev.analytics.stg_products
where cost is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.468066 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.stg_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.468500 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.469009 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.470284 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:20:41.470608 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.471812 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m13:20:41.472196 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a'
[0m13:20:41.472505 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.472915 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_price.2d147627d4'
[0m13:20:41.474059 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: ROLLBACK
[0m13:20:41.474383 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:20:41.474754 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_stg_products_price.2d147627d4: Close
[0m13:20:41.475813 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:20:41.476195 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_cost.addf44ba80'
[0m13:20:41.477501 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3'
[0m13:20:41.476732 [info ] [Thread-4 (]: 27 of 52 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.477914 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_stg_products_cost.addf44ba80: Close
[0m13:20:41.477143 [info ] [Thread-2 (]: 25 of 52 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.478339 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:20:41.478821 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_stg_products_price.2d147627d4
[0m13:20:41.479310 [info ] [Thread-3 (]: 26 of 52 PASS not_null_stg_products_cost ....................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.479776 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a
[0m13:20:41.480187 [debug] [Thread-4 (]: Began running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.480661 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_stg_products_cost.addf44ba80
[0m13:20:41.481069 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.481550 [info ] [Thread-1 (]: 28 of 52 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m13:20:41.482027 [info ] [Thread-4 (]: 29 of 52 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m13:20:41.483082 [debug] [Thread-3 (]: Began running node model.ci_cd_project.dim_customers
[0m13:20:41.482589 [info ] [Thread-2 (]: 30 of 52 START test unique_stg_products_product_id ............................. [RUN]
[0m13:20:41.483668 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3
[0m13:20:41.484048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_price.2d147627d4, now test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m13:20:41.484512 [info ] [Thread-3 (]: 31 of 52 START sql table model analytics.dim_customers ......................... [RUN]
[0m13:20:41.484922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_orders_order_id.e3b841c71a, now test.ci_cd_project.unique_stg_products_product_id.7d950a1467)
[0m13:20:41.485346 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.485696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_cost.addf44ba80, now model.ci_cd_project.dim_customers)
[0m13:20:41.486019 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.492679 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.493009 [debug] [Thread-3 (]: Began compiling node model.ci_cd_project.dim_customers
[0m13:20:41.497029 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.500767 [debug] [Thread-3 (]: Writing injected SQL for node "model.ci_cd_project.dim_customers"
[0m13:20:41.502084 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.502436 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.502752 [debug] [Thread-3 (]: Began executing node model.ci_cd_project.dim_customers
[0m13:20:41.505596 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.509300 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.528595 [debug] [Thread-3 (]: Writing runtime sql for node "model.ci_cd_project.dim_customers"
[0m13:20:41.529241 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.529639 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.530002 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:20:41.530347 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: BEGIN
[0m13:20:41.530693 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.531025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.531390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.531718 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: BEGIN
[0m13:20:41.532139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.567051 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.567442 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"
[0m13:20:41.567793 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m13:20:41.568145 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:20:41.568480 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.stg_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.568832 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.569158 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:20:41.569647 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */

  
    
    

    create  table
      dev.analytics.dim_customers__dbt_tmp
  
    as (
      

with customers as (
    select * from dev.analytics.stg_customers
),

customer_metrics as (
    select
        customer_id,
        count(*) as total_orders,
        sum(total_amount) as total_spent,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date
    from dev.analytics.stg_orders
    group by customer_id
)

select
    c.customer_id,
    c.first_name,
    c.last_name,
    c.email,
    c.phone,
    c.address,
    c.city,
    c.state,
    c.zip_code,
    c.country,
    c.created_at,
    c.updated_at,
    coalesce(cm.total_orders, 0) as total_orders,
    coalesce(cm.total_spent, 0) as total_spent,
    cm.first_order_date,
    cm.last_order_date,
    case
        when cm.total_spent >= 1000 then 'VIP'
        when cm.total_spent >= 500 then 'Premium'
        when cm.total_spent >= 100 then 'Regular'
        else 'New'
    end as customer_tier
from customers c
left join customer_metrics cm on c.customer_id = cm.customer_id
    );
  
  
[0m13:20:41.570076 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from dev.analytics.stg_order_items
    where product_id is not null
),

parent as (
    select product_id as to_field
    from dev.analytics.stg_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.570461 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.572025 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:20:41.572444 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.572848 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_stg_products_product_id.7d950a1467'
[0m13:20:41.573263 [debug] [Thread-2 (]: On test.ci_cd_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:20:41.574464 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: ROLLBACK
[0m13:20:41.575289 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:20:41.575666 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c'
[0m13:20:41.575016 [info ] [Thread-2 (]: 30 of 52 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:20:41.579206 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.579559 [debug] [Thread-4 (]: On test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: Close
[0m13:20:41.580115 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_stg_products_product_id.7d950a1467
[0m13:20:41.580459 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
alter table dev.analytics.dim_customers__dbt_tmp rename to dim_customers
[0m13:20:41.581108 [info ] [Thread-4 (]: 29 of 52 PASS relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.10s]
[0m13:20:41.581758 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:20:41.582207 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.586909 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:20:41.587371 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.587763 [debug] [Thread-1 (]: Began running node model.ci_cd_project.dim_products
[0m13:20:41.588070 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: COMMIT
[0m13:20:41.588380 [debug] [Thread-2 (]: Began running node model.ci_cd_project.fct_orders
[0m13:20:41.588822 [info ] [Thread-1 (]: 32 of 52 START sql table model analytics.dim_products .......................... [RUN]
[0m13:20:41.589685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_stg_products_product_id.6373b0acf3, now model.ci_cd_project.dim_products)
[0m13:20:41.589340 [info ] [Thread-2 (]: 33 of 52 START sql table model analytics.fct_orders ............................ [RUN]
[0m13:20:41.590147 [debug] [Thread-1 (]: Began compiling node model.ci_cd_project.dim_products
[0m13:20:41.590466 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.590820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_stg_products_product_id.7d950a1467, now model.ci_cd_project.fct_orders)
[0m13:20:41.594575 [debug] [Thread-1 (]: Writing injected SQL for node "model.ci_cd_project.dim_products"
[0m13:20:41.598578 [debug] [Thread-3 (]: Using duckdb connection "model.ci_cd_project.dim_customers"
[0m13:20:41.598933 [debug] [Thread-2 (]: Began compiling node model.ci_cd_project.fct_orders
[0m13:20:41.599346 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_customers"} */
drop table if exists dev.analytics.dim_customers__dbt_backup cascade
[0m13:20:41.603485 [debug] [Thread-2 (]: Writing injected SQL for node "model.ci_cd_project.fct_orders"
[0m13:20:41.604074 [debug] [Thread-1 (]: Began executing node model.ci_cd_project.dim_products
[0m13:20:41.604425 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.608034 [debug] [Thread-1 (]: Writing runtime sql for node "model.ci_cd_project.dim_products"
[0m13:20:41.609213 [debug] [Thread-3 (]: On model.ci_cd_project.dim_customers: Close
[0m13:20:41.609811 [debug] [Thread-2 (]: Began executing node model.ci_cd_project.fct_orders
[0m13:20:41.613410 [debug] [Thread-2 (]: Writing runtime sql for node "model.ci_cd_project.fct_orders"
[0m13:20:41.613843 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.614192 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: BEGIN
[0m13:20:41.614633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be656c0>]}
[0m13:20:41.614975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.615374 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.615861 [info ] [Thread-3 (]: 31 of 52 OK created sql table model analytics.dim_customers .................... [[32mOK[0m in 0.13s]
[0m13:20:41.616297 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: BEGIN
[0m13:20:41.616754 [debug] [Thread-3 (]: Finished running node model.ci_cd_project.dim_customers
[0m13:20:41.617056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.617682 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.618060 [info ] [Thread-4 (]: 34 of 52 START test accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [RUN]
[0m13:20:41.618433 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.618790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3)
[0m13:20:41.619147 [info ] [Thread-3 (]: 35 of 52 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:20:41.619501 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.619866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_customers, now test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:20:41.625473 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.660557 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.661192 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:20:41.661533 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m13:20:41.665826 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.666207 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.666569 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.667044 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */

  
    
    

    create  table
      dev.analytics.dim_products__dbt_tmp
  
    as (
      

with products as (
    select * from dev.analytics.stg_products
),

product_metrics as (
    select
        product_id,
        count(*) as total_orders,
        sum(quantity) as total_quantity_sold,
        sum(total_price) as total_revenue,
        avg(unit_price) as avg_selling_price
    from dev.analytics.stg_order_items
    group by product_id
)

select
    p.product_id,
    p.product_name,
    p.category,
    p.subcategory,
    p.brand,
    p.price,
    p.cost,
    p.description,
    p.is_active,
    p.created_at,
    p.updated_at,
    coalesce(pm.total_orders, 0) as total_orders,
    coalesce(pm.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(pm.total_revenue, 0) as total_revenue,
    coalesce(pm.avg_selling_price, 0) as avg_selling_price,
    (p.price - p.cost) as profit_margin,
    case
        when pm.total_revenue >= 10000 then 'High Performance'
        when pm.total_revenue >= 5000 then 'Medium Performance'
        when pm.total_revenue >= 1000 then 'Low Performance'
        else 'No Sales'
    end as performance_category
from products p
left join product_metrics pm on p.product_id = pm.product_id
    );
  
  
[0m13:20:41.667466 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.667872 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */

  
    
    

    create  table
      dev.analytics.fct_orders__dbt_tmp
  
    as (
      

with orders as (
    select * from dev.analytics.stg_orders
),

order_items as (
    select * from dev.analytics.stg_order_items
),

products as (
    select * from dev.analytics.stg_products
),

customers as (
    select * from dev.analytics.stg_customers
),

order_details as (
    select
        oi.order_item_id,
        oi.order_id,
        oi.product_id,
        oi.quantity,
        oi.unit_price,
        oi.total_price,
        oi.discount_amount,
        o.order_date,
        o.status,
        o.customer_id,
        o.total_amount as order_total,
        p.product_name,
        p.category,
        p.brand,
        p.price as product_price,
        p.cost as product_cost,
        c.first_name,
        c.last_name,
        c.email,
        c.city,
        c.state,
        c.country,
        oi.created_at
    from order_items oi
    inner join orders o on oi.order_id = o.order_id
    inner join products p on oi.product_id = p.product_id
    inner join customers c on o.customer_id = c.customer_id
)

select * from order_details
where true
    );
  
  
[0m13:20:41.671095 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.671492 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.671966 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:41.674979 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.679182 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.679554 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:20:41.679956 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
alter table dev.analytics.dim_products__dbt_tmp rename to dim_products
[0m13:20:41.680390 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.683636 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.684096 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: BEGIN
[0m13:20:41.684463 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
alter table dev.analytics.fct_orders__dbt_tmp rename to fct_orders
[0m13:20:41.684816 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.685136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.685448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.685824 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:20:41.686930 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:20:41.687266 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.687652 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.687977 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.688292 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.689332 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:20:41.689739 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"
[0m13:20:41.690072 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.690377 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: COMMIT
[0m13:20:41.690698 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.691055 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_tier as value_field,
        count(*) as n_records

    from dev.analytics.dim_customers
    group by customer_tier

)

select *
from all_values
where value_field not in (
    'VIP','Premium','Regular','New'
)



  
  
      
    ) dbt_internal_test
[0m13:20:41.691399 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:20:41.691765 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: COMMIT
[0m13:20:41.692194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.692509 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.dim_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.692853 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.695647 [debug] [Thread-1 (]: Using duckdb connection "model.ci_cd_project.dim_products"
[0m13:20:41.696003 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:20:41.696451 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.dim_products"} */
drop table if exists dev.analytics.dim_products__dbt_backup cascade
[0m13:20:41.697641 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: ROLLBACK
[0m13:20:41.697989 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.700773 [debug] [Thread-2 (]: Using duckdb connection "model.ci_cd_project.fct_orders"
[0m13:20:41.701308 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3'
[0m13:20:41.701674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.702764 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:20:41.703104 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "model.ci_cd_project.fct_orders"} */
drop table if exists dev.analytics.fct_orders__dbt_backup cascade
[0m13:20:41.703453 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3: Close
[0m13:20:41.704513 [debug] [Thread-1 (]: On model.ci_cd_project.dim_products: Close
[0m13:20:41.704915 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m13:20:41.705512 [info ] [Thread-4 (]: 34 of 52 PASS accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New  [[32mPASS[0m in 0.09s]
[0m13:20:41.705898 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.706315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be7ac50>]}
[0m13:20:41.706631 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:20:41.707110 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3
[0m13:20:41.708134 [debug] [Thread-2 (]: On model.ci_cd_project.fct_orders: Close
[0m13:20:41.708684 [info ] [Thread-1 (]: 32 of 52 OK created sql table model analytics.dim_products ..................... [[32mOK[0m in 0.12s]
[0m13:20:41.709199 [info ] [Thread-3 (]: 35 of 52 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.709592 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.710138 [debug] [Thread-1 (]: Finished running node model.ci_cd_project.dim_products
[0m13:20:41.710583 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:20:41.711078 [info ] [Thread-4 (]: 36 of 52 START test not_null_dim_customers_customer_tier ....................... [RUN]
[0m13:20:41.711606 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.712308 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.712887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_customers_customer_tier__VIP__Premium__Regular__New.23fbc108c3, now test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075)
[0m13:20:41.713259 [info ] [Thread-1 (]: 37 of 52 START test not_null_dim_customers_total_orders ........................ [RUN]
[0m13:20:41.713622 [info ] [Thread-3 (]: 38 of 52 START test not_null_dim_customers_total_spent ......................... [RUN]
[0m13:20:41.713987 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.714349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.dim_products, now test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9)
[0m13:20:41.714702 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed)
[0m13:20:41.720746 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.721219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0672e7a-a637-4ba9-bbc4-adc7af9f33bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a63b0>]}
[0m13:20:41.721567 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.721927 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.726552 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.722553 [info ] [Thread-2 (]: 33 of 52 OK created sql table model analytics.fct_orders ....................... [[32mOK[0m in 0.13s]
[0m13:20:41.730800 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.731261 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.731782 [debug] [Thread-2 (]: Finished running node model.ci_cd_project.fct_orders
[0m13:20:41.734672 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.735086 [debug] [Thread-2 (]: Began running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.735400 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.736372 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.740276 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.736056 [info ] [Thread-2 (]: 39 of 52 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:20:41.743146 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.743617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ci_cd_project.fct_orders, now test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:20:41.743989 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.744415 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.744762 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: BEGIN
[0m13:20:41.745151 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.749222 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.749630 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.749960 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.750291 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: BEGIN
[0m13:20:41.750677 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: BEGIN
[0m13:20:41.751099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.751413 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.751713 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.754665 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.755318 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.755645 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:20:41.755948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.788924 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.789286 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"
[0m13:20:41.789609 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m13:20:41.789921 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.790247 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_tier
from dev.analytics.dim_customers
where customer_tier is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.790553 [debug] [Thread-3 (]: SQL status: OK in 0.039 seconds
[0m13:20:41.790859 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:20:41.791164 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"
[0m13:20:41.791570 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"
[0m13:20:41.791915 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:41.792227 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.792545 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from dev.analytics.dim_customers
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.792889 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from dev.analytics.dim_customers
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.794421 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: ROLLBACK
[0m13:20:41.794919 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075'
[0m13:20:41.795252 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.795562 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.795867 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075: Close
[0m13:20:41.796170 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.797315 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: ROLLBACK
[0m13:20:41.798419 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:20:41.798930 [info ] [Thread-4 (]: 36 of 52 PASS not_null_dim_customers_customer_tier ............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.800177 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: ROLLBACK
[0m13:20:41.800578 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9'
[0m13:20:41.800957 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd'
[0m13:20:41.801428 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075
[0m13:20:41.801795 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed'
[0m13:20:41.802105 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9: Close
[0m13:20:41.802415 [debug] [Thread-2 (]: On test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:20:41.802794 [debug] [Thread-4 (]: Began running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.803185 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed: Close
[0m13:20:41.803698 [info ] [Thread-1 (]: 37 of 52 PASS not_null_dim_customers_total_orders .............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.804228 [info ] [Thread-2 (]: 39 of 52 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m13:20:41.804647 [info ] [Thread-4 (]: 40 of 52 START test accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [RUN]
[0m13:20:41.805196 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9
[0m13:20:41.805643 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:20:41.806100 [info ] [Thread-3 (]: 38 of 52 PASS not_null_dim_customers_total_spent ............................... [[32mPASS[0m in 0.09s]
[0m13:20:41.806483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_customer_tier.61510b1075, now test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed)
[0m13:20:41.806858 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.807258 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.807711 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed
[0m13:20:41.808056 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.808396 [info ] [Thread-1 (]: 41 of 52 START test not_null_dim_products_performance_category ................. [RUN]
[0m13:20:41.808744 [info ] [Thread-2 (]: 42 of 52 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:20:41.809172 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.815084 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.815486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_orders.6e18bb41d9, now test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69)
[0m13:20:41.815846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1)
[0m13:20:41.816200 [info ] [Thread-3 (]: 43 of 52 START test not_null_dim_products_profit_margin ........................ [RUN]
[0m13:20:41.816617 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.816939 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.817306 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_customers_total_spent.0ff6f454ed, now test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71)
[0m13:20:41.821752 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.822123 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.826168 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.826530 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.829600 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.834941 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.835381 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.835806 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.838681 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.841458 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.841893 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.842437 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: BEGIN
[0m13:20:41.842778 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.843150 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.843599 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.846299 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.846673 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.847064 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: BEGIN
[0m13:20:41.847451 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:20:41.847768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.848099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.848438 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.848803 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: BEGIN
[0m13:20:41.849096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:41.886834 [debug] [Thread-4 (]: SQL status: OK in 0.044 seconds
[0m13:20:41.887299 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"
[0m13:20:41.887664 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.888109 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        performance_category as value_field,
        count(*) as n_records

    from dev.analytics.dim_products
    group by performance_category

)

select *
from all_values
where value_field not in (
    'High Performance','Medium Performance','Low Performance','No Sales'
)



  
  
      
    ) dbt_internal_test
[0m13:20:41.888505 [debug] [Thread-2 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.888856 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"
[0m13:20:41.889165 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:20:41.889620 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"
[0m13:20:41.889979 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select performance_category
from dev.analytics.dim_products
where performance_category is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.890355 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"
[0m13:20:41.890684 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.891021 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.dim_products
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.891422 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select profit_margin
from dev.analytics.dim_products
where profit_margin is null



  
  
      
    ) dbt_internal_test
[0m13:20:41.892800 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: ROLLBACK
[0m13:20:41.893205 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:20:41.893600 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.894011 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed'
[0m13:20:41.894333 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:41.895565 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: ROLLBACK
[0m13:20:41.896674 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:20:41.897002 [debug] [Thread-4 (]: On test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed: Close
[0m13:20:41.897432 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69'
[0m13:20:41.898487 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: ROLLBACK
[0m13:20:41.898858 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1'
[0m13:20:41.899659 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69: Close
[0m13:20:41.899388 [info ] [Thread-4 (]: 40 of 52 PASS accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales  [[32mPASS[0m in 0.09s]
[0m13:20:41.900117 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71'
[0m13:20:41.900433 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:20:41.900903 [info ] [Thread-1 (]: 41 of 52 PASS not_null_dim_products_performance_category ....................... [[32mPASS[0m in 0.09s]
[0m13:20:41.901412 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed
[0m13:20:41.901734 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71: Close
[0m13:20:41.902187 [info ] [Thread-2 (]: 42 of 52 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m13:20:41.902712 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69
[0m13:20:41.903139 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.903707 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1
[0m13:20:41.904102 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.904474 [info ] [Thread-4 (]: 44 of 52 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:20:41.905146 [info ] [Thread-3 (]: 43 of 52 PASS not_null_dim_products_profit_margin .............................. [[32mPASS[0m in 0.09s]
[0m13:20:41.905698 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.906144 [info ] [Thread-1 (]: 45 of 52 START test unique_dim_products_product_id ............................. [RUN]
[0m13:20:41.906573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.accepted_values_dim_products_performance_category__High_Performance__Medium_Performance__Low_Performance__No_Sales.85239a3fed, now test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:20:41.907052 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71
[0m13:20:41.907391 [info ] [Thread-2 (]: 46 of 52 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:20:41.907766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_performance_category.cc222c8f69, now test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985)
[0m13:20:41.908102 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.908462 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.908839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_product_id.c8aba288d1, now test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:20:41.909173 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.914963 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.915350 [info ] [Thread-3 (]: 47 of 52 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:20:41.915708 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.965667 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.966231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_profit_margin.c5a6f54e71, now test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0)
[0m13:20:41.970461 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.970963 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:41.971285 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.974215 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.978969 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.979310 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:41.979812 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:41.982590 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.985432 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.985881 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:41.986327 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:41.986734 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:20:41.987122 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:41.989832 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.990206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:41.990551 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:20:41.990912 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:41.991358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.991707 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:20:41.992053 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:41.992374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:41.992770 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:20:41.993104 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:42.026827 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m13:20:42.027210 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"
[0m13:20:42.027543 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m13:20:42.027869 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from dev.analytics.dim_products
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:42.028180 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m13:20:42.028462 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m13:20:42.028765 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"
[0m13:20:42.029114 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:20:42.029513 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:20:42.029874 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from dev.analytics.fct_orders
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.030252 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from dev.analytics.dim_products
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.030567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.030885 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from dev.analytics.fct_orders
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.032355 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:20:42.032868 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985'
[0m13:20:42.033214 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:42.033529 [debug] [Thread-1 (]: On test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:20:42.033833 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:42.034125 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.035286 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:20:42.035835 [info ] [Thread-1 (]: 45 of 52 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.13s]
[0m13:20:42.036958 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:20:42.038051 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:20:42.038435 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0'
[0m13:20:42.038899 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985
[0m13:20:42.039268 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a'
[0m13:20:42.039627 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b'
[0m13:20:42.039937 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:20:42.040305 [debug] [Thread-1 (]: Began running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.040677 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:20:42.040999 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:20:42.041484 [info ] [Thread-3 (]: 47 of 52 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:20:42.041900 [info ] [Thread-1 (]: 48 of 52 START test not_null_fct_orders_order_item_id .......................... [RUN]
[0m13:20:42.042502 [info ] [Thread-4 (]: 44 of 52 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.14s]
[0m13:20:42.043252 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0
[0m13:20:42.043623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.unique_dim_products_product_id.ef7b2a9985, now test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94)
[0m13:20:42.044156 [info ] [Thread-2 (]: 46 of 52 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m13:20:42.044662 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a
[0m13:20:42.045031 [debug] [Thread-3 (]: Began running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.045385 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.045849 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b
[0m13:20:42.046210 [debug] [Thread-4 (]: Began running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.046579 [info ] [Thread-3 (]: 49 of 52 START test not_null_fct_orders_product_id ............................. [RUN]
[0m13:20:42.052288 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.052706 [debug] [Thread-2 (]: Began running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.053088 [info ] [Thread-4 (]: 50 of 52 START test not_null_fct_orders_quantity ............................... [RUN]
[0m13:20:42.053581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_id.4e687af8d0, now test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24)
[0m13:20:42.054211 [info ] [Thread-2 (]: 51 of 52 START test not_null_fct_orders_unit_price ............................. [RUN]
[0m13:20:42.054627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_dim_products_total_revenue.07243f7e3a, now test.ci_cd_project.not_null_fct_orders_quantity.f754434156)
[0m13:20:42.054986 [debug] [Thread-3 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.055314 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.056094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_customer_id.16fe324f7b, now test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982)
[0m13:20:42.056425 [debug] [Thread-4 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.060614 [debug] [Thread-3 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.063440 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.063788 [debug] [Thread-2 (]: Began compiling node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.067866 [debug] [Thread-4 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.073357 [debug] [Thread-2 (]: Writing injected SQL for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.073894 [debug] [Thread-3 (]: Began executing node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.076709 [debug] [Thread-3 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.077163 [debug] [Thread-2 (]: Began executing node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.077557 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.077893 [debug] [Thread-4 (]: Began executing node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.080656 [debug] [Thread-2 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.081027 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: BEGIN
[0m13:20:42.081404 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.084170 [debug] [Thread-4 (]: Writing runtime sql for node "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.084570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.084908 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: BEGIN
[0m13:20:42.085360 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.085775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:20:42.086135 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.086468 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: BEGIN
[0m13:20:42.086949 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: BEGIN
[0m13:20:42.087289 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:20:42.087616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:20:42.125402 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m13:20:42.125752 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m13:20:42.126145 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m13:20:42.126493 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"
[0m13:20:42.126832 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:20:42.127144 [debug] [Thread-3 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"
[0m13:20:42.127467 [debug] [Thread-2 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"
[0m13:20:42.127808 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_item_id
from dev.analytics.fct_orders
where order_item_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.128140 [debug] [Thread-4 (]: Using duckdb connection "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"
[0m13:20:42.128469 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from dev.analytics.fct_orders
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.128818 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from dev.analytics.fct_orders
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.129271 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.not_null_fct_orders_quantity.f754434156"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from dev.analytics.fct_orders
where quantity is null



  
  
      
    ) dbt_internal_test
[0m13:20:42.129721 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.130107 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:20:42.130508 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:20:42.131787 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: ROLLBACK
[0m13:20:42.132112 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:20:42.133242 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: ROLLBACK
[0m13:20:42.134395 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: ROLLBACK
[0m13:20:42.134803 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94'
[0m13:20:42.135213 [debug] [Thread-3 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24'
[0m13:20:42.136309 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: ROLLBACK
[0m13:20:42.136704 [debug] [Thread-2 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982'
[0m13:20:42.137015 [debug] [Thread-1 (]: On test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94: Close
[0m13:20:42.137323 [debug] [Thread-3 (]: On test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24: Close
[0m13:20:42.137678 [debug] [Thread-4 (]: Failed to rollback 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156'
[0m13:20:42.137984 [debug] [Thread-2 (]: On test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982: Close
[0m13:20:42.138484 [info ] [Thread-1 (]: 48 of 52 PASS not_null_fct_orders_order_item_id ................................ [[32mPASS[0m in 0.09s]
[0m13:20:42.138883 [debug] [Thread-4 (]: On test.ci_cd_project.not_null_fct_orders_quantity.f754434156: Close
[0m13:20:42.139328 [info ] [Thread-3 (]: 49 of 52 PASS not_null_fct_orders_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:20:42.139867 [info ] [Thread-2 (]: 51 of 52 PASS not_null_fct_orders_unit_price ................................... [[32mPASS[0m in 0.08s]
[0m13:20:42.140379 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94
[0m13:20:42.140895 [debug] [Thread-3 (]: Finished running node test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24
[0m13:20:42.141398 [debug] [Thread-2 (]: Finished running node test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982
[0m13:20:42.141875 [info ] [Thread-4 (]: 50 of 52 PASS not_null_fct_orders_quantity ..................................... [[32mPASS[0m in 0.09s]
[0m13:20:42.142277 [debug] [Thread-1 (]: Began running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.142929 [debug] [Thread-4 (]: Finished running node test.ci_cd_project.not_null_fct_orders_quantity.f754434156
[0m13:20:42.143287 [info ] [Thread-1 (]: 52 of 52 START test unique_fct_orders_order_item_id ............................ [RUN]
[0m13:20:42.143889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ci_cd_project.not_null_fct_orders_order_item_id.d90f190d94, now test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7)
[0m13:20:42.144419 [debug] [Thread-1 (]: Began compiling node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.148916 [debug] [Thread-1 (]: Writing injected SQL for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.149586 [debug] [Thread-1 (]: Began executing node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.154137 [debug] [Thread-1 (]: Writing runtime sql for node "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.154887 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.155222 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: BEGIN
[0m13:20:42.155525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.193121 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m13:20:42.193489 [debug] [Thread-1 (]: Using duckdb connection "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"
[0m13:20:42.193834 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "workshop_duckdb", "target_name": "dev", "node_id": "test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from dev.analytics.fct_orders
where order_item_id is not null
group by order_item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:42.194762 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:42.196065 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: ROLLBACK
[0m13:20:42.196475 [debug] [Thread-1 (]: Failed to rollback 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7'
[0m13:20:42.196792 [debug] [Thread-1 (]: On test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7: Close
[0m13:20:42.197930 [info ] [Thread-1 (]: 52 of 52 PASS unique_fct_orders_order_item_id .................................. [[32mPASS[0m in 0.05s]
[0m13:20:42.198482 [debug] [Thread-1 (]: Finished running node test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7
[0m13:20:42.199456 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:42.199746 [debug] [MainThread]: On master: BEGIN
[0m13:20:42.200002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:42.239113 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m13:20:42.239482 [debug] [MainThread]: On master: COMMIT
[0m13:20:42.239775 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:42.240042 [debug] [MainThread]: On master: COMMIT
[0m13:20:42.240377 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:42.240654 [debug] [MainThread]: On master: Close
[0m13:20:42.241637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:42.241910 [debug] [MainThread]: Connection 'test.ci_cd_project.unique_fct_orders_order_item_id.0719ca0ce7' was properly closed.
[0m13:20:42.242158 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_unit_price.a8881f4982' was properly closed.
[0m13:20:42.242400 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_product_id.8e73ef4e24' was properly closed.
[0m13:20:42.242640 [debug] [MainThread]: Connection 'test.ci_cd_project.not_null_fct_orders_quantity.f754434156' was properly closed.
[0m13:20:42.243039 [info ] [MainThread]: 
[0m13:20:42.243345 [info ] [MainThread]: Finished running 4 seeds, 4 view models, 41 data tests, 3 table models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m13:20:42.249121 [debug] [MainThread]: Command end result
[0m13:20:42.322906 [info ] [MainThread]: 
[0m13:20:42.323323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:42.323673 [info ] [MainThread]: 
[0m13:20:42.323980 [info ] [MainThread]: Done. PASS=52 WARN=0 ERROR=0 SKIP=0 TOTAL=52
[0m13:20:42.326570 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.7717614, "process_in_blocks": "0", "process_kernel_time": 0.648976, "process_mem_max_rss": "197722112", "process_out_blocks": "0", "process_user_time": 9.237883}
[0m13:20:42.326985 [debug] [MainThread]: Command `dbt build` succeeded at 13:20:42.326906 after 5.77 seconds
[0m13:20:42.327325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a6c20>]}
[0m13:20:42.327655 [debug] [MainThread]: Flushing usage events
